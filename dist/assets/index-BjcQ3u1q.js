var e,s=Object.defineProperty,t=(e,t,a)=>((e,t,a)=>t in e?s(e,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[t]=a)(e,"symbol"!=typeof t?t+"":t,a);import{c as a,a as r,u as n,j as i,B as l,P as c,V as o,b as d,d as m,e as h,f as u,R as x,g as p,h as f,i as g,k as v,A as j,D as y,C as b,l as N,m as w,n as _,o as k,p as S,S as E,L as T,T as C,q as A,r as R,s as I,I as P,t as D,v as M,w as O,x as F,y as L,z,E as U,F as B,G as H,H as V,J as G,K as q,O as W,M as Y,N as K,Q as J,U as X,W as Z,X as Q,Y as ee,Z as se,_ as te,$ as ae,a0 as re,a1 as ne,a2 as ie}from"./ui-LjY_H29l.js";import{a as le,r as ce,R as oe,v as de,u as me,d as he,N as ue,O as xe,e as pe,B as fe,f as ge,h as ve}from"./vendor-DLSghn9u.js";import{c as je,a as ye}from"./utils-DUg4_aAP.js";import{Q as be,a as Ne}from"./query-CAvIcl5m.js";import{c as we}from"./supabase-B2fm64Xi.js";import{E as _e}from"./charts-CJOb3IqK.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&s(e)}).observe(document,{childList:!0,subtree:!0})}function s(e){if(e.ep)return;e.ep=!0;const s=function(e){const s={};return e.integrity&&(s.integrity=e.integrity),e.referrerPolicy&&(s.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?s.credentials="include":"anonymous"===e.crossOrigin?s.credentials="omit":s.credentials="same-origin",s}(e);fetch(e.href,s)}}();var ke=le;e=ke.createRoot,ke.hydrateRoot;let Se=0;const Ee=new Map,Te=e=>{if(Ee.has(e))return;const s=setTimeout(()=>{Ee.delete(e),Ie({type:"REMOVE_TOAST",toastId:e})},1e6);Ee.set(e,s)},Ce=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{const{toastId:t}=s;return t?Te(t):e.toasts.forEach(e=>{Te(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":return void 0===s.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},Ae=[];let Re={toasts:[]};function Ie(e){Re=Ce(Re,e),Ae.forEach(e=>{e(Re)})}function Pe({...e}){const s=(Se=(Se+1)%Number.MAX_SAFE_INTEGER,Se.toString()),t=()=>Ie({type:"DISMISS_TOAST",toastId:s});return Ie({type:"ADD_TOAST",toast:{...e,id:s,open:!0,onOpenChange:e=>{e||t()}}}),{id:s,dismiss:t,update:e=>Ie({type:"UPDATE_TOAST",toast:{...e,id:s}})}}function De(){const[e,s]=ce.useState(Re);return ce.useEffect(()=>(Ae.push(s),()=>{const e=Ae.indexOf(s);e>-1&&Ae.splice(e,1)}),[e]),{...e,toast:Pe,dismiss:e=>Ie({type:"DISMISS_TOAST",toastId:e})}}var Me="ToastProvider",[Oe,Fe,Le]=a("Toast"),[ze,Ue]=r("Toast",[Le]),[Be,$e]=ze(Me),He=e=>{const{__scopeToast:s,label:t="Notification",duration:a=5e3,swipeDirection:r="right",swipeThreshold:n=50,children:l}=e,[c,o]=ce.useState(null),[d,m]=ce.useState(0),h=ce.useRef(!1),u=ce.useRef(!1);return t.trim(),i.jsx(Oe.Provider,{scope:s,children:i.jsx(Be,{scope:s,label:t,duration:a,swipeDirection:r,swipeThreshold:n,toastCount:d,viewport:c,onViewportChange:o,onToastAdd:ce.useCallback(()=>m(e=>e+1),[]),onToastRemove:ce.useCallback(()=>m(e=>e-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:u,children:l})})};He.displayName=Me;var Ve="ToastViewport",Ge=["F8"],qe="toast.viewportPause",We="toast.viewportResume",Ye=ce.forwardRef((e,s)=>{const{__scopeToast:t,hotkey:a=Ge,label:r="Notifications ({hotkey})",...o}=e,d=$e(Ve,t),m=Fe(t),h=ce.useRef(null),u=ce.useRef(null),x=ce.useRef(null),p=ce.useRef(null),f=n(s,p,d.onViewportChange),g=a.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=d.toastCount>0;ce.useEffect(()=>{const e=e=>{var s;0!==a.length&&a.every(s=>e[s]||e.code===s)&&(null==(s=p.current)||s.focus())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[a]),ce.useEffect(()=>{const e=h.current,s=p.current;if(v&&e&&s){const t=()=>{if(!d.isClosePausedRef.current){const e=new CustomEvent(qe);s.dispatchEvent(e),d.isClosePausedRef.current=!0}},a=()=>{if(d.isClosePausedRef.current){const e=new CustomEvent(We);s.dispatchEvent(e),d.isClosePausedRef.current=!1}},r=s=>{!e.contains(s.relatedTarget)&&a()},n=()=>{e.contains(document.activeElement)||a()};return e.addEventListener("focusin",t),e.addEventListener("focusout",r),e.addEventListener("pointermove",t),e.addEventListener("pointerleave",n),window.addEventListener("blur",t),window.addEventListener("focus",a),()=>{e.removeEventListener("focusin",t),e.removeEventListener("focusout",r),e.removeEventListener("pointermove",t),e.removeEventListener("pointerleave",n),window.removeEventListener("blur",t),window.removeEventListener("focus",a)}}},[v,d.isClosePausedRef]);const j=ce.useCallback(({tabbingDirection:e})=>{const s=m().map(s=>{const t=s.ref.current,a=[t,...hs(t)];return"forwards"===e?a:a.reverse()});return("forwards"===e?s.reverse():s).flat()},[m]);return ce.useEffect(()=>{const e=p.current;if(e){const s=s=>{var t,a,r;const n=s.altKey||s.ctrlKey||s.metaKey;if("Tab"===s.key&&!n){const n=document.activeElement,i=s.shiftKey;if(s.target===e&&i)return void(null==(t=u.current)||t.focus());const l=j({tabbingDirection:i?"backwards":"forwards"}),c=l.findIndex(e=>e===n);us(l.slice(c+1))?s.preventDefault():i?null==(a=u.current)||a.focus():null==(r=x.current)||r.focus()}};return e.addEventListener("keydown",s),()=>e.removeEventListener("keydown",s)}},[m,j]),i.jsxs(l,{ref:h,role:"region","aria-label":r.replace("{hotkey}",g),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&i.jsx(Je,{ref:u,onFocusFromOutsideViewport:()=>{us(j({tabbingDirection:"forwards"}))}}),i.jsx(Oe.Slot,{scope:t,children:i.jsx(c.ol,{tabIndex:-1,...o,ref:f})}),v&&i.jsx(Je,{ref:x,onFocusFromOutsideViewport:()=>{us(j({tabbingDirection:"backwards"}))}})]})});Ye.displayName=Ve;var Ke="ToastFocusProxy",Je=ce.forwardRef((e,s)=>{const{__scopeToast:t,onFocusFromOutsideViewport:a,...r}=e,n=$e(Ke,t);return i.jsx(o,{"aria-hidden":!0,tabIndex:0,...r,ref:s,style:{position:"fixed"},onFocus:e=>{var s;const t=e.relatedTarget;!(null==(s=n.viewport)?void 0:s.contains(t))&&a()}})});Je.displayName=Ke;var Xe="Toast",Ze=ce.forwardRef((e,s)=>{const{forceMount:t,open:a,defaultOpen:r,onOpenChange:n,...l}=e,[c,o]=d({prop:a,defaultProp:r??!0,onChange:n,caller:Xe});return i.jsx(m,{present:t||c,children:i.jsx(ss,{open:c,...l,ref:s,onClose:()=>o(!1),onPause:h(e.onPause),onResume:h(e.onResume),onSwipeStart:u(e.onSwipeStart,e=>{e.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:u(e.onSwipeMove,e=>{const{x:s,y:t}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","move"),e.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${s}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${t}px`)}),onSwipeCancel:u(e.onSwipeCancel,e=>{e.currentTarget.setAttribute("data-swipe","cancel"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:u(e.onSwipeEnd,e=>{const{x:s,y:t}=e.detail.delta;e.currentTarget.setAttribute("data-swipe","end"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),e.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),e.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${s}px`),e.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${t}px`),o(!1)})})})});Ze.displayName=Xe;var[Qe,es]=ze(Xe,{onClose(){}}),ss=ce.forwardRef((e,s)=>{const{__scopeToast:t,type:a="foreground",duration:r,open:l,onClose:o,onEscapeKeyDown:d,onPause:m,onResume:p,onSwipeStart:f,onSwipeMove:g,onSwipeCancel:v,onSwipeEnd:j,...y}=e,b=$e(Xe,t),[N,w]=ce.useState(null),_=n(s,e=>w(e)),k=ce.useRef(null),S=ce.useRef(null),E=r||b.duration,T=ce.useRef(0),C=ce.useRef(E),A=ce.useRef(0),{onToastAdd:R,onToastRemove:I}=b,P=h(()=>{var e;(null==N?void 0:N.contains(document.activeElement))&&(null==(e=b.viewport)||e.focus()),o()}),D=ce.useCallback(e=>{e&&e!==1/0&&(window.clearTimeout(A.current),T.current=(new Date).getTime(),A.current=window.setTimeout(P,e))},[P]);ce.useEffect(()=>{const e=b.viewport;if(e){const s=()=>{D(C.current),null==p||p()},t=()=>{const e=(new Date).getTime()-T.current;C.current=C.current-e,window.clearTimeout(A.current),null==m||m()};return e.addEventListener(qe,t),e.addEventListener(We,s),()=>{e.removeEventListener(qe,t),e.removeEventListener(We,s)}}},[b.viewport,E,m,p,D]),ce.useEffect(()=>{l&&!b.isClosePausedRef.current&&D(E)},[l,E,b.isClosePausedRef,D]),ce.useEffect(()=>(R(),()=>I()),[R,I]);const M=ce.useMemo(()=>N?os(N):null,[N]);return b.viewport?i.jsxs(i.Fragment,{children:[M&&i.jsx(ts,{__scopeToast:t,role:"status","aria-live":"foreground"===a?"assertive":"polite","aria-atomic":!0,children:M}),i.jsx(Qe,{scope:t,onClose:P,children:le.createPortal(i.jsx(Oe.ItemSlot,{scope:t,children:i.jsx(x,{asChild:!0,onEscapeKeyDown:u(d,()=>{b.isFocusedToastEscapeKeyDownRef.current||P(),b.isFocusedToastEscapeKeyDownRef.current=!1}),children:i.jsx(c.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":l?"open":"closed","data-swipe-direction":b.swipeDirection,...y,ref:_,style:{userSelect:"none",touchAction:"none",...e.style},onKeyDown:u(e.onKeyDown,e=>{"Escape"===e.key&&(null==d||d(e.nativeEvent),e.nativeEvent.defaultPrevented||(b.isFocusedToastEscapeKeyDownRef.current=!0,P()))}),onPointerDown:u(e.onPointerDown,e=>{0===e.button&&(k.current={x:e.clientX,y:e.clientY})}),onPointerMove:u(e.onPointerMove,e=>{if(!k.current)return;const s=e.clientX-k.current.x,t=e.clientY-k.current.y,a=Boolean(S.current),r=["left","right"].includes(b.swipeDirection),n=["left","up"].includes(b.swipeDirection)?Math.min:Math.max,i=r?n(0,s):0,l=r?0:n(0,t),c="touch"===e.pointerType?10:2,o={x:i,y:l},d={originalEvent:e,delta:o};a?(S.current=o,ds("toast.swipeMove",g,d,{discrete:!1})):ms(o,b.swipeDirection,c)?(S.current=o,ds("toast.swipeStart",f,d,{discrete:!1}),e.target.setPointerCapture(e.pointerId)):(Math.abs(s)>c||Math.abs(t)>c)&&(k.current=null)}),onPointerUp:u(e.onPointerUp,e=>{const s=S.current,t=e.target;if(t.hasPointerCapture(e.pointerId)&&t.releasePointerCapture(e.pointerId),S.current=null,k.current=null,s){const t=e.currentTarget,a={originalEvent:e,delta:s};ms(s,b.swipeDirection,b.swipeThreshold)?ds("toast.swipeEnd",j,a,{discrete:!0}):ds("toast.swipeCancel",v,a,{discrete:!0}),t.addEventListener("click",e=>e.preventDefault(),{once:!0})}})})})}),b.viewport)})]}):null}),ts=e=>{const{__scopeToast:s,children:t,...a}=e,r=$e(Xe,s),[n,l]=ce.useState(!1),[c,d]=ce.useState(!1);return function(e=()=>{}){const s=h(e);f(()=>{let e=0,t=0;return e=window.requestAnimationFrame(()=>t=window.requestAnimationFrame(s)),()=>{window.cancelAnimationFrame(e),window.cancelAnimationFrame(t)}},[s])}(()=>l(!0)),ce.useEffect(()=>{const e=window.setTimeout(()=>d(!0),1e3);return()=>window.clearTimeout(e)},[]),c?null:i.jsx(p,{asChild:!0,children:i.jsx(o,{...a,children:n&&i.jsxs(i.Fragment,{children:[r.label," ",t]})})})},as=ce.forwardRef((e,s)=>{const{__scopeToast:t,...a}=e;return i.jsx(c.div,{...a,ref:s})});as.displayName="ToastTitle";var rs=ce.forwardRef((e,s)=>{const{__scopeToast:t,...a}=e;return i.jsx(c.div,{...a,ref:s})});rs.displayName="ToastDescription";var ns=ce.forwardRef((e,s)=>{const{altText:t,...a}=e;return t.trim()?i.jsx(cs,{altText:t,asChild:!0,children:i.jsx(ls,{...a,ref:s})}):null});ns.displayName="ToastAction";var is="ToastClose",ls=ce.forwardRef((e,s)=>{const{__scopeToast:t,...a}=e,r=es(is,t);return i.jsx(cs,{asChild:!0,children:i.jsx(c.button,{type:"button",...a,ref:s,onClick:u(e.onClick,r.onClose)})})});ls.displayName=is;var cs=ce.forwardRef((e,s)=>{const{__scopeToast:t,altText:a,...r}=e;return i.jsx(c.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":a||void 0,...r,ref:s})});function os(e){const s=[];return Array.from(e.childNodes).forEach(e=>{if(e.nodeType===e.TEXT_NODE&&e.textContent&&s.push(e.textContent),function(e){return e.nodeType===e.ELEMENT_NODE}(e)){const t=e.ariaHidden||e.hidden||"none"===e.style.display,a=""===e.dataset.radixToastAnnounceExclude;if(!t)if(a){const t=e.dataset.radixToastAnnounceAlt;t&&s.push(t)}else s.push(...os(e))}}),s}function ds(e,s,t,{discrete:a}){const r=t.originalEvent.currentTarget,n=new CustomEvent(e,{bubbles:!0,cancelable:!0,detail:t});s&&r.addEventListener(e,s,{once:!0}),a?g(r,n):r.dispatchEvent(n)}var ms=(e,s,t=0)=>{const a=Math.abs(e.x),r=Math.abs(e.y),n=a>r;return"left"===s||"right"===s?n&&a>t:!n&&r>t};function hs(e){const s=[],t=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:e=>{const s="INPUT"===e.tagName&&"hidden"===e.type;return e.disabled||e.hidden||s?NodeFilter.FILTER_SKIP:e.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;t.nextNode();)s.push(t.currentNode);return s}function us(e){const s=document.activeElement;return e.some(e=>e===s||(e.focus(),document.activeElement!==s))}var xs=He,ps=Ye,fs=Ze,gs=as,vs=rs,js=ns,ys=ls;
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
const bs=(...e)=>e.filter((e,s,t)=>Boolean(e)&&""!==e.trim()&&t.indexOf(e)===s).join(" ").trim();
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */
var Ns={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=ce.forwardRef(({color:e="currentColor",size:s=24,strokeWidth:t=2,absoluteStrokeWidth:a,className:r="",children:n,iconNode:i,...l},c)=>ce.createElement("svg",{ref:c,...Ns,width:s,height:s,stroke:e,strokeWidth:a?24*Number(t)/Number(s):t,className:bs("lucide",r),...l},[...i.map(([e,s])=>ce.createElement(e,s)),...Array.isArray(n)?n:[n]])),_s=(e,s)=>{const t=ce.forwardRef(({className:t,...a},r)=>{return ce.createElement(ws,{ref:r,iconNode:s,className:bs(`lucide-${n=e,n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,t),...a});var n});return t.displayName=`${e}`,t},ks=_s("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),Ss=_s("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Es=_s("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]),Ts=_s("Award",[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]]),Cs=_s("BookOpen",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]]),As=_s("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),Rs=_s("Brain",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]]),Is=_s("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]),Ps=_s("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),Ds=_s("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),Ms=_s("ChartColumn",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Os=_s("ChartPie",[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]]),Fs=_s("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Ls=_s("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),zs=_s("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Us=_s("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Bs=_s("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),$s=_s("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]),Hs=_s("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]),Vs=_s("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Gs=_s("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),qs=_s("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]),Ws=_s("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),Ys=_s("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),Ks=_s("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),Js=_s("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),Xs=_s("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),Zs=_s("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]),Qs=_s("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),et=_s("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]),st=_s("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]),tt=_s("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),at=_s("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),rt=_s("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]),nt=_s("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]),it=_s("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]),lt=_s("Lightbulb",[["path",{d:"M15 14c.2-1 .7-1.7 1.5-2.5 1-.9 1.5-2.2 1.5-3.5A6 6 0 0 0 6 8c0 1 .2 2.2 1.5 3.5.7.7 1.3 1.5 1.5 2.5",key:"1gvzjb"}],["path",{d:"M9 18h6",key:"x1upvd"}],["path",{d:"M10 22h4",key:"ceow96"}]]),ct=_s("List",[["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 18h.01",key:"1tta3j"}],["path",{d:"M3 6h.01",key:"1rqtza"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 18h13",key:"1lx6n3"}],["path",{d:"M8 6h13",key:"ik3vkj"}]]),ot=_s("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),dt=_s("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),mt=_s("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]),ht=_s("Maximize",[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]]),ut=_s("MessageCircle",[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]]),xt=_s("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),pt=_s("MicOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M18.89 13.23A7.12 7.12 0 0 0 19 12v-2",key:"80xlxr"}],["path",{d:"M5 10v2a7 7 0 0 0 12 5",key:"p2k8kg"}],["path",{d:"M15 9.34V5a3 3 0 0 0-5.68-1.33",key:"1gzdoj"}],["path",{d:"M9 9v3a3 3 0 0 0 5.12 2.12",key:"r2i35w"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),ft=_s("Mic",[["path",{d:"M12 2a3 3 0 0 0-3 3v7a3 3 0 0 0 6 0V5a3 3 0 0 0-3-3Z",key:"131961"}],["path",{d:"M19 10v2a7 7 0 0 1-14 0v-2",key:"1vc78b"}],["line",{x1:"12",x2:"12",y1:"19",y2:"22",key:"x3vr5v"}]]),gt=_s("Package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["path",{d:"m3.3 7 7.703 4.734a2 2 0 0 0 1.994 0L20.7 7",key:"yx3hmr"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]]),vt=_s("PanelLeft",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}]]),jt=_s("Pause",[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]]),yt=_s("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]),bt=_s("PhoneOff",[["path",{d:"M10.68 13.31a16 16 0 0 0 3.41 2.6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7 2 2 0 0 1 1.72 2v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.42 19.42 0 0 1-3.33-2.67m-2.67-3.34a19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91",key:"z86iuo"}],["line",{x1:"22",x2:"2",y1:"2",y2:"22",key:"11kh81"}]]),Nt=_s("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]),wt=_s("Play",[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]]),_t=_s("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),kt=_s("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),St=_s("Repeat",[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]]),Et=_s("RotateCcw",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]]),Tt=_s("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]),Ct=_s("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),At=_s("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]),Rt=_s("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),It=_s("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),Pt=_s("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]),Dt=_s("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]]),Mt=_s("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]),Ot=_s("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Ft=_s("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]),Lt=_s("TestTube",[["path",{d:"M14.5 2v17.5c0 1.4-1.1 2.5-2.5 2.5c-1.4 0-2.5-1.1-2.5-2.5V2",key:"125lnx"}],["path",{d:"M8.5 2h7",key:"csnxdl"}],["path",{d:"M14.5 16h-5",key:"1ox875"}]]),zt=_s("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]),Ut=_s("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Bt=_s("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),$t=_s("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]),Ht=_s("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),Vt=_s("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]),Gt=_s("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),qt=_s("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Wt=_s("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Yt=_s("VideoOff",[["path",{d:"M10.66 6H14a2 2 0 0 1 2 2v2.5l5.248-3.062A.5.5 0 0 1 22 7.87v8.196",key:"w8jjjt"}],["path",{d:"M16 16a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h2",key:"1xawa7"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]),Kt=_s("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]),Jt=_s("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]),Xt=_s("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Zt=_s("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Qt=e=>{const s=aa(e),{conflictingClassGroups:t,conflictingClassGroupModifiers:a}=e;return{getClassGroupId:e=>{const t=e.split("-");return""===t[0]&&1!==t.length&&t.shift(),ea(t,s)||ta(e)},getConflictingClassGroupIds:(e,s)=>{const r=t[e]||[];return s&&a[e]?[...r,...a[e]]:r}}},ea=(e,s)=>{var t;if(0===e.length)return s.classGroupId;const a=e[0],r=s.nextPart.get(a),n=r?ea(e.slice(1),r):void 0;if(n)return n;if(0===s.validators.length)return;const i=e.join("-");return null==(t=s.validators.find(({validator:e})=>e(i)))?void 0:t.classGroupId},sa=/^\[(.+)\]$/,ta=e=>{if(sa.test(e)){const s=sa.exec(e)[1],t=null==s?void 0:s.substring(0,s.indexOf(":"));if(t)return"arbitrary.."+t}},aa=e=>{const{theme:s,prefix:t}=e,a={nextPart:new Map,validators:[]};return la(Object.entries(e.classGroups),t).forEach(([e,t])=>{ra(t,a,e,s)}),a},ra=(e,s,t,a)=>{e.forEach(e=>{if("string"==typeof e){return void((""===e?s:na(s,e)).classGroupId=t)}if("function"==typeof e)return ia(e)?void ra(e(a),s,t,a):void s.validators.push({validator:e,classGroupId:t});Object.entries(e).forEach(([e,r])=>{ra(r,na(s,e),t,a)})})},na=(e,s)=>{let t=e;return s.split("-").forEach(e=>{t.nextPart.has(e)||t.nextPart.set(e,{nextPart:new Map,validators:[]}),t=t.nextPart.get(e)}),t},ia=e=>e.isThemeGetter,la=(e,s)=>s?e.map(([e,t])=>[e,t.map(e=>"string"==typeof e?s+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map(([e,t])=>[s+e,t])):e)]):e,ca=e=>{if(e<1)return{get:()=>{},set:()=>{}};let s=0,t=new Map,a=new Map;const r=(r,n)=>{t.set(r,n),s++,s>e&&(s=0,a=t,t=new Map)};return{get(e){let s=t.get(e);return void 0!==s?s:void 0!==(s=a.get(e))?(r(e,s),s):void 0},set(e,s){t.has(e)?t.set(e,s):r(e,s)}}},oa=e=>{const{separator:s,experimentalParseClassName:t}=e,a=1===s.length,r=s[0],n=s.length,i=e=>{const t=[];let i,l=0,c=0;for(let m=0;m<e.length;m++){let o=e[m];if(0===l){if(o===r&&(a||e.slice(m,m+n)===s)){t.push(e.slice(c,m)),c=m+n;continue}if("/"===o){i=m;continue}}"["===o?l++:"]"===o&&l--}const o=0===t.length?e:e.substring(c),d=o.startsWith("!");return{modifiers:t,hasImportantModifier:d,baseClassName:d?o.substring(1):o,maybePostfixModifierPosition:i&&i>c?i-c:void 0}};return t?e=>t({className:e,parseClassName:i}):i},da=e=>{if(e.length<=1)return e;const s=[];let t=[];return e.forEach(e=>{"["===e[0]?(s.push(...t.sort(),e),t=[]):t.push(e)}),s.push(...t.sort()),s},ma=/\s+/;
/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */function ha(){let e,s,t=0,a="";for(;t<arguments.length;)(e=arguments[t++])&&(s=ua(e))&&(a&&(a+=" "),a+=s);return a}const ua=e=>{if("string"==typeof e)return e;let s,t="";for(let a=0;a<e.length;a++)e[a]&&(s=ua(e[a]))&&(t&&(t+=" "),t+=s);return t};function xa(e,...s){let t,a,r,n=function(l){const c=s.reduce((e,s)=>s(e),e());return t=(e=>({cache:ca(e.cacheSize),parseClassName:oa(e),...Qt(e)}))(c),a=t.cache.get,r=t.cache.set,n=i,i(l)};function i(e){const s=a(e);if(s)return s;const n=((e,s)=>{const{parseClassName:t,getClassGroupId:a,getConflictingClassGroupIds:r}=s,n=[],i=e.trim().split(ma);let l="";for(let c=i.length-1;c>=0;c-=1){const e=i[c],{modifiers:s,hasImportantModifier:o,baseClassName:d,maybePostfixModifierPosition:m}=t(e);let h=Boolean(m),u=a(h?d.substring(0,m):d);if(!u){if(!h){l=e+(l.length>0?" "+l:l);continue}if(u=a(d),!u){l=e+(l.length>0?" "+l:l);continue}h=!1}const x=da(s).join(":"),p=o?x+"!":x,f=p+u;if(n.includes(f))continue;n.push(f);const g=r(u,h);for(let t=0;t<g.length;++t){const e=g[t];n.push(p+e)}l=e+(l.length>0?" "+l:l)}return l})(e,t);return r(e,n),n}return function(){return n(ha.apply(null,arguments))}}const pa=e=>{const s=s=>s[e]||[];return s.isThemeGetter=!0,s},fa=/^\[(?:([a-z-]+):)?(.+)\]$/i,ga=/^\d+\/\d+$/,va=new Set(["px","full","screen"]),ja=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ya=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ba=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Na=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,wa=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,_a=e=>Sa(e)||va.has(e)||ga.test(e),ka=e=>za(e,"length",Ua),Sa=e=>Boolean(e)&&!Number.isNaN(Number(e)),Ea=e=>za(e,"number",Sa),Ta=e=>Boolean(e)&&Number.isInteger(Number(e)),Ca=e=>e.endsWith("%")&&Sa(e.slice(0,-1)),Aa=e=>fa.test(e),Ra=e=>ja.test(e),Ia=new Set(["length","size","percentage"]),Pa=e=>za(e,Ia,Ba),Da=e=>za(e,"position",Ba),Ma=new Set(["image","url"]),Oa=e=>za(e,Ma,Ha),Fa=e=>za(e,"",$a),La=()=>!0,za=(e,s,t)=>{const a=fa.exec(e);return!!a&&(a[1]?"string"==typeof s?a[1]===s:s.has(a[1]):t(a[2]))},Ua=e=>ya.test(e)&&!ba.test(e),Ba=()=>!1,$a=e=>Na.test(e),Ha=e=>wa.test(e),Va=xa(()=>{const e=pa("colors"),s=pa("spacing"),t=pa("blur"),a=pa("brightness"),r=pa("borderColor"),n=pa("borderRadius"),i=pa("borderSpacing"),l=pa("borderWidth"),c=pa("contrast"),o=pa("grayscale"),d=pa("hueRotate"),m=pa("invert"),h=pa("gap"),u=pa("gradientColorStops"),x=pa("gradientColorStopPositions"),p=pa("inset"),f=pa("margin"),g=pa("opacity"),v=pa("padding"),j=pa("saturate"),y=pa("scale"),b=pa("sepia"),N=pa("skew"),w=pa("space"),_=pa("translate"),k=()=>["auto",Aa,s],S=()=>[Aa,s],E=()=>["",_a,ka],T=()=>["auto",Sa,Aa],C=()=>["","0",Aa],A=()=>[Sa,Aa];return{cacheSize:500,separator:":",theme:{colors:[La],spacing:[_a,ka],blur:["none","",Ra,Aa],brightness:A(),borderColor:[e],borderRadius:["none","","full",Ra,Aa],borderSpacing:S(),borderWidth:E(),contrast:A(),grayscale:C(),hueRotate:A(),invert:C(),gap:S(),gradientColorStops:[e],gradientColorStopPositions:[Ca,ka],inset:k(),margin:k(),opacity:A(),padding:S(),saturate:A(),scale:A(),sepia:C(),skew:A(),space:S(),translate:S()},classGroups:{aspect:[{aspect:["auto","square","video",Aa]}],container:["container"],columns:[{columns:[Ra]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",Aa]}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[p]}],"inset-x":[{"inset-x":[p]}],"inset-y":[{"inset-y":[p]}],start:[{start:[p]}],end:[{end:[p]}],top:[{top:[p]}],right:[{right:[p]}],bottom:[{bottom:[p]}],left:[{left:[p]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Ta,Aa]}],basis:[{basis:k()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Aa]}],grow:[{grow:C()}],shrink:[{shrink:C()}],order:[{order:["first","last","none",Ta,Aa]}],"grid-cols":[{"grid-cols":[La]}],"col-start-end":[{col:["auto",{span:["full",Ta,Aa]},Aa]}],"col-start":[{"col-start":T()}],"col-end":[{"col-end":T()}],"grid-rows":[{"grid-rows":[La]}],"row-start-end":[{row:["auto",{span:[Ta,Aa]},Aa]}],"row-start":[{"row-start":T()}],"row-end":[{"row-end":T()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Aa]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Aa]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal","start","end","center","between","around","evenly","stretch"]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[f]}],mx:[{mx:[f]}],my:[{my:[f]}],ms:[{ms:[f]}],me:[{me:[f]}],mt:[{mt:[f]}],mr:[{mr:[f]}],mb:[{mb:[f]}],ml:[{ml:[f]}],"space-x":[{"space-x":[w]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[w]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Aa,s]}],"min-w":[{"min-w":[Aa,s,"min","max","fit"]}],"max-w":[{"max-w":[Aa,s,"none","full","min","max","fit","prose",{screen:[Ra]},Ra]}],h:[{h:[Aa,s,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Aa,s,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Aa,s,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Aa,s,"auto","min","max","fit"]}],"font-size":[{text:["base",Ra,ka]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ea]}],"font-family":[{font:[La]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Aa]}],"line-clamp":[{"line-clamp":["none",Sa,Ea]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",_a,Aa]}],"list-image":[{"list-image":["none",Aa]}],"list-style-type":[{list:["none","disc","decimal",Aa]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[g]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[g]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","none","wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",_a,ka]}],"underline-offset":[{"underline-offset":["auto",_a,Aa]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:S()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Aa]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Aa]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[g]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",Da]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Pa]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Oa]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[x]}],"gradient-via-pos":[{via:[x]}],"gradient-to-pos":[{to:[x]}],"gradient-from":[{from:[u]}],"gradient-via":[{via:[u]}],"gradient-to":[{to:[u]}],rounded:[{rounded:[n]}],"rounded-s":[{"rounded-s":[n]}],"rounded-e":[{"rounded-e":[n]}],"rounded-t":[{"rounded-t":[n]}],"rounded-r":[{"rounded-r":[n]}],"rounded-b":[{"rounded-b":[n]}],"rounded-l":[{"rounded-l":[n]}],"rounded-ss":[{"rounded-ss":[n]}],"rounded-se":[{"rounded-se":[n]}],"rounded-ee":[{"rounded-ee":[n]}],"rounded-es":[{"rounded-es":[n]}],"rounded-tl":[{"rounded-tl":[n]}],"rounded-tr":[{"rounded-tr":[n]}],"rounded-br":[{"rounded-br":[n]}],"rounded-bl":[{"rounded-bl":[n]}],"border-w":[{border:[l]}],"border-w-x":[{"border-x":[l]}],"border-w-y":[{"border-y":[l]}],"border-w-s":[{"border-s":[l]}],"border-w-e":[{"border-e":[l]}],"border-w-t":[{"border-t":[l]}],"border-w-r":[{"border-r":[l]}],"border-w-b":[{"border-b":[l]}],"border-w-l":[{"border-l":[l]}],"border-opacity":[{"border-opacity":[g]}],"border-style":[{border:["solid","dashed","dotted","double","none","hidden"]}],"divide-x":[{"divide-x":[l]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[l]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[g]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["","solid","dashed","dotted","double","none"]}],"outline-offset":[{"outline-offset":[_a,Aa]}],"outline-w":[{outline:[_a,ka]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:E()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[g]}],"ring-offset-w":[{"ring-offset":[_a,ka]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",Ra,Fa]}],"shadow-color":[{shadow:[La]}],opacity:[{opacity:[g]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],filter:[{filter:["","none"]}],blur:[{blur:[t]}],brightness:[{brightness:[a]}],contrast:[{contrast:[c]}],"drop-shadow":[{"drop-shadow":["","none",Ra,Aa]}],grayscale:[{grayscale:[o]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[m]}],saturate:[{saturate:[j]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[t]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[c]}],"backdrop-grayscale":[{"backdrop-grayscale":[o]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[m]}],"backdrop-opacity":[{"backdrop-opacity":[g]}],"backdrop-saturate":[{"backdrop-saturate":[j]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[i]}],"border-spacing-x":[{"border-spacing-x":[i]}],"border-spacing-y":[{"border-spacing-y":[i]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Aa]}],duration:[{duration:A()}],ease:[{ease:["linear","in","out","in-out",Aa]}],delay:[{delay:A()}],animate:[{animate:["none","spin","ping","pulse","bounce",Aa]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[y]}],"scale-x":[{"scale-x":[y]}],"scale-y":[{"scale-y":[y]}],rotate:[{rotate:[Ta,Aa]}],"translate-x":[{"translate-x":[_]}],"translate-y":[{"translate-y":[_]}],"skew-x":[{"skew-x":[N]}],"skew-y":[{"skew-y":[N]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Aa]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Aa]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":S()}],"scroll-mx":[{"scroll-mx":S()}],"scroll-my":[{"scroll-my":S()}],"scroll-ms":[{"scroll-ms":S()}],"scroll-me":[{"scroll-me":S()}],"scroll-mt":[{"scroll-mt":S()}],"scroll-mr":[{"scroll-mr":S()}],"scroll-mb":[{"scroll-mb":S()}],"scroll-ml":[{"scroll-ml":S()}],"scroll-p":[{"scroll-p":S()}],"scroll-px":[{"scroll-px":S()}],"scroll-py":[{"scroll-py":S()}],"scroll-ps":[{"scroll-ps":S()}],"scroll-pe":[{"scroll-pe":S()}],"scroll-pt":[{"scroll-pt":S()}],"scroll-pr":[{"scroll-pr":S()}],"scroll-pb":[{"scroll-pb":S()}],"scroll-pl":[{"scroll-pl":S()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Aa]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[_a,ka,Ea]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}});function Ga(...e){return Va(je(e))}const qa=xs,Wa=ce.forwardRef(({className:e,...s},t)=>i.jsx(ps,{ref:t,className:Ga("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",e),...s}));Wa.displayName=ps.displayName;const Ya=ye("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Ka=ce.forwardRef(({className:e,variant:s,...t},a)=>i.jsx(fs,{ref:a,className:Ga(Ya({variant:s}),e),...t}));Ka.displayName=fs.displayName;ce.forwardRef(({className:e,...s},t)=>i.jsx(js,{ref:t,className:Ga("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",e),...s})).displayName=js.displayName;const Ja=ce.forwardRef(({className:e,...s},t)=>i.jsx(ys,{ref:t,className:Ga("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",e),"toast-close":"",...s,children:i.jsx(Xt,{className:"h-4 w-4"})}));Ja.displayName=ys.displayName;const Xa=ce.forwardRef(({className:e,...s},t)=>i.jsx(gs,{ref:t,className:Ga("text-sm font-semibold",e),...s}));Xa.displayName=gs.displayName;const Za=ce.forwardRef(({className:e,...s},t)=>i.jsx(vs,{ref:t,className:Ga("text-sm opacity-90",e),...s}));function Qa(){const{toasts:e}=De();return i.jsxs(qa,{children:[e.map(function({id:e,title:s,description:t,action:a,...r}){return i.jsxs(Ka,{...r,children:[i.jsxs("div",{className:"grid gap-1",children:[s&&i.jsx(Xa,{children:s}),t&&i.jsx(Za,{children:t})]}),a,i.jsx(Ja,{})]},e)}),i.jsx(Wa,{})]})}Za.displayName=vs.displayName;var er=["light","dark"],sr=ce.createContext(void 0),tr={setTheme:e=>{},themes:[]};ce.memo(({forcedTheme:e,storageKey:s,attribute:t,enableSystem:a,enableColorScheme:r,defaultTheme:n,value:i,attrs:l,nonce:c})=>{let o="system"===n,d="class"===t?`var d=document.documentElement,c=d.classList;c.remove(${l.map(e=>`'${e}'`).join(",")});`:`var d=document.documentElement,n='${t}',s='setAttribute';`,m=r?er.includes(n)&&n?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${n}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",h=(e,s=!1,a=!0)=>{let n=i?i[e]:e,l=s?e+"|| ''":`'${n}'`,c="";return r&&a&&!s&&er.includes(e)&&(c+=`d.style.colorScheme = '${e}';`),"class"===t?c+=s||n?`c.add(${l})`:"null":n&&(c+=`d[s](n,${l})`),c},u=e?`!function(){${d}${h(e)}}()`:a?`!function(){try{${d}var e=localStorage.getItem('${s}');if('system'===e||(!e&&${o})){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){${h("dark")}}else{${h("light")}}}else if(e){${i?`var x=${JSON.stringify(i)};`:""}${h(i?"x[e]":"e",!0)}}${o?"":"else{"+h(n,!1,!1)+"}"}${m}}catch(e){}}()`:`!function(){try{${d}var e=localStorage.getItem('${s}');if(e){${i?`var x=${JSON.stringify(i)};`:""}${h(i?"x[e]":"e",!0)}}else{${h(n,!1,!1)};}${m}}catch(t){}}();`;return ce.createElement("script",{nonce:c,dangerouslySetInnerHTML:{__html:u}})});var ar=Array(12).fill(0),rr=({visible:e,className:s})=>oe.createElement("div",{className:["sonner-loading-wrapper",s].filter(Boolean).join(" "),"data-visible":e},oe.createElement("div",{className:"sonner-spinner"},ar.map((e,s)=>oe.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${s}`})))),nr=oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},oe.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),ir=oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},oe.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),lr=oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},oe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),cr=oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},oe.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),or=oe.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},oe.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),oe.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),dr=1,mr=new class{constructor(){this.subscribe=e=>(this.subscribers.push(e),()=>{let s=this.subscribers.indexOf(e);this.subscribers.splice(s,1)}),this.publish=e=>{this.subscribers.forEach(s=>s(e))},this.addToast=e=>{this.publish(e),this.toasts=[...this.toasts,e]},this.create=e=>{var s;let{message:t,...a}=e,r="number"==typeof(null==e?void 0:e.id)||(null==(s=e.id)?void 0:s.length)>0?e.id:dr++,n=this.toasts.find(e=>e.id===r),i=void 0===e.dismissible||e.dismissible;return this.dismissedToasts.has(r)&&this.dismissedToasts.delete(r),n?this.toasts=this.toasts.map(s=>s.id===r?(this.publish({...s,...e,id:r,title:t}),{...s,...e,id:r,dismissible:i,title:t}):s):this.addToast({title:t,...a,dismissible:i,id:r}),r},this.dismiss=e=>(this.dismissedToasts.add(e),e||this.toasts.forEach(e=>{this.subscribers.forEach(s=>s({id:e.id,dismiss:!0}))}),this.subscribers.forEach(s=>s({id:e,dismiss:!0})),e),this.message=(e,s)=>this.create({...s,message:e}),this.error=(e,s)=>this.create({...s,message:e,type:"error"}),this.success=(e,s)=>this.create({...s,type:"success",message:e}),this.info=(e,s)=>this.create({...s,type:"info",message:e}),this.warning=(e,s)=>this.create({...s,type:"warning",message:e}),this.loading=(e,s)=>this.create({...s,type:"loading",message:e}),this.promise=(e,s)=>{if(!s)return;let t;void 0!==s.loading&&(t=this.create({...s,promise:e,type:"loading",message:s.loading,description:"function"!=typeof s.description?s.description:void 0}));let a,r=e instanceof Promise?e:e(),n=void 0!==t,i=r.then(async e=>{if(a=["resolve",e],oe.isValidElement(e))n=!1,this.create({id:t,type:"default",message:e});else if(hr(e)&&!e.ok){n=!1;let a="function"==typeof s.error?await s.error(`HTTP error! status: ${e.status}`):s.error,r="function"==typeof s.description?await s.description(`HTTP error! status: ${e.status}`):s.description;this.create({id:t,type:"error",message:a,description:r})}else if(void 0!==s.success){n=!1;let a="function"==typeof s.success?await s.success(e):s.success,r="function"==typeof s.description?await s.description(e):s.description;this.create({id:t,type:"success",message:a,description:r})}}).catch(async e=>{if(a=["reject",e],void 0!==s.error){n=!1;let a="function"==typeof s.error?await s.error(e):s.error,r="function"==typeof s.description?await s.description(e):s.description;this.create({id:t,type:"error",message:a,description:r})}}).finally(()=>{var e;n&&(this.dismiss(t),t=void 0),null==(e=s.finally)||e.call(s)}),l=()=>new Promise((e,s)=>i.then(()=>"reject"===a[0]?s(a[1]):e(a[1])).catch(s));return"string"!=typeof t&&"number"!=typeof t?{unwrap:l}:Object.assign(t,{unwrap:l})},this.custom=(e,s)=>{let t=(null==s?void 0:s.id)||dr++;return this.create({jsx:e(t),id:t,...s}),t},this.getActiveToasts=()=>this.toasts.filter(e=>!this.dismissedToasts.has(e.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},hr=e=>e&&"object"==typeof e&&"ok"in e&&"boolean"==typeof e.ok&&"status"in e&&"number"==typeof e.status,ur=(e,s)=>{let t=(null==s?void 0:s.id)||dr++;return mr.addToast({title:e,...s,id:t}),t},xr=Object.assign(ur,{success:mr.success,info:mr.info,warning:mr.warning,error:mr.error,custom:mr.custom,message:mr.message,promise:mr.promise,dismiss:mr.dismiss,loading:mr.loading},{getHistory:()=>mr.toasts,getToasts:()=>mr.getActiveToasts()});function pr(e){return void 0!==e.label}!function(e,{insertAt:s}={}){if("undefined"==typeof document)return;let t=document.head||document.getElementsByTagName("head")[0],a=document.createElement("style");a.type="text/css","top"===s&&t.firstChild?t.insertBefore(a,t.firstChild):t.appendChild(a),a.styleSheet?a.styleSheet.cssText=e:a.appendChild(document.createTextNode(e))}(':where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}\n');var fr=3,gr=14;function vr(...e){return e.filter(Boolean).join(" ")}var jr=e=>{var s,t,a,r,n,i,l,c,o,d,m;let{invert:h,toast:u,unstyled:x,interacting:p,setHeights:f,visibleToasts:g,heights:v,index:j,toasts:y,expanded:b,removeToast:N,defaultRichColors:w,closeButton:_,style:k,cancelButtonStyle:S,actionButtonStyle:E,className:T="",descriptionClassName:C="",duration:A,position:R,gap:I,loadingIcon:P,expandByDefault:D,classNames:M,icons:O,closeButtonAriaLabel:F="Close toast",pauseWhenPageIsHidden:L}=e,[z,U]=oe.useState(null),[B,$]=oe.useState(null),[H,V]=oe.useState(!1),[G,q]=oe.useState(!1),[W,Y]=oe.useState(!1),[K,J]=oe.useState(!1),[X,Z]=oe.useState(!1),[Q,ee]=oe.useState(0),[se,te]=oe.useState(0),ae=oe.useRef(u.duration||A||4e3),re=oe.useRef(null),ne=oe.useRef(null),ie=0===j,le=j+1<=g,de=u.type,me=!1!==u.dismissible,he=u.className||"",ue=u.descriptionClassName||"",xe=oe.useMemo(()=>v.findIndex(e=>e.toastId===u.id)||0,[v,u.id]),pe=oe.useMemo(()=>{var e;return null!=(e=u.closeButton)?e:_},[u.closeButton,_]),fe=oe.useMemo(()=>u.duration||A||4e3,[u.duration,A]),ge=oe.useRef(0),ve=oe.useRef(0),je=oe.useRef(0),ye=oe.useRef(null),[be,Ne]=R.split("-"),we=oe.useMemo(()=>v.reduce((e,s,t)=>t>=xe?e:e+s.height,0),[v,xe]),_e=(()=>{let[e,s]=oe.useState(document.hidden);return oe.useEffect(()=>{let e=()=>{s(document.hidden)};return document.addEventListener("visibilitychange",e),()=>window.removeEventListener("visibilitychange",e)},[]),e})(),ke=u.invert||h,Se="loading"===de;ve.current=oe.useMemo(()=>xe*I+we,[xe,we]),oe.useEffect(()=>{ae.current=fe},[fe]),oe.useEffect(()=>{V(!0)},[]),oe.useEffect(()=>{let e=ne.current;if(e){let s=e.getBoundingClientRect().height;return te(s),f(e=>[{toastId:u.id,height:s,position:u.position},...e]),()=>f(e=>e.filter(e=>e.toastId!==u.id))}},[f,u.id]),oe.useLayoutEffect(()=>{if(!H)return;let e=ne.current,s=e.style.height;e.style.height="auto";let t=e.getBoundingClientRect().height;e.style.height=s,te(t),f(e=>e.find(e=>e.toastId===u.id)?e.map(e=>e.toastId===u.id?{...e,height:t}:e):[{toastId:u.id,height:t,position:u.position},...e])},[H,u.title,u.description,f,u.id]);let Ee=oe.useCallback(()=>{q(!0),ee(ve.current),f(e=>e.filter(e=>e.toastId!==u.id)),setTimeout(()=>{N(u)},200)},[u,N,f,ve]);return oe.useEffect(()=>{if(u.promise&&"loading"===de||u.duration===1/0||"loading"===u.type)return;let e;return b||p||L&&_e?(()=>{if(je.current<ge.current){let e=(new Date).getTime()-ge.current;ae.current=ae.current-e}je.current=(new Date).getTime()})():ae.current!==1/0&&(ge.current=(new Date).getTime(),e=setTimeout(()=>{var e;null==(e=u.onAutoClose)||e.call(u,u),Ee()},ae.current)),()=>clearTimeout(e)},[b,p,u,de,L,_e,Ee]),oe.useEffect(()=>{u.delete&&Ee()},[Ee,u.delete]),oe.createElement("li",{tabIndex:0,ref:ne,className:vr(T,he,null==M?void 0:M.toast,null==(s=null==u?void 0:u.classNames)?void 0:s.toast,null==M?void 0:M.default,null==M?void 0:M[de],null==(t=null==u?void 0:u.classNames)?void 0:t[de]),"data-sonner-toast":"","data-rich-colors":null!=(a=u.richColors)?a:w,"data-styled":!(u.jsx||u.unstyled||x),"data-mounted":H,"data-promise":!!u.promise,"data-swiped":X,"data-removed":G,"data-visible":le,"data-y-position":be,"data-x-position":Ne,"data-index":j,"data-front":ie,"data-swiping":W,"data-dismissible":me,"data-type":de,"data-invert":ke,"data-swipe-out":K,"data-swipe-direction":B,"data-expanded":!!(b||D&&H),style:{"--index":j,"--toasts-before":j,"--z-index":y.length-j,"--offset":`${G?Q:ve.current}px`,"--initial-height":D?"auto":`${se}px`,...k,...u.style},onDragEnd:()=>{Y(!1),U(null),ye.current=null},onPointerDown:e=>{Se||!me||(re.current=new Date,ee(ve.current),e.target.setPointerCapture(e.pointerId),"BUTTON"!==e.target.tagName&&(Y(!0),ye.current={x:e.clientX,y:e.clientY}))},onPointerUp:()=>{var e,s,t,a;if(K||!me)return;ye.current=null;let r=Number((null==(e=ne.current)?void 0:e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),n=Number((null==(s=ne.current)?void 0:s.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),i=(new Date).getTime()-(null==(t=re.current)?void 0:t.getTime()),l="x"===z?r:n,c=Math.abs(l)/i;if(Math.abs(l)>=20||c>.11)return ee(ve.current),null==(a=u.onDismiss)||a.call(u,u),$("x"===z?r>0?"right":"left":n>0?"down":"up"),Ee(),J(!0),void Z(!1);Y(!1),U(null)},onPointerMove:s=>{var t,a,r,n;if(!ye.current||!me||(null==(t=window.getSelection())?void 0:t.toString().length)>0)return;let i=s.clientY-ye.current.y,l=s.clientX-ye.current.x,c=null!=(a=e.swipeDirections)?a:function(e){let[s,t]=e.split("-"),a=[];return s&&a.push(s),t&&a.push(t),a}(R);!z&&(Math.abs(l)>1||Math.abs(i)>1)&&U(Math.abs(l)>Math.abs(i)?"x":"y");let o={x:0,y:0};"y"===z?(c.includes("top")||c.includes("bottom"))&&(c.includes("top")&&i<0||c.includes("bottom")&&i>0)&&(o.y=i):"x"===z&&(c.includes("left")||c.includes("right"))&&(c.includes("left")&&l<0||c.includes("right")&&l>0)&&(o.x=l),(Math.abs(o.x)>0||Math.abs(o.y)>0)&&Z(!0),null==(r=ne.current)||r.style.setProperty("--swipe-amount-x",`${o.x}px`),null==(n=ne.current)||n.style.setProperty("--swipe-amount-y",`${o.y}px`)}},pe&&!u.jsx?oe.createElement("button",{"aria-label":F,"data-disabled":Se,"data-close-button":!0,onClick:Se||!me?()=>{}:()=>{var e;Ee(),null==(e=u.onDismiss)||e.call(u,u)},className:vr(null==M?void 0:M.closeButton,null==(r=null==u?void 0:u.classNames)?void 0:r.closeButton)},null!=(n=null==O?void 0:O.close)?n:or):null,u.jsx||ce.isValidElement(u.title)?u.jsx?u.jsx:"function"==typeof u.title?u.title():u.title:oe.createElement(oe.Fragment,null,de||u.icon||u.promise?oe.createElement("div",{"data-icon":"",className:vr(null==M?void 0:M.icon,null==(i=null==u?void 0:u.classNames)?void 0:i.icon)},u.promise||"loading"===u.type&&!u.icon?u.icon||(null!=O&&O.loading?oe.createElement("div",{className:vr(null==M?void 0:M.loader,null==(Te=null==u?void 0:u.classNames)?void 0:Te.loader,"sonner-loader"),"data-visible":"loading"===de},O.loading):P?oe.createElement("div",{className:vr(null==M?void 0:M.loader,null==(Ce=null==u?void 0:u.classNames)?void 0:Ce.loader,"sonner-loader"),"data-visible":"loading"===de},P):oe.createElement(rr,{className:vr(null==M?void 0:M.loader,null==(Ae=null==u?void 0:u.classNames)?void 0:Ae.loader),visible:"loading"===de})):null,"loading"!==u.type?u.icon||(null==O?void 0:O[de])||(e=>{switch(e){case"success":return nr;case"info":return lr;case"warning":return ir;case"error":return cr;default:return null}})(de):null):null,oe.createElement("div",{"data-content":"",className:vr(null==M?void 0:M.content,null==(l=null==u?void 0:u.classNames)?void 0:l.content)},oe.createElement("div",{"data-title":"",className:vr(null==M?void 0:M.title,null==(c=null==u?void 0:u.classNames)?void 0:c.title)},"function"==typeof u.title?u.title():u.title),u.description?oe.createElement("div",{"data-description":"",className:vr(C,ue,null==M?void 0:M.description,null==(o=null==u?void 0:u.classNames)?void 0:o.description)},"function"==typeof u.description?u.description():u.description):null),ce.isValidElement(u.cancel)?u.cancel:u.cancel&&pr(u.cancel)?oe.createElement("button",{"data-button":!0,"data-cancel":!0,style:u.cancelButtonStyle||S,onClick:e=>{var s,t;pr(u.cancel)&&me&&(null==(t=(s=u.cancel).onClick)||t.call(s,e),Ee())},className:vr(null==M?void 0:M.cancelButton,null==(d=null==u?void 0:u.classNames)?void 0:d.cancelButton)},u.cancel.label):null,ce.isValidElement(u.action)?u.action:u.action&&pr(u.action)?oe.createElement("button",{"data-button":!0,"data-action":!0,style:u.actionButtonStyle||E,onClick:e=>{var s,t;pr(u.action)&&(null==(t=(s=u.action).onClick)||t.call(s,e),!e.defaultPrevented&&Ee())},className:vr(null==M?void 0:M.actionButton,null==(m=null==u?void 0:u.classNames)?void 0:m.actionButton)},u.action.label):null));var Te,Ce,Ae};function yr(){if("undefined"==typeof window||"undefined"==typeof document)return"ltr";let e=document.documentElement.getAttribute("dir");return"auto"!==e&&e?e:window.getComputedStyle(document.documentElement).direction}function br(e,s){let t={};return[e,s].forEach((e,s)=>{let a=1===s,r=a?"--mobile-offset":"--offset",n=a?"16px":"32px";function i(e){["top","right","bottom","left"].forEach(s=>{t[`${r}-${s}`]="number"==typeof e?`${e}px`:e})}"number"==typeof e||"string"==typeof e?i(e):"object"==typeof e?["top","right","bottom","left"].forEach(s=>{void 0===e[s]?t[`${r}-${s}`]=n:t[`${r}-${s}`]="number"==typeof e[s]?`${e[s]}px`:e[s]}):i(n)}),t}var Nr=ce.forwardRef(function(e,s){let{invert:t,position:a="bottom-right",hotkey:r=["altKey","KeyT"],expand:n,closeButton:i,className:l,offset:c,mobileOffset:o,theme:d="light",richColors:m,duration:h,style:u,visibleToasts:x=fr,toastOptions:p,dir:f=yr(),gap:g=gr,loadingIcon:v,icons:j,containerAriaLabel:y="Notifications",pauseWhenPageIsHidden:b}=e,[N,w]=oe.useState([]),_=oe.useMemo(()=>Array.from(new Set([a].concat(N.filter(e=>e.position).map(e=>e.position)))),[N,a]),[k,S]=oe.useState([]),[E,T]=oe.useState(!1),[C,A]=oe.useState(!1),[R,I]=oe.useState("system"!==d?d:"undefined"!=typeof window&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),P=oe.useRef(null),D=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),M=oe.useRef(null),O=oe.useRef(!1),F=oe.useCallback(e=>{w(s=>{var t;return null!=(t=s.find(s=>s.id===e.id))&&t.delete||mr.dismiss(e.id),s.filter(({id:s})=>s!==e.id)})},[]);return oe.useEffect(()=>mr.subscribe(e=>{e.dismiss?w(s=>s.map(s=>s.id===e.id?{...s,delete:!0}:s)):setTimeout(()=>{de.flushSync(()=>{w(s=>{let t=s.findIndex(s=>s.id===e.id);return-1!==t?[...s.slice(0,t),{...s[t],...e},...s.slice(t+1)]:[e,...s]})})})}),[]),oe.useEffect(()=>{if("system"!==d)return void I(d);if("system"===d&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?I("dark"):I("light")),"undefined"==typeof window)return;let e=window.matchMedia("(prefers-color-scheme: dark)");try{e.addEventListener("change",({matches:e})=>{I(e?"dark":"light")})}catch(s){e.addListener(({matches:e})=>{try{I(e?"dark":"light")}catch(s){}})}},[d]),oe.useEffect(()=>{N.length<=1&&T(!1)},[N]),oe.useEffect(()=>{let e=e=>{var s,t;r.every(s=>e[s]||e.code===s)&&(T(!0),null==(s=P.current)||s.focus()),"Escape"===e.code&&(document.activeElement===P.current||null!=(t=P.current)&&t.contains(document.activeElement))&&T(!1)};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)},[r]),oe.useEffect(()=>{if(P.current)return()=>{M.current&&(M.current.focus({preventScroll:!0}),M.current=null,O.current=!1)}},[P.current]),oe.createElement("section",{ref:s,"aria-label":`${y} ${D}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},_.map((s,a)=>{var r;let[d,y]=s.split("-");return N.length?oe.createElement("ol",{key:s,dir:"auto"===f?yr():f,tabIndex:-1,ref:P,className:l,"data-sonner-toaster":!0,"data-theme":R,"data-y-position":d,"data-lifted":E&&N.length>1&&!n,"data-x-position":y,style:{"--front-toast-height":`${(null==(r=k[0])?void 0:r.height)||0}px`,"--width":"356px","--gap":`${g}px`,...u,...br(c,o)},onBlur:e=>{O.current&&!e.currentTarget.contains(e.relatedTarget)&&(O.current=!1,M.current&&(M.current.focus({preventScroll:!0}),M.current=null))},onFocus:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||O.current||(O.current=!0,M.current=e.relatedTarget)},onMouseEnter:()=>T(!0),onMouseMove:()=>T(!0),onMouseLeave:()=>{C||T(!1)},onDragEnd:()=>T(!1),onPointerDown:e=>{e.target instanceof HTMLElement&&"false"===e.target.dataset.dismissible||A(!0)},onPointerUp:()=>A(!1)},N.filter(e=>!e.position&&0===a||e.position===s).map((a,r)=>{var l,c;return oe.createElement(jr,{key:a.id,icons:j,index:r,toast:a,defaultRichColors:m,duration:null!=(l=null==p?void 0:p.duration)?l:h,className:null==p?void 0:p.className,descriptionClassName:null==p?void 0:p.descriptionClassName,invert:t,visibleToasts:x,closeButton:null!=(c=null==p?void 0:p.closeButton)?c:i,interacting:C,position:s,style:null==p?void 0:p.style,unstyled:null==p?void 0:p.unstyled,classNames:null==p?void 0:p.classNames,cancelButtonStyle:null==p?void 0:p.cancelButtonStyle,actionButtonStyle:null==p?void 0:p.actionButtonStyle,removeToast:F,toasts:N.filter(e=>e.position==a.position),heights:k.filter(e=>e.position==a.position),setHeights:S,expandByDefault:n,gap:g,loadingIcon:v,expanded:E,pauseWhenPageIsHidden:b,swipeDirections:e.swipeDirections})})):null}))});const wr=({...e})=>{const{theme:s="system"}=null!=(t=ce.useContext(sr))?t:tr;var t;return i.jsx(Nr,{theme:s,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...e})};var[_r,kr]=r("Tooltip",[v]),Sr=v(),Er="TooltipProvider",Tr=700,Cr="tooltip.open",[Ar,Rr]=_r(Er),Ir=e=>{const{__scopeTooltip:s,delayDuration:t=Tr,skipDelayDuration:a=300,disableHoverableContent:r=!1,children:n}=e,l=ce.useRef(!0),c=ce.useRef(!1),o=ce.useRef(0);return ce.useEffect(()=>{const e=o.current;return()=>window.clearTimeout(e)},[]),i.jsx(Ar,{scope:s,isOpenDelayedRef:l,delayDuration:t,onOpen:ce.useCallback(()=>{window.clearTimeout(o.current),l.current=!1},[]),onClose:ce.useCallback(()=>{window.clearTimeout(o.current),o.current=window.setTimeout(()=>l.current=!0,a)},[a]),isPointerInTransitRef:c,onPointerInTransitChange:ce.useCallback(e=>{c.current=e},[]),disableHoverableContent:r,children:n})};Ir.displayName=Er;var Pr="Tooltip",[Dr,Mr]=_r(Pr),Or=e=>{const{__scopeTooltip:s,children:t,open:a,defaultOpen:r,onOpenChange:n,disableHoverableContent:l,delayDuration:c}=e,o=Rr(Pr,e.__scopeTooltip),m=Sr(s),[h,u]=ce.useState(null),x=_(),p=ce.useRef(0),f=l??o.disableHoverableContent,g=c??o.delayDuration,v=ce.useRef(!1),[j,y]=d({prop:a,defaultProp:r??!1,onChange:e=>{e?(o.onOpen(),document.dispatchEvent(new CustomEvent(Cr))):o.onClose(),null==n||n(e)},caller:Pr}),b=ce.useMemo(()=>j?v.current?"delayed-open":"instant-open":"closed",[j]),N=ce.useCallback(()=>{window.clearTimeout(p.current),p.current=0,v.current=!1,y(!0)},[y]),w=ce.useCallback(()=>{window.clearTimeout(p.current),p.current=0,y(!1)},[y]),S=ce.useCallback(()=>{window.clearTimeout(p.current),p.current=window.setTimeout(()=>{v.current=!0,y(!0),p.current=0},g)},[g,y]);return ce.useEffect(()=>()=>{p.current&&(window.clearTimeout(p.current),p.current=0)},[]),i.jsx(k,{...m,children:i.jsx(Dr,{scope:s,contentId:x,open:j,stateAttribute:b,trigger:h,onTriggerChange:u,onTriggerEnter:ce.useCallback(()=>{o.isOpenDelayedRef.current?S():N()},[o.isOpenDelayedRef,S,N]),onTriggerLeave:ce.useCallback(()=>{f?w():(window.clearTimeout(p.current),p.current=0)},[w,f]),onOpen:N,onClose:w,disableHoverableContent:f,children:t})})};Or.displayName=Pr;var Fr="TooltipTrigger",Lr=ce.forwardRef((e,s)=>{const{__scopeTooltip:t,...a}=e,r=Mr(Fr,t),l=Rr(Fr,t),o=Sr(t),d=ce.useRef(null),m=n(s,d,r.onTriggerChange),h=ce.useRef(!1),x=ce.useRef(!1),p=ce.useCallback(()=>h.current=!1,[]);return ce.useEffect(()=>()=>document.removeEventListener("pointerup",p),[p]),i.jsx(j,{asChild:!0,...o,children:i.jsx(c.button,{"aria-describedby":r.open?r.contentId:void 0,"data-state":r.stateAttribute,...a,ref:m,onPointerMove:u(e.onPointerMove,e=>{"touch"!==e.pointerType&&(x.current||l.isPointerInTransitRef.current||(r.onTriggerEnter(),x.current=!0))}),onPointerLeave:u(e.onPointerLeave,()=>{r.onTriggerLeave(),x.current=!1}),onPointerDown:u(e.onPointerDown,()=>{r.open&&r.onClose(),h.current=!0,document.addEventListener("pointerup",p,{once:!0})}),onFocus:u(e.onFocus,()=>{h.current||r.onOpen()}),onBlur:u(e.onBlur,r.onClose),onClick:u(e.onClick,r.onClose)})})});Lr.displayName=Fr;var[zr,Ur]=_r("TooltipPortal",{forceMount:void 0}),Br="TooltipContent",$r=ce.forwardRef((e,s)=>{const t=Ur(Br,e.__scopeTooltip),{forceMount:a=t.forceMount,side:r="top",...n}=e,l=Mr(Br,e.__scopeTooltip);return i.jsx(m,{present:a||l.open,children:l.disableHoverableContent?i.jsx(Wr,{side:r,...n,ref:s}):i.jsx(Hr,{side:r,...n,ref:s})})}),Hr=ce.forwardRef((e,s)=>{const t=Mr(Br,e.__scopeTooltip),a=Rr(Br,e.__scopeTooltip),r=ce.useRef(null),l=n(s,r),[c,o]=ce.useState(null),{trigger:d,onClose:m}=t,h=r.current,{onPointerInTransitChange:u}=a,x=ce.useCallback(()=>{o(null),u(!1)},[u]),p=ce.useCallback((e,s)=>{const t=e.currentTarget,a={x:e.clientX,y:e.clientY},r=function(e,s,t=5){const a=[];switch(s){case"top":a.push({x:e.x-t,y:e.y+t},{x:e.x+t,y:e.y+t});break;case"bottom":a.push({x:e.x-t,y:e.y-t},{x:e.x+t,y:e.y-t});break;case"left":a.push({x:e.x+t,y:e.y-t},{x:e.x+t,y:e.y+t});break;case"right":a.push({x:e.x-t,y:e.y-t},{x:e.x-t,y:e.y+t})}return a}(a,function(e,s){const t=Math.abs(s.top-e.y),a=Math.abs(s.bottom-e.y),r=Math.abs(s.right-e.x),n=Math.abs(s.left-e.x);switch(Math.min(t,a,r,n)){case n:return"left";case r:return"right";case t:return"top";case a:return"bottom";default:throw new Error("unreachable")}}(a,t.getBoundingClientRect())),n=function(e){const s=e.slice();return s.sort((e,s)=>e.x<s.x?-1:e.x>s.x?1:e.y<s.y?-1:e.y>s.y?1:0),function(e){if(e.length<=1)return e.slice();const s=[];for(let a=0;a<e.length;a++){const t=e[a];for(;s.length>=2;){const e=s[s.length-1],a=s[s.length-2];if(!((e.x-a.x)*(t.y-a.y)>=(e.y-a.y)*(t.x-a.x)))break;s.pop()}s.push(t)}s.pop();const t=[];for(let a=e.length-1;a>=0;a--){const s=e[a];for(;t.length>=2;){const e=t[t.length-1],a=t[t.length-2];if(!((e.x-a.x)*(s.y-a.y)>=(e.y-a.y)*(s.x-a.x)))break;t.pop()}t.push(s)}return t.pop(),1===s.length&&1===t.length&&s[0].x===t[0].x&&s[0].y===t[0].y?s:s.concat(t)}(s)}([...r,...function(e){const{top:s,right:t,bottom:a,left:r}=e;return[{x:r,y:s},{x:t,y:s},{x:t,y:a},{x:r,y:a}]}(s.getBoundingClientRect())]);o(n),u(!0)},[u]);return ce.useEffect(()=>()=>x(),[x]),ce.useEffect(()=>{if(d&&h){const e=e=>p(e,h),s=e=>p(e,d);return d.addEventListener("pointerleave",e),h.addEventListener("pointerleave",s),()=>{d.removeEventListener("pointerleave",e),h.removeEventListener("pointerleave",s)}}},[d,h,p,x]),ce.useEffect(()=>{if(c){const e=e=>{const s=e.target,t={x:e.clientX,y:e.clientY},a=(null==d?void 0:d.contains(s))||(null==h?void 0:h.contains(s)),r=!function(e,s){const{x:t,y:a}=e;let r=!1;for(let n=0,i=s.length-1;n<s.length;i=n++){const e=s[n],l=s[i],c=e.x,o=e.y,d=l.x,m=l.y;o>a!=m>a&&t<(d-c)*(a-o)/(m-o)+c&&(r=!r)}return r}(t,c);a?x():r&&(x(),m())};return document.addEventListener("pointermove",e),()=>document.removeEventListener("pointermove",e)}},[d,h,c,m,x]),i.jsx(Wr,{...e,ref:l})}),[Vr,Gr]=_r(Pr,{isInside:!1}),qr=S("TooltipContent"),Wr=ce.forwardRef((e,s)=>{const{__scopeTooltip:t,children:a,"aria-label":r,onEscapeKeyDown:n,onPointerDownOutside:l,...c}=e,o=Mr(Br,t),d=Sr(t),{onClose:m}=o;return ce.useEffect(()=>(document.addEventListener(Cr,m),()=>document.removeEventListener(Cr,m)),[m]),ce.useEffect(()=>{if(o.trigger){const e=e=>{const s=e.target;(null==s?void 0:s.contains(o.trigger))&&m()};return window.addEventListener("scroll",e,{capture:!0}),()=>window.removeEventListener("scroll",e,{capture:!0})}},[o.trigger,m]),i.jsx(y,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:n,onPointerDownOutside:l,onFocusOutside:e=>e.preventDefault(),onDismiss:m,children:i.jsxs(b,{"data-state":o.stateAttribute,...d,...c,ref:s,style:{...c.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[i.jsx(qr,{children:a}),i.jsx(Vr,{scope:t,isInside:!0,children:i.jsx(N,{id:o.contentId,role:"tooltip",children:r||a})})]})})});$r.displayName=Br;var Yr="TooltipArrow";ce.forwardRef((e,s)=>{const{__scopeTooltip:t,...a}=e,r=Sr(t);return Gr(Yr,t).isInside?null:i.jsx(w,{...r,...a,ref:s})}).displayName=Yr;var Kr=$r;const Jr=Ir,Xr=Or,Zr=Lr,Qr=ce.forwardRef(({className:e,sideOffset:s=4,...t},a)=>i.jsx(Kr,{ref:a,sideOffset:s,className:Ga("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...t}));Qr.displayName=Kr.displayName;const en=we("https://lmzzskcneufwglycfdov.supabase.co","sb_publishable_RcFtEqS2LPwTtPfd2EU2RA_uX0Vzt0f",{auth:{storage:localStorage,persistSession:!0,autoRefreshToken:!0}}),sn=ce.createContext(void 0),tn=()=>{const e=ce.useContext(sn);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e},an=({children:e})=>{const[s,t]=ce.useState(null),[a,r]=ce.useState(null),[n,l]=ce.useState(!0);ce.useEffect(()=>{const{data:{subscription:e}}=en.auth.onAuthStateChange((e,s)=>{r(s),t((null==s?void 0:s.user)??null),l(!1)});return en.auth.getSession().then(({data:{session:e}})=>{r(e),t((null==e?void 0:e.user)??null),l(!1)}),()=>e.unsubscribe()},[]);const c={user:s,session:a,loading:n,signIn:async(e,s)=>{const{error:t}=await en.auth.signInWithPassword({email:e,password:s});return{error:t}},signUp:async(e,s,t="hr_manager")=>{const a=`${window.location.origin}/`,{data:r,error:n}=await en.auth.signUp({email:e,password:s,options:{emailRedirectTo:a,data:{role:t}}});if(!n&&r.user){const{error:e}=await en.from("profiles").update({role:t}).eq("user_id",r.user.id)}return{error:n}},signOut:async()=>{await en.auth.signOut()}};return i.jsx(sn.Provider,{value:c,children:e})},rn=ye("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),nn=ce.forwardRef(({className:e,variant:s,size:t,asChild:a=!1,...r},n)=>{const l=a?E:"button";return i.jsx(l,{className:Ga(rn({variant:s,size:t,className:e})),ref:n,...r})});nn.displayName="Button";const ln=ce.forwardRef(({className:e,type:s,...t},a)=>i.jsx("input",{type:s,className:Ga("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),ref:a,...t}));ln.displayName="Input";var cn=ce.forwardRef((e,s)=>i.jsx(c.label,{...e,ref:s,onMouseDown:s=>{var t;s.target.closest("button, input, select, textarea")||(null==(t=e.onMouseDown)||t.call(e,s),!s.defaultPrevented&&s.detail>1&&s.preventDefault())}}));cn.displayName="Label";var on=cn;const dn=ye("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),mn=ce.forwardRef(({className:e,...s},t)=>i.jsx(on,{ref:t,className:Ga(dn(),e),...s}));mn.displayName=on.displayName;const hn=R,un=ce.forwardRef(({className:e,...s},t)=>i.jsx(T,{ref:t,className:Ga("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...s}));un.displayName=T.displayName;const xn=ce.forwardRef(({className:e,...s},t)=>i.jsx(C,{ref:t,className:Ga("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...s}));xn.displayName=C.displayName;const pn=ce.forwardRef(({className:e,...s},t)=>i.jsx(A,{ref:t,className:Ga("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...s}));pn.displayName=A.displayName;const fn=ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{ref:t,className:Ga("rounded-lg border bg-card text-card-foreground shadow-sm",e),...s}));fn.displayName="Card";const gn=ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{ref:t,className:Ga("flex flex-col space-y-1.5 p-6",e),...s}));gn.displayName="CardHeader";const vn=ce.forwardRef(({className:e,...s},t)=>i.jsx("h3",{ref:t,className:Ga("text-2xl font-semibold leading-none tracking-tight",e),...s}));vn.displayName="CardTitle";const jn=ce.forwardRef(({className:e,...s},t)=>i.jsx("p",{ref:t,className:Ga("text-sm text-muted-foreground",e),...s}));jn.displayName="CardDescription";const yn=ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{ref:t,className:Ga("p-6 pt-0",e),...s}));yn.displayName="CardContent";ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{ref:t,className:Ga("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter";const bn=G,Nn=q,wn=ce.forwardRef(({className:e,children:s,...t},a)=>i.jsxs(I,{ref:a,className:Ga("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",e),...t,children:[s,i.jsx(P,{asChild:!0,children:i.jsx(Ls,{className:"h-4 w-4 opacity-50"})})]}));wn.displayName=I.displayName;const _n=ce.forwardRef(({className:e,...s},t)=>i.jsx(D,{ref:t,className:Ga("flex cursor-default items-center justify-center py-1",e),...s,children:i.jsx(Bs,{className:"h-4 w-4"})}));_n.displayName=D.displayName;const kn=ce.forwardRef(({className:e,...s},t)=>i.jsx(M,{ref:t,className:Ga("flex cursor-default items-center justify-center py-1",e),...s,children:i.jsx(Ls,{className:"h-4 w-4"})}));kn.displayName=M.displayName;const Sn=ce.forwardRef(({className:e,children:s,position:t="popper",...a},r)=>i.jsx(O,{children:i.jsxs(F,{ref:r,className:Ga("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===t&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:t,...a,children:[i.jsx(_n,{}),i.jsx(L,{className:Ga("p-1","popper"===t&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),i.jsx(kn,{})]})}));Sn.displayName=F.displayName;ce.forwardRef(({className:e,...s},t)=>i.jsx(z,{ref:t,className:Ga("py-1.5 pl-8 pr-2 text-sm font-semibold",e),...s})).displayName=z.displayName;const En=ce.forwardRef(({className:e,children:s,...t},a)=>i.jsxs(U,{ref:a,className:Ga("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",e),...t,children:[i.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:i.jsx(B,{children:i.jsx(Fs,{className:"h-4 w-4"})})}),i.jsx(H,{children:s})]}));En.displayName=U.displayName;ce.forwardRef(({className:e,...s},t)=>i.jsx(V,{ref:t,className:Ga("-mx-1 my-1 h-px bg-muted",e),...s})).displayName=V.displayName;const Tn=()=>{const{user:e,signIn:s,signUp:t,loading:a}=tn(),{toast:r}=De(),n=me(),[l,c]=ce.useState(!1),[o,d]=ce.useState(""),[m,h]=ce.useState(""),[u,x]=ce.useState("hr_manager");ce.useEffect(()=>{e&&!a&&n("/dashboard")},[e,a,n]);return a?i.jsx("div",{className:"min-h-screen bg-background flex items-center justify-center",children:i.jsx(ot,{className:"h-8 w-8 animate-spin text-primary"})}):i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-primary/5 via-background to-accent/5",children:[i.jsx("header",{className:"xlsmart-gradient-bg text-white",children:i.jsx("div",{className:"container mx-auto px-6 py-6",children:i.jsx("div",{className:"flex items-center justify-center",children:i.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[i.jsx("img",{src:"/xlsmart-logo.svg",alt:"XLSMART Logo",className:"h-16 w-auto"}),i.jsx("p",{className:"text-white/90 text-lg font-medium text-center",children:"AI-Powered HR Platform by SimplifyAI"})]})})})}),i.jsx("div",{className:"container mx-auto px-6 py-12",children:i.jsx("div",{className:"max-w-6xl mx-auto",children:i.jsxs("div",{className:"grid lg:grid-cols-2 gap-12 items-center",children:[i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-4xl font-bold text-foreground mb-4",children:"Welcome to the Future of HR"}),i.jsx("p",{className:"text-xl text-muted-foreground leading-relaxed",children:"Transform your human resources with AI-powered role standardization, skills assessment, and career development planning."})]}),i.jsxs("div",{className:"grid gap-6",children:[i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"p-3 bg-primary/10 rounded-xl",children:i.jsx(Rs,{className:"h-6 w-6 text-primary"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-foreground",children:"AI-Powered Analysis"}),i.jsx("p",{className:"text-muted-foreground",children:"Intelligent role standardization and skill mapping powered by advanced AI"})]})]}),i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"p-3 bg-accent/10 rounded-xl",children:i.jsx(Ft,{className:"h-6 w-6 text-accent"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-foreground",children:"Precision Matching"}),i.jsx("p",{className:"text-muted-foreground",children:"Accurate role alignment and career path recommendations"})]})]}),i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"p-3 bg-primary/10 rounded-xl",children:i.jsx(Zt,{className:"h-6 w-6 text-primary"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-foreground",children:"Lightning Fast"}),i.jsx("p",{className:"text-muted-foreground",children:"Process thousands of roles and skills in seconds"})]})]}),i.jsxs("div",{className:"flex items-start space-x-4",children:[i.jsx("div",{className:"p-3 bg-accent/10 rounded-xl",children:i.jsx(Wt,{className:"h-6 w-6 text-accent"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-semibold text-foreground",children:"Enterprise Ready"}),i.jsx("p",{className:"text-muted-foreground",children:"Built for telecommunications industry standards and scale"})]})]})]})]}),i.jsx("div",{className:"flex justify-center",children:i.jsxs(fn,{className:"w-full max-w-md shadow-xl border-0 bg-card/50 backdrop-blur-sm",children:[i.jsxs(gn,{className:"text-center pb-2",children:[i.jsx(vn,{className:"text-2xl font-bold",children:"Access Your Account"}),i.jsx(jn,{children:"Sign in to continue to SimplifyAI Platform"})]}),i.jsx(yn,{children:i.jsxs(hn,{defaultValue:"signin",className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-2 mb-6",children:[i.jsx(xn,{value:"signin",children:"Sign In"}),i.jsx(xn,{value:"signup",children:"Sign Up"})]}),i.jsx(pn,{value:"signin",className:"space-y-4",children:i.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!o||!m)return;c(!0);const{error:t}=await s(o,m);r(t?{title:"Sign In Failed",description:t.message,variant:"destructive"}:{title:"Welcome back!",description:"You have been signed in successfully."}),c(!1)},className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"signin-email",children:"Email"}),i.jsx(ln,{id:"signin-email",type:"email",placeholder:"Enter your email",value:o,onChange:e=>d(e.target.value),required:!0,className:"h-11"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"signin-password",children:"Password"}),i.jsx(ln,{id:"signin-password",type:"password",placeholder:"Enter your password",value:m,onChange:e=>h(e.target.value),required:!0,className:"h-11"})]}),i.jsxs(nn,{type:"submit",className:"w-full h-11 xlsmart-primary-gradient text-white font-medium",disabled:l,children:[l&&i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Sign In to Platform"]})]})}),i.jsxs(pn,{value:"signup",className:"space-y-4",children:[i.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!o||!m)return;c(!0);const{error:s}=await t(o,m,u);r(s?{title:"Sign Up Failed",description:s.message,variant:"destructive"}:{title:"Account Created!",description:"Please check your email to verify your account."}),c(!1)},className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"signup-email",children:"Email"}),i.jsx(ln,{id:"signup-email",type:"email",placeholder:"Enter your email",value:o,onChange:e=>d(e.target.value),required:!0,className:"h-11"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"signup-password",children:"Password"}),i.jsx(ln,{id:"signup-password",type:"password",placeholder:"Create a password",value:m,onChange:e=>h(e.target.value),required:!0,className:"h-11"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"signup-role",children:"Role"}),i.jsxs(bn,{value:u,onValueChange:e=>x(e),children:[i.jsx(wn,{className:"h-11",children:i.jsx(Nn,{placeholder:"Select your role"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"hr_manager",children:"HR Manager"}),i.jsx(En,{value:"candidate",children:"Candidate"}),i.jsx(En,{value:"super_admin",children:"Super Admin"})]})]})]}),i.jsxs(nn,{type:"submit",className:"w-full h-11 xlsmart-primary-gradient text-white font-medium",disabled:l,children:[l&&i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Create Account"]}),i.jsx(nn,{type:"button",variant:"outline",className:"w-full h-11 mt-2",onClick:()=>{d("test@xlsmart.com"),h("test123456")},children:"Fill Test Credentials"})]}),i.jsxs("div",{className:"mt-4 p-4 bg-green-50 rounded-lg border border-green-200",children:[i.jsx("p",{className:"text-sm text-green-700 text-center mb-2",children:i.jsx("strong",{children:"Testing the Complete Platform:"})}),i.jsxs("ol",{className:"text-xs text-green-600 text-left space-y-1",children:[i.jsx("li",{children:'1. Click "Fill Test Credentials" above'}),i.jsx("li",{children:'2. Click "Create Account" (or "Sign In" if account exists)'}),i.jsx("li",{children:'3. Navigate to "Job Descriptions" in the sidebar'}),i.jsx("li",{children:'4. Test the "Intelligence" tab for JD analysis'}),i.jsx("li",{children:'5. Test the "AI Tester" tab for role assignments'})]}),i.jsx("p",{className:"text-xs text-green-600 text-center mt-2",children:"✅ Database: 34 job descriptions | ✅ AI: OpenAI API configured | ✅ Functions: All operational"})]})]})]})})]})})]})})}),i.jsx("footer",{className:"border-t bg-card/30 backdrop-blur-sm",children:i.jsx("div",{className:"container mx-auto px-6 py-8",children:i.jsx("div",{className:"text-center text-muted-foreground",children:i.jsx("p",{children:"© 2024 XLSMART. Powered by SimplifyAI. All rights reserved."})})})})]})},Cn=Q,An=ee,Rn=Z,In=ce.forwardRef(({className:e,...s},t)=>i.jsx(W,{ref:t,className:Ga("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));In.displayName=W.displayName;const Pn=ce.forwardRef(({className:e,children:s,...t},a)=>i.jsxs(Rn,{children:[i.jsx(In,{}),i.jsxs(Y,{ref:a,className:Ga("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...t,children:[s,i.jsxs(K,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[i.jsx(Xt,{className:"h-4 w-4"}),i.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));Pn.displayName=Y.displayName;const Dn=({className:e,...s})=>i.jsx("div",{className:Ga("flex flex-col space-y-1.5 text-center sm:text-left",e),...s});Dn.displayName="DialogHeader";const Mn=({className:e,...s})=>i.jsx("div",{className:Ga("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});Mn.displayName="DialogFooter";const On=ce.forwardRef(({className:e,...s},t)=>i.jsx(J,{ref:t,className:Ga("text-lg font-semibold leading-none tracking-tight",e),...s}));On.displayName=J.displayName;const Fn=ce.forwardRef(({className:e,...s},t)=>i.jsx(X,{ref:t,className:Ga("text-sm text-muted-foreground",e),...s}));Fn.displayName=X.displayName;const Ln=ye("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function zn({className:e,variant:s,...t}){return i.jsx("div",{className:Ga(Ln({variant:s}),e),...t})}var Un="ScrollArea",[Bn,$n]=r(Un),[Hn,Vn]=Bn(Un),Gn=ce.forwardRef((e,s)=>{const{__scopeScrollArea:t,type:a="hover",dir:r,scrollHideDelay:l=600,...o}=e,[d,m]=ce.useState(null),[h,u]=ce.useState(null),[x,p]=ce.useState(null),[f,g]=ce.useState(null),[v,j]=ce.useState(null),[y,b]=ce.useState(0),[N,w]=ce.useState(0),[_,k]=ce.useState(!1),[S,E]=ce.useState(!1),T=n(s,e=>m(e)),C=se(r);return i.jsx(Hn,{scope:t,type:a,dir:C,scrollHideDelay:l,scrollArea:d,viewport:h,onViewportChange:u,content:x,onContentChange:p,scrollbarX:f,onScrollbarXChange:g,scrollbarXEnabled:_,onScrollbarXEnabledChange:k,scrollbarY:v,onScrollbarYChange:j,scrollbarYEnabled:S,onScrollbarYEnabledChange:E,onCornerWidthChange:b,onCornerHeightChange:w,children:i.jsx(c.div,{dir:C,...o,ref:T,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":N+"px",...e.style}})})});Gn.displayName=Un;var qn="ScrollAreaViewport",Wn=ce.forwardRef((e,s)=>{const{__scopeScrollArea:t,children:a,nonce:r,...l}=e,o=Vn(qn,t),d=ce.useRef(null),m=n(s,d,o.onViewportChange);return i.jsxs(i.Fragment,{children:[i.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),i.jsx(c.div,{"data-radix-scroll-area-viewport":"",...l,ref:m,style:{overflowX:o.scrollbarXEnabled?"scroll":"hidden",overflowY:o.scrollbarYEnabled?"scroll":"hidden",...e.style},children:i.jsx("div",{ref:o.onContentChange,style:{minWidth:"100%",display:"table"},children:a})})]})});Wn.displayName=qn;var Yn="ScrollAreaScrollbar",Kn=ce.forwardRef((e,s)=>{const{forceMount:t,...a}=e,r=Vn(Yn,e.__scopeScrollArea),{onScrollbarXEnabledChange:n,onScrollbarYEnabledChange:l}=r,c="horizontal"===e.orientation;return ce.useEffect(()=>(c?n(!0):l(!0),()=>{c?n(!1):l(!1)}),[c,n,l]),"hover"===r.type?i.jsx(Jn,{...a,ref:s,forceMount:t}):"scroll"===r.type?i.jsx(Xn,{...a,ref:s,forceMount:t}):"auto"===r.type?i.jsx(Zn,{...a,ref:s,forceMount:t}):"always"===r.type?i.jsx(Qn,{...a,ref:s}):null});Kn.displayName=Yn;var Jn=ce.forwardRef((e,s)=>{const{forceMount:t,...a}=e,r=Vn(Yn,e.__scopeScrollArea),[n,l]=ce.useState(!1);return ce.useEffect(()=>{const e=r.scrollArea;let s=0;if(e){const t=()=>{window.clearTimeout(s),l(!0)},a=()=>{s=window.setTimeout(()=>l(!1),r.scrollHideDelay)};return e.addEventListener("pointerenter",t),e.addEventListener("pointerleave",a),()=>{window.clearTimeout(s),e.removeEventListener("pointerenter",t),e.removeEventListener("pointerleave",a)}}},[r.scrollArea,r.scrollHideDelay]),i.jsx(m,{present:t||n,children:i.jsx(Zn,{"data-state":n?"visible":"hidden",...a,ref:s})})}),Xn=ce.forwardRef((e,s)=>{const{forceMount:t,...a}=e,r=Vn(Yn,e.__scopeScrollArea),n="horizontal"===e.orientation,l=vi(()=>o("SCROLL_END"),100),[c,o]=(d="hidden",h={hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}},ce.useReducer((e,s)=>h[e][s]??e,d));var d,h;return ce.useEffect(()=>{if("idle"===c){const e=window.setTimeout(()=>o("HIDE"),r.scrollHideDelay);return()=>window.clearTimeout(e)}},[c,r.scrollHideDelay,o]),ce.useEffect(()=>{const e=r.viewport,s=n?"scrollLeft":"scrollTop";if(e){let t=e[s];const a=()=>{const a=e[s];t!==a&&(o("SCROLL"),l()),t=a};return e.addEventListener("scroll",a),()=>e.removeEventListener("scroll",a)}},[r.viewport,n,o,l]),i.jsx(m,{present:t||"hidden"!==c,children:i.jsx(Qn,{"data-state":"hidden"===c?"hidden":"visible",...a,ref:s,onPointerEnter:u(e.onPointerEnter,()=>o("POINTER_ENTER")),onPointerLeave:u(e.onPointerLeave,()=>o("POINTER_LEAVE"))})})}),Zn=ce.forwardRef((e,s)=>{const t=Vn(Yn,e.__scopeScrollArea),{forceMount:a,...r}=e,[n,l]=ce.useState(!1),c="horizontal"===e.orientation,o=vi(()=>{if(t.viewport){const e=t.viewport.offsetWidth<t.viewport.scrollWidth,s=t.viewport.offsetHeight<t.viewport.scrollHeight;l(c?e:s)}},10);return ji(t.viewport,o),ji(t.content,o),i.jsx(m,{present:a||n,children:i.jsx(Qn,{"data-state":n?"visible":"hidden",...r,ref:s})})}),Qn=ce.forwardRef((e,s)=>{const{orientation:t="vertical",...a}=e,r=Vn(Yn,e.__scopeScrollArea),n=ce.useRef(null),l=ce.useRef(0),[c,o]=ce.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=hi(c.viewport,c.content),m={...a,sizes:c,onSizesChange:o,hasThumb:Boolean(d>0&&d<1),onThumbChange:e=>n.current=e,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:e=>l.current=e};function h(e,s){return function(e,s,t,a="ltr"){const r=ui(t),n=r/2,i=s||n,l=r-i,c=t.scrollbar.paddingStart+i,o=t.scrollbar.size-t.scrollbar.paddingEnd-l,d=t.content-t.viewport,m="ltr"===a?[0,d]:[-1*d,0];return pi([c,o],m)(e)}(e,l.current,c,s)}return"horizontal"===t?i.jsx(ei,{...m,ref:s,onThumbPositionChange:()=>{if(r.viewport&&n.current){const e=xi(r.viewport.scrollLeft,c,r.dir);n.current.style.transform=`translate3d(${e}px, 0, 0)`}},onWheelScroll:e=>{r.viewport&&(r.viewport.scrollLeft=e)},onDragScroll:e=>{r.viewport&&(r.viewport.scrollLeft=h(e,r.dir))}}):"vertical"===t?i.jsx(si,{...m,ref:s,onThumbPositionChange:()=>{if(r.viewport&&n.current){const e=xi(r.viewport.scrollTop,c);n.current.style.transform=`translate3d(0, ${e}px, 0)`}},onWheelScroll:e=>{r.viewport&&(r.viewport.scrollTop=e)},onDragScroll:e=>{r.viewport&&(r.viewport.scrollTop=h(e))}}):null}),ei=ce.forwardRef((e,s)=>{const{sizes:t,onSizesChange:a,...r}=e,l=Vn(Yn,e.__scopeScrollArea),[c,o]=ce.useState(),d=ce.useRef(null),m=n(s,d,l.onScrollbarXChange);return ce.useEffect(()=>{d.current&&o(getComputedStyle(d.current))},[d]),i.jsx(ri,{"data-orientation":"horizontal",...r,ref:m,sizes:t,style:{bottom:0,left:"rtl"===l.dir?"var(--radix-scroll-area-corner-width)":0,right:"ltr"===l.dir?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":ui(t)+"px",...e.style},onThumbPointerDown:s=>e.onThumbPointerDown(s.x),onDragScroll:s=>e.onDragScroll(s.x),onWheelScroll:(s,t)=>{if(l.viewport){const a=l.viewport.scrollLeft+s.deltaX;e.onWheelScroll(a),fi(a,t)&&s.preventDefault()}},onResize:()=>{d.current&&l.viewport&&c&&a({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:d.current.clientWidth,paddingStart:mi(c.paddingLeft),paddingEnd:mi(c.paddingRight)}})}})}),si=ce.forwardRef((e,s)=>{const{sizes:t,onSizesChange:a,...r}=e,l=Vn(Yn,e.__scopeScrollArea),[c,o]=ce.useState(),d=ce.useRef(null),m=n(s,d,l.onScrollbarYChange);return ce.useEffect(()=>{d.current&&o(getComputedStyle(d.current))},[d]),i.jsx(ri,{"data-orientation":"vertical",...r,ref:m,sizes:t,style:{top:0,right:"ltr"===l.dir?0:void 0,left:"rtl"===l.dir?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":ui(t)+"px",...e.style},onThumbPointerDown:s=>e.onThumbPointerDown(s.y),onDragScroll:s=>e.onDragScroll(s.y),onWheelScroll:(s,t)=>{if(l.viewport){const a=l.viewport.scrollTop+s.deltaY;e.onWheelScroll(a),fi(a,t)&&s.preventDefault()}},onResize:()=>{d.current&&l.viewport&&c&&a({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:d.current.clientHeight,paddingStart:mi(c.paddingTop),paddingEnd:mi(c.paddingBottom)}})}})}),[ti,ai]=Bn(Yn),ri=ce.forwardRef((e,s)=>{const{__scopeScrollArea:t,sizes:a,hasThumb:r,onThumbChange:l,onThumbPointerUp:o,onThumbPointerDown:d,onThumbPositionChange:m,onDragScroll:x,onWheelScroll:p,onResize:f,...g}=e,v=Vn(Yn,t),[j,y]=ce.useState(null),b=n(s,e=>y(e)),N=ce.useRef(null),w=ce.useRef(""),_=v.viewport,k=a.content-a.viewport,S=h(p),E=h(m),T=vi(f,10);function C(e){if(N.current){const s=e.clientX-N.current.left,t=e.clientY-N.current.top;x({x:s,y:t})}}return ce.useEffect(()=>{const e=e=>{const s=e.target;(null==j?void 0:j.contains(s))&&S(e,k)};return document.addEventListener("wheel",e,{passive:!1}),()=>document.removeEventListener("wheel",e,{passive:!1})},[_,j,k,S]),ce.useEffect(E,[a,E]),ji(j,T),ji(v.content,T),i.jsx(ti,{scope:t,scrollbar:j,hasThumb:r,onThumbChange:h(l),onThumbPointerUp:h(o),onThumbPositionChange:E,onThumbPointerDown:h(d),children:i.jsx(c.div,{...g,ref:b,style:{position:"absolute",...g.style},onPointerDown:u(e.onPointerDown,e=>{if(0===e.button){e.target.setPointerCapture(e.pointerId),N.current=j.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",v.viewport&&(v.viewport.style.scrollBehavior="auto"),C(e)}}),onPointerMove:u(e.onPointerMove,C),onPointerUp:u(e.onPointerUp,e=>{const s=e.target;s.hasPointerCapture(e.pointerId)&&s.releasePointerCapture(e.pointerId),document.body.style.webkitUserSelect=w.current,v.viewport&&(v.viewport.style.scrollBehavior=""),N.current=null})})})}),ni="ScrollAreaThumb",ii=ce.forwardRef((e,s)=>{const{forceMount:t,...a}=e,r=ai(ni,e.__scopeScrollArea);return i.jsx(m,{present:t||r.hasThumb,children:i.jsx(li,{ref:s,...a})})}),li=ce.forwardRef((e,s)=>{const{__scopeScrollArea:t,style:a,...r}=e,l=Vn(ni,t),o=ai(ni,t),{onThumbPositionChange:d}=o,m=n(s,e=>o.onThumbChange(e)),h=ce.useRef(void 0),x=vi(()=>{h.current&&(h.current(),h.current=void 0)},100);return ce.useEffect(()=>{const e=l.viewport;if(e){const s=()=>{if(x(),!h.current){const s=gi(e,d);h.current=s,d()}};return d(),e.addEventListener("scroll",s),()=>e.removeEventListener("scroll",s)}},[l.viewport,x,d]),i.jsx(c.div,{"data-state":o.hasThumb?"visible":"hidden",...r,ref:m,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...a},onPointerDownCapture:u(e.onPointerDownCapture,e=>{const s=e.target.getBoundingClientRect(),t=e.clientX-s.left,a=e.clientY-s.top;o.onThumbPointerDown({x:t,y:a})}),onPointerUp:u(e.onPointerUp,o.onThumbPointerUp)})});ii.displayName=ni;var ci="ScrollAreaCorner",oi=ce.forwardRef((e,s)=>{const t=Vn(ci,e.__scopeScrollArea),a=Boolean(t.scrollbarX&&t.scrollbarY);return"scroll"!==t.type&&a?i.jsx(di,{...e,ref:s}):null});oi.displayName=ci;var di=ce.forwardRef((e,s)=>{const{__scopeScrollArea:t,...a}=e,r=Vn(ci,t),[n,l]=ce.useState(0),[o,d]=ce.useState(0),m=Boolean(n&&o);return ji(r.scrollbarX,()=>{var e;const s=(null==(e=r.scrollbarX)?void 0:e.offsetHeight)||0;r.onCornerHeightChange(s),d(s)}),ji(r.scrollbarY,()=>{var e;const s=(null==(e=r.scrollbarY)?void 0:e.offsetWidth)||0;r.onCornerWidthChange(s),l(s)}),m?i.jsx(c.div,{...a,ref:s,style:{width:n,height:o,position:"absolute",right:"ltr"===r.dir?0:void 0,left:"rtl"===r.dir?0:void 0,bottom:0,...e.style}}):null});function mi(e){return e?parseInt(e,10):0}function hi(e,s){const t=e/s;return isNaN(t)?0:t}function ui(e){const s=hi(e.viewport,e.content),t=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,a=(e.scrollbar.size-t)*s;return Math.max(a,18)}function xi(e,s,t="ltr"){const a=ui(s),r=s.scrollbar.paddingStart+s.scrollbar.paddingEnd,n=s.scrollbar.size-r,i=s.content-s.viewport,l=n-a,c=te(e,"ltr"===t?[0,i]:[-1*i,0]);return pi([0,i],[0,l])(c)}function pi(e,s){return t=>{if(e[0]===e[1]||s[0]===s[1])return s[0];const a=(s[1]-s[0])/(e[1]-e[0]);return s[0]+a*(t-e[0])}}function fi(e,s){return e>0&&e<s}var gi=(e,s=()=>{})=>{let t={left:e.scrollLeft,top:e.scrollTop},a=0;return function r(){const n={left:e.scrollLeft,top:e.scrollTop},i=t.left!==n.left,l=t.top!==n.top;(i||l)&&s(),t=n,a=window.requestAnimationFrame(r)}(),()=>window.cancelAnimationFrame(a)};function vi(e,s){const t=h(e),a=ce.useRef(0);return ce.useEffect(()=>()=>window.clearTimeout(a.current),[]),ce.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(t,s)},[t,s])}function ji(e,s){const t=h(s);f(()=>{let s=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(t)});return a.observe(e),()=>{window.cancelAnimationFrame(s),a.unobserve(e)}}},[e,t])}var yi=Gn,bi=Wn,Ni=oi;const wi=ce.forwardRef(({className:e,children:s,...t},a)=>i.jsxs(yi,{ref:a,className:Ga("relative overflow-hidden",e),...t,children:[i.jsx(bi,{className:"h-full w-full rounded-[inherit]",children:s}),i.jsx(_i,{}),i.jsx(Ni,{})]}));wi.displayName=yi.displayName;const _i=ce.forwardRef(({className:e,orientation:s="vertical",...t},a)=>i.jsx(Kn,{ref:a,orientation:s,className:Ga("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...t,children:i.jsx(ii,{className:"relative flex-1 rounded-full bg-border"})}));_i.displayName=Kn.displayName;const ki=({context:e="hr_assistant",title:s="HR AI Assistant"})=>{const[t,a]=ce.useState([{id:"1",content:"Hello! I'm your Simplify HR AI assistant. I can help you with role standardization, job descriptions, employee assessments, and career development. How can I assist you today?",sender:"ai",timestamp:new Date}]),[r,n]=ce.useState(""),[l,c]=ce.useState(!1),o=async()=>{if(!r.trim())return;const s={id:Date.now().toString(),content:r,sender:"user",timestamp:new Date};a(e=>[...e,s]),n(""),c(!0);try{const{data:s,error:t}=await en.functions.invoke("ai-chat",{body:{message:r,context:e}});if(t)throw t;const n={id:(Date.now()+1).toString(),content:s.response,sender:"ai",timestamp:new Date};a(e=>[...e,n])}catch(t){const e={id:(Date.now()+1).toString(),content:"Sorry, I encountered an error. Please try again.",sender:"ai",timestamp:new Date};a(s=>[...s,e])}finally{c(!1)}};return i.jsx("div",{className:"p-6",children:i.jsxs(fn,{className:"h-[600px] flex flex-col border-border bg-card",children:[i.jsx(gn,{className:"pb-4 border-b border-border",children:i.jsxs(vn,{className:"flex items-center gap-2 text-card-foreground",children:[i.jsx(ut,{className:"h-5 w-5 text-primary"}),s]})}),i.jsxs(yn,{className:"flex-1 flex flex-col gap-4 p-4",children:[i.jsx(wi,{className:"flex-1 pr-4",children:i.jsxs("div",{className:"space-y-4",children:[t.map(e=>i.jsx("div",{className:"flex gap-3 "+("user"===e.sender?"justify-end":"justify-start"),children:i.jsxs("div",{className:"flex gap-2 max-w-[80%] "+("user"===e.sender?"flex-row-reverse":"flex-row"),children:[i.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center "+("user"===e.sender?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"),children:"user"===e.sender?i.jsx(qt,{className:"h-4 w-4"}):i.jsx(As,{className:"h-4 w-4"})}),i.jsxs("div",{className:"rounded-lg px-4 py-2 "+("user"===e.sender?"bg-primary text-primary-foreground":"bg-muted text-card-foreground"),children:[i.jsx("p",{className:"text-sm whitespace-pre-wrap",children:e.content}),i.jsx("p",{className:"text-xs opacity-70 mt-1",children:e.timestamp.toLocaleTimeString()})]})]})},e.id)),l&&i.jsx("div",{className:"flex gap-3 justify-start",children:i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:"flex-shrink-0 w-8 h-8 rounded-full bg-muted text-muted-foreground flex items-center justify-center",children:i.jsx(As,{className:"h-4 w-4"})}),i.jsx("div",{className:"bg-muted text-card-foreground rounded-lg px-4 py-2",children:i.jsxs("div",{className:"flex space-x-1",children:[i.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce"}),i.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),i.jsx("div",{className:"w-2 h-2 bg-current rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})})]})}),i.jsxs("div",{className:"flex gap-2 border-t border-border pt-4",children:[i.jsx(ln,{value:r,onChange:e=>n(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),o())},placeholder:"Type your message...",disabled:l,className:"flex-1 bg-background border-border text-foreground"}),i.jsx(nn,{onClick:o,disabled:l||!r.trim(),size:"icon",className:"xl-button-primary",children:i.jsx(At,{className:"h-4 w-4"})})]})]})]})})};var Si="Progress",[Ei,Ti]=r(Si),[Ci,Ai]=Ei(Si),Ri=ce.forwardRef((e,s)=>{const{__scopeProgress:t,value:a=null,max:r,getValueLabel:n=Di,...l}=e;(r||0===r)&&Fi(r);const o=Fi(r)?r:100;null!==a&&Li(a,o);const d=Li(a,o)?a:null,m=Oi(d)?n(d,o):void 0;return i.jsx(Ci,{scope:t,value:d,max:o,children:i.jsx(c.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":Oi(d)?d:void 0,"aria-valuetext":m,role:"progressbar","data-state":Mi(d,o),"data-value":d??void 0,"data-max":o,...l,ref:s})})});Ri.displayName=Si;var Ii="ProgressIndicator",Pi=ce.forwardRef((e,s)=>{const{__scopeProgress:t,...a}=e,r=Ai(Ii,t);return i.jsx(c.div,{"data-state":Mi(r.value,r.max),"data-value":r.value??void 0,"data-max":r.max,...a,ref:s})});function Di(e,s){return`${Math.round(e/s*100)}%`}function Mi(e,s){return null==e?"indeterminate":e===s?"complete":"loading"}function Oi(e){return"number"==typeof e}function Fi(e){return Oi(e)&&!isNaN(e)&&e>0}function Li(e,s){return Oi(e)&&!isNaN(e)&&e<=s&&e>=0}Pi.displayName=Ii;var zi=Ri,Ui=Pi;const Bi=ce.forwardRef(({className:e,value:s,...t},a)=>i.jsx(zi,{ref:a,className:Ga("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...t,children:i.jsx(Ui,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(s||0)}%)`}})}));Bi.displayName=zi.displayName;const $i=ye("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),Hi=ce.forwardRef(({className:e,variant:s,...t},a)=>i.jsx("div",{ref:a,role:"alert",className:Ga($i({variant:s}),e),...t}));Hi.displayName="Alert";ce.forwardRef(({className:e,...s},t)=>i.jsx("h5",{ref:t,className:Ga("mb-1 font-medium leading-none tracking-tight",e),...s})).displayName="AlertTitle";const Vi=ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{ref:t,className:Ga("text-sm [&_p]:leading-relaxed",e),...s}));Vi.displayName="AlertDescription";const Gi={MAX_FILE_SIZE:10485760,ALLOWED_TYPES:["application/vnd.openxmlformats-officedocument.spreadsheetml.sheet","application/vnd.ms-excel","text/csv"],BATCH_SIZE:100},qi=["Junior","Mid-Level","Senior","Lead","Principal","Manager","Director","VP","C-Level"],Wi=["Engineering","Product","Design","Marketing","Sales","HR","Finance","Operations","Customer Success","Legal"],Yi="An unexpected error occurred. Please try again.",Ki="You are not authorized to perform this action.",Ji="Please check your input and try again.",Xi="Data saved successfully!",Zi=()=>{var e,s,t,a,r,n,l,c,o,d,m,h,u,x,p,f,g,v,j,y,b,N,w,_;const[k,S]=ce.useState({}),[E,T]=ce.useState(!1),[C,A]=ce.useState(null),{toast:R}=De(),I=async()=>{T(!0);try{const{data:e,error:s}=await en.from("xlsmart_upload_sessions").select("*").order("created_at",{ascending:!1}).limit(5),{data:t,error:a}=await en.from("xlsmart_standard_roles").select("*").order("created_at",{ascending:!1}).limit(10),{data:r,error:n}=await en.from("xlsmart_role_mappings").select("*").order("created_at",{ascending:!1}).limit(10),{data:i,error:l}=await en.from("xlsmart_role_catalogs").select("*").order("created_at",{ascending:!1}).limit(5);S({sessions:{data:e,error:s},roles:{data:t,error:a},mappings:{data:r,error:n},catalogs:{data:i,error:l}})}catch(e){}finally{T(!1)}};ce.useEffect(()=>{I()},[]);const P=(e,s)=>e?i.jsxs(zn,{variant:"destructive",className:"ml-2",children:["Error: ",e.message]}):0===s?i.jsx(zn,{variant:"secondary",className:"ml-2",children:"No Data"}):i.jsxs(zn,{variant:"default",className:"ml-2",children:[s," records"]});return i.jsxs(fn,{className:"mb-6",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center justify-between",children:[i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx(Js,{className:"h-5 w-5"}),"🔍 Upload Status Debugger"]}),i.jsxs(nn,{onClick:I,disabled:E,size:"sm",children:[i.jsx(Et,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[(null==(a=null==(t=null==(s=null==(e=k.sessions)?void 0:e.data)?void 0:s[0])?void 0:t.ai_analysis)?void 0:a.createdRoles)&&i.jsxs("div",{className:"p-3 border-2 border-green-200 bg-green-50 rounded-lg",children:[i.jsxs("h4",{className:"font-medium flex items-center text-green-700",children:[i.jsx(Zt,{className:"h-4 w-4 mr-2"}),"🎉 Latest Upload Results - Roles Created This Session",i.jsxs(zn,{variant:"default",className:"ml-2 bg-green-500",children:[k.sessions.data[0].ai_analysis.createdRoles.length," new roles"]})]}),i.jsx("div",{className:"mt-3 grid gap-2",children:k.sessions.data[0].ai_analysis.createdRoles.map((e,s)=>i.jsxs("div",{className:"p-2 bg-white rounded border border-green-200",children:[i.jsx("div",{className:"font-medium text-sm text-green-800",children:e.title}),i.jsxs("div",{className:"text-xs text-green-600",children:[e.department," • ",e.level," • ",e.family]})]},e.id||s))}),i.jsxs("div",{className:"mt-2 text-xs text-green-600",children:["Processed at: ",new Date(k.sessions.data[0].ai_analysis.processedAt||k.sessions.data[0].created_at).toLocaleString()]})]}),i.jsxs("div",{className:"p-3 border rounded-lg",children:[i.jsxs("h4",{className:"font-medium flex items-center",children:[i.jsx(et,{className:"h-4 w-4 mr-2"}),"Recent Upload Sessions",P(null==(r=k.sessions)?void 0:r.error,(null==(l=null==(n=k.sessions)?void 0:n.data)?void 0:l.length)||0)]}),(null==(o=null==(c=k.sessions)?void 0:c.data)?void 0:o.length)>0?i.jsx("div",{className:"mt-2 space-y-1",children:k.sessions.data.slice(0,3).map(e=>i.jsxs("div",{className:"text-sm text-muted-foreground border-l-2 border-gray-200 pl-3 py-2",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:["• ",e.session_name," - Status: ",i.jsx(zn,{size:"sm",children:e.status}),"processing"===e.status&&i.jsxs(nn,{size:"sm",variant:"outline",className:"ml-2 h-6",onClick:()=>(async e=>{var s;A(e);try{const{error:t}=await en.from("xlsmart_upload_sessions").update({status:"completed",ai_analysis:{...null==(s=k.sessions.data.find(s=>s.id===e))?void 0:s.ai_analysis,fixed_at:(new Date).toISOString(),fixed_reason:"Manual intervention - processing timeout"}}).eq("id",e);if(t)throw t;R({title:"Session Fixed",description:"Upload session marked as completed. You may need to re-run standardization."}),await I()}catch(t){R({title:"Fix Failed",description:t.message,variant:"destructive"})}finally{A(null)}})(e.id),disabled:C===e.id,children:[i.jsx(Zt,{className:"h-3 w-3 mr-1"}),C===e.id?"Fixing...":"Fix Stuck"]})]})}),i.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Created: ",new Date(e.created_at).toLocaleString()," | Total Rows: ",e.total_rows,e.ai_analysis&&i.jsxs("div",{className:"mt-1",children:["AI Analysis: ",JSON.stringify(e.ai_analysis).substring(0,100),"..."]})]})]},e.id))}):i.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"No upload sessions found"})]}),i.jsxs("div",{className:"p-3 border rounded-lg",children:[i.jsxs("h4",{className:"font-medium flex items-center",children:[i.jsx(Is,{className:"h-4 w-4 mr-2"}),"Standardized Roles",P(null==(d=k.roles)?void 0:d.error,(null==(h=null==(m=k.roles)?void 0:m.data)?void 0:h.length)||0)]}),(null==(x=null==(u=k.roles)?void 0:u.data)?void 0:x.length)>0?i.jsx("div",{className:"mt-2 space-y-1",children:k.roles.data.slice(0,5).map(e=>i.jsxs("div",{className:"text-sm text-muted-foreground",children:["• ",e.role_title," (",e.department||"No dept",")"]},e.id))}):i.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"No standardized roles found"})]}),i.jsxs("div",{className:"p-3 border rounded-lg",children:[i.jsxs("h4",{className:"font-medium flex items-center",children:[i.jsx(Vs,{className:"h-4 w-4 mr-2"}),"Role Mappings",P(null==(p=k.mappings)?void 0:p.error,(null==(g=null==(f=k.mappings)?void 0:f.data)?void 0:g.length)||0)]}),(null==(j=null==(v=k.mappings)?void 0:v.data)?void 0:j.length)>0?i.jsx("div",{className:"mt-2 space-y-1",children:k.mappings.data.slice(0,5).map(e=>i.jsxs("div",{className:"text-sm text-muted-foreground",children:["• ",e.original_role_title," → ",e.standardized_role_title]},e.id))}):i.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"No role mappings found"})]}),i.jsxs("div",{className:"p-3 border rounded-lg",children:[i.jsxs("h4",{className:"font-medium flex items-center",children:[i.jsx(Js,{className:"h-4 w-4 mr-2"}),"Role Catalogs",P(null==(y=k.catalogs)?void 0:y.error,(null==(N=null==(b=k.catalogs)?void 0:b.data)?void 0:N.length)||0)]}),(null==(_=null==(w=k.catalogs)?void 0:w.data)?void 0:_.length)>0?i.jsx("div",{className:"mt-2 space-y-1",children:k.catalogs.data.slice(0,3).map(e=>i.jsxs("div",{className:"text-sm text-muted-foreground",children:["• ",e.source_company," - Status: ",i.jsx(zn,{size:"sm",children:e.upload_status})]},e.id))}):i.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"No role catalogs found"})]}),E&&i.jsx("div",{className:"text-center py-4",children:i.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-primary mx-auto"})})]})})]})};function Qi({className:e,...s}){return i.jsx("div",{className:Ga("animate-pulse rounded-md bg-muted",e),...s})}const el=ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{className:"relative w-full overflow-auto",children:i.jsx("table",{ref:t,className:Ga("w-full caption-bottom text-sm",e),...s})}));el.displayName="Table";const sl=ce.forwardRef(({className:e,...s},t)=>i.jsx("thead",{ref:t,className:Ga("[&_tr]:border-b",e),...s}));sl.displayName="TableHeader";const tl=ce.forwardRef(({className:e,...s},t)=>i.jsx("tbody",{ref:t,className:Ga("[&_tr:last-child]:border-0",e),...s}));tl.displayName="TableBody";ce.forwardRef(({className:e,...s},t)=>i.jsx("tfoot",{ref:t,className:Ga("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",e),...s})).displayName="TableFooter";const al=ce.forwardRef(({className:e,...s},t)=>i.jsx("tr",{ref:t,className:Ga("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",e),...s}));al.displayName="TableRow";const rl=ce.forwardRef(({className:e,...s},t)=>i.jsx("th",{ref:t,className:Ga("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",e),...s}));rl.displayName="TableHead";const nl=ce.forwardRef(({className:e,...s},t)=>i.jsx("td",{ref:t,className:Ga("p-4 align-middle [&:has([role=checkbox])]:pr-0",e),...s}));nl.displayName="TableCell";ce.forwardRef(({className:e,...s},t)=>i.jsx("caption",{ref:t,className:Ga("mt-4 text-sm text-muted-foreground",e),...s})).displayName="TableCaption";const il=({currentPage:e,totalPages:s,pageSize:t,totalItems:a,onPageChange:r,onPageSizeChange:n})=>{const l=(e-1)*t+1,c=Math.min(e*t,a);return s<=1?null:i.jsxs("div",{className:"flex items-center justify-between px-2 py-4",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",l," to ",c," of ",a," results"]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-sm text-muted-foreground",children:"Show:"}),i.jsxs(bn,{value:t.toString(),onValueChange:e=>n(Number(e)),children:[i.jsx(wn,{className:"w-20 h-8",children:i.jsx(Nn,{})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"10",children:"10"}),i.jsx(En,{value:"25",children:"25"}),i.jsx(En,{value:"50",children:"50"}),i.jsx(En,{value:"100",children:"100"})]})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>r(1),disabled:1===e,className:"h-8 w-8 p-0",children:i.jsx($s,{className:"h-4 w-4"})}),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>r(e-1),disabled:1===e,className:"h-8 w-8 p-0",children:i.jsx(zs,{className:"h-4 w-4"})}),(()=>{const t=[],a=[];for(let r=Math.max(2,e-2);r<=Math.min(s-1,e+2);r++)t.push(r);return e-2>2?a.push(1,"..."):a.push(1),a.push(...t),e+2<s-1?a.push("...",s):s>1&&a.push(s),a})().map((s,t)=>i.jsx(nn,{variant:s===e?"default":"outline",size:"sm",onClick:()=>"number"==typeof s&&r(s),disabled:"..."===s,className:`h-8 w-8 p-0 ${s===e?"bg-primary text-primary-foreground":""} ${"..."===s?"cursor-default":""}`,children:s},t)),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>r(e+1),disabled:e===s,className:"h-8 w-8 p-0",children:i.jsx(Us,{className:"h-4 w-4"})}),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>r(s),disabled:e===s,className:"h-8 w-8 p-0",children:i.jsx(Hs,{className:"h-4 w-4"})})]})]})},ll=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState([]),[r,n]=ce.useState(!0),[l,c]=ce.useState(""),[o,d]=ce.useState(1),[m,h]=ce.useState(10),[u,x]=ce.useState(null),[p,f]=ce.useState(!1),[g,v]=ce.useState(0),[j,y]=ce.useState(null),{toast:b}=De();ce.useEffect(()=>{N();const e=en.channel("xl_roles_changes").on("postgres_changes",{event:"*",schema:"public",table:"xl_roles_data"},()=>{N()}).subscribe(),s=en.channel("smart_roles_changes").on("postgres_changes",{event:"*",schema:"public",table:"smart_roles_data"},()=>{N()}).subscribe(),t=en.channel("sessions_changes").on("postgres_changes",{event:"*",schema:"public",table:"xlsmart_upload_sessions"},()=>{N()}).subscribe(),a=setInterval(()=>{N()},3e4);return()=>{e.unsubscribe(),s.unsubscribe(),t.unsubscribe(),clearInterval(a)}},[]);const N=async()=>{try{n(!0);const{data:e,error:t}=await en.from("xlsmart_upload_sessions").select("*").order("created_at",{ascending:!1});if(t)throw t;const r=(null==e?void 0:e.filter(e=>{var s;return(null==(s=e.session_name)?void 0:s.includes("Role Upload"))||"processing"===e.status||"completed"===e.status}))||[];a(r);const i=r.map(e=>e.id);if(0===i.length)return void s([]);const[l,c]=await Promise.all([en.from("xl_roles_data").select("*").in("session_id",i).order("created_at",{ascending:!1}),en.from("smart_roles_data").select("*").in("session_id",i).order("created_at",{ascending:!1})]);if(l.error)throw l.error;if(c.error)throw c.error;if(l.error)throw l.error;if(c.error)throw c.error;const o=(l.data||[]).map(e=>({...e,source_type:"xl"})),d=(c.data||[]).map(e=>({...e,source_type:"smart"}));s([...o,...d]);[...o,...d].length}catch(e){b({title:"Error",description:"Failed to fetch uploaded roles",variant:"destructive"})}finally{n(!1)}},w=e.filter(e=>{var s,t,a,r,n;const i=l.toLowerCase(),c=(null==(s=e.role_title)?void 0:s.toLowerCase())||"",o=(null==(t=e.department)?void 0:t.toLowerCase())||"",d=(null==(a=e.role_family)?void 0:a.toLowerCase())||"",m=(null==(r=e.required_skills)?void 0:r.toLowerCase())||"",h=(null==(n=e.preferred_skills)?void 0:n.toLowerCase())||"";return c.includes(i)||o.includes(i)||d.includes(i)||m.includes(i)||h.includes(i)}),_=u?w.filter(e=>e.session_id===u):w,k=_.slice((o-1)*m,o*m);ce.useEffect(()=>{d(1)},[l,u]),ce.useEffect(()=>{const e=Math.ceil(_.length/m);o>e&&e>0&&d(e)},[m,_.length,o]);const S=e=>{switch(e){case"uploading":return i.jsx(zn,{className:"bg-blue-100 text-blue-800 border-blue-200",children:"Uploading"});case"processing":return i.jsx(zn,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:"Ready to Standardize"});case"completed":return i.jsx(zn,{className:"bg-green-100 text-green-800 border-green-200",children:"Completed"});case"failed":return i.jsx(zn,{className:"bg-red-100 text-red-800 border-red-200",children:"Failed"});default:return i.jsx(zn,{className:"bg-gray-100 text-gray-800 border-gray-200",children:e})}};return r?i.jsxs("div",{className:"space-y-4",children:[i.jsx(Qi,{className:"h-8 w-1/3"}),i.jsx(Qi,{className:"h-64 w-full"})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx($t,{className:"h-5 w-5 text-muted-foreground"}),i.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.reduce((e,s)=>e+(s.total_rows||0),0)," roles uploaded"]})]}),l&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Ct,{className:"h-4 w-4 text-muted-foreground"}),i.jsxs("span",{className:"text-sm text-muted-foreground",children:[w.length,' matching "',l,'"']})]}),u&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(tt,{className:"h-4 w-4 text-muted-foreground"}),i.jsxs("span",{className:"text-sm text-muted-foreground",children:[_.length," in selected session"]})]}),i.jsxs(nn,{variant:"outline",size:"sm",onClick:()=>{N(),b({title:"Data Refreshed",description:"Fetched latest data from database"})},children:[i.jsx(kt,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}),t.length>0&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ys,{className:"h-5 w-5"}),"Upload Sessions Ready for Standardization"]})}),i.jsxs(yn,{children:[i.jsx("div",{className:"space-y-4",children:t.map(s=>{const a=e.filter(e=>e.session_id===s.id),r=a.filter(e=>"xl"===e.source_type).length,n=a.filter(e=>"smart"===e.source_type).length;return i.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h3",{className:"font-medium",children:s.session_name}),i.jsxs("div",{className:"flex items-center gap-4 text-sm text-muted-foreground mt-1",children:[i.jsx("span",{children:new Date(s.created_at).toLocaleDateString()}),i.jsx("span",{children:"•"}),i.jsxs("span",{children:[s.total_rows," total rows"]}),i.jsx("span",{children:"•"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(tt,{className:"h-3 w-3"}),i.jsxs("span",{children:[r," XL roles"]})]}),i.jsx("span",{children:"•"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Js,{className:"h-3 w-3"}),i.jsxs("span",{children:[n," Smart roles"]})]})]}),a.length>0&&i.jsxs("div",{className:"mt-2 text-xs text-muted-foreground",children:[i.jsx("strong",{children:"Sample roles:"})," ",a.slice(0,3).map(e=>e.role_title).join(", "),a.length>3&&` +${a.length-3} more`]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[S(s.status),i.jsx(nn,{onClick:()=>(async s=>{f(!0),v(0);try{if(!t.find(e=>e.id===s))throw new Error("Session not found");v(20);const a=e.filter(e=>e.session_id===s),r=a.filter(e=>"xl"===e.source_type),n=a.filter(e=>"smart"===e.source_type);v(40);const{data:i,error:l}=await en.functions.invoke("ai-role-standardization",{body:{sessionId:s,xlData:r,smartData:n}});if(l)throw l;if(v(80),!(null==i?void 0:i.success))throw new Error((null==i?void 0:i.error)||"Standardization failed");v(100),b({title:"✅ Standardization Complete!",description:`Successfully standardized ${i.standardRolesCreated||0} roles`,duration:5e3}),await N(),await N()}catch(a){b({title:"❌ Standardization Failed",description:a instanceof Error?a.message:"Unknown error occurred",variant:"destructive"})}finally{f(!1),v(0)}})(s.id),disabled:p,className:"flex items-center gap-2",children:p?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Standardizing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rs,{className:"h-4 w-4"}),"Standardize"]})}),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>(async e=>{y(e);try{const[s,t]=await Promise.all([en.from("xl_roles_data").delete().eq("session_id",e),en.from("smart_roles_data").delete().eq("session_id",e)]);if(s.error)throw s.error;if(t.error)throw t.error;const{error:a}=await en.from("xlsmart_upload_sessions").delete().eq("id",e);if(a)throw a;b({title:"✅ Session Deleted",description:"Upload session and all associated roles have been deleted successfully",duration:5e3}),await N()}catch(s){b({title:"❌ Delete Failed",description:s instanceof Error?s.message:"Failed to delete session",variant:"destructive"})}finally{y(null)}})(s.id),disabled:j===s.id||p,className:"flex items-center gap-2 text-red-600 hover:text-red-700 hover:bg-red-50",children:j===s.id?i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-red-600"}),"Deleting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(zt,{className:"h-4 w-4"}),"Delete"]})})]})]},s.id)})}),p&&i.jsxs("div",{className:"mt-4 space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Standardization Progress"}),i.jsxs("span",{children:[g,"%"]})]}),i.jsx(Bi,{value:g,className:"w-full"})]})]})]}),e.length>0&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ln,{placeholder:"Search roles...",value:l,onChange:e=>c(e.target.value),className:"w-64"}),t.length>1&&i.jsxs(bn,{value:u||"all",onValueChange:e=>x("all"===e?null:e),children:[i.jsx(wn,{className:"w-48",children:i.jsx(Nn,{placeholder:"Filter by session"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"all",children:"All Sessions"}),t.map(e=>i.jsxs(En,{value:e.id,children:[e.session_name.substring(0,30),"..."]},e.id))]})]}),i.jsx(nn,{variant:"outline",onClick:()=>{x(null),c("")},disabled:!u&&!l,children:"Clear Filters"})]})})}),i.jsx(yn,{children:0===k.length?i.jsxs("div",{className:"text-center py-8",children:[i.jsx($t,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium text-muted-foreground mb-2",children:0===t.length?'No "Upload Only" sessions found':"No roles found"}),i.jsx("p",{className:"text-muted-foreground",children:0===t.length?'Upload roles using the "Upload Only" option to see them here. Roles from "Upload & Standardize" sessions are not shown in this view.':l?`No roles match your search "${l}"`:u?"No roles found in the selected session":"Upload session found but no role data loaded yet"})]}):i.jsxs(i.Fragment,{children:[i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Role Title"}),i.jsx(rl,{children:"Department"}),i.jsx(rl,{children:"Source"}),i.jsx(rl,{children:"Level"}),i.jsx(rl,{children:"Skills"}),i.jsx(rl,{children:"Uploaded"})]})}),i.jsx(tl,{children:0===k.length?i.jsx(al,{children:i.jsx(nl,{colSpan:6,className:"text-center py-8",children:i.jsxs("div",{className:"flex flex-col items-center gap-2 text-muted-foreground",children:[i.jsx(Wt,{className:"h-8 w-8"}),i.jsx("p",{children:l?`No roles found matching "${l}"`:u?"No roles in selected session":"No roles uploaded yet"}),l&&i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>c(""),children:"Clear search"})]})})}):k.map(e=>{return i.jsxs(al,{children:[i.jsx(nl,{className:"font-medium",children:i.jsx("div",{className:"max-w-xs",title:`Raw data - Title: "${e.role_title}" | Family: "${e.role_family}" | Dept: "${e.department}" | Alts: "${e.alternate_titles}" | Purpose: "${e.role_purpose}"`,children:(()=>{var s,t,a,r,n;const i=null==(s=e.role_title)?void 0:s.trim(),l=null==(t=e.role_family)?void 0:t.trim(),c=null==(a=e.department)?void 0:a.trim(),o=null==(r=e.alternate_titles)?void 0:r.trim(),d=null==(n=e.role_purpose)?void 0:n.trim();return i&&"Unknown Role"!==i&&i!==c&&!i.endsWith(" Role")?i:d&&"Unknown Role"!==d&&d!==c&&!d.endsWith(" Role")&&d.length<50&&!d.includes(".")?d:l&&"Unknown Role"!==l&&l!==c&&!l.endsWith(" Role")?l:o&&"Unknown Role"!==o&&o!==c&&!o.endsWith(" Role")?o:i&&"Unknown Role"!==i?i:"Untitled Role"})()})}),i.jsx(nl,{children:i.jsx("div",{className:"max-w-xs truncate",children:e.department||"-"})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-1",children:[(s=e.source_type,"xl"===s?i.jsx(tt,{className:"h-4 w-4"}):i.jsx(Js,{className:"h-4 w-4"})),i.jsx("span",{className:"capitalize",children:"xl"===e.source_type?"XL":"Smart"})]})}),i.jsx(nl,{children:i.jsx("div",{className:"max-w-xs truncate",children:e.seniority_band||e.role_level||"-"})}),i.jsx(nl,{children:i.jsx("div",{className:"max-w-xs truncate",title:e.required_skills||e.preferred_skills||"",children:e.required_skills||e.preferred_skills||"-"})}),i.jsx(nl,{children:i.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()})})]},e.id);var s})})]}),i.jsx(il,{currentPage:o,totalPages:Math.ceil(_.length/m),pageSize:m,totalItems:_.length,onPageChange:d,onPageSizeChange:h})]})})]})]})};
/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */
var cl=1252,ol=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],dl={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},ml=function(e){-1!=ol.indexOf(e)&&(cl=dl[0]=e)};var hl=function(e){ml(e)};function ul(){hl(1200),ml(1252)}function xl(e){for(var s=[],t=0,a=e.length;t<a;++t)s[t]=e.charCodeAt(t);return s}function pl(e){for(var s=[],t=0;t<e.length>>1;++t)s[t]=String.fromCharCode(e.charCodeAt(2*t+1)+(e.charCodeAt(2*t)<<8));return s.join("")}var fl,gl=function(e){var s=e.charCodeAt(0),t=e.charCodeAt(1);return 255==s&&254==t?function(e){for(var s=[],t=0;t<e.length>>1;++t)s[t]=String.fromCharCode(e.charCodeAt(2*t)+(e.charCodeAt(2*t+1)<<8));return s.join("")}(e.slice(2)):254==s&&255==t?pl(e.slice(2)):65279==s?e.slice(1):e},vl=function(e){return String.fromCharCode(e)},jl=function(e){return String.fromCharCode(e)},yl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function bl(e){for(var s="",t=0,a=0,r=0,n=0,i=0,l=0,c=0,o=0;o<e.length;)n=(t=e.charCodeAt(o++))>>2,i=(3&t)<<4|(a=e.charCodeAt(o++))>>4,l=(15&a)<<2|(r=e.charCodeAt(o++))>>6,c=63&r,isNaN(a)?l=c=64:isNaN(r)&&(c=64),s+=yl.charAt(n)+yl.charAt(i)+yl.charAt(l)+yl.charAt(c);return s}function Nl(e){var s="",t=0,a=0,r=0,n=0,i=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)t=yl.indexOf(e.charAt(c++))<<2|(n=yl.indexOf(e.charAt(c++)))>>4,s+=String.fromCharCode(t),a=(15&n)<<4|(i=yl.indexOf(e.charAt(c++)))>>2,64!==i&&(s+=String.fromCharCode(a)),r=(3&i)<<6|(l=yl.indexOf(e.charAt(c++))),64!==l&&(s+=String.fromCharCode(r));return s}var wl=function(){return"undefined"!=typeof Buffer&&"undefined"!=typeof process&&void 0!==process.versions&&!!process.versions.node}(),_l=function(){if("undefined"!=typeof Buffer){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch(s){e=!0}return e?function(e,s){return s?new Buffer(e,s):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}}();function kl(e){return wl?Buffer.alloc?Buffer.alloc(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}function Sl(e){return wl?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):"undefined"!=typeof Uint8Array?new Uint8Array(e):new Array(e)}var El=function(e){return wl?_l(e,"binary"):e.split("").map(function(e){return 255&e.charCodeAt(0)})};function Tl(e){if(Array.isArray(e))return e.map(function(e){return String.fromCharCode(e)}).join("");for(var s=[],t=0;t<e.length;++t)s[t]=String.fromCharCode(e[t]);return s.join("")}function Cl(e){if("undefined"==typeof ArrayBuffer)throw new Error("Unsupported");if(e instanceof ArrayBuffer)return Cl(new Uint8Array(e));for(var s=new Array(e.length),t=0;t<e.length;++t)s[t]=e[t];return s}var Al=wl?function(e){return Buffer.concat(e.map(function(e){return Buffer.isBuffer(e)?e:_l(e)}))}:function(e){if("undefined"!=typeof Uint8Array){var s=0,t=0;for(s=0;s<e.length;++s)t+=e[s].length;var a=new Uint8Array(t),r=0;for(s=0,t=0;s<e.length;t+=r,++s)if(r=e[s].length,e[s]instanceof Uint8Array)a.set(e[s],t);else{if("string"==typeof e[s])throw"wtf";a.set(new Uint8Array(e[s]),t)}return a}return[].concat.apply([],e.map(function(e){return Array.isArray(e)?e:[].slice.call(e)}))};var Rl=/\u0000/g,Il=/[\u0001-\u0006]/g;function Pl(e){for(var s="",t=e.length-1;t>=0;)s+=e.charAt(t--);return s}function Dl(e,s){var t=""+e;return t.length>=s?t:$c("0",s-t.length)+t}function Ml(e,s){var t=""+e;return t.length>=s?t:$c(" ",s-t.length)+t}function Ol(e,s){var t=""+e;return t.length>=s?t:t+$c(" ",s-t.length)}var Fl=Math.pow(2,32);function Ll(e,s){return e>Fl||e<-Fl?function(e,s){var t=""+Math.round(e);return t.length>=s?t:$c("0",s-t.length)+t}(e,s):function(e,s){var t=""+e;return t.length>=s?t:$c("0",s-t.length)+t}(Math.round(e),s)}function zl(e,s){return s=s||0,e.length>=7+s&&103==(32|e.charCodeAt(s))&&101==(32|e.charCodeAt(s+1))&&110==(32|e.charCodeAt(s+2))&&101==(32|e.charCodeAt(s+3))&&114==(32|e.charCodeAt(s+4))&&97==(32|e.charCodeAt(s+5))&&108==(32|e.charCodeAt(s+6))}var Ul=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Bl=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];var $l={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},Hl={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Vl={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function Gl(e,s,t){for(var a=e<0?-1:1,r=e*a,n=0,i=1,l=0,c=1,o=0,d=0,m=Math.floor(r);o<s&&(l=(m=Math.floor(r))*i+n,d=m*o+c,!(r-m<5e-8));)r=1/(r-m),n=i,i=l,c=o,o=d;if(d>s&&(o>s?(d=c,l=n):(d=o,l=i)),!t)return[0,a*l,d];var h=Math.floor(a*l/d);return[h,a*l-h*d,d]}function ql(e,s,t){if(e>2958465||e<0)return null;var a=0|e,r=Math.floor(86400*(e-a)),n=0,i=[],l={D:a,T:r,u:86400*(e-a)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),s&&s.date1904&&(a+=1462),l.u>.9999&&(l.u=0,86400==++r&&(l.T=r=0,++a,++l.D)),60===a)i=t?[1317,10,29]:[1900,2,29],n=3;else if(0===a)i=t?[1317,8,29]:[1900,1,0],n=6;else{a>60&&--a;var c=new Date(1900,0,1);c.setDate(c.getDate()+a-1),i=[c.getFullYear(),c.getMonth()+1,c.getDate()],n=c.getDay(),a<60&&(n=(n+6)%7),t&&(n=function(e,s){s[0]-=581;var t=e.getDay();e<60&&(t=(t+6)%7);return t}(c,i))}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=r%60,r=Math.floor(r/60),l.M=r%60,r=Math.floor(r/60),l.H=r,l.q=n,l}var Wl=new Date(1899,11,31,0,0,0),Yl=Wl.getTime(),Kl=new Date(1900,2,1,0,0,0);function Jl(e,s){var t=e.getTime();return s?t-=1262304e5:e>=Kl&&(t+=864e5),(t-(Yl+6e4*(e.getTimezoneOffset()-Wl.getTimezoneOffset())))/864e5}function Xl(e){return-1==e.indexOf(".")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Zl(e){var s,t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E);return s=t>=-4&&t<=-1?e.toPrecision(10+t):Math.abs(t)<=9?function(e){var s=e<0?12:11,t=Xl(e.toFixed(12));return t.length<=s||(t=e.toPrecision(10)).length<=s?t:e.toExponential(5)}(e):10===t?e.toFixed(10).substr(0,12):function(e){var s=Xl(e.toFixed(11));return s.length>(e<0?12:11)||"0"===s||"-0"===s?e.toPrecision(6):s}(e),Xl(function(e){return-1==e.indexOf("E")?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}(s.toUpperCase()))}function Ql(e,s){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(0|e)===e?e.toString(10):Zl(e);case"undefined":return"";case"object":if(null==e)return"";if(e instanceof Date)return yc(14,Jl(e,s&&s.date1904),s)}throw new Error("unsupported value in General format: "+e)}function ec(e,s,t,a){var r,n="",i=0,l=0,c=t.y,o=0;switch(e){case 98:c=t.y+543;case 121:switch(s.length){case 1:case 2:r=c%100,o=2;break;default:r=c%1e4,o=4}break;case 109:switch(s.length){case 1:case 2:r=t.m,o=s.length;break;case 3:return Bl[t.m-1][1];case 5:return Bl[t.m-1][0];default:return Bl[t.m-1][2]}break;case 100:switch(s.length){case 1:case 2:r=t.d,o=s.length;break;case 3:return Ul[t.q][0];default:return Ul[t.q][1]}break;case 104:switch(s.length){case 1:case 2:r=1+(t.H+11)%12,o=s.length;break;default:throw"bad hour format: "+s}break;case 72:switch(s.length){case 1:case 2:r=t.H,o=s.length;break;default:throw"bad hour format: "+s}break;case 77:switch(s.length){case 1:case 2:r=t.M,o=s.length;break;default:throw"bad minute format: "+s}break;case 115:if("s"!=s&&"ss"!=s&&".0"!=s&&".00"!=s&&".000"!=s)throw"bad second format: "+s;return 0!==t.u||"s"!=s&&"ss"!=s?(l=a>=2?3===a?1e3:100:1===a?10:1,(i=Math.round(l*(t.S+t.u)))>=60*l&&(i=0),"s"===s?0===i?"0":""+i/l:(n=Dl(i,2+a),"ss"===s?n.substr(0,2):"."+n.substr(2,s.length-1))):Dl(t.S,s.length);case 90:switch(s){case"[h]":case"[hh]":r=24*t.D+t.H;break;case"[m]":case"[mm]":r=60*(24*t.D+t.H)+t.M;break;case"[s]":case"[ss]":r=60*(60*(24*t.D+t.H)+t.M)+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+s}o=3===s.length?1:2;break;case 101:r=c,o=1}return o>0?Dl(r,o):""}function sc(e){if(e.length<=3)return e;for(var s=e.length%3,t=e.substr(0,s);s!=e.length;s+=3)t+=(t.length>0?",":"")+e.substr(s,3);return t}var tc=/%/g;function ac(e,s){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==s)return"0.0E+0";if(s<0)return"-"+ac(e,-s);var r=e.indexOf(".");-1===r&&(r=e.indexOf("E"));var n=Math.floor(Math.log(s)*Math.LOG10E)%r;if(n<0&&(n+=r),-1===(t=(s/Math.pow(10,n)).toPrecision(a+1+(r+n)%r)).indexOf("e")){var i=Math.floor(Math.log(s)*Math.LOG10E);for(-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+n):t+="E+"+(i-n);"0."===t.substr(0,2);)t=(t=t.charAt(0)+t.substr(2,r)+"."+t.substr(2+r)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,s,t,a){return s+t+a.substr(0,(r+n)%r)+"."+a.substr(n)+"E"})}else t=s.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var rc=/# (\?+)( ?)\/( ?)(\d+)/;var nc=/^#*0*\.([0#]+)/,ic=/\).*[0#]/,lc=/\(###\) ###\\?-####/;function cc(e){for(var s,t="",a=0;a!=e.length;++a)switch(s=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(s)}return t}function oc(e,s){var t=Math.pow(10,s);return""+Math.round(e*t)/t}function dc(e,s){var t=e-Math.floor(e),a=Math.pow(10,s);return s<(""+Math.round(t*a)).length?0:Math.round(t*a)}function mc(e,s,t){if(40===e.charCodeAt(0)&&!s.match(ic)){var a=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?mc("n",a,t):"("+mc("n",a,-t)+")"}if(44===s.charCodeAt(s.length-1))return function(e,s,t){for(var a=s.length-1;44===s.charCodeAt(a-1);)--a;return xc(e,s.substr(0,a),t/Math.pow(10,3*(s.length-a)))}(e,s,t);if(-1!==s.indexOf("%"))return function(e,s,t){var a=s.replace(tc,""),r=s.length-a.length;return xc(e,a,t*Math.pow(10,2*r))+$c("%",r)}(e,s,t);if(-1!==s.indexOf("E"))return ac(s,t);if(36===s.charCodeAt(0))return"$"+mc(e,s.substr(" "==s.charAt(1)?2:1),t);var r,n,i,l,c=Math.abs(t),o=t<0?"-":"";if(s.match(/^00+$/))return o+Ll(c,s.length);if(s.match(/^[#?]+$/))return"0"===(r=Ll(t,0))&&(r=""),r.length>s.length?r:cc(s.substr(0,s.length-r.length))+r;if(n=s.match(rc))return function(e,s,t){var a=parseInt(e[4],10),r=Math.round(s*a),n=Math.floor(r/a),i=r-n*a,l=a;return t+(0===n?"":""+n)+" "+(0===i?$c(" ",e[1].length+1+e[4].length):Ml(i,e[1].length)+e[2]+"/"+e[3]+Dl(l,e[4].length))}(n,c,o);if(s.match(/^#+0+$/))return o+Ll(c,s.length-s.indexOf("0"));if(n=s.match(nc))return r=oc(t,n[1].length).replace(/^([^\.]+)$/,"$1."+cc(n[1])).replace(/\.$/,"."+cc(n[1])).replace(/\.(\d*)$/,function(e,s){return"."+s+$c("0",cc(n[1]).length-s.length)}),-1!==s.indexOf("0.")?r:r.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),n=s.match(/^(0*)\.(#*)$/))return o+oc(c,n[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=s.match(/^#{1,3},##0(\.?)$/))return o+sc(Ll(c,0));if(n=s.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+mc(e,s,-t):sc(""+(Math.floor(t)+function(e,s){return s<(""+Math.round((e-Math.floor(e))*Math.pow(10,s))).length?1:0}(t,n[1].length)))+"."+Dl(dc(t,n[1].length),n[1].length);if(n=s.match(/^#,#*,#0/))return mc(e,s.replace(/^#,#*,/,""),t);if(n=s.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Pl(mc(e,s.replace(/[\\-]/g,""),t)),i=0,Pl(Pl(s.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<r.length?r.charAt(i++):"0"===e?"0":""}));if(s.match(lc))return"("+(r=mc(e,"##########",t)).substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var d="";if(n=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),l=Gl(c,Math.pow(10,i)-1,!1),r=""+o," "==(d=xc("n",n[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),r+=d+n[2]+"/"+n[3],(d=Ol(l[2],i)).length<n[4].length&&(d=cc(n[4].substr(n[4].length-d.length))+d),r+=d;if(n=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),o+((l=Gl(c,Math.pow(10,i)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?Ml(l[1],i)+n[2]+"/"+n[3]+Ol(l[2],i):$c(" ",2*i+1+n[2].length+n[3].length));if(n=s.match(/^[#0?]+$/))return r=Ll(t,0),s.length<=r.length?r:cc(s.substr(0,s.length-r.length))+r;if(n=s.match(/^([#0?]+)\.([#0]+)$/)){r=""+t.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=r.indexOf(".");var m=s.indexOf(".")-i,h=s.length-r.length-m;return cc(s.substr(0,m)+r+s.substr(s.length-h))}if(n=s.match(/^00,000\.([#0]*0)$/))return i=dc(t,n[1].length),t<0?"-"+mc(e,s,-t):sc(function(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Dl(0,3-e.length):"")+e})+"."+Dl(i,n[1].length);switch(s){case"###,##0.00":return mc(e,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var u=sc(Ll(c,0));return"0"!==u?o+u:"";case"###,###.00":return mc(e,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return mc(e,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+s+"|")}function hc(e,s){var t,a=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(0==s)return"0.0E+0";if(s<0)return"-"+hc(e,-s);var r=e.indexOf(".");-1===r&&(r=e.indexOf("E"));var n=Math.floor(Math.log(s)*Math.LOG10E)%r;if(n<0&&(n+=r),!(t=(s/Math.pow(10,n)).toPrecision(a+1+(r+n)%r)).match(/[Ee]/)){var i=Math.floor(Math.log(s)*Math.LOG10E);-1===t.indexOf(".")?t=t.charAt(0)+"."+t.substr(1)+"E+"+(i-t.length+n):t+="E+"+(i-n),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,s,t,a){return s+t+a.substr(0,(r+n)%r)+"."+a.substr(n)+"E"})}else t=s.toExponential(a);return e.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),e.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function uc(e,s,t){if(40===e.charCodeAt(0)&&!s.match(ic)){var a=s.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?uc("n",a,t):"("+uc("n",a,-t)+")"}if(44===s.charCodeAt(s.length-1))return function(e,s,t){for(var a=s.length-1;44===s.charCodeAt(a-1);)--a;return xc(e,s.substr(0,a),t/Math.pow(10,3*(s.length-a)))}(e,s,t);if(-1!==s.indexOf("%"))return function(e,s,t){var a=s.replace(tc,""),r=s.length-a.length;return xc(e,a,t*Math.pow(10,2*r))+$c("%",r)}(e,s,t);if(-1!==s.indexOf("E"))return hc(s,t);if(36===s.charCodeAt(0))return"$"+uc(e,s.substr(" "==s.charAt(1)?2:1),t);var r,n,i,l,c=Math.abs(t),o=t<0?"-":"";if(s.match(/^00+$/))return o+Dl(c,s.length);if(s.match(/^[#?]+$/))return r=""+t,0===t&&(r=""),r.length>s.length?r:cc(s.substr(0,s.length-r.length))+r;if(n=s.match(rc))return function(e,s,t){return t+(0===s?"":""+s)+$c(" ",e[1].length+2+e[4].length)}(n,c,o);if(s.match(/^#+0+$/))return o+Dl(c,s.length-s.indexOf("0"));if(n=s.match(nc))return r=(r=(""+t).replace(/^([^\.]+)$/,"$1."+cc(n[1])).replace(/\.$/,"."+cc(n[1]))).replace(/\.(\d*)$/,function(e,s){return"."+s+$c("0",cc(n[1]).length-s.length)}),-1!==s.indexOf("0.")?r:r.replace(/^0\./,".");if(s=s.replace(/^#+([0.])/,"$1"),n=s.match(/^(0*)\.(#*)$/))return o+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,n[1].length?"0.":".");if(n=s.match(/^#{1,3},##0(\.?)$/))return o+sc(""+c);if(n=s.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+uc(e,s,-t):sc(""+t)+"."+$c("0",n[1].length);if(n=s.match(/^#,#*,#0/))return uc(e,s.replace(/^#,#*,/,""),t);if(n=s.match(/^([0#]+)(\\?-([0#]+))+$/))return r=Pl(uc(e,s.replace(/[\\-]/g,""),t)),i=0,Pl(Pl(s.replace(/\\/g,"")).replace(/[0#]/g,function(e){return i<r.length?r.charAt(i++):"0"===e?"0":""}));if(s.match(lc))return"("+(r=uc(e,"##########",t)).substr(0,3)+") "+r.substr(3,3)+"-"+r.substr(6);var d="";if(n=s.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(n[4].length,7),l=Gl(c,Math.pow(10,i)-1,!1),r=""+o," "==(d=xc("n",n[1],l[1])).charAt(d.length-1)&&(d=d.substr(0,d.length-1)+"0"),r+=d+n[2]+"/"+n[3],(d=Ol(l[2],i)).length<n[4].length&&(d=cc(n[4].substr(n[4].length-d.length))+d),r+=d;if(n=s.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(n[1].length,n[4].length),7),o+((l=Gl(c,Math.pow(10,i)-1,!0))[0]||(l[1]?"":"0"))+" "+(l[1]?Ml(l[1],i)+n[2]+"/"+n[3]+Ol(l[2],i):$c(" ",2*i+1+n[2].length+n[3].length));if(n=s.match(/^[#0?]+$/))return r=""+t,s.length<=r.length?r:cc(s.substr(0,s.length-r.length))+r;if(n=s.match(/^([#0]+)\.([#0]+)$/)){r=""+t.toFixed(Math.min(n[2].length,10)).replace(/([^0])0+$/,"$1"),i=r.indexOf(".");var m=s.indexOf(".")-i,h=s.length-r.length-m;return cc(s.substr(0,m)+r+s.substr(s.length-h))}if(n=s.match(/^00,000\.([#0]*0)$/))return t<0?"-"+uc(e,s,-t):sc(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?Dl(0,3-e.length):"")+e})+"."+Dl(0,n[1].length);switch(s){case"###,###":case"##,###":case"#,###":var u=sc(""+c);return"0"!==u?o+u:"";default:if(s.match(/\.[0#?]*$/))return uc(e,s.slice(0,s.lastIndexOf(".")),t)+cc(s.slice(s.lastIndexOf(".")))}throw new Error("unsupported format |"+s+"|")}function xc(e,s,t){return(0|t)===t?uc(e,s,t):mc(e,s,t)}var pc=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function fc(e){for(var s=0,t="",a="";s<e.length;)switch(t=e.charAt(s)){case"G":zl(e,s)&&(s+=6),s++;break;case'"':for(;34!==e.charCodeAt(++s)&&s<e.length;);++s;break;case"\\":case"_":s+=2;break;case"@":++s;break;case"B":case"b":if("1"===e.charAt(s+1)||"2"===e.charAt(s+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if("A/P"===e.substr(s,3).toUpperCase())return!0;if("AM/PM"===e.substr(s,5).toUpperCase())return!0;if("上午/下午"===e.substr(s,5).toUpperCase())return!0;++s;break;case"[":for(a=t;"]"!==e.charAt(s++)&&s<e.length;)a+=e.charAt(s);if(a.match(pc))return!0;break;case".":case"0":case"#":for(;s<e.length&&("0#?.,E+-%".indexOf(t=e.charAt(++s))>-1||"\\"==t&&"-"==e.charAt(s+1)&&"0#".indexOf(e.charAt(s+2))>-1););break;case"?":for(;e.charAt(++s)===t;);break;case"*":++s," "!=e.charAt(s)&&"*"!=e.charAt(s)||++s;break;case"(":case")":++s;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;s<e.length&&"0123456789".indexOf(e.charAt(++s))>-1;);break;default:++s}return!1}var gc=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vc(e,s){if(null==s)return!1;var t=parseFloat(s[2]);switch(s[1]){case"=":if(e==t)return!0;break;case">":if(e>t)return!0;break;case"<":if(e<t)return!0;break;case"<>":if(e!=t)return!0;break;case">=":if(e>=t)return!0;break;case"<=":if(e<=t)return!0}return!1}function jc(e,s){var t=function(e){for(var s=[],t=!1,a=0,r=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:s[s.length]=e.substr(r,a-r),r=a+1}if(s[s.length]=e.substr(r),!0===t)throw new Error("Format |"+e+"| unterminated string ");return s}(e),a=t.length,r=t[a-1].indexOf("@");if(a<4&&r>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if("number"!=typeof s)return[4,4===t.length||r>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=r>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=r>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=r>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"]}var n=s>0?t[0]:s<0?t[1]:t[2];if(-1===t[0].indexOf("[")&&-1===t[1].indexOf("["))return[a,n];if(null!=t[0].match(/\[[=<>]/)||null!=t[1].match(/\[[=<>]/)){var i=t[0].match(gc),l=t[1].match(gc);return vc(s,i)?[a,t[0]]:vc(s,l)?[a,t[1]]:[a,t[null!=i&&null!=l?2:1]]}return[a,n]}function yc(e,s,t){null==t&&(t={});var a="";switch(typeof e){case"string":a="m/d/yy"==e&&t.dateNF?t.dateNF:e;break;case"number":null==(a=14==e&&t.dateNF?t.dateNF:(null!=t.table?t.table:$l)[e])&&(a=t.table&&t.table[Hl[e]]||$l[Hl[e]]),null==a&&(a=Vl[e]||"General")}if(zl(a,0))return Ql(s,t);s instanceof Date&&(s=Jl(s,t.date1904));var r=jc(a,s);if(zl(r[1]))return Ql(s,t);if(!0===s)s="TRUE";else if(!1===s)s="FALSE";else if(""===s||null==s)return"";return function(e,s,t,a){for(var r,n,i,l=[],c="",o=0,d="",m="t",h="H";o<e.length;)switch(d=e.charAt(o)){case"G":if(!zl(e,o))throw new Error("unrecognized character "+d+" in "+e);l[l.length]={t:"G",v:"General"},o+=7;break;case'"':for(c="";34!==(i=e.charCodeAt(++o))&&o<e.length;)c+=String.fromCharCode(i);l[l.length]={t:"t",v:c},++o;break;case"\\":var u=e.charAt(++o),x="("===u||")"===u?u:"t";l[l.length]={t:x,v:u},++o;break;case"_":l[l.length]={t:"t",v:" "},o+=2;break;case"@":l[l.length]={t:"T",v:s},++o;break;case"B":case"b":if("1"===e.charAt(o+1)||"2"===e.charAt(o+1)){if(null==r&&null==(r=ql(s,t,"2"===e.charAt(o+1))))return"";l[l.length]={t:"X",v:e.substr(o,2)},m=d,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(s<0)return"";if(null==r&&null==(r=ql(s,t)))return"";for(c=d;++o<e.length&&e.charAt(o).toLowerCase()===d;)c+=d;"m"===d&&"h"===m.toLowerCase()&&(d="M"),"h"===d&&(d=h),l[l.length]={t:d,v:c},m=d;break;case"A":case"a":case"上":var p={t:d,v:d};if(null==r&&(r=ql(s,t)),"A/P"===e.substr(o,3).toUpperCase()?(null!=r&&(p.v=r.H>=12?"P":"A"),p.t="T",h="h",o+=3):"AM/PM"===e.substr(o,5).toUpperCase()?(null!=r&&(p.v=r.H>=12?"PM":"AM"),p.t="T",o+=5,h="h"):"上午/下午"===e.substr(o,5).toUpperCase()?(null!=r&&(p.v=r.H>=12?"下午":"上午"),p.t="T",o+=5,h="h"):(p.t="t",++o),null==r&&"T"===p.t)return"";l[l.length]=p,m=d;break;case"[":for(c=d;"]"!==e.charAt(o++)&&o<e.length;)c+=e.charAt(o);if("]"!==c.slice(-1))throw'unterminated "[" block: |'+c+"|";if(c.match(pc)){if(null==r&&null==(r=ql(s,t)))return"";l[l.length]={t:"Z",v:c.toLowerCase()},m=c.charAt(1)}else c.indexOf("$")>-1&&(c=(c.match(/\$([^-\[\]]*)/)||[])[1]||"$",fc(e)||(l[l.length]={t:"t",v:c}));break;case".":if(null!=r){for(c=d;++o<e.length&&"0"===(d=e.charAt(o));)c+=d;l[l.length]={t:"s",v:c};break}case"0":case"#":for(c=d;++o<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(o))>-1;)c+=d;l[l.length]={t:"n",v:c};break;case"?":for(c=d;e.charAt(++o)===d;)c+=d;l[l.length]={t:d,v:c},m=d;break;case"*":++o," "!=e.charAt(o)&&"*"!=e.charAt(o)||++o;break;case"(":case")":l[l.length]={t:1===a?"t":d,v:d},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(c=d;o<e.length&&"0123456789".indexOf(e.charAt(++o))>-1;)c+=e.charAt(o);l[l.length]={t:"D",v:c};break;case" ":l[l.length]={t:d,v:d},++o;break;case"$":l[l.length]={t:"t",v:"$"},++o;break;default:if(-1===",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(d))throw new Error("unrecognized character "+d+" in "+e);l[l.length]={t:"t",v:d},++o}var f,g=0,v=0;for(o=l.length-1,m="t";o>=0;--o)switch(l[o].t){case"h":case"H":l[o].t=h,m="h",g<1&&(g=1);break;case"s":(f=l[o].v.match(/\.0+$/))&&(v=Math.max(v,f[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":m=l[o].t;break;case"m":"s"===m&&(l[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&l[o].v.match(/[Hh]/)&&(g=1),g<2&&l[o].v.match(/[Mm]/)&&(g=2),g<3&&l[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M),r.M>=60&&(r.M=0,++r.H);break;case 2:r.u>=.5&&(r.u=0,++r.S),r.S>=60&&(r.S=0,++r.M)}var j,y="";for(o=0;o<l.length;++o)switch(l[o].t){case"t":case"T":case" ":case"D":break;case"X":l[o].v="",l[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":l[o].v=ec(l[o].t.charCodeAt(0),l[o].v,r,v),l[o].t="t";break;case"n":case"?":for(j=o+1;null!=l[j]&&("?"===(d=l[j].t)||"D"===d||(" "===d||"t"===d)&&null!=l[j+1]&&("?"===l[j+1].t||"t"===l[j+1].t&&"/"===l[j+1].v)||"("===l[o].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===l[j].v||" "===l[j].v&&null!=l[j+1]&&"?"==l[j+1].t));)l[o].v+=l[j].v,l[j]={v:"",t:";"},++j;y+=l[o].v,o=j-1;break;case"G":l[o].t="t",l[o].v=Ql(s,t)}var b,N,w="";if(y.length>0){40==y.charCodeAt(0)?(b=s<0&&45===y.charCodeAt(0)?-s:s,N=xc("n",y,b)):(N=xc("n",y,b=s<0&&a>1?-s:s),b<0&&l[0]&&"t"==l[0].t&&(N=N.substr(1),l[0].v="-"+l[0].v)),j=N.length-1;var _=l.length;for(o=0;o<l.length;++o)if(null!=l[o]&&"t"!=l[o].t&&l[o].v.indexOf(".")>-1){_=o;break}var k=l.length;if(_===l.length&&-1===N.indexOf("E")){for(o=l.length-1;o>=0;--o)null!=l[o]&&-1!=="n?".indexOf(l[o].t)&&(j>=l[o].v.length-1?(j-=l[o].v.length,l[o].v=N.substr(j+1,l[o].v.length)):j<0?l[o].v="":(l[o].v=N.substr(0,j+1),j=-1),l[o].t="t",k=o);j>=0&&k<l.length&&(l[k].v=N.substr(0,j+1)+l[k].v)}else if(_!==l.length&&-1===N.indexOf("E")){for(j=N.indexOf(".")-1,o=_;o>=0;--o)if(null!=l[o]&&-1!=="n?".indexOf(l[o].t)){for(n=l[o].v.indexOf(".")>-1&&o===_?l[o].v.indexOf(".")-1:l[o].v.length-1,w=l[o].v.substr(n+1);n>=0;--n)j>=0&&("0"===l[o].v.charAt(n)||"#"===l[o].v.charAt(n))&&(w=N.charAt(j--)+w);l[o].v=w,l[o].t="t",k=o}for(j>=0&&k<l.length&&(l[k].v=N.substr(0,j+1)+l[k].v),j=N.indexOf(".")+1,o=_;o<l.length;++o)if(null!=l[o]&&(-1!=="n?(".indexOf(l[o].t)||o===_)){for(n=l[o].v.indexOf(".")>-1&&o===_?l[o].v.indexOf(".")+1:0,w=l[o].v.substr(0,n);n<l[o].v.length;++n)j<N.length&&(w+=N.charAt(j++));l[o].v=w,l[o].t="t",k=o}}}for(o=0;o<l.length;++o)null!=l[o]&&"n?".indexOf(l[o].t)>-1&&(b=a>1&&s<0&&o>0&&"-"===l[o-1].v?-s:s,l[o].v=xc(l[o].t,l[o].v,b),l[o].t="t");var S="";for(o=0;o!==l.length;++o)null!=l[o]&&(S+=l[o].v);return S}(r[1],s,t,r[0])}function bc(e,s){if("number"!=typeof s){s=+s||-1;for(var t=0;t<392;++t)if(null!=$l[t]){if($l[t]==e){s=t;break}}else s<0&&(s=t);s<0&&(s=391)}return $l[s]=e,s}function Nc(){var e;e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',$l=e}var wc={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},_c=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;var kc=function(){var e={};e.version="1.2.0";var s=function(){for(var e=0,s=new Array(256),t=0;256!=t;++t)e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=1&(e=t)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1)?-306674912^e>>>1:e>>>1,s[t]=e;return"undefined"!=typeof Int32Array?new Int32Array(s):s}();var t=function(e){var s=0,t=0,a=0,r="undefined"!=typeof Int32Array?new Int32Array(4096):new Array(4096);for(a=0;256!=a;++a)r[a]=e[a];for(a=0;256!=a;++a)for(t=e[a],s=256+a;s<4096;s+=256)t=r[s]=t>>>8^e[255&t];var n=[];for(a=1;16!=a;++a)n[a-1]="undefined"!=typeof Int32Array?r.subarray(256*a,256*a+256):r.slice(256*a,256*a+256);return n}(s),a=t[0],r=t[1],n=t[2],i=t[3],l=t[4],c=t[5],o=t[6],d=t[7],m=t[8],h=t[9],u=t[10],x=t[11],p=t[12],f=t[13],g=t[14];return e.table=s,e.bstr=function(e,t){for(var a=-1^t,r=0,n=e.length;r<n;)a=a>>>8^s[255&(a^e.charCodeAt(r++))];return~a},e.buf=function(e,t){for(var v=-1^t,j=e.length-15,y=0;y<j;)v=g[e[y++]^255&v]^f[e[y++]^v>>8&255]^p[e[y++]^v>>16&255]^x[e[y++]^v>>>24]^u[e[y++]]^h[e[y++]]^m[e[y++]]^d[e[y++]]^o[e[y++]]^c[e[y++]]^l[e[y++]]^i[e[y++]]^n[e[y++]]^r[e[y++]]^a[e[y++]]^s[e[y++]];for(j+=15;y<j;)v=v>>>8^s[255&(v^e[y++])];return~v},e.str=function(e,t){for(var a=-1^t,r=0,n=e.length,i=0,l=0;r<n;)(i=e.charCodeAt(r++))<128?a=a>>>8^s[255&(a^i)]:i<2048?a=(a=a>>>8^s[255&(a^(192|i>>6&31))])>>>8^s[255&(a^(128|63&i))]:i>=55296&&i<57344?(i=64+(1023&i),l=1023&e.charCodeAt(r++),a=(a=(a=(a=a>>>8^s[255&(a^(240|i>>8&7))])>>>8^s[255&(a^(128|i>>2&63))])>>>8^s[255&(a^(128|l>>6&15|(3&i)<<4))])>>>8^s[255&(a^(128|63&l))]):a=(a=(a=a>>>8^s[255&(a^(224|i>>12&15))])>>>8^s[255&(a^(128|i>>6&63))])>>>8^s[255&(a^(128|63&i))];return~a},e}(),Sc=function(){var e,s={};function t(e){if("/"==e.charAt(e.length-1))return-1===e.slice(0,-1).indexOf("/")?e:t(e.slice(0,-1));var s=e.lastIndexOf("/");return-1===s?e:e.slice(0,s+1)}function a(e){if("/"==e.charAt(e.length-1))return a(e.slice(0,-1));var s=e.lastIndexOf("/");return-1===s?e:e.slice(s+1)}function r(e,s){"string"==typeof s&&(s=new Date(s));var t=s.getHours();t=(t=t<<6|s.getMinutes())<<5|s.getSeconds()>>>1,e.write_shift(2,t);var a=s.getFullYear()-1980;a=(a=a<<4|s.getMonth()+1)<<5|s.getDate(),e.write_shift(2,a)}function n(e){gd(e,0);for(var s={},t=0;e.l<=e.length-4;){var a=e.read_shift(2),r=e.read_shift(2),n=e.l+r,i={};if(21589===a)1&(t=e.read_shift(1))&&(i.mtime=e.read_shift(4)),r>5&&(2&t&&(i.atime=e.read_shift(4)),4&t&&(i.ctime=e.read_shift(4))),i.mtime&&(i.mt=new Date(1e3*i.mtime));e.l=n,s[a]=i}return s}function i(){return e||(e={})}function l(e,s){if(80==e[0]&&75==e[1])return ae(e,s);if(109==(32|e[0])&&105==(32|e[1]))return function(e,s){if("mime-version:"!=N(e.slice(0,13)).toLowerCase())throw new Error("Unsupported MAD header");var t=s&&s.root||"",a=(wl&&Buffer.isBuffer(e)?e.toString("binary"):N(e)).split("\r\n"),r=0,n="";for(r=0;r<a.length;++r)if(n=a[r],/^Content-Location:/i.test(n)&&(n=n.slice(n.indexOf("file")),t||(t=n.slice(0,n.lastIndexOf("/")+1)),n.slice(0,t.length)!=t))for(;t.length>0&&(t=(t=t.slice(0,t.length-1)).slice(0,t.lastIndexOf("/")+1),n.slice(0,t.length)!=t););var i=(a[1]||"").match(/boundary="(.*?)"/);if(!i)throw new Error("MAD cannot find boundary");var l="--"+(i[1]||""),c=[],o=[],d={FileIndex:c,FullPaths:o};h(d);var m,u=0;for(r=0;r<a.length;++r){var x=a[r];x!==l&&x!==l+"--"||(u++&&oe(d,a.slice(m,r),t),m=r)}return d}(e,s);if(e.length<512)throw new Error("CFB file size "+e.length+" < 512");var t,a,r,n,i,l,u=512,x=[],p=e.slice(0,512);gd(p,0);var f=function(e){if(80==e[e.l]&&75==e[e.l+1])return[0,0];e.chk(v,"Header Signature: "),e.l+=16;var s=e.read_shift(2,"u");return[e.read_shift(2,"u"),s]}(p);switch(t=f[0]){case 3:u=512;break;case 4:u=4096;break;case 0:if(0==f[1])return ae(e,s);default:throw new Error("Major Version: Expected 3 or 4 saw "+t)}512!==u&&gd(p=e.slice(0,u),28);var j=e.slice(0,u);!function(e,s){var t=9;switch(e.l+=2,t=e.read_shift(2)){case 9:if(3!=s)throw new Error("Sector Shift: Expected 9 saw "+t);break;case 12:if(4!=s)throw new Error("Sector Shift: Expected 12 saw "+t);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+t)}e.chk("0600","Mini Sector Shift: "),e.chk("000000000000","Reserved: ")}(p,t);var y=p.read_shift(4,"i");if(3===t&&0!==y)throw new Error("# Directory Sectors: Expected 0 saw "+y);p.l+=4,n=p.read_shift(4,"i"),p.l+=4,p.chk("00100000","Mini Stream Cutoff Size: "),i=p.read_shift(4,"i"),a=p.read_shift(4,"i"),l=p.read_shift(4,"i"),r=p.read_shift(4,"i");for(var b=-1,w=0;w<109&&!((b=p.read_shift(4,"i"))<0);++w)x[w]=b;var _=function(e,s){for(var t=Math.ceil(e.length/s)-1,a=[],r=1;r<t;++r)a[r-1]=e.slice(r*s,(r+1)*s);return a[t-1]=e.slice(t*s),a}(e,u);o(l,r,_,u,x);var k=function(e,s,t,a){var r=e.length,n=[],i=[],l=[],c=[],o=a-1,d=0,m=0,h=0,u=0;for(d=0;d<r;++d)if(l=[],(h=d+s)>=r&&(h-=r),!i[h]){c=[];var x=[];for(m=h;m>=0;){x[m]=!0,i[m]=!0,l[l.length]=m,c.push(e[m]);var p=t[Math.floor(4*m/a)];if(a<4+(u=4*m&o))throw new Error("FAT boundary crossed: "+m+" 4 "+a);if(!e[p])break;if(x[m=od(e[p],u)])break}n[h]={nodes:l,data:zo([c])}}return n}(_,n,x,u);k[n].name="!Directory",a>0&&i!==g&&(k[i].name="!MiniFAT"),k[x[0]].name="!FAT",k.fat_addrs=x,k.ssz=u;var S=[],E=[],T=[];!function(e,s,t,a,r,n,i,l){for(var o,h=0,u=a.length?2:0,x=s[e].data,p=0,f=0;p<x.length;p+=128){var v=x.slice(p,p+128);gd(v,64),f=v.read_shift(2),o=Bo(v,0,f-u),a.push(o);var j={name:o,type:v.read_shift(1),color:v.read_shift(1),L:v.read_shift(4,"i"),R:v.read_shift(4,"i"),C:v.read_shift(4,"i"),clsid:v.read_shift(16),state:v.read_shift(4,"i"),start:0,size:0};0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(j.ct=m(v,v.l-8)),0!==v.read_shift(2)+v.read_shift(2)+v.read_shift(2)+v.read_shift(2)&&(j.mt=m(v,v.l-8)),j.start=v.read_shift(4,"i"),j.size=v.read_shift(4,"i"),j.size<0&&j.start<0&&(j.size=j.type=0,j.start=g,j.name=""),5===j.type?(h=j.start,r>0&&h!==g&&(s[h].name="!StreamData")):j.size>=4096?(j.storage="fat",void 0===s[j.start]&&(s[j.start]=d(t,j.start,s.fat_addrs,s.ssz)),s[j.start].name=j.name,j.content=s[j.start].data.slice(0,j.size)):(j.storage="minifat",j.size<0?j.size=0:h!==g&&j.start!==g&&s[h]&&(j.content=c(j,s[h].data,(s[l]||{}).data))),j.content&&gd(j.content,0),n[o]=j,i.push(j)}}(n,k,_,S,a,{},E,i),function(e,s,t){for(var a=0,r=0,n=0,i=0,l=0,c=t.length,o=[],d=[];a<c;++a)o[a]=d[a]=a,s[a]=t[a];for(;l<d.length;++l)r=e[a=d[l]].L,n=e[a].R,i=e[a].C,o[a]===a&&(-1!==r&&o[r]!==r&&(o[a]=o[r]),-1!==n&&o[n]!==n&&(o[a]=o[n])),-1!==i&&(o[i]=a),-1!==r&&a!=o[a]&&(o[r]=o[a],d.lastIndexOf(r)<l&&d.push(r)),-1!==n&&a!=o[a]&&(o[n]=o[a],d.lastIndexOf(n)<l&&d.push(n));for(a=1;a<c;++a)o[a]===a&&(-1!==n&&o[n]!==n?o[a]=o[n]:-1!==r&&o[r]!==r&&(o[a]=o[r]));for(a=1;a<c;++a)if(0!==e[a].type){if((l=a)!=o[l])do{l=o[l],s[a]=s[l]+"/"+s[a]}while(0!==l&&-1!==o[l]&&l!=o[l]);o[a]=-1}for(s[0]+="/",a=1;a<c;++a)2!==e[a].type&&(s[a]+="/")}(E,T,S),S.shift();var C={FileIndex:E,FullPaths:T};return s&&s.raw&&(C.raw={header:j,sectors:_}),C}function c(e,s,t){for(var a=e.start,r=e.size,n=[],i=a;t&&r>0&&i>=0;)n.push(s.slice(i*f,i*f+f)),r-=f,i=od(t,4*i);return 0===n.length?jd(0):Al(n).slice(0,e.size)}function o(e,s,t,a,r){var n=g;if(e===g){if(0!==s)throw new Error("DIFAT chain shorter than expected")}else if(-1!==e){var i=t[e],l=(a>>>2)-1;if(!i)return;for(var c=0;c<l&&(n=od(i,4*c))!==g;++c)r.push(n);o(od(i,a-4),s-1,t,a,r)}}function d(e,s,t,a,r){var n=[],i=[];r||(r=[]);var l=a-1,c=0,o=0;for(c=s;c>=0;){r[c]=!0,n[n.length]=c,i.push(e[c]);var d=t[Math.floor(4*c/a)];if(a<4+(o=4*c&l))throw new Error("FAT boundary crossed: "+c+" 4 "+a);if(!e[d])break;c=od(e[d],o)}return{nodes:n,data:zo([i])}}function m(e,s){return new Date(1e3*(cd(e,s+4)/1e7*Math.pow(2,32)+cd(e,s)/1e7-11644473600))}function h(e,s){var t=s||{},a=t.root||"Root Entry";if(e.FullPaths||(e.FullPaths=[]),e.FileIndex||(e.FileIndex=[]),e.FullPaths.length!==e.FileIndex.length)throw new Error("inconsistent CFB structure");0===e.FullPaths.length&&(e.FullPaths[0]=a+"/",e.FileIndex[0]={name:a,type:5}),t.CLSID&&(e.FileIndex[0].clsid=t.CLSID),function(e){var s="Sh33tJ5";if(Sc.find(e,"/"+s))return;var t=jd(4);t[0]=55,t[1]=t[3]=50,t[2]=54,e.FileIndex.push({name:s,type:2,content:t,size:4,L:69,R:69,C:69}),e.FullPaths.push(e.FullPaths[0]+s),u(e)}(e)}function u(e,s){h(e);for(var r=!1,n=!1,i=e.FullPaths.length-1;i>=0;--i){var l=e.FileIndex[i];switch(l.type){case 0:n?r=!0:(e.FileIndex.pop(),e.FullPaths.pop());break;case 1:case 2:case 5:n=!0,isNaN(l.R*l.L*l.C)&&(r=!0),l.R>-1&&l.L>-1&&l.R==l.L&&(r=!0);break;default:r=!0}}if(r||s){var c=new Date(1987,1,19),o=0,d=Object.create?Object.create(null):{},m=[];for(i=0;i<e.FullPaths.length;++i)d[e.FullPaths[i]]=!0,0!==e.FileIndex[i].type&&m.push([e.FullPaths[i],e.FileIndex[i]]);for(i=0;i<m.length;++i){var u=t(m[i][0]);(n=d[u])||(m.push([u,{name:a(u).replace("/",""),type:1,clsid:y,ct:c,mt:c,content:null}]),d[u]=!0)}for(m.sort(function(e,s){return function(e,s){for(var t=e.split("/"),a=s.split("/"),r=0,n=0,i=Math.min(t.length,a.length);r<i;++r){if(n=t[r].length-a[r].length)return n;if(t[r]!=a[r])return t[r]<a[r]?-1:1}return t.length-a.length}(e[0],s[0])}),e.FullPaths=[],e.FileIndex=[],i=0;i<m.length;++i)e.FullPaths[i]=m[i][0],e.FileIndex[i]=m[i][1];for(i=0;i<m.length;++i){var x=e.FileIndex[i],p=e.FullPaths[i];if(x.name=a(p).replace("/",""),x.L=x.R=x.C=-(x.color=1),x.size=x.content?x.content.length:0,x.start=0,x.clsid=x.clsid||y,0===i)x.C=m.length>1?1:-1,x.size=0,x.type=5;else if("/"==p.slice(-1)){for(o=i+1;o<m.length&&t(e.FullPaths[o])!=p;++o);for(x.C=o>=m.length?-1:o,o=i+1;o<m.length&&t(e.FullPaths[o])!=t(p);++o);x.R=o>=m.length?-1:o,x.type=1}else t(e.FullPaths[i+1]||"")==t(p)&&(x.R=i+1),x.type=2}}}function x(e,s){var t=s||{};if("mad"==t.fileType)return function(e,s){for(var t=s||{},a=t.boundary||"SheetJS",r=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+(a="------="+a).slice(2)+'"',"","",""],n=e.FullPaths[0],i=n,l=e.FileIndex[0],c=1;c<e.FullPaths.length;++c)if(i=e.FullPaths[c].slice(n.length),(l=e.FileIndex[c]).size&&l.content&&"Sh33tJ5"!=i){i=i.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(e){return"_x"+e.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(e){return"_u"+e.charCodeAt(0).toString(16)+"_"});for(var o=l.content,d=wl&&Buffer.isBuffer(o)?o.toString("binary"):N(o),m=0,h=Math.min(1024,d.length),u=0,x=0;x<=h;++x)(u=d.charCodeAt(x))>=32&&u<128&&++m;var p=m>=4*h/5;r.push(a),r.push("Content-Location: "+(t.root||"file:///C:/SheetJS/")+i),r.push("Content-Transfer-Encoding: "+(p?"quoted-printable":"base64")),r.push("Content-Type: "+ie(l,i)),r.push(""),r.push(p?ce(d):le(d))}return r.push(a+"--\r\n"),r.join("\r\n")}(e,t);if(u(e),"zip"===t.fileType)return function(e,s){var t=s||{},a=[],n=[],i=jd(1),l=t.compression?8:0,c=0,o=0,d=0,m=0,h=0,u=e.FullPaths[0],x=u,p=e.FileIndex[0],f=[],g=0;for(o=1;o<e.FullPaths.length;++o)if(x=e.FullPaths[o].slice(u.length),(p=e.FileIndex[o]).size&&p.content&&"Sh33tJ5"!=x){var v=m,j=jd(x.length);for(d=0;d<x.length;++d)j.write_shift(1,127&x.charCodeAt(d));j=j.slice(0,j.l),f[h]=kc.buf(p.content,0);var y=p.content;8==l&&(y=w(y)),(i=jd(30)).write_shift(4,67324752),i.write_shift(2,20),i.write_shift(2,c),i.write_shift(2,l),p.mt?r(i,p.mt):i.write_shift(4,0),i.write_shift(-4,f[h]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),i.write_shift(2,j.length),i.write_shift(2,0),m+=i.length,a.push(i),m+=j.length,a.push(j),m+=y.length,a.push(y),(i=jd(46)).write_shift(4,33639248),i.write_shift(2,0),i.write_shift(2,20),i.write_shift(2,c),i.write_shift(2,l),i.write_shift(4,0),i.write_shift(-4,f[h]),i.write_shift(4,y.length),i.write_shift(4,p.content.length),i.write_shift(2,j.length),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(4,0),i.write_shift(4,v),g+=i.l,n.push(i),g+=j.length,n.push(j),++h}return i=jd(22),i.write_shift(4,101010256),i.write_shift(2,0),i.write_shift(2,0),i.write_shift(2,h),i.write_shift(2,h),i.write_shift(4,g),i.write_shift(4,m),i.write_shift(2,0),Al([Al(a),Al(n),i])}(e,t);var a=function(e){for(var s=0,t=0,a=0;a<e.FileIndex.length;++a){var r=e.FileIndex[a];if(r.content){var n=r.content.length;n>0&&(n<4096?s+=n+63>>6:t+=n+511>>9)}}for(var i=e.FullPaths.length+3>>2,l=s+127>>7,c=(s+7>>3)+t+i+l,o=c+127>>7,d=o<=109?0:Math.ceil((o-109)/127);c+o+d+127>>7>o;)d=++o<=109?0:Math.ceil((o-109)/127);var m=[1,d,o,l,i,t,s,0];return e.FileIndex[0].size=s<<6,m[7]=(e.FileIndex[0].start=m[0]+m[1]+m[2]+m[3]+m[4]+m[5])+(m[6]+7>>3),m}(e),n=jd(a[7]<<9),i=0,l=0;for(i=0;i<8;++i)n.write_shift(1,j[i]);for(i=0;i<8;++i)n.write_shift(2,0);for(n.write_shift(2,62),n.write_shift(2,3),n.write_shift(2,65534),n.write_shift(2,9),n.write_shift(2,6),i=0;i<3;++i)n.write_shift(2,0);for(n.write_shift(4,0),n.write_shift(4,a[2]),n.write_shift(4,a[0]+a[1]+a[2]+a[3]-1),n.write_shift(4,0),n.write_shift(4,4096),n.write_shift(4,a[3]?a[0]+a[1]+a[2]-1:g),n.write_shift(4,a[3]),n.write_shift(-4,a[1]?a[0]-1:g),n.write_shift(4,a[1]),i=0;i<109;++i)n.write_shift(-4,i<a[2]?a[1]+i:-1);if(a[1])for(l=0;l<a[1];++l){for(;i<236+127*l;++i)n.write_shift(-4,i<a[2]?a[1]+i:-1);n.write_shift(-4,l===a[1]-1?g:l+1)}var c=function(e){for(l+=e;i<l-1;++i)n.write_shift(-4,i+1);e&&(++i,n.write_shift(-4,g))};for(l=i=0,l+=a[1];i<l;++i)n.write_shift(-4,b.DIFSECT);for(l+=a[2];i<l;++i)n.write_shift(-4,b.FATSECT);c(a[3]),c(a[4]);for(var o=0,d=0,m=e.FileIndex[0];o<e.FileIndex.length;++o)(m=e.FileIndex[o]).content&&((d=m.content.length)<4096||(m.start=l,c(d+511>>9)));for(c(a[6]+7>>3);511&n.l;)n.write_shift(-4,b.ENDOFCHAIN);for(l=i=0,o=0;o<e.FileIndex.length;++o)(m=e.FileIndex[o]).content&&(!(d=m.content.length)||d>=4096||(m.start=l,c(d+63>>6)));for(;511&n.l;)n.write_shift(-4,b.ENDOFCHAIN);for(i=0;i<a[4]<<2;++i){var h=e.FullPaths[i];if(h&&0!==h.length){m=e.FileIndex[i],0===i&&(m.start=m.size?m.start-1:g);var x=0===i&&t.root||m.name;if(d=2*(x.length+1),n.write_shift(64,x,"utf16le"),n.write_shift(2,d),n.write_shift(1,m.type),n.write_shift(1,m.color),n.write_shift(-4,m.L),n.write_shift(-4,m.R),n.write_shift(-4,m.C),m.clsid)n.write_shift(16,m.clsid,"hex");else for(o=0;o<4;++o)n.write_shift(4,0);n.write_shift(4,m.state||0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,m.start),n.write_shift(4,m.size),n.write_shift(4,0)}else{for(o=0;o<17;++o)n.write_shift(4,0);for(o=0;o<3;++o)n.write_shift(4,-1);for(o=0;o<12;++o)n.write_shift(4,0)}}for(i=1;i<e.FileIndex.length;++i)if((m=e.FileIndex[i]).size>=4096)if(n.l=m.start+1<<9,wl&&Buffer.isBuffer(m.content))m.content.copy(n,n.l,0,m.size),n.l+=m.size+511&-512;else{for(o=0;o<m.size;++o)n.write_shift(1,m.content[o]);for(;511&o;++o)n.write_shift(1,0)}for(i=1;i<e.FileIndex.length;++i)if((m=e.FileIndex[i]).size>0&&m.size<4096)if(wl&&Buffer.isBuffer(m.content))m.content.copy(n,n.l,0,m.size),n.l+=m.size+63&-64;else{for(o=0;o<m.size;++o)n.write_shift(1,m.content[o]);for(;63&o;++o)n.write_shift(1,0)}if(wl)n.l=n.length;else for(;n.l<n.length;)n.write_shift(1,0);return n}s.version="1.2.1";var p,f=64,g=-2,v="d0cf11e0a1b11ae1",j=[208,207,17,224,161,177,26,225],y="00000000000000000000000000000000",b={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:g,FREESECT:-1,HEADER_SIGNATURE:v,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:y,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function N(e){for(var s=new Array(e.length),t=0;t<e.length;++t)s[t]=String.fromCharCode(e[t]);return s.join("")}function w(e){return p?p.deflateRawSync(e):Y(e)}var _=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],k=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],S=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function E(e){var s=139536&(e<<1|e<<11)|558144&(e<<5|e<<15);return 255&(s>>16|s>>8|s)}for(var T="undefined"!=typeof Uint8Array,C=T?new Uint8Array(256):[],A=0;A<256;++A)C[A]=E(A);function R(e,s){var t=C[255&e];return s<=8?t>>>8-s:(t=t<<8|C[e>>8&255],s<=16?t>>>16-s:(t=t<<8|C[e>>16&255])>>>24-s)}function I(e,s){var t=7&s,a=s>>>3;return(e[a]|(t<=6?0:e[a+1]<<8))>>>t&3}function P(e,s){var t=7&s,a=s>>>3;return(e[a]|(t<=5?0:e[a+1]<<8))>>>t&7}function D(e,s){var t=7&s,a=s>>>3;return(e[a]|(t<=3?0:e[a+1]<<8))>>>t&31}function M(e,s){var t=7&s,a=s>>>3;return(e[a]|(t<=1?0:e[a+1]<<8))>>>t&127}function O(e,s,t){var a=7&s,r=s>>>3,n=(1<<t)-1,i=e[r]>>>a;return t<8-a?i&n:(i|=e[r+1]<<8-a,t<16-a?i&n:(i|=e[r+2]<<16-a,t<24-a?i&n:(i|=e[r+3]<<24-a)&n))}function F(e,s,t){var a=7&s,r=s>>>3;return a<=5?e[r]|=(7&t)<<a:(e[r]|=t<<a&255,e[r+1]=(7&t)>>8-a),s+3}function L(e,s,t){return t=(1&t)<<(7&s),e[s>>>3]|=t,s+1}function z(e,s,t){var a=s>>>3;return t<<=7&s,e[a]|=255&t,t>>>=8,e[a+1]=t,s+8}function U(e,s,t){var a=s>>>3;return t<<=7&s,e[a]|=255&t,t>>>=8,e[a+1]=255&t,e[a+2]=t>>>8,s+16}function B(e,s){var t=e.length,a=2*t>s?2*t:s+5,r=0;if(t>=s)return e;if(wl){var n=Sl(a);if(e.copy)e.copy(n);else for(;r<e.length;++r)n[r]=e[r];return n}if(T){var i=new Uint8Array(a);if(i.set)i.set(e);else for(;r<t;++r)i[r]=e[r];return i}return e.length=a,e}function $(e){for(var s=new Array(e),t=0;t<e;++t)s[t]=0;return s}function H(e,s,t){var a=1,r=0,n=0,i=0,l=0,c=e.length,o=T?new Uint16Array(32):$(32);for(n=0;n<32;++n)o[n]=0;for(n=c;n<t;++n)e[n]=0;c=e.length;var d=T?new Uint16Array(c):$(c);for(n=0;n<c;++n)o[r=e[n]]++,a<r&&(a=r),d[n]=0;for(o[0]=0,n=1;n<=a;++n)o[n+16]=l=l+o[n-1]<<1;for(n=0;n<c;++n)0!=(l=e[n])&&(d[n]=o[l+16]++);var m=0;for(n=0;n<c;++n)if(0!=(m=e[n]))for(l=R(d[n],a)>>a-m,i=(1<<a+4-m)-1;i>=0;--i)s[l|i<<m]=15&m|n<<4;return a}var V=T?new Uint16Array(512):$(512),G=T?new Uint16Array(32):$(32);if(!T){for(var q=0;q<512;++q)V[q]=0;for(q=0;q<32;++q)G[q]=0}!function(){for(var e=[],s=0;s<32;s++)e.push(5);H(e,G,32);var t=[];for(s=0;s<=143;s++)t.push(8);for(;s<=255;s++)t.push(9);for(;s<=279;s++)t.push(7);for(;s<=287;s++)t.push(8);H(t,V,288)}();var W=function(){for(var e=T?new Uint8Array(32768):[],s=0,t=0;s<S.length-1;++s)for(;t<S[s+1];++t)e[t]=s;for(;t<32768;++t)e[t]=29;var a=T?new Uint8Array(259):[];for(s=0,t=0;s<k.length-1;++s)for(;t<k[s+1];++t)a[t]=s;return function(s,t){return s.length<8?function(e,s){for(var t=0;t<e.length;){var a=Math.min(65535,e.length-t),r=t+a==e.length;for(s.write_shift(1,+r),s.write_shift(2,a),s.write_shift(2,65535&~a);a-- >0;)s[s.l++]=e[t++]}return s.l}(s,t):function(s,t){for(var r=0,n=0,i=T?new Uint16Array(32768):[];n<s.length;){var l=Math.min(65535,s.length-n);if(l<10){for(7&(r=F(t,r,+!(n+l!=s.length)))&&(r+=8-(7&r)),t.l=r/8|0,t.write_shift(2,l),t.write_shift(2,65535&~l);l-- >0;)t[t.l++]=s[n++];r=8*t.l}else{r=F(t,r,+!(n+l!=s.length)+2);for(var c=0;l-- >0;){var o=s[n],d=-1,m=0;if((d=i[c=32767&(c<<5^o)])&&((d|=-32768&n)>n&&(d-=32768),d<n))for(;s[d+m]==s[n+m]&&m<250;)++m;if(m>2){(o=a[m])<=22?r=z(t,r,C[o+1]>>1)-1:(z(t,r,3),z(t,r+=5,C[o-23]>>5),r+=3);var h=o<8?0:o-4>>2;h>0&&(U(t,r,m-k[o]),r+=h),o=e[n-d],r=z(t,r,C[o]>>3),r-=3;var u=o<4?0:o-2>>1;u>0&&(U(t,r,n-d-S[o]),r+=u);for(var x=0;x<m;++x)i[c]=32767&n,c=32767&(c<<5^s[n]),++n;l-=m-1}else o<=143?o+=48:r=L(t,r,1),r=z(t,r,C[o]),i[c]=32767&n,++n}r=z(t,r,0)-1}}return t.l=(r+7)/8|0,t.l}(s,t)}}();function Y(e){var s=jd(50+Math.floor(1.1*e.length)),t=W(e,s);return s.slice(0,t)}var K=T?new Uint16Array(32768):$(32768),J=T?new Uint16Array(32768):$(32768),X=T?new Uint16Array(128):$(128),Z=1,Q=1;function ee(e,s){var t=D(e,s)+257,a=D(e,s+=5)+1,r=function(e,s){var t=7&s,a=s>>>3;return(e[a]|(t<=4?0:e[a+1]<<8))>>>t&15}(e,s+=5)+4;s+=4;for(var n=0,i=T?new Uint8Array(19):$(19),l=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],c=1,o=T?new Uint8Array(8):$(8),d=T?new Uint8Array(8):$(8),m=i.length,h=0;h<r;++h)i[_[h]]=n=P(e,s),c<n&&(c=n),o[n]++,s+=3;var u=0;for(o[0]=0,h=1;h<=c;++h)d[h]=u=u+o[h-1]<<1;for(h=0;h<m;++h)0!=(u=i[h])&&(l[h]=d[u]++);var x=0;for(h=0;h<m;++h)if(0!=(x=i[h])){u=C[l[h]]>>8-x;for(var p=(1<<7-x)-1;p>=0;--p)X[u|p<<x]=7&x|h<<3}var f=[];for(c=1;f.length<t+a;)switch(s+=7&(u=X[M(e,s)]),u>>>=3){case 16:for(n=3+I(e,s),s+=2,u=f[f.length-1];n-- >0;)f.push(u);break;case 17:for(n=3+P(e,s),s+=3;n-- >0;)f.push(0);break;case 18:for(n=11+M(e,s),s+=7;n-- >0;)f.push(0);break;default:f.push(u),c<u&&(c=u)}var g=f.slice(0,t),v=f.slice(t);for(h=t;h<286;++h)g[h]=0;for(h=a;h<30;++h)v[h]=0;return Z=H(g,K,286),Q=H(v,J,30),s}function se(e,s){var t=function(e,s){if(3==e[0]&&!(3&e[1]))return[kl(s),2];for(var t=0,a=0,r=Sl(s||1<<18),n=0,i=r.length>>>0,l=0,c=0;!(1&a);)if(a=P(e,t),t+=3,a>>>1!=0)for(a>>1==1?(l=9,c=5):(t=ee(e,t),l=Z,c=Q);;){!s&&i<n+32767&&(i=(r=B(r,n+32767)).length);var o=O(e,t,l),d=a>>>1==1?V[o]:K[o];if(t+=15&d,(d>>>=4)>>>8&255){if(256==d)break;var m=(d-=257)<8?0:d-4>>2;m>5&&(m=0);var h=n+k[d];m>0&&(h+=O(e,t,m),t+=m),o=O(e,t,c),t+=15&(d=a>>>1==1?G[o]:J[o]);var u=(d>>>=4)<4?0:d-2>>1,x=S[d];for(u>0&&(x+=O(e,t,u),t+=u),!s&&i<h&&(i=(r=B(r,h+100)).length);n<h;)r[n]=r[n-x],++n}else r[n++]=d}else{7&t&&(t+=8-(7&t));var p=e[t>>>3]|e[(t>>>3)+1]<<8;if(t+=32,p>0)for(!s&&i<n+p&&(i=(r=B(r,n+p)).length);p-- >0;)r[n++]=e[t>>>3],t+=8}return s?[r,t+7>>>3]:[r.slice(0,n),t+7>>>3]}(e.slice(e.l||0),s);return e.l+=t[1],t[0]}function te(e,s){if(!e)throw new Error(s)}function ae(e,s){var t=e;gd(t,0);var a={FileIndex:[],FullPaths:[]};h(a,{root:s.root});for(var r=t.length-4;(80!=t[r]||75!=t[r+1]||5!=t[r+2]||6!=t[r+3])&&r>=0;)--r;t.l=r+4,t.l+=4;var i=t.read_shift(2);t.l+=6;var l=t.read_shift(4);for(t.l=l,r=0;r<i;++r){t.l+=20;var c=t.read_shift(4),o=t.read_shift(4),d=t.read_shift(2),m=t.read_shift(2),u=t.read_shift(2);t.l+=8;var x=t.read_shift(4),p=n(t.slice(t.l+d,t.l+d+m));t.l+=d+m+u;var f=t.l;t.l=x+4,re(t,c,o,a,p),t.l=f}return a}function re(e,s,t,a,r){e.l+=2;var i=e.read_shift(2),l=e.read_shift(2),c=function(e){var s=65535&e.read_shift(2),t=65535&e.read_shift(2),a=new Date,r=31&t,n=15&(t>>>=5);t>>>=4,a.setMilliseconds(0),a.setFullYear(t+1980),a.setMonth(n-1),a.setDate(r);var i=31&s,l=63&(s>>>=5);return s>>>=6,a.setHours(s),a.setMinutes(l),a.setSeconds(i<<1),a}(e);if(8257&i)throw new Error("Unsupported ZIP encryption");e.read_shift(4);for(var o=e.read_shift(4),d=e.read_shift(4),m=e.read_shift(2),h=e.read_shift(2),u="",x=0;x<m;++x)u+=String.fromCharCode(e[e.l++]);if(h){var f=n(e.slice(e.l,e.l+h));(f[21589]||{}).mt&&(c=f[21589].mt),((r||{})[21589]||{}).mt&&(c=r[21589].mt)}e.l+=h;var g=e.slice(e.l,e.l+o);switch(l){case 8:g=function(e,s){if(!p)return se(e,s);var t=new(0,p.InflateRaw),a=t._processChunk(e.slice(e.l),t._finishFlushFlag);return e.l+=t.bytesRead,a}(e,d);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+l)}var v=!1;8&i&&(134695760==e.read_shift(4)&&(e.read_shift(4),v=!0),o=e.read_shift(4),d=e.read_shift(4)),o!=s&&te(v,"Bad compressed size: "+s+" != "+o),d!=t&&te(v,"Bad uncompressed size: "+t+" != "+d),de(a,u,g,{unsafe:!0,mt:c})}var ne={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function ie(e,s){if(e.ctype)return e.ctype;var t=e.name||"",a=t.match(/\.([^\.]+)$/);return a&&ne[a[1]]||s&&(a=(t=s).match(/[\.\\]([^\.\\])+$/))&&ne[a[1]]?ne[a[1]]:"application/octet-stream"}function le(e){for(var s=bl(e),t=[],a=0;a<s.length;a+=76)t.push(s.slice(a,a+76));return t.join("\r\n")+"\r\n"}function ce(e){var s=e.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(e){var s=e.charCodeAt(0).toString(16).toUpperCase();return"="+(1==s.length?"0"+s:s)});"\n"==(s=s.replace(/ $/gm,"=20").replace(/\t$/gm,"=09")).charAt(0)&&(s="=0D"+s.slice(1));for(var t=[],a=(s=s.replace(/\r(?!\n)/gm,"=0D").replace(/\n\n/gm,"\n=0A").replace(/([^\r\n])\n/gm,"$1=0A")).split("\r\n"),r=0;r<a.length;++r){var n=a[r];if(0!=n.length)for(var i=0;i<n.length;){var l=76,c=n.slice(i,i+l);"="==c.charAt(l-1)?l--:"="==c.charAt(l-2)?l-=2:"="==c.charAt(l-3)&&(l-=3),c=n.slice(i,i+l),(i+=l)<n.length&&(c+="="),t.push(c)}else t.push("")}return t.join("\r\n")}function oe(e,s,t){for(var a,r="",n="",i="",l=0;l<10;++l){var c=s[l];if(!c||c.match(/^\s*$/))break;var o=c.match(/^(.*?):\s*([^\s].*)$/);if(o)switch(o[1].toLowerCase()){case"content-location":r=o[2].trim();break;case"content-type":i=o[2].trim();break;case"content-transfer-encoding":n=o[2].trim()}}switch(++l,n.toLowerCase()){case"base64":a=El(Nl(s.slice(l).join("")));break;case"quoted-printable":a=function(e){for(var s=[],t=0;t<e.length;++t){for(var a=e[t];t<=e.length&&"="==a.charAt(a.length-1);)a=a.slice(0,a.length-1)+e[++t];s.push(a)}for(var r=0;r<s.length;++r)s[r]=s[r].replace(/[=][0-9A-Fa-f]{2}/g,function(e){return String.fromCharCode(parseInt(e.slice(1),16))});return El(s.join("\r\n"))}(s.slice(l));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+n)}var d=de(e,r.slice(t.length),a,{unsafe:!0});i&&(d.ctype=i)}function de(e,s,t,r){var n=r&&r.unsafe;n||h(e);var i=!n&&Sc.find(e,s);if(!i){var l=e.FullPaths[0];s.slice(0,l.length)==l?l=s:("/"!=l.slice(-1)&&(l+="/"),l=(l+s).replace("//","/")),i={name:a(s),type:2},e.FileIndex.push(i),e.FullPaths.push(l),n||Sc.utils.cfb_gc(e)}return i.content=t,i.size=t?t.length:0,r&&(r.CLSID&&(i.clsid=r.CLSID),r.mt&&(i.mt=r.mt),r.ct&&(i.ct=r.ct)),i}return s.find=function(e,s){var t=e.FullPaths.map(function(e){return e.toUpperCase()}),a=t.map(function(e){var s=e.split("/");return s[s.length-("/"==e.slice(-1)?2:1)]}),r=!1;47===s.charCodeAt(0)?(r=!0,s=t[0].slice(0,-1)+s):r=-1!==s.indexOf("/");var n=s.toUpperCase(),i=!0===r?t.indexOf(n):a.indexOf(n);if(-1!==i)return e.FileIndex[i];var l=!n.match(Il);for(n=n.replace(Rl,""),l&&(n=n.replace(Il,"!")),i=0;i<t.length;++i){if((l?t[i].replace(Il,"!"):t[i]).replace(Rl,"")==n)return e.FileIndex[i];if((l?a[i].replace(Il,"!"):a[i]).replace(Rl,"")==n)return e.FileIndex[i]}return null},s.read=function(s,t){var a=t&&t.type;switch(a||wl&&Buffer.isBuffer(s)&&(a="buffer"),a||"base64"){case"file":return function(s,t){return i(),l(e.readFileSync(s),t)}(s,t);case"base64":return l(El(Nl(s)),t);case"binary":return l(El(s),t)}return l(s,t)},s.parse=l,s.write=function(s,t){var a=x(s,t);switch(t&&t.type||"buffer"){case"file":return i(),e.writeFileSync(t.filename,a),a;case"binary":return"string"==typeof a?a:N(a);case"base64":return bl("string"==typeof a?a:N(a));case"buffer":if(wl)return Buffer.isBuffer(a)?a:_l(a);case"array":return"string"==typeof a?El(a):a}return a},s.writeFile=function(s,t,a){i();var r=x(s,a);e.writeFileSync(t,r)},s.utils={cfb_new:function(e){var s={};return h(s,e),s},cfb_add:de,cfb_del:function(e,s){h(e);var t=Sc.find(e,s);if(t)for(var a=0;a<e.FileIndex.length;++a)if(e.FileIndex[a]==t)return e.FileIndex.splice(a,1),e.FullPaths.splice(a,1),!0;return!1},cfb_mov:function(e,s,t){h(e);var r=Sc.find(e,s);if(r)for(var n=0;n<e.FileIndex.length;++n)if(e.FileIndex[n]==r)return e.FileIndex[n].name=a(t),e.FullPaths[n]=t,!0;return!1},cfb_gc:function(e){u(e,!0)},ReadShift:md,CheckField:fd,prep_blob:gd,bconcat:Al,use_zlib:function(e){try{var s=new(0,e.InflateRaw);if(s._processChunk(new Uint8Array([3,0]),s._finishFlushFlag),!s.bytesRead)throw new Error("zlib does not expose bytesRead");p=e}catch(t){}},_deflateRaw:Y,_inflateRaw:se,consts:b},s}();function Ec(e){for(var s=Object.keys(e),t=[],a=0;a<s.length;++a)Object.prototype.hasOwnProperty.call(e,s[a])&&t.push(s[a]);return t}function Tc(e){for(var s=[],t=Ec(e),a=0;a!==t.length;++a)s[e[t[a]]]=t[a];return s}var Cc=new Date(1899,11,30,0,0,0);function Ac(e,s){return(e.getTime()-(Cc.getTime()+6e4*(e.getTimezoneOffset()-Cc.getTimezoneOffset())))/864e5}var Rc=new Date,Ic=Cc.getTime()+6e4*(Rc.getTimezoneOffset()-Cc.getTimezoneOffset()),Pc=Rc.getTimezoneOffset();function Dc(e){var s=new Date;return s.setTime(24*e*60*60*1e3+Ic),s.getTimezoneOffset()!==Pc&&s.setTime(s.getTime()+6e4*(s.getTimezoneOffset()-Pc)),s}function Mc(e){var s=0,t=0,a=!1,r=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!r)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var n=1;n!=r.length;++n)if(r[n]){switch(t=1,n>3&&(a=!0),r[n].slice(r[n].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+r[n].slice(r[n].length-1));case"D":t*=24;case"H":t*=60;case"M":if(!a)throw new Error("Unsupported ISO Duration Field: M");t*=60}s+=t*parseInt(r[n],10)}return s}var Oc=new Date("2017-02-19T19:06:09.000Z"),Fc=isNaN(Oc.getFullYear())?new Date("2/19/17"):Oc,Lc=2017==Fc.getFullYear();function zc(e,s){var t=new Date(e);if(Lc)return s>0?t.setTime(t.getTime()+60*t.getTimezoneOffset()*1e3):s<0&&t.setTime(t.getTime()-60*t.getTimezoneOffset()*1e3),t;if(e instanceof Date)return e;if(1917==Fc.getFullYear()&&!isNaN(t.getFullYear())){var a=t.getFullYear();return e.indexOf(""+a)>-1||t.setFullYear(t.getFullYear()+100),t}var r=e.match(/\d+/g)||["2017","2","19","0","0","0"],n=new Date(+r[0],+r[1]-1,+r[2],+r[3]||0,+r[4]||0,+r[5]||0);return e.indexOf("Z")>-1&&(n=new Date(n.getTime()-60*n.getTimezoneOffset()*1e3)),n}function Uc(e,s){if(wl&&Buffer.isBuffer(e)){if(s){if(255==e[0]&&254==e[1])return ko(e.slice(2).toString("utf16le"));if(254==e[1]&&255==e[2])return ko(pl(e.slice(2).toString("binary")))}return e.toString("binary")}if("undefined"!=typeof TextDecoder)try{if(s){if(255==e[0]&&254==e[1])return ko(new TextDecoder("utf-16le").decode(e.slice(2)));if(254==e[0]&&255==e[1])return ko(new TextDecoder("utf-16be").decode(e.slice(2)))}var t={"€":"","‚":"","ƒ":"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"","Š":"","‹":"","Œ":"","Ž":"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"","š":"","›":"","œ":"","ž":"","Ÿ":""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(e){return t[e]||e})}catch(n){}for(var a=[],r=0;r!=e.length;++r)a.push(String.fromCharCode(e[r]));return a.join("")}function Bc(e){if("undefined"!=typeof JSON&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if("object"!=typeof e||null==e)return e;if(e instanceof Date)return new Date(e.getTime());var s={};for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(s[t]=Bc(e[t]));return s}function $c(e,s){for(var t="";t.length<s;)t+=e;return t}function Hc(e){var s=Number(e);if(!isNaN(s))return isFinite(s)?s:NaN;if(!/\d/.test(e))return s;var t=1,a=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return isNaN(s=Number(a))?(a=a.replace(/[(](.*)[)]/,function(e,s){return t=-t,s}),isNaN(s=Number(a))?s:s/t):s/t}var Vc=["january","february","march","april","may","june","july","august","september","october","november","december"];function Gc(e){var s=new Date(e),t=new Date(NaN),a=s.getYear(),r=s.getMonth(),n=s.getDate();if(isNaN(n))return t;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if((i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,"")).length>3&&-1==Vc.indexOf(i))return t}else if(i.match(/[a-z]/))return t;return a<0||a>8099?t:(r>0||n>1)&&101!=a?s:e.match(/[^-0-9:,\/\\]/)?t:s}var qc=function(){var e=5=="abacaba".split(/(:?b)/i).length;return function(s,t,a){if(e||"string"==typeof t)return s.split(t);for(var r=s.split(t),n=[r[0]],i=1;i<r.length;++i)n.push(a),n.push(r[i]);return n}}();function Wc(e){return e?e.content&&e.type?Uc(e.content,!0):e.data?gl(e.data):e.asNodeBuffer&&wl?gl(e.asNodeBuffer().toString("binary")):e.asBinary?gl(e.asBinary()):e._data&&e._data.getContent?gl(Uc(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function Yc(e){if(!e)return null;if(e.data)return xl(e.data);if(e.asNodeBuffer&&wl)return e.asNodeBuffer();if(e._data&&e._data.getContent){var s=e._data.getContent();return"string"==typeof s?xl(s):Array.prototype.slice.call(s)}return e.content&&e.type?e.content:null}function Kc(e,s){for(var t=e.FullPaths||Ec(e.files),a=s.toLowerCase().replace(/[\/]/g,"\\"),r=a.replace(/\\/g,"/"),n=0;n<t.length;++n){var i=t[n].replace(/^Root Entry[\/]/,"").toLowerCase();if(a==i||r==i)return e.files?e.files[t[n]]:e.FileIndex[n]}return null}function Jc(e,s){var t=Kc(e,s);if(null==t)throw new Error("Cannot find file "+s+" in zip");return t}function Xc(e,s,t){if(!t)return(a=Jc(e,s))&&".bin"===a.name.slice(-4)?Yc(a):Wc(a);var a;if(!s)return null;try{return Xc(e,s)}catch(r){return null}}function Zc(e,s,t){if(!t)return Wc(Jc(e,s));if(!s)return null;try{return Zc(e,s)}catch(a){return null}}function Qc(e){for(var s=e.FullPaths||Ec(e.files),t=[],a=0;a<s.length;++a)"/"!=s[a].slice(-1)&&t.push(s[a].replace(/^Root Entry[\/]/,""));return t.sort()}function eo(e,s,t){if(e.FullPaths){var a;if("string"==typeof t)return a=wl?_l(t):function(e){for(var s=[],t=0,a=e.length+250,r=kl(e.length+255),n=0;n<e.length;++n){var i=e.charCodeAt(n);if(i<128)r[t++]=i;else if(i<2048)r[t++]=192|i>>6&31,r[t++]=128|63&i;else if(i>=55296&&i<57344){i=64+(1023&i);var l=1023&e.charCodeAt(++n);r[t++]=240|i>>8&7,r[t++]=128|i>>2&63,r[t++]=128|l>>6&15|(3&i)<<4,r[t++]=128|63&l}else r[t++]=224|i>>12&15,r[t++]=128|i>>6&63,r[t++]=128|63&i;t>a&&(s.push(r.slice(0,t)),t=0,r=kl(65535),a=65530)}return s.push(r.slice(0,t)),Al(s)}(t),Sc.utils.cfb_add(e,s,a);Sc.utils.cfb_add(e,s,t)}else e.file(s,t)}function so(e,s){switch(s.type){case"base64":return Sc.read(e,{type:"base64"});case"binary":return Sc.read(e,{type:"binary"});case"buffer":case"array":return Sc.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+s.type)}function to(e,s){if("/"==e.charAt(0))return e.slice(1);var t=s.split("/");"/"!=s.slice(-1)&&t.pop();for(var a=e.split("/");0!==a.length;){var r=a.shift();".."===r?t.pop():"."!==r&&t.push(r)}return t.join("/")}var ao='<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r\n',ro=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,no=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/gm,io=ao.match(no)?no:/<[^>]*>/g,lo=/<\w*:/,co=/<(\/?)\w+:/;function oo(e,s,t){for(var a={},r=0,n=0;r!==e.length&&(32!==(n=e.charCodeAt(r))&&10!==n&&13!==n);++r);if(s||(a[0]=e.slice(0,r)),r===e.length)return a;var i=e.match(ro),l=0,c="",o=0,d="",m="",h=1;if(i)for(o=0;o!=i.length;++o){for(m=i[o],n=0;n!=m.length&&61!==m.charCodeAt(n);++n);for(d=m.slice(0,n).trim();32==m.charCodeAt(n+1);)++n;for(h=34==(r=m.charCodeAt(n+1))||39==r?1:0,c=m.slice(n+1+h,m.length-h),l=0;l!=d.length&&58!==d.charCodeAt(l);++l);if(l===d.length)d.indexOf("_")>0&&(d=d.slice(0,d.indexOf("_"))),a[d]=c,a[d.toLowerCase()]=c;else{var u=(5===l&&"xmlns"===d.slice(0,5)?"xmlns":"")+d.slice(l+1);if(a[u]&&"ext"==d.slice(l-3,l))continue;a[u]=c,a[u.toLowerCase()]=c}}return a}function mo(e){return e.replace(co,"<$1")}var ho={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},uo=Tc(ho),xo=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/gi,s=/_x([\da-fA-F]{4})_/gi;return function t(a){var r=a+"",n=r.indexOf("<![CDATA[");if(-1==n)return r.replace(e,function(e,s){return ho[e]||String.fromCharCode(parseInt(s,e.indexOf("x")>-1?16:10))||e}).replace(s,function(e,s){return String.fromCharCode(parseInt(s,16))});var i=r.indexOf("]]>");return t(r.slice(0,n))+r.slice(n+9,i)+t(r.slice(i+3))}}(),po=/[&<>'"]/g,fo=/[\u0000-\u001f]/g;function go(e){return(e+"").replace(po,function(e){return uo[e]}).replace(/\n/g,"<br/>").replace(fo,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}var vo=function(){var e=/&#(\d+);/g;function s(e,s){return String.fromCharCode(parseInt(s,10))}return function(t){return t.replace(e,s)}}();function jo(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function yo(e){for(var s="",t=0,a=0,r=0,n=0,i=0,l=0;t<e.length;)(a=e.charCodeAt(t++))<128?s+=String.fromCharCode(a):(r=e.charCodeAt(t++),a>191&&a<224?(i=(31&a)<<6,i|=63&r,s+=String.fromCharCode(i)):(n=e.charCodeAt(t++),a<240?s+=String.fromCharCode((15&a)<<12|(63&r)<<6|63&n):(l=((7&a)<<18|(63&r)<<12|(63&n)<<6|63&(i=e.charCodeAt(t++)))-65536,s+=String.fromCharCode(55296+(l>>>10&1023)),s+=String.fromCharCode(56320+(1023&l)))));return s}function bo(e){var s,t,a,r=kl(2*e.length),n=1,i=0,l=0;for(t=0;t<e.length;t+=n)n=1,(a=e.charCodeAt(t))<128?s=a:a<224?(s=64*(31&a)+(63&e.charCodeAt(t+1)),n=2):a<240?(s=4096*(15&a)+64*(63&e.charCodeAt(t+1))+(63&e.charCodeAt(t+2)),n=3):(n=4,s=262144*(7&a)+4096*(63&e.charCodeAt(t+1))+64*(63&e.charCodeAt(t+2))+(63&e.charCodeAt(t+3)),l=55296+((s-=65536)>>>10&1023),s=56320+(1023&s)),0!==l&&(r[i++]=255&l,r[i++]=l>>>8,l=0),r[i++]=s%256,r[i++]=s>>>8;return r.slice(0,i).toString("ucs2")}function No(e){return _l(e,"binary").toString("utf8")}var wo="foo bar bazâð£",_o=wl&&(No(wo)==yo(wo)&&No||bo(wo)==yo(wo)&&bo)||yo,ko=wl?function(e){return _l(e,"utf8").toString("binary")}:function(e){for(var s=[],t=0,a=0,r=0;t<e.length;)switch(a=e.charCodeAt(t++),!0){case a<128:s.push(String.fromCharCode(a));break;case a<2048:s.push(String.fromCharCode(192+(a>>6))),s.push(String.fromCharCode(128+(63&a)));break;case a>=55296&&a<57344:a-=55296,r=e.charCodeAt(t++)-56320+(a<<10),s.push(String.fromCharCode(240+(r>>18&7))),s.push(String.fromCharCode(144+(r>>12&63))),s.push(String.fromCharCode(128+(r>>6&63))),s.push(String.fromCharCode(128+(63&r)));break;default:s.push(String.fromCharCode(224+(a>>12))),s.push(String.fromCharCode(128+(a>>6&63))),s.push(String.fromCharCode(128+(63&a)))}return s.join("")},So=function(){var e={};return function(s,t){var a=s+"|"+(t||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+s+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+s+">",t||"")}}(),Eo=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(s){for(var t=s.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,"\n").replace(/<[^>]*>/g,""),a=0;a<e.length;++a)t=t.replace(e[a][0],e[a][1]);return t}}(),To=function(){var e={};return function(s){return void 0!==e[s]?e[s]:e[s]=new RegExp("<(?:vt:)?"+s+">([\\s\\S]*?)</(?:vt:)?"+s+">","g")}}(),Co=/<\/?(?:vt:)?variant>/g,Ao=/<(?:vt:)([^>]*)>([\s\S]*)</;function Ro(e,s){var t=oo(e),a=e.match(To(t.baseType))||[],r=[];if(a.length!=t.size){if(s.WTF)throw new Error("unexpected vector length "+a.length+" != "+t.size);return r}return a.forEach(function(e){var s=e.replace(Co,"").match(Ao);s&&r.push({v:_o(s[2]),t:s[1]})}),r}var Io=/(^\s|\s$|\n)/;function Po(e,s,t){return"<"+e+(null!=t?function(e){return Ec(e).map(function(s){return" "+s+'="'+e[s]+'"'}).join("")}(t):"")+(null!=s?(s.match(Io)?' xml:space="preserve"':"")+">"+s+"</"+e:"/")+">"}function Do(e){if(wl&&Buffer.isBuffer(e))return e.toString("utf8");if("string"==typeof e)return e;if("undefined"!=typeof Uint8Array&&e instanceof Uint8Array)return _o(Tl(Cl(e)));throw new Error("Bad input format: expected Buffer or string")}var Mo=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/gm,Oo="http://schemas.openxmlformats.org/package/2006/content-types",Fo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];var Lo=function(e){for(var s=[],t=0;t<e[0].length;++t)if(e[0][t])for(var a=0,r=e[0][t].length;a<r;a+=10240)s.push.apply(s,e[0][t].slice(a,a+10240));return s},zo=wl?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(e){return Buffer.isBuffer(e)?e:_l(e)})):Lo(e)}:Lo,Uo=function(e,s,t){for(var a=[],r=s;r<t;r+=2)a.push(String.fromCharCode(id(e,r)));return a.join("").replace(Rl,"")},Bo=wl?function(e,s,t){return Buffer.isBuffer(e)?e.toString("utf16le",s,t).replace(Rl,""):Uo(e,s,t)}:Uo,$o=function(e,s,t){for(var a=[],r=s;r<s+t;++r)a.push(("0"+e[r].toString(16)).slice(-2));return a.join("")},Ho=wl?function(e,s,t){return Buffer.isBuffer(e)?e.toString("hex",s,s+t):$o(e,s,t)}:$o,Vo=function(e,s,t){for(var a=[],r=s;r<t;r++)a.push(String.fromCharCode(nd(e,r)));return a.join("")},Go=wl?function(e,s,t){return Buffer.isBuffer(e)?e.toString("utf8",s,t):Vo(e,s,t)}:Vo,qo=function(e,s){var t=cd(e,s);return t>0?Go(e,s+4,s+4+t-1):""},Wo=qo,Yo=function(e,s){var t=cd(e,s);return t>0?Go(e,s+4,s+4+t-1):""},Ko=Yo,Jo=function(e,s){var t=2*cd(e,s);return t>0?Go(e,s+4,s+4+t-1):""},Xo=Jo,Zo=function(e,s){var t=cd(e,s);return t>0?Bo(e,s+4,s+4+t):""},Qo=Zo,ed=function(e,s){var t=cd(e,s);return t>0?Go(e,s+4,s+4+t):""},sd=ed,td=function(e,s){return function(e,s){for(var t=1-2*(e[s+7]>>>7),a=((127&e[s+7])<<4)+(e[s+6]>>>4&15),r=15&e[s+6],n=5;n>=0;--n)r=256*r+e[s+n];return 2047==a?0==r?t*(1/0):NaN:(0==a?a=-1022:(a-=1023,r+=Math.pow(2,52)),t*Math.pow(2,a-52)*r)}(e,s)},ad=td,rd=function(e){return Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array};wl&&(Wo=function(e,s){if(!Buffer.isBuffer(e))return qo(e,s);var t=e.readUInt32LE(s);return t>0?e.toString("utf8",s+4,s+4+t-1):""},Ko=function(e,s){if(!Buffer.isBuffer(e))return Yo(e,s);var t=e.readUInt32LE(s);return t>0?e.toString("utf8",s+4,s+4+t-1):""},Xo=function(e,s){if(!Buffer.isBuffer(e))return Jo(e,s);var t=2*e.readUInt32LE(s);return e.toString("utf16le",s+4,s+4+t-1)},Qo=function(e,s){if(!Buffer.isBuffer(e))return Zo(e,s);var t=e.readUInt32LE(s);return e.toString("utf16le",s+4,s+4+t)},sd=function(e,s){if(!Buffer.isBuffer(e))return ed(e,s);var t=e.readUInt32LE(s);return e.toString("utf8",s+4,s+4+t)},ad=function(e,s){return Buffer.isBuffer(e)?e.readDoubleLE(s):td(e,s)},rd=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||"undefined"!=typeof Uint8Array&&e instanceof Uint8Array});var nd=function(e,s){return e[s]},id=function(e,s){return 256*e[s+1]+e[s]},ld=function(e,s){var t=256*e[s+1]+e[s];return t<32768?t:-1*(65535-t+1)},cd=function(e,s){return e[s+3]*(1<<24)+(e[s+2]<<16)+(e[s+1]<<8)+e[s]},od=function(e,s){return e[s+3]<<24|e[s+2]<<16|e[s+1]<<8|e[s]},dd=function(e,s){return e[s]<<24|e[s+1]<<16|e[s+2]<<8|e[s+3]};function md(e,s){var t,a,r,n,i,l,c="",o=[];switch(s){case"dbcs":if(l=this.l,wl&&Buffer.isBuffer(this))c=this.slice(this.l,this.l+2*e).toString("utf16le");else for(i=0;i<e;++i)c+=String.fromCharCode(id(this,l)),l+=2;e*=2;break;case"utf8":c=Go(this,this.l,this.l+e);break;case"utf16le":e*=2,c=Bo(this,this.l,this.l+e);break;case"wstr":return md.call(this,e,"dbcs");case"lpstr-ansi":c=Wo(this,this.l),e=4+cd(this,this.l);break;case"lpstr-cp":c=Ko(this,this.l),e=4+cd(this,this.l);break;case"lpwstr":c=Xo(this,this.l),e=4+2*cd(this,this.l);break;case"lpp4":e=4+cd(this,this.l),c=Qo(this,this.l),2&e&&(e+=2);break;case"8lpp4":e=4+cd(this,this.l),c=sd(this,this.l),3&e&&(e+=4-(3&e));break;case"cstr":for(e=0,c="";0!==(r=nd(this,this.l+e++));)o.push(vl(r));c=o.join("");break;case"_wstr":for(e=0,c="";0!==(r=id(this,this.l+e));)o.push(vl(r)),e+=2;e+=2,c=o.join("");break;case"dbcs-cont":for(c="",l=this.l,i=0;i<e;++i){if(this.lens&&-1!==this.lens.indexOf(l))return r=nd(this,l),this.l=l+1,n=md.call(this,e-i,r?"dbcs-cont":"sbcs-cont"),o.join("")+n;o.push(vl(id(this,l))),l+=2}c=o.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(c="",l=this.l,i=0;i!=e;++i){if(this.lens&&-1!==this.lens.indexOf(l))return r=nd(this,l),this.l=l+1,n=md.call(this,e-i,r?"dbcs-cont":"sbcs-cont"),o.join("")+n;o.push(vl(nd(this,l))),l+=1}c=o.join("");break;default:switch(e){case 1:return t=nd(this,this.l),this.l++,t;case 2:return t=("i"===s?ld:id)(this,this.l),this.l+=2,t;case 4:case-4:return"i"!==s&&128&this[this.l+3]?(a=cd(this,this.l),this.l+=4,a):(t=(e>0?od:dd)(this,this.l),this.l+=4,t);case 8:case-8:if("f"===s)return a=8==e?ad(this,this.l):ad([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:c=Ho(this,this.l,e)}}return this.l+=e,c}var hd=function(e,s,t){e[t]=255&s,e[t+1]=s>>>8&255,e[t+2]=s>>>16&255,e[t+3]=s>>>24&255},ud=function(e,s,t){e[t]=255&s,e[t+1]=s>>8&255,e[t+2]=s>>16&255,e[t+3]=s>>24&255},xd=function(e,s,t){e[t]=255&s,e[t+1]=s>>>8&255};function pd(e,s,t){var a=0,r=0;if("dbcs"===t){for(r=0;r!=s.length;++r)xd(this,s.charCodeAt(r),this.l+2*r);a=2*s.length}else if("sbcs"===t){for(s=s.replace(/[^\x00-\x7F]/g,"_"),r=0;r!=s.length;++r)this[this.l+r]=255&s.charCodeAt(r);a=s.length}else{if("hex"===t){for(;r<e;++r)this[this.l++]=parseInt(s.slice(2*r,2*r+2),16)||0;return this}if("utf16le"===t){var n=Math.min(this.l+e,this.length);for(r=0;r<Math.min(s.length,e);++r){var i=s.charCodeAt(r);this[this.l++]=255&i,this[this.l++]=i>>8}for(;this.l<n;)this[this.l++]=0;return this}switch(e){case 1:a=1,this[this.l]=255&s;break;case 2:a=2,this[this.l]=255&s,s>>>=8,this[this.l+1]=255&s;break;case 3:a=3,this[this.l]=255&s,s>>>=8,this[this.l+1]=255&s,s>>>=8,this[this.l+2]=255&s;break;case 4:a=4,hd(this,s,this.l);break;case 8:if(a=8,"f"===t){!function(e,s,t){var a=(s<0||1/s==-1/0?1:0)<<7,r=0,n=0,i=a?-s:s;isFinite(i)?0==i?r=n=0:(r=Math.floor(Math.log(i)/Math.LN2),n=i*Math.pow(2,52-r),r<=-1023&&(!isFinite(n)||n<Math.pow(2,52))?r=-1022:(n-=Math.pow(2,52),r+=1023)):(r=2047,n=isNaN(s)?26985:0);for(var l=0;l<=5;++l,n/=256)e[t+l]=255&n;e[t+6]=(15&r)<<4|15&n,e[t+7]=r>>4|a}(this,s,this.l);break}case 16:break;case-4:a=4,ud(this,s,this.l)}}return this.l+=a,this}function fd(e,s){var t=Ho(this,this.l,e.length>>1);if(t!==e)throw new Error(s+"Expected "+e+" saw "+t);this.l+=e.length>>1}function gd(e,s){e.l=s,e.read_shift=md,e.chk=fd,e.write_shift=pd}function vd(e,s){e.l+=s}function jd(e){var s=kl(e);return gd(s,0),s}function yd(e,s,t){if(e){var a,r,n;gd(e,e.l||0);for(var i=e.length,l=0,c=0;e.l<i;){128&(l=e.read_shift(1))&&(l=(127&l)+((127&e.read_shift(1))<<7));var o=Ep[l]||Ep[65535];for(n=127&(a=e.read_shift(1)),r=1;r<4&&128&a;++r)n+=(127&(a=e.read_shift(1)))<<7*r;c=e.l+n;var d=o.f&&o.f(e,n,t);if(e.l=c,s(d,o,l))return}}}function bd(){var e=[],s=wl?256:2048,t=function(e){var s=jd(e);return gd(s,0),s},a=t(s),r=function(){a&&(a.length>a.l&&((a=a.slice(0,a.l)).l=a.length),a.length>0&&e.push(a),a=null)},n=function(e){return a&&e<a.length-a.l?a:(r(),a=t(Math.max(e+1,s)))};return{next:n,push:function(e){r(),null==(a=e).l&&(a.l=a.length),n(s)},end:function(){return r(),Al(e)},_bufs:e}}function Nd(e,s,t){var a=Bc(e);if(s.s?(a.cRel&&(a.c+=s.s.c),a.rRel&&(a.r+=s.s.r)):(a.cRel&&(a.c+=s.c),a.rRel&&(a.r+=s.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function wd(e,s,t){var a=Bc(e);return a.s=Nd(a.s,s.s,t),a.e=Nd(a.e,s.s,t),a}function _d(e,s){if(e.cRel&&e.c<0)for(e=Bc(e);e.c<0;)e.c+=s>8?16384:256;if(e.rRel&&e.r<0)for(e=Bc(e);e.r<0;)e.r+=s>8?1048576:s>5?65536:16384;var t=Rd(e);return e.cRel||null==e.cRel||(t=t.replace(/^([A-Z])/,"$$$1")),e.rRel||null==e.rRel||(t=function(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}(t)),t}function kd(e,s){return 0!=e.s.r||e.s.rRel||e.e.r!=(s.biff>=12?1048575:s.biff>=8?65536:16384)||e.e.rRel?0!=e.s.c||e.s.cRel||e.e.c!=(s.biff>=12?16383:255)||e.e.cRel?_d(e.s,s.biff)+":"+_d(e.e,s.biff):(e.s.rRel?"":"$")+Ed(e.s.r)+":"+(e.e.rRel?"":"$")+Ed(e.e.r):(e.s.cRel?"":"$")+Cd(e.s.c)+":"+(e.e.cRel?"":"$")+Cd(e.e.c)}function Sd(e){return parseInt(e.replace(/\$(\d+)$/,"$1"),10)-1}function Ed(e){return""+(e+1)}function Td(e){for(var s=e.replace(/^\$([A-Z])/,"$1"),t=0,a=0;a!==s.length;++a)t=26*t+s.charCodeAt(a)-64;return t-1}function Cd(e){if(e<0)throw new Error("invalid column "+e);var s="";for(++e;e;e=Math.floor((e-1)/26))s=String.fromCharCode((e-1)%26+65)+s;return s}function Ad(e){for(var s=0,t=0,a=0;a<e.length;++a){var r=e.charCodeAt(a);r>=48&&r<=57?s=10*s+(r-48):r>=65&&r<=90&&(t=26*t+(r-64))}return{c:t-1,r:s-1}}function Rd(e){for(var s=e.c+1,t="";s;s=(s-1)/26|0)t=String.fromCharCode((s-1)%26+65)+t;return t+(e.r+1)}function Id(e){var s=e.indexOf(":");return-1==s?{s:Ad(e),e:Ad(e)}:{s:Ad(e.slice(0,s)),e:Ad(e.slice(s+1))}}function Pd(e,s){return void 0===s||"number"==typeof s?Pd(e.s,e.e):("string"!=typeof e&&(e=Rd(e)),"string"!=typeof s&&(s=Rd(s)),e==s?e:e+":"+s)}function Dd(e){var s={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,r=0,n=e.length;for(t=0;a<n&&!((r=e.charCodeAt(a)-64)<1||r>26);++a)t=26*t+r;for(s.s.c=--t,t=0;a<n&&!((r=e.charCodeAt(a)-48)<0||r>9);++a)t=10*t+r;if(s.s.r=--t,a===n||10!=r)return s.e.c=s.s.c,s.e.r=s.s.r,s;for(++a,t=0;a!=n&&!((r=e.charCodeAt(a)-64)<1||r>26);++a)t=26*t+r;for(s.e.c=--t,t=0;a!=n&&!((r=e.charCodeAt(a)-48)<0||r>9);++a)t=10*t+r;return s.e.r=--t,s}function Md(e,s){var t="d"==e.t&&s instanceof Date;if(null!=e.z)try{return e.w=yc(e.z,t?Ac(s):s)}catch(a){}try{return e.w=yc((e.XF||{}).numFmtId||(t?14:0),t?Ac(s):s)}catch(a){return""+s}}function Od(e,s,t){return null==e||null==e.t||"z"==e.t?"":void 0!==e.w?e.w:("d"==e.t&&!e.z&&t&&t.dateNF&&(e.z=t.dateNF),"e"==e.t?om[e.v]||e.v:Md(e,null==s?e.v:s))}function Fd(e,s){var t=s&&s.sheet?s.sheet:"Sheet1",a={};return a[t]=e,{SheetNames:[t],Sheets:a}}function Ld(e,s,t){var a=t||{},r=e?Array.isArray(e):a.dense,n=e||(r?[]:{}),i=0,l=0;if(n&&null!=a.origin){if("number"==typeof a.origin)i=a.origin;else{var c="string"==typeof a.origin?Ad(a.origin):a.origin;i=c.r,l=c.c}n["!ref"]||(n["!ref"]="A1:A1")}var o={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(n["!ref"]){var d=Dd(n["!ref"]);o.s.c=d.s.c,o.s.r=d.s.r,o.e.c=Math.max(o.e.c,d.e.c),o.e.r=Math.max(o.e.r,d.e.r),-1==i&&(o.e.r=i=d.e.r+1)}for(var m=0;m!=s.length;++m)if(s[m]){if(!Array.isArray(s[m]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=s[m].length;++h)if(void 0!==s[m][h]){var u={v:s[m][h]},x=i+m,p=l+h;if(o.s.r>x&&(o.s.r=x),o.s.c>p&&(o.s.c=p),o.e.r<x&&(o.e.r=x),o.e.c<p&&(o.e.c=p),!s[m][h]||"object"!=typeof s[m][h]||Array.isArray(s[m][h])||s[m][h]instanceof Date)if(Array.isArray(u.v)&&(u.f=s[m][h][1],u.v=u.v[0]),null===u.v)if(u.f)u.t="n";else if(a.nullError)u.t="e",u.v=0;else{if(!a.sheetStubs)continue;u.t="z"}else"number"==typeof u.v?u.t="n":"boolean"==typeof u.v?u.t="b":u.v instanceof Date?(u.z=a.dateNF||$l[14],a.cellDates?(u.t="d",u.w=yc(u.z,Ac(u.v))):(u.t="n",u.v=Ac(u.v),u.w=yc(u.z,u.v))):u.t="s";else u=s[m][h];if(r)n[x]||(n[x]=[]),n[x][p]&&n[x][p].z&&(u.z=n[x][p].z),n[x][p]=u;else{var f=Rd({c:p,r:x});n[f]&&n[f].z&&(u.z=n[f].z),n[f]=u}}}return o.s.c<1e7&&(n["!ref"]=Pd(o)),n}function zd(e,s){return Ld(null,e,s)}function Ud(e){var s=e.read_shift(4);return 0===s?"":e.read_shift(s,"dbcs")}function Bd(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function $d(e,s){var t=e.l,a=e.read_shift(1),r=Ud(e),n=[],i={t:r,h:r};if(1&a){for(var l=e.read_shift(4),c=0;c!=l;++c)n.push(Bd(e));i.r=n}else i.r=[{ich:0,ifnt:0}];return e.l=t+s,i}var Hd=$d;function Vd(e){var s=e.read_shift(4),t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:s,iStyleRef:t}}function Gd(e){var s=e.read_shift(2);return s+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:s}}var qd=Ud;function Wd(e){var s=e.read_shift(4);return 0===s||4294967295===s?"":e.read_shift(s,"dbcs")}var Yd=Ud,Kd=Wd;function Jd(e){var s=e.slice(e.l,e.l+4),t=1&s[0],a=2&s[0];e.l+=4;var r=0===a?ad([0,0,0,0,252&s[0],s[1],s[2],s[3]],0):od(s,0)>>2;return t?r/100:r}function Xd(e){var s={s:{},e:{}};return s.s.r=e.read_shift(4),s.e.r=e.read_shift(4),s.s.c=e.read_shift(4),s.e.c=e.read_shift(4),s}var Zd=Xd;function Qd(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function em(e,s){var t=e.read_shift(4);switch(t){case 0:return"";case 4294967295:case 4294967294:return{2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"}[e.read_shift(4)]||""}if(t>400)throw new Error("Unsupported Clipboard: "+t.toString(16));return e.l-=4,e.read_shift(0,1==s?"lpstr":"lpwstr")}var sm=80,tm=[sm,81],am={1:{n:"CodePage",t:2},2:{n:"Category",t:sm},3:{n:"PresentationFormat",t:sm},4:{n:"ByteCount",t:3},5:{n:"LineCount",t:3},6:{n:"ParagraphCount",t:3},7:{n:"SlideCount",t:3},8:{n:"NoteCount",t:3},9:{n:"HiddenCount",t:3},10:{n:"MultimediaClipCount",t:3},11:{n:"ScaleCrop",t:11},12:{n:"HeadingPairs",t:4108},13:{n:"TitlesOfParts",t:4126},14:{n:"Manager",t:sm},15:{n:"Company",t:sm},16:{n:"LinksUpToDate",t:11},17:{n:"CharacterCount",t:3},19:{n:"SharedDoc",t:11},22:{n:"HyperlinksChanged",t:11},23:{n:"AppVersion",t:3,p:"version"},24:{n:"DigSig",t:65},26:{n:"ContentType",t:sm},27:{n:"ContentStatus",t:sm},28:{n:"Language",t:sm},29:{n:"Version",t:sm},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},rm={1:{n:"CodePage",t:2},2:{n:"Title",t:sm},3:{n:"Subject",t:sm},4:{n:"Author",t:sm},5:{n:"Keywords",t:sm},6:{n:"Comments",t:sm},7:{n:"Template",t:sm},8:{n:"LastAuthor",t:sm},9:{n:"RevNumber",t:sm},10:{n:"EditTime",t:64},11:{n:"LastPrinted",t:64},12:{n:"CreatedDate",t:64},13:{n:"ModifiedDate",t:64},14:{n:"PageCount",t:3},15:{n:"WordCount",t:3},16:{n:"CharCount",t:3},17:{n:"Thumbnail",t:71},18:{n:"Application",t:sm},19:{n:"DocSecurity",t:3},255:{},2147483648:{n:"Locale",t:19},2147483651:{n:"Behavior",t:19},1919054434:{}},nm={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},im=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function lm(e){return e.map(function(e){return[e>>16&255,e>>8&255,255&e]})}var cm=Bc(lm([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0])),om={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},dm={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},mm={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};var hm={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function um(e){var s=e.lastIndexOf("/");return e.slice(0,s+1)+"_rels/"+e.slice(s+1)+".rels"}function xm(e,s){var t={"!id":{}};if(!e)return t;"/"!==s.charAt(0)&&(s="/"+s);var a={};return(e.match(io)||[]).forEach(function(e){var r=oo(e);if("<Relationship"===r[0]){var n={};n.Type=r.Type,n.Target=r.Target,n.Id=r.Id,r.TargetMode&&(n.TargetMode=r.TargetMode);var i="External"===r.TargetMode?r.Target:to(r.Target,s);t[i]=n,a[r.Id]=n}}),t["!id"]=a,t}var pm=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],fm=function(){for(var e=new Array(pm.length),s=0;s<pm.length;++s){var t=pm[s],a="(?:"+t[0].slice(0,t[0].indexOf(":"))+":)"+t[0].slice(t[0].indexOf(":")+1);e[s]=new RegExp("<"+a+"[^>]*>([\\s\\S]*?)</"+a+">")}return e}();function gm(e){var s={};e=_o(e);for(var t=0;t<pm.length;++t){var a=pm[t],r=e.match(fm[t]);null!=r&&r.length>0&&(s[a[1]]=xo(r[1])),"date"===a[2]&&s[a[1]]&&(s[a[1]]=zc(s[a[1]]))}return s}var vm=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function jm(e,s,t,a){var r=[];if("string"==typeof e)r=Ro(e,a);else for(var n=0;n<e.length;++n)r=r.concat(e[n].map(function(e){return{v:e}}));var i="string"==typeof s?Ro(s,a).map(function(e){return e.v}):s,l=0,c=0;if(i.length>0)for(var o=0;o!==r.length;o+=2){switch(c=+r[o+1].v,r[o].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":t.Worksheets=c,t.SheetNames=i.slice(l,l+c);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":t.NamedRanges=c,t.DefinedNames=i.slice(l,l+c);break;case"Charts":case"Diagramme":t.Chartsheets=c,t.ChartNames=i.slice(l,l+c)}l+=c}}var ym=/<[^>]+>[^<]*/g;var bm,Nm={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function wm(e,s,t){bm||(bm=Tc(Nm)),e[s=bm[s]||s]=t}function _m(e){var s=e.read_shift(4),t=e.read_shift(4);return new Date(1e3*(t/1e7*Math.pow(2,32)+s/1e7-11644473600)).toISOString().replace(/\.000/,"")}function km(e,s,t){var a=e.l,r=e.read_shift(0,"lpstr-cp");if(t)for(;e.l-a&3;)++e.l;return r}function Sm(e,s,t){return e.read_shift(0,"lpwstr")}function Em(e,s,t){return 31===s?Sm(e):km(e,0,t)}function Tm(e,s,t){return Em(e,s,!1===t?0:4)}function Cm(e){var s=e.l,t=Im(e,81);return 0==e[e.l]&&0==e[e.l+1]&&e.l-s&2&&(e.l+=2),[t,Im(e,3)]}function Am(e,s){for(var t=e.read_shift(4),a={},r=0;r!=t;++r){var n=e.read_shift(4),i=e.read_shift(4);a[n]=e.read_shift(i,1200===s?"utf16le":"utf8").replace(Rl,"").replace(Il,"!"),1200===s&&i%2&&(e.l+=2)}return 3&e.l&&(e.l=e.l>>3<<2),a}function Rm(e){var s=e.read_shift(4),t=e.slice(e.l,e.l+s);return e.l+=s,(3&s)>0&&(e.l+=4-(3&s)&3),t}function Im(e,s,t){var a,r=e.read_shift(2),n=t||{};if(e.l+=2,12!==s&&r!==s&&-1===tm.indexOf(s)&&(4126!=(65534&s)||4126!=(65534&r)))throw new Error("Expected type "+s+" saw "+r);switch(12===s?r:s){case 2:return a=e.read_shift(2,"i"),n.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i");case 11:return 0!==e.read_shift(4);case 19:return a=e.read_shift(4);case 30:return km(e,0,4).replace(Rl,"");case 31:return Sm(e);case 64:return _m(e);case 65:return Rm(e);case 71:return function(e){var s={};return s.Size=e.read_shift(4),e.l+=s.Size+3-(s.Size-1)%4,s}(e);case 80:return Tm(e,r,!n.raw).replace(Rl,"");case 81:return function(e,s){if(!s)throw new Error("VtUnalignedString must have positive length");return Em(e,s,0)}(e,r).replace(Rl,"");case 4108:return function(e){for(var s=e.read_shift(4),t=[],a=0;a<s/2;++a)t.push(Cm(e));return t}(e);case 4126:case 4127:return 4127==r?function(e){for(var s=e.read_shift(4),t=[],a=0;a!=s;++a){var r=e.l;t[a]=e.read_shift(0,"lpwstr").replace(Rl,""),e.l-r&2&&(e.l+=2)}return t}(e):function(e){for(var s=e.read_shift(4),t=[],a=0;a!=s;++a)t[a]=e.read_shift(0,"lpstr-cp").replace(Rl,"");return t}(e);default:throw new Error("TypedPropertyValue unrecognized type "+s+" "+r)}}function Pm(e,s){var t=e.l,a=e.read_shift(4),r=e.read_shift(4),n=[],i=0,l=0,c=-1,o={};for(i=0;i!=r;++i){var d=e.read_shift(4),m=e.read_shift(4);n[i]=[d,m+t]}n.sort(function(e,s){return e[1]-s[1]});var h={};for(i=0;i!=r;++i){if(e.l!==n[i][1]){var u=!0;if(i>0&&s)switch(s[n[i-1][0]].t){case 2:e.l+2===n[i][1]&&(e.l+=2,u=!1);break;case 80:case 4108:e.l<=n[i][1]&&(e.l=n[i][1],u=!1)}if((!s||0==i)&&e.l<=n[i][1]&&(u=!1,e.l=n[i][1]),u)throw new Error("Read Error: Expected address "+n[i][1]+" at "+e.l+" :"+i)}if(s){var x=s[n[i][0]];if(h[x.n]=Im(e,x.t,{raw:!0}),"version"===x.p&&(h[x.n]=String(h[x.n]>>16)+"."+("0000"+String(65535&h[x.n])).slice(-4)),"CodePage"==x.n)switch(h[x.n]){case 0:h[x.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:hl(l=h[x.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[x.n])}}else if(1===n[i][0]){if(l=h.CodePage=Im(e,2),hl(l),-1!==c){var p=e.l;e.l=n[c][1],o=Am(e,l),e.l=p}}else if(0===n[i][0]){if(0===l){c=i,e.l=n[i+1][1];continue}o=Am(e,l)}else{var f,g=o[n[i][0]];switch(e[e.l]){case 65:e.l+=4,f=Rm(e);break;case 30:case 31:e.l+=4,f=Tm(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,f=e.read_shift(4,"i");break;case 19:e.l+=4,f=e.read_shift(4);break;case 5:e.l+=4,f=e.read_shift(8,"f");break;case 11:e.l+=4,f=Om(e,4);break;case 64:e.l+=4,f=zc(_m(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[g]=f}}return e.l=t+a,h}function Dm(e,s,t){var a=e.content;if(!a)return{};gd(a,0);var r,n,i,l,c=0;a.chk("feff","Byte Order: "),a.read_shift(2);var o=a.read_shift(4),d=a.read_shift(16);if(d!==Sc.utils.consts.HEADER_CLSID&&d!==t)throw new Error("Bad PropertySet CLSID "+d);if(1!==(r=a.read_shift(4))&&2!==r)throw new Error("Unrecognized #Sets: "+r);if(n=a.read_shift(16),l=a.read_shift(4),1===r&&l!==a.l)throw new Error("Length mismatch: "+l+" !== "+a.l);2===r&&(i=a.read_shift(16),c=a.read_shift(4));var m,h=Pm(a,s),u={SystemIdentifier:o};for(var x in h)u[x]=h[x];if(u.FMTID=n,1===r)return u;if(c-a.l==2&&(a.l+=2),a.l!==c)throw new Error("Length mismatch 2: "+a.l+" !== "+c);try{m=Pm(a,null)}catch(p){}for(x in m)u[x]=m[x];return u.FMTID=[n,i],u}function Mm(e,s){return e.read_shift(s),null}function Om(e,s){return 1===e.read_shift(s)}function Fm(e){return e.read_shift(2,"u")}function Lm(e,s){return function(e,s,t){for(var a=[],r=e.l+s;e.l<r;)a.push(t(e,r-e.l));if(r!==e.l)throw new Error("Slurp error");return a}(e,s,Fm)}function zm(e,s,t){var a=e.read_shift(t&&t.biff>=12?2:1),r="sbcs-cont";(t&&t.biff,t&&8!=t.biff)?12==t.biff&&(r="wstr"):e.read_shift(1)&&(r="dbcs-cont");return t.biff>=2&&t.biff<=5&&(r="cpstr"),a?e.read_shift(a,r):""}function Um(e){var s,t=e.read_shift(2),a=e.read_shift(1),r=4&a,n=8&a,i=1+(1&a),l=0,c={};n&&(l=e.read_shift(2)),r&&(s=e.read_shift(4));var o=2==i?"dbcs-cont":"sbcs-cont",d=0===t?"":e.read_shift(t,o);return n&&(e.l+=4*l),r&&(e.l+=s),c.t=d,n||(c.raw="<t>"+c.t+"</t>",c.r=c.t),c}function Bm(e,s,t){if(t){if(t.biff>=2&&t.biff<=5)return e.read_shift(s,"cpstr");if(t.biff>=12)return e.read_shift(s,"dbcs-cont")}return 0===e.read_shift(1)?e.read_shift(s,"sbcs-cont"):e.read_shift(s,"dbcs-cont")}function $m(e,s,t){var a=e.read_shift(t&&2==t.biff?1:2);return 0===a?(e.l++,""):Bm(e,a,t)}function Hm(e,s,t){if(t.biff>5)return $m(e,0,t);var a=e.read_shift(1);return 0===a?(e.l++,""):e.read_shift(a,t.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function Vm(e,s){var t=e.read_shift(16);switch(t){case"e0c9ea79f9bace118c8200aa004ba90b":return function(e){var s=e.read_shift(4),t=e.l,a=!1;s>24&&(e.l+=s-24,"795881f43b1d7f48af2c825dc4852763"===e.read_shift(16)&&(a=!0),e.l=t);var r=e.read_shift((a?s-24:s)>>1,"utf16le").replace(Rl,"");return a&&(e.l+=24),r}(e);case"0303000000000000c000000000000046":return function(e){for(var s=e.read_shift(2),t="";s-- >0;)t+="../";var a=e.read_shift(0,"lpstr-ansi");if(e.l+=2,57005!=e.read_shift(2))throw new Error("Bad FileMoniker");if(0===e.read_shift(4))return t+a.replace(/\\/g,"/");var r=e.read_shift(4);if(3!=e.read_shift(2))throw new Error("Bad FileMoniker");return t+e.read_shift(r>>1,"utf16le").replace(Rl,"")}(e);default:throw new Error("Unsupported Moniker "+t)}}function Gm(e){var s=e.read_shift(4);return s>0?e.read_shift(s,"utf16le").replace(Rl,""):""}function qm(e){return[e.read_shift(1),e.read_shift(1),e.read_shift(1),e.read_shift(1)]}function Wm(e,s){var t=qm(e);return t[3]=0,t}function Ym(e){return{r:e.read_shift(2),c:e.read_shift(2),ixfe:e.read_shift(2)}}function Km(e,s,t){var a=t.biff>8?4:2;return[e.read_shift(a),e.read_shift(a,"i"),e.read_shift(a,"i")]}function Jm(e){return[e.read_shift(2),Jd(e)]}function Xm(e){var s=e.read_shift(2),t=e.read_shift(2);return{s:{c:e.read_shift(2),r:s},e:{c:e.read_shift(2),r:t}}}function Zm(e){var s=e.read_shift(2),t=e.read_shift(2);return{s:{c:e.read_shift(1),r:s},e:{c:e.read_shift(1),r:t}}}var Qm=Zm;function eh(e){e.l+=4;var s=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(2);return e.l+=12,[t,s,a]}function sh(e){e.l+=2,e.l+=e.read_shift(2)}var th={0:sh,4:sh,5:sh,6:sh,7:function(e){return e.l+=4,e.cf=e.read_shift(2),{}},8:sh,9:sh,10:sh,11:sh,12:sh,13:function(e){var s={};return e.l+=4,e.l+=16,s.fSharedNote=e.read_shift(2),e.l+=4,s},14:sh,15:sh,16:sh,17:sh,18:sh,19:sh,20:sh,21:eh};function ah(e,s){var t={BIFFVer:0,dt:0};switch(t.BIFFVer=e.read_shift(2),(s-=2)>=2&&(t.dt=e.read_shift(2),e.l-=2),t.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(s>6)throw new Error("Unexpected BIFF Ver "+t.BIFFVer)}return e.read_shift(s),t}function rh(e,s,t){var a=0;t&&2==t.biff||(a=e.read_shift(2));var r=e.read_shift(2);return t&&2==t.biff&&(a=1-(r>>15),r&=32767),[{Unsynced:1&a,DyZero:(2&a)>>1,ExAsc:(4&a)>>2,ExDsc:(8&a)>>3},r]}var nh=Hm;function ih(e,s,t){var a=e.l+s,r=8!=t.biff&&t.biff?2:4,n=e.read_shift(r),i=e.read_shift(r),l=e.read_shift(2),c=e.read_shift(2);return e.l=a,{s:{r:n,c:l},e:{r:i,c:c}}}function lh(e,s,t){var a=Ym(e);2!=t.biff&&9!=s||++e.l;var r=function(e){var s=e.read_shift(1);return 1===e.read_shift(1)?s:1===s}(e);return a.val=r,a.t=!0===r||!1===r?"b":"e",a}var ch=function(e,s,t){return 0===s?"":Hm(e,0,t)};function oh(e,s,t){var a,r=e.read_shift(2),n={fBuiltIn:1&r,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return 14849===t.sbcch&&(a=function(e,s,t){e.l+=4,s-=4;var a=e.l+s,r=zm(e,0,t),n=e.read_shift(2);if(n!==(a-=e.l))throw new Error("Malformed AddinUdf: padding = "+a+" != "+n);return e.l+=n,r}(e,s-2,t)),n.body=a||e.read_shift(s-2),"string"==typeof a&&(n.Name=a),n}var dh=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function mh(e,s,t){var a=e.l+s,r=e.read_shift(2),n=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(t&&2==t.biff?1:2),c=0;(!t||t.biff>=5)&&(5!=t.biff&&(e.l+=2),c=e.read_shift(2),5==t.biff&&(e.l+=2),e.l+=4);var o=Bm(e,i,t);32&r&&(o=dh[o.charCodeAt(0)]);var d=a-e.l;t&&2==t.biff&&--d;var m=a!=e.l&&0!==l&&d>0?function(e,s,t,a){var r,n=e.l+s,i=Qu(e,a,t);n!==e.l&&(r=Zu(e,n-e.l,i,t));return[i,r]}(e,d,t,l):[];return{chKey:n,Name:o,itab:c,rgce:m}}function hh(e,s,t){if(t.biff<8)return function(e,s,t){3==e[e.l+1]&&e[e.l]++;var a=zm(e,0,t);return 3==a.charCodeAt(0)?a.slice(1):a}(e,0,t);for(var a=[],r=e.l+s,n=e.read_shift(t.biff>8?4:2);0!==n--;)a.push(Km(e,t.biff,t));if(e.l!=r)throw new Error("Bad ExternSheet: "+e.l+" != "+r);return a}function uh(e,s,t){var a=Qm(e);switch(t.biff){case 2:e.l++,s-=7;break;case 3:case 4:e.l+=2,s-=8;break;default:e.l+=6,s-=12}return[a,nx(e,s,t)]}var xh={8:function(e,s){var t=e.l+s;e.l+=10;var a=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var r=e.read_shift(1);return e.l+=r,e.l=t,{fmt:a}}};function ph(e,s,t){if(!t.cellStyles)return vd(e,s);var a=t&&t.biff>=12?4:2,r=e.read_shift(a),n=e.read_shift(a),i=e.read_shift(a),l=e.read_shift(a),c=e.read_shift(2);2==a&&(e.l+=2);var o={s:r,e:n,w:i,ixfe:l,flags:c};return(t.biff>=5||!t.biff)&&(o.level=c>>8&7),o}var fh=Ym,gh=Lm,vh=$m;var jh=[2,3,48,49,131,139,140,245],yh=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},s=Tc({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(s,t){var a=t||{};a.dateNF||(a.dateNF="yyyymmdd");var r=zd(function(s,t){var a=[],r=kl(1);switch(t.type){case"base64":r=El(Nl(s));break;case"binary":r=El(s);break;case"buffer":case"array":r=s}gd(r,0);var n=r.read_shift(1),i=!!(136&n),l=!1,c=!1;switch(n){case 2:case 3:case 131:case 139:case 245:break;case 48:case 49:l=!0,i=!0;break;case 140:c=!0;break;default:throw new Error("DBF Unsupported Version: "+n.toString(16))}var o=0,d=521;2==n&&(o=r.read_shift(2)),r.l+=3,2!=n&&(o=r.read_shift(4)),o>1048576&&(o=1e6),2!=n&&(d=r.read_shift(2));var m=r.read_shift(2),h=t.codepage||1252;2!=n&&(r.l+=16,r.read_shift(1),0!==r[r.l]&&(h=e[r[r.l]]),r.l+=1,r.l+=2),c&&(r.l+=36);for(var u=[],x={},p=Math.min(r.length,2==n?521:d-10-(l?264:0)),f=c?32:11;r.l<p&&13!=r[r.l];)switch((x={}).name=fl.utils.decode(h,r.slice(r.l,r.l+f)).replace(/[\u0000\r\n].*$/g,""),r.l+=f,x.type=String.fromCharCode(r.read_shift(1)),2==n||c||(x.offset=r.read_shift(4)),x.len=r.read_shift(1),2==n&&(x.offset=r.read_shift(2)),x.dec=r.read_shift(1),x.name.length&&u.push(x),2!=n&&(r.l+=c?13:14),x.type){case"B":(!l||8!=x.len)&&t.WTF;break;case"G":case"P":t.WTF;break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+x.type)}if(13!==r[r.l]&&(r.l=d-1),13!==r.read_shift(1))throw new Error("DBF Terminator not found "+r.l+" "+r[r.l]);r.l=d;var g=0,v=0;for(a[0]=[],v=0;v!=u.length;++v)a[0][v]=u[v].name;for(;o-- >0;)if(42!==r[r.l])for(++r.l,a[++g]=[],v=0,v=0;v!=u.length;++v){var j=r.slice(r.l,r.l+u[v].len);r.l+=u[v].len,gd(j,0);var y=fl.utils.decode(h,j);switch(u[v].type){case"C":y.trim().length&&(a[g][v]=y.replace(/\s+$/,""));break;case"D":8===y.length?a[g][v]=new Date(+y.slice(0,4),+y.slice(4,6)-1,+y.slice(6,8)):a[g][v]=y;break;case"F":a[g][v]=parseFloat(y.trim());break;case"+":case"I":a[g][v]=c?2147483648^j.read_shift(-4,"i"):j.read_shift(4,"i");break;case"L":switch(y.trim().toUpperCase()){case"Y":case"T":a[g][v]=!0;break;case"N":case"F":a[g][v]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+y+"|")}break;case"M":if(!i)throw new Error("DBF Unexpected MEMO for type "+n.toString(16));a[g][v]="##MEMO##"+(c?parseInt(y.trim(),10):j.read_shift(4));break;case"N":(y=y.replace(/\u0000/g,"").trim())&&"."!=y&&(a[g][v]=+y||0);break;case"@":a[g][v]=new Date(j.read_shift(-8,"f")-621356832e5);break;case"T":a[g][v]=new Date(864e5*(j.read_shift(4)-2440588)+j.read_shift(4));break;case"Y":a[g][v]=j.read_shift(4,"i")/1e4+j.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":a[g][v]=-j.read_shift(-8,"f");break;case"B":if(l&&8==u[v].len){a[g][v]=j.read_shift(8,"f");break}case"G":case"P":j.l+=u[v].len;break;case"0":if("_NullFlags"===u[v].name)break;default:throw new Error("DBF Unsupported data type "+u[v].type)}}else r.l+=m;if(2!=n&&r.l<r.length&&26!=r[r.l++])throw new Error("DBF EOF Marker missing "+(r.l-1)+" of "+r.length+" "+r[r.l-1].toString(16));return t&&t.sheetRows&&(a=a.slice(0,t.sheetRows)),t.DBF=u,a}(s,a),a);return r["!cols"]=a.DBF.map(function(e){return{wch:e.len,DBF:e}}),delete a.DBF,r}var a={B:8,C:250,L:1,D:8,"?":0,"":0};return{to_workbook:function(e,s){try{return Fd(t(e,s),s)}catch(a){if(s&&s.WTF)throw a}return{SheetNames:[],Sheets:{}}},to_sheet:t,from_sheet:function(e,t){var r=t||{};if(+r.codepage>=0&&hl(+r.codepage),"string"==r.type)throw new Error("Cannot write DBF to JS string");var n=bd(),i=xf(e,{header:1,raw:!0,cellDates:!0}),l=i[0],c=i.slice(1),o=e["!cols"]||[],d=0,m=0,h=0,u=1;for(d=0;d<l.length;++d)if(((o[d]||{}).DBF||{}).name)l[d]=o[d].DBF.name,++h;else if(null!=l[d]){if(++h,"number"==typeof l[d]&&(l[d]=l[d].toString(10)),"string"!=typeof l[d])throw new Error("DBF Invalid column name "+l[d]+" |"+typeof l[d]+"|");if(l.indexOf(l[d])!==d)for(m=0;m<1024;++m)if(-1==l.indexOf(l[d]+"_"+m)){l[d]+="_"+m;break}}var x=Dd(e["!ref"]),p=[],f=[],g=[];for(d=0;d<=x.e.c-x.s.c;++d){var v="",j="",y=0,b=[];for(m=0;m<c.length;++m)null!=c[m][d]&&b.push(c[m][d]);if(0!=b.length&&null!=l[d]){for(m=0;m<b.length;++m){switch(typeof b[m]){case"number":j="B";break;case"string":default:j="C";break;case"boolean":j="L";break;case"object":j=b[m]instanceof Date?"D":"C"}y=Math.max(y,String(b[m]).length),v=v&&v!=j?"C":j}y>250&&(y=250),"C"==(j=((o[d]||{}).DBF||{}).type)&&o[d].DBF.len>y&&(y=o[d].DBF.len),"B"==v&&"N"==j&&(v="N",g[d]=o[d].DBF.dec,y=o[d].DBF.len),f[d]="C"==v||"N"==j?y:a[v]||0,u+=f[d],p[d]=v}else p[d]="?"}var N=n.next(32);for(N.write_shift(4,318902576),N.write_shift(4,c.length),N.write_shift(2,296+32*h),N.write_shift(2,u),d=0;d<4;++d)N.write_shift(4,0);for(N.write_shift(4,(+s[cl]||3)<<8),d=0,m=0;d<l.length;++d)if(null!=l[d]){var w=n.next(32),_=(l[d].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);w.write_shift(1,_,"sbcs"),w.write_shift(1,"?"==p[d]?"C":p[d],"sbcs"),w.write_shift(4,m),w.write_shift(1,f[d]||a[p[d]]||0),w.write_shift(1,g[d]||0),w.write_shift(1,2),w.write_shift(4,0),w.write_shift(1,0),w.write_shift(4,0),w.write_shift(4,0),m+=f[d]||a[p[d]]||0}var k=n.next(264);for(k.write_shift(4,13),d=0;d<65;++d)k.write_shift(4,0);for(d=0;d<c.length;++d){var S=n.next(u);for(S.write_shift(1,0),m=0;m<l.length;++m)if(null!=l[m])switch(p[m]){case"L":S.write_shift(1,null==c[d][m]?63:c[d][m]?84:70);break;case"B":S.write_shift(8,c[d][m]||0,"f");break;case"N":var E="0";for("number"==typeof c[d][m]&&(E=c[d][m].toFixed(g[m]||0)),h=0;h<f[m]-E.length;++h)S.write_shift(1,32);S.write_shift(1,E,"sbcs");break;case"D":c[d][m]?(S.write_shift(4,("0000"+c[d][m].getFullYear()).slice(-4),"sbcs"),S.write_shift(2,("00"+(c[d][m].getMonth()+1)).slice(-2),"sbcs"),S.write_shift(2,("00"+c[d][m].getDate()).slice(-2),"sbcs")):S.write_shift(8,"00000000","sbcs");break;case"C":var T=String(null!=c[d][m]?c[d][m]:"").slice(0,f[m]);for(S.write_shift(1,T,"sbcs"),h=0;h<f[m]-T.length;++h)S.write_shift(1,32)}}return n.next(1).write_shift(1,26),n.end()}}}(),bh=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},s=new RegExp("N("+Ec(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(s,t){var a=e[t];return"number"==typeof a?jl(a):a},a=function(e,s,t){var a=s.charCodeAt(0)-32<<4|t.charCodeAt(0)-48;return 59==a?e:jl(a)};function r(e,r){var n,i=e.split(/[\n\r]+/),l=-1,c=-1,o=0,d=0,m=[],h=[],u=null,x={},p=[],f=[],g=[],v=0;for(+r.codepage>=0&&hl(+r.codepage);o!==i.length;++o){v=0;var j,y=i[o].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(s,t),b=y.replace(/;;/g,"\0").split(";").map(function(e){return e.replace(/\u0000/g,";")}),N=b[0];if(y.length>0)switch(N){case"ID":case"E":case"B":case"O":case"W":break;case"P":"P"==b[1].charAt(0)&&h.push(y.slice(3).replace(/;;/g,";"));break;case"C":var w=!1,_=!1,k=!1,S=!1,E=-1,T=-1;for(d=1;d<b.length;++d)switch(b[d].charAt(0)){case"A":case"G":break;case"X":c=parseInt(b[d].slice(1))-1,_=!0;break;case"Y":for(l=parseInt(b[d].slice(1))-1,_||(c=0),n=m.length;n<=l;++n)m[n]=[];break;case"K":'"'===(j=b[d].slice(1)).charAt(0)?j=j.slice(1,j.length-1):"TRUE"===j?j=!0:"FALSE"===j?j=!1:isNaN(Hc(j))?isNaN(Gc(j).getDate())||(j=zc(j)):(j=Hc(j),null!==u&&fc(u)&&(j=Dc(j))),w=!0;break;case"E":S=!0;var C=Eu(b[d].slice(1),{r:l,c:c});m[l][c]=[m[l][c],C];break;case"S":k=!0,m[l][c]=[m[l][c],"S5S"];break;case"R":E=parseInt(b[d].slice(1))-1;break;case"C":T=parseInt(b[d].slice(1))-1;break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+y)}if(w&&(m[l][c]&&2==m[l][c].length?m[l][c][0]=j:m[l][c]=j,u=null),k){if(S)throw new Error("SYLK shared formula cannot have own formula");var A=E>-1&&m[E][T];if(!A||!A[1])throw new Error("SYLK shared formula cannot find base");m[l][c][1]=Au(A[1],{r:l-E,c:c-T})}break;case"F":var R=0;for(d=1;d<b.length;++d)switch(b[d].charAt(0)){case"X":c=parseInt(b[d].slice(1))-1,++R;break;case"Y":for(l=parseInt(b[d].slice(1))-1,n=m.length;n<=l;++n)m[n]=[];break;case"M":v=parseInt(b[d].slice(1))/20;break;case"F":case"G":case"S":case"D":case"N":break;case"P":u=h[parseInt(b[d].slice(1))];break;case"W":for(g=b[d].slice(1).split(" "),n=parseInt(g[0],10);n<=parseInt(g[1],10);++n)v=parseInt(g[2],10),f[n-1]=0===v?{hidden:!0}:{wch:v},au(f[n-1]);break;case"C":f[c=parseInt(b[d].slice(1))-1]||(f[c]={});break;case"R":p[l=parseInt(b[d].slice(1))-1]||(p[l]={}),v>0?(p[l].hpt=v,p[l].hpx=iu(v)):0===v&&(p[l].hidden=!0);break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+y)}R<1&&(u=null);break;default:if(r&&r.WTF)throw new Error("SYLK bad record "+y)}}return p.length>0&&(x["!rows"]=p),f.length>0&&(x["!cols"]=f),r&&r.sheetRows&&(m=m.slice(0,r.sheetRows)),[m,x]}function n(e,s){var t=function(e,s){switch(s.type){case"base64":return r(Nl(e),s);case"binary":return r(e,s);case"buffer":return r(wl&&Buffer.isBuffer(e)?e.toString("binary"):Tl(e),s);case"array":return r(Uc(e),s)}throw new Error("Unrecognized type "+s.type)}(e,s),a=t[0],n=t[1],i=zd(a,s);return Ec(n).forEach(function(e){i[e]=n[e]}),i}function i(e,s,t,a){var r="C;Y"+(t+1)+";X"+(a+1)+";K";switch(e.t){case"n":r+=e.v||0,e.f&&!e.F&&(r+=";E"+Cu(e.f,{r:t,c:a}));break;case"b":r+=e.v?"TRUE":"FALSE";break;case"e":r+=e.w||e.v;break;case"d":r+='"'+(e.w||e.v)+'"';break;case"s":r+='"'+e.v.replace(/"/g,"").replace(/;/g,";;")+'"'}return r}return e["|"]=254,{to_workbook:function(e,s){return Fd(n(e,s),s)},to_sheet:n,from_sheet:function(e,s){var t,a,r=["ID;PWXL;N;E"],n=[],l=Dd(e["!ref"]),c=Array.isArray(e),o="\r\n";r.push("P;PGeneral"),r.push("F;P0;DG0G8;M255"),e["!cols"]&&(a=r,e["!cols"].forEach(function(e,s){var t="F;W"+(s+1)+" "+(s+1)+" ";e.hidden?t+="0":("number"!=typeof e.width||e.wpx||(e.wpx=Zh(e.width)),"number"!=typeof e.wpx||e.wch||(e.wch=Qh(e.wpx)),"number"==typeof e.wch&&(t+=Math.round(e.wch)))," "!=t.charAt(t.length-1)&&a.push(t)})),e["!rows"]&&function(e,s){s.forEach(function(s,t){var a="F;";s.hidden?a+="M0;":s.hpt?a+="M"+20*s.hpt+";":s.hpx&&(a+="M"+20*nu(s.hpx)+";"),a.length>2&&e.push(a+"R"+(t+1))})}(r,e["!rows"]),r.push("B;Y"+(l.e.r-l.s.r+1)+";X"+(l.e.c-l.s.c+1)+";D"+[l.s.c,l.s.r,l.e.c,l.e.r].join(" "));for(var d=l.s.r;d<=l.e.r;++d)for(var m=l.s.c;m<=l.e.c;++m){var h=Rd({r:d,c:m});(t=c?(e[d]||[])[m]:e[h])&&(null!=t.v||t.f&&!t.F)&&n.push(i(t,0,d,m))}return r.join(o)+o+n.join(o)+o+"E"+o}}}(),Nh=function(){function e(e,s){for(var t=e.split("\n"),a=-1,r=-1,n=0,i=[];n!==t.length;++n)if("BOT"!==t[n].trim()){if(!(a<0)){for(var l=t[n].trim().split(","),c=l[0],o=l[1],d=t[++n]||"";1&(d.match(/["]/g)||[]).length&&n<t.length-1;)d+="\n"+t[++n];switch(d=d.trim(),+c){case-1:if("BOT"===d){i[++a]=[],r=0;continue}if("EOD"!==d)throw new Error("Unrecognized DIF special command "+d);break;case 0:"TRUE"===d?i[a][r]=!0:"FALSE"===d?i[a][r]=!1:isNaN(Hc(o))?isNaN(Gc(o).getDate())?i[a][r]=o:i[a][r]=zc(o):i[a][r]=Hc(o),++r;break;case 1:(d=(d=d.slice(1,d.length-1)).replace(/""/g,'"'))&&d.match(/^=".*"$/)&&(d=d.slice(2,-1)),i[a][r++]=""!==d?d:null}if("EOD"===d)break}}else i[++a]=[],r=0;return s&&s.sheetRows&&(i=i.slice(0,s.sheetRows)),i}function s(s,t){return zd(function(s,t){switch(t.type){case"base64":return e(Nl(s),t);case"binary":return e(s,t);case"buffer":return e(wl&&Buffer.isBuffer(s)?s.toString("binary"):Tl(s),t);case"array":return e(Uc(s),t)}throw new Error("Unrecognized type "+t.type)}(s,t),t)}return{to_workbook:function(e,t){return Fd(s(e,t),t)},to_sheet:s,from_sheet:function(){var e=function(e,s,t,a,r){e.push(s),e.push(t+","+a),e.push('"'+r.replace(/"/g,'""')+'"')},s=function(e,s,t,a){e.push(s+","+t),e.push(1==s?'"'+a.replace(/"/g,'""')+'"':a)};return function(t){var a,r=[],n=Dd(t["!ref"]),i=Array.isArray(t);e(r,"TABLE",0,1,"sheetjs"),e(r,"VECTORS",0,n.e.r-n.s.r+1,""),e(r,"TUPLES",0,n.e.c-n.s.c+1,""),e(r,"DATA",0,0,"");for(var l=n.s.r;l<=n.e.r;++l){s(r,-1,0,"BOT");for(var c=n.s.c;c<=n.e.c;++c){var o=Rd({r:l,c:c});if(a=i?(t[l]||[])[c]:t[o])switch(a.t){case"n":var d=a.w;d||null==a.v||(d=a.v),null==d?a.f&&!a.F?s(r,1,0,"="+a.f):s(r,1,0,""):s(r,0,d,"V");break;case"b":s(r,0,a.v?1:0,a.v?"TRUE":"FALSE");break;case"s":s(r,1,0,isNaN(a.v)?a.v:'="'+a.v+'"');break;case"d":a.w||(a.w=yc(a.z||$l[14],Ac(zc(a.v)))),s(r,0,a.w,"V");break;default:s(r,1,0,"")}else s(r,1,0,"")}}s(r,-1,0,"EOD");return r.join("\r\n")}}()}}(),wh=function(){function e(e){return e.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,"\n")}function s(e){return e.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(s,t){return zd(function(s,t){for(var a=s.split("\n"),r=-1,n=-1,i=0,l=[];i!==a.length;++i){var c=a[i].trim().split(":");if("cell"===c[0]){var o=Ad(c[1]);if(l.length<=o.r)for(r=l.length;r<=o.r;++r)l[r]||(l[r]=[]);switch(r=o.r,n=o.c,c[2]){case"t":l[r][n]=e(c[3]);break;case"v":l[r][n]=+c[3];break;case"vtf":var d=c[c.length-1];case"vtc":"nl"===c[3]?l[r][n]=!!+c[4]:l[r][n]=+c[4],"vtf"==c[2]&&(l[r][n]=[l[r][n],d])}}}return t&&t.sheetRows&&(l=l.slice(0,t.sheetRows)),l}(s,t),t)}var a=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join("\n"),r=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join("\n")+"\n",n=["# SocialCalc Spreadsheet Control Save","part:sheet"].join("\n"),i="--SocialCalcSpreadsheetControlSave--";function l(e){if(!e||!e["!ref"])return"";for(var t,a=[],r=[],n="",i=Id(e["!ref"]),l=Array.isArray(e),c=i.s.r;c<=i.e.r;++c)for(var o=i.s.c;o<=i.e.c;++o)if(n=Rd({r:c,c:o}),(t=l?(e[c]||[])[o]:e[n])&&null!=t.v&&"z"!==t.t){switch(r=["cell",n,"t"],t.t){case"s":case"str":r.push(s(t.v));break;case"n":t.f?(r[2]="vtf",r[3]="n",r[4]=t.v,r[5]=s(t.f)):(r[2]="v",r[3]=t.v);break;case"b":r[2]="vt"+(t.f?"f":"c"),r[3]="nl",r[4]=t.v?"1":"0",r[5]=s(t.f||(t.v?"TRUE":"FALSE"));break;case"d":var d=Ac(zc(t.v));r[2]="vtc",r[3]="nd",r[4]=""+d,r[5]=t.w||yc(t.z||$l[14],d);break;case"e":continue}a.push(r.join(":"))}return a.push("sheet:c:"+(i.e.c-i.s.c+1)+":r:"+(i.e.r-i.s.r+1)+":tvf:1"),a.push("valueformat:1:text-wiki"),a.join("\n")}return{to_workbook:function(e,s){return Fd(t(e,s),s)},to_sheet:t,from_sheet:function(e){return[a,r,n,r,l(e),i].join("\n")}}}(),_h=function(){function e(e,s,t,a,r){r.raw?s[t][a]=e:""===e||("TRUE"===e?s[t][a]=!0:"FALSE"===e?s[t][a]=!1:isNaN(Hc(e))?isNaN(Gc(e).getDate())?s[t][a]=e:s[t][a]=zc(e):s[t][a]=Hc(e))}var s={44:",",9:"\t",59:";",124:"|"},t={44:3,9:2,59:1,124:0};function a(e){for(var a={},r=!1,n=0,i=0;n<e.length;++n)34==(i=e.charCodeAt(n))?r=!r:!r&&i in s&&(a[i]=(a[i]||0)+1);for(n in i=[],a)Object.prototype.hasOwnProperty.call(a,n)&&i.push([a[n],n]);if(!i.length)for(n in a=t)Object.prototype.hasOwnProperty.call(a,n)&&i.push([a[n],n]);return i.sort(function(e,s){return e[0]-s[0]||t[e[1]]-t[s[1]]}),s[i.pop()[1]]||44}function r(e,s){var t=s||{},r="",n=t.dense?[]:{},i={s:{c:0,r:0},e:{c:0,r:0}};"sep="==e.slice(0,4)?13==e.charCodeAt(5)&&10==e.charCodeAt(6)?(r=e.charAt(4),e=e.slice(7)):13==e.charCodeAt(5)||10==e.charCodeAt(5)?(r=e.charAt(4),e=e.slice(6)):r=a(e.slice(0,1024)):r=t&&t.FS?t.FS:a(e.slice(0,1024));var l=0,c=0,o=0,d=0,m=0,h=r.charCodeAt(0),u=!1,x=0,p=e.charCodeAt(0);e=e.replace(/\r\n/gm,"\n");var f,g,v=null!=t.dateNF?(f=t.dateNF,g=(g="number"==typeof f?$l[f]:f).replace(_c,"(\\d+)"),new RegExp("^"+g+"$")):null;function j(){var s=e.slice(d,m),a={};if('"'==s.charAt(0)&&'"'==s.charAt(s.length-1)&&(s=s.slice(1,-1).replace(/""/g,'"')),0===s.length)a.t="z";else if(t.raw)a.t="s",a.v=s;else if(0===s.trim().length)a.t="s",a.v=s;else if(61==s.charCodeAt(0))34==s.charCodeAt(1)&&34==s.charCodeAt(s.length-1)?(a.t="s",a.v=s.slice(2,-1).replace(/""/g,'"')):1!=s.length?(a.t="n",a.f=s.slice(1)):(a.t="s",a.v=s);else if("TRUE"==s)a.t="b",a.v=!0;else if("FALSE"==s)a.t="b",a.v=!1;else if(isNaN(o=Hc(s)))if(!isNaN(Gc(s).getDate())||v&&s.match(v)){a.z=t.dateNF||$l[14];var r=0;v&&s.match(v)&&(s=function(e,s,t){var a=-1,r=-1,n=-1,i=-1,l=-1,c=-1;(s.match(_c)||[]).forEach(function(e,s){var o=parseInt(t[s+1],10);switch(e.toLowerCase().charAt(0)){case"y":a=o;break;case"d":n=o;break;case"h":i=o;break;case"s":c=o;break;case"m":i>=0?l=o:r=o}}),c>=0&&-1==l&&r>=0&&(l=r,r=-1);var o=(""+(a>=0?a:(new Date).getFullYear())).slice(-4)+"-"+("00"+(r>=1?r:1)).slice(-2)+"-"+("00"+(n>=1?n:1)).slice(-2);7==o.length&&(o="0"+o),8==o.length&&(o="20"+o);var d=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return-1==i&&-1==l&&-1==c?o:-1==a&&-1==r&&-1==n?d:o+"T"+d}(0,t.dateNF,s.match(v)||[]),r=1),t.cellDates?(a.t="d",a.v=zc(s,r)):(a.t="n",a.v=Ac(zc(s,r))),!1!==t.cellText&&(a.w=yc(a.z,a.v instanceof Date?Ac(a.v):a.v)),t.cellNF||delete a.z}else a.t="s",a.v=s;else a.t="n",!1!==t.cellText&&(a.w=s),a.v=o;if("z"==a.t||(t.dense?(n[l]||(n[l]=[]),n[l][c]=a):n[Rd({c:c,r:l})]=a),d=m+1,p=e.charCodeAt(d),i.e.c<c&&(i.e.c=c),i.e.r<l&&(i.e.r=l),x==h)++c;else if(c=0,++l,t.sheetRows&&t.sheetRows<=l)return!0}e:for(;m<e.length;++m)switch(x=e.charCodeAt(m)){case 34:34===p&&(u=!u);break;case h:case 10:case 13:if(!u&&j())break e}return m-d>0&&j(),n["!ref"]=Pd(i),n}function n(s,t){return t&&t.PRN?t.FS||"sep="==s.slice(0,4)||s.indexOf("\t")>=0||s.indexOf(",")>=0||s.indexOf(";")>=0?r(s,t):zd(function(s,t){var a=t||{},r=[];if(!s||0===s.length)return r;for(var n=s.split(/[\r\n]/),i=n.length-1;i>=0&&0===n[i].length;)--i;for(var l=10,c=0,o=0;o<=i;++o)-1==(c=n[o].indexOf(" "))?c=n[o].length:c++,l=Math.max(l,c);for(o=0;o<=i;++o){r[o]=[];var d=0;for(e(n[o].slice(0,l).trim(),r,o,d,a),d=1;d<=(n[o].length-l)/10+1;++d)e(n[o].slice(l+10*(d-1),l+10*d).trim(),r,o,d,a)}return a.sheetRows&&(r=r.slice(0,a.sheetRows)),r}(s,t),t):r(s,t)}function i(e,s){var t="",a="string"==s.type?[0,0,0,0]:of(e,s);switch(s.type){case"base64":t=Nl(e);break;case"binary":case"string":t=e;break;case"buffer":65001==s.codepage?t=e.toString("utf8"):(s.codepage,t=wl&&Buffer.isBuffer(e)?e.toString("binary"):Tl(e));break;case"array":t=Uc(e);break;default:throw new Error("Unrecognized type "+s.type)}return 239==a[0]&&187==a[1]&&191==a[2]?t=_o(t.slice(3)):"string"!=s.type&&"buffer"!=s.type&&65001==s.codepage?t=_o(t):s.type,"socialcalc:version:"==t.slice(0,19)?wh.to_sheet("string"==s.type?t:_o(t),s):n(t,s)}return{to_workbook:function(e,s){return Fd(i(e,s),s)},to_sheet:i,from_sheet:function(e){for(var s,t=[],a=Dd(e["!ref"]),r=Array.isArray(e),n=a.s.r;n<=a.e.r;++n){for(var i=[],l=a.s.c;l<=a.e.c;++l){var c=Rd({r:n,c:l});if((s=r?(e[n]||[])[l]:e[c])&&null!=s.v){for(var o=(s.w||(Od(s),s.w)||"").slice(0,10);o.length<10;)o+=" ";i.push(o+(0===l?" ":""))}else i.push("          ")}t.push(i.join(""))}return t.join("\n")}}}();var kh=function(){function e(e,s,t){if(e){gd(e,e.l||0);for(var a=t.Enum||g;e.l<e.length;){var r=e.read_shift(2),n=a[r]||a[65535],i=e.read_shift(2),l=e.l+i,c=n.f&&n.f(e,i,t);if(e.l=l,s(c,n,r))return}}}function s(s,t){if(!s)return s;var a=t||{},r=a.dense?[]:{},n="Sheet1",i="",l=0,c={},o=[],d=[],m={s:{r:0,c:0},e:{r:0,c:0}},h=a.sheetRows||0;if(0==s[2]&&(8==s[3]||9==s[3])&&s.length>=16&&5==s[14]&&108===s[15])throw new Error("Unsupported Works 3 for Mac file");if(2==s[2])a.Enum=g,e(s,function(e,s,t){switch(t){case 0:a.vers=e,e>=4096&&(a.qpro=!0);break;case 6:m=e;break;case 204:e&&(i=e);break;case 222:i=e;break;case 15:case 51:a.qpro||(e[1].v=e[1].v.slice(1));case 13:case 14:case 16:14==t&&!(112&~e[2])&&(15&e[2])>1&&(15&e[2])<15&&(e[1].z=a.dateNF||$l[14],a.cellDates&&(e[1].t="d",e[1].v=Dc(e[1].v))),a.qpro&&e[3]>l&&(r["!ref"]=Pd(m),c[n]=r,o.push(n),r=a.dense?[]:{},m={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],n=i||"Sheet"+(l+1),i="");var d=a.dense?(r[e[0].r]||[])[e[0].c]:r[Rd(e[0])];if(d){d.t=e[1].t,d.v=e[1].v,null!=e[1].z&&(d.z=e[1].z),null!=e[1].f&&(d.f=e[1].f);break}a.dense?(r[e[0].r]||(r[e[0].r]=[]),r[e[0].r][e[0].c]=e[1]):r[Rd(e[0])]=e[1]}},a);else{if(26!=s[2]&&14!=s[2])throw new Error("Unrecognized LOTUS BOF "+s[2]);a.Enum=v,14==s[2]&&(a.qpro=!0,s.l=0),e(s,function(e,s,t){switch(t){case 204:n=e;break;case 22:e[1].v=e[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(e[3]>l&&(r["!ref"]=Pd(m),c[n]=r,o.push(n),r=a.dense?[]:{},m={s:{r:0,c:0},e:{r:0,c:0}},l=e[3],n="Sheet"+(l+1)),h>0&&e[0].r>=h)break;a.dense?(r[e[0].r]||(r[e[0].r]=[]),r[e[0].r][e[0].c]=e[1]):r[Rd(e[0])]=e[1],m.e.c<e[0].c&&(m.e.c=e[0].c),m.e.r<e[0].r&&(m.e.r=e[0].r);break;case 27:e[14e3]&&(d[e[14e3][0]]=e[14e3][1]);break;case 1537:d[e[0]]=e[1],e[0]==l&&(n=e[1])}},a)}if(r["!ref"]=Pd(m),c[i||n]=r,o.push(i||n),!d.length)return{SheetNames:o,Sheets:c};for(var u={},x=[],p=0;p<d.length;++p)c[o[p]]?(x.push(d[p]||o[p]),u[d[p]]=c[d[p]]||c[o[p]]):(x.push(d[p]),u[d[p]]={"!ref":"A1"});return{SheetNames:x,Sheets:u}}function t(e,s,t){var a=[{c:0,r:0},{t:"n",v:0},0,0];return t.qpro&&20768!=t.vers?(a[0].c=e.read_shift(1),a[3]=e.read_shift(1),a[0].r=e.read_shift(2),e.l+=2):(a[2]=e.read_shift(1),a[0].c=e.read_shift(2),a[0].r=e.read_shift(2)),a}function a(e,s,a){var r=e.l+s,n=t(e,0,a);if(n[1].t="s",20768==a.vers){e.l++;var i=e.read_shift(1);return n[1].v=e.read_shift(i,"utf8"),n}return a.qpro&&e.l++,n[1].v=e.read_shift(r-e.l,"cstr"),n}function r(e,s,t){var a=jd(7+t.length);a.write_shift(1,255),a.write_shift(2,s),a.write_shift(2,e),a.write_shift(1,39);for(var r=0;r<a.length;++r){var n=t.charCodeAt(r);a.write_shift(1,n>=128?95:n)}return a.write_shift(1,0),a}function n(e,s,t){var a=jd(7);return a.write_shift(1,255),a.write_shift(2,s),a.write_shift(2,e),a.write_shift(2,t,"i"),a}function i(e,s,t){var a=jd(13);return a.write_shift(1,255),a.write_shift(2,s),a.write_shift(2,e),a.write_shift(8,t,"f"),a}function l(e,s,t){var a=32768&s;return s=(a?e:0)+((s&=-32769)>=8192?s-16384:s),(a?"":"$")+(t?Cd(s):Ed(s))}var c={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},o=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function d(e){var s=[{c:0,r:0},{t:"n",v:0},0];return s[0].r=e.read_shift(2),s[3]=e[e.l++],s[0].c=e[e.l++],s}function m(e,s,t,a){var r=jd(6+a.length);r.write_shift(2,e),r.write_shift(1,t),r.write_shift(1,s),r.write_shift(1,39);for(var n=0;n<a.length;++n){var i=a.charCodeAt(n);r.write_shift(1,i>=128?95:i)}return r.write_shift(1,0),r}function h(e,s){var t=d(e),a=e.read_shift(4),r=e.read_shift(4),n=e.read_shift(2);if(65535==n)return 0===a&&3221225472===r?(t[1].t="e",t[1].v=15):0===a&&3489660928===r?(t[1].t="e",t[1].v=42):t[1].v=0,t;var i=32768&n;return n=(32767&n)-16446,t[1].v=(1-2*i)*(r*Math.pow(2,n+32)+a*Math.pow(2,n)),t}function u(e,s,t,a){var r=jd(14);if(r.write_shift(2,e),r.write_shift(1,t),r.write_shift(1,s),0==a)return r.write_shift(4,0),r.write_shift(4,0),r.write_shift(2,65535),r;var n,i=0,l=0,c=0;return a<0&&(i=1,a=-a),l=0|Math.log2(a),2147483648&(c=(a/=Math.pow(2,l-31))>>>0)||(++l,c=(a/=2)>>>0),a-=c,c|=2147483648,c>>>=0,n=(a*=Math.pow(2,32))>>>0,r.write_shift(4,n),r.write_shift(4,c),l+=16383+(i?32768:0),r.write_shift(2,l),r}function x(e,s){var t=d(e),a=e.read_shift(8,"f");return t[1].v=a,t}function p(e,s){return 0==e[e.l+s-1]?e.read_shift(s,"cstr"):""}function f(e,s){var t=jd(5+e.length);t.write_shift(2,14e3),t.write_shift(2,s);for(var a=0;a<e.length;++a){var r=e.charCodeAt(a);t[t.l++]=r>127?95:r}return t[t.l++]=0,t}var g={0:{n:"BOF",f:Fm},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:function(e,s,t){var a={s:{c:0,r:0},e:{c:0,r:0}};return 8==s&&t.qpro?(a.s.c=e.read_shift(1),e.l++,a.s.r=e.read_shift(2),a.e.c=e.read_shift(1),e.l++,a.e.r=e.read_shift(2),a):(a.s.c=e.read_shift(2),a.s.r=e.read_shift(2),12==s&&t.qpro&&(e.l+=2),a.e.c=e.read_shift(2),a.e.r=e.read_shift(2),12==s&&t.qpro&&(e.l+=2),65535==a.s.c&&(a.s.c=a.e.c=a.s.r=a.e.r=0),a)}},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:function(e,s,a){var r=t(e,0,a);return r[1].v=e.read_shift(2,"i"),r}},14:{n:"NUMBER",f:function(e,s,a){var r=t(e,0,a);return r[1].v=e.read_shift(8,"f"),r}},15:{n:"LABEL",f:a},16:{n:"FORMULA",f:function(e,s,a){var r=e.l+s,n=t(e,0,a);if(n[1].v=e.read_shift(8,"f"),a.qpro)e.l=r;else{var i=e.read_shift(2);!function(e,s){gd(e,0);var t=[],a=0,r="",n="",i="",d="";for(;e.l<e.length;){var m=e[e.l++];switch(m){case 0:t.push(e.read_shift(8,"f"));break;case 1:n=l(s[0].c,e.read_shift(2),!0),r=l(s[0].r,e.read_shift(2),!1),t.push(n+r);break;case 2:var h=l(s[0].c,e.read_shift(2),!0),u=l(s[0].r,e.read_shift(2),!1);n=l(s[0].c,e.read_shift(2),!0),r=l(s[0].r,e.read_shift(2),!1),t.push(h+u+":"+n+r);break;case 3:if(e.l<e.length)return;break;case 4:t.push("("+t.pop()+")");break;case 5:t.push(e.read_shift(2));break;case 6:for(var x="";m=e[e.l++];)x+=String.fromCharCode(m);t.push('"'+x.replace(/"/g,'""')+'"');break;case 8:t.push("-"+t.pop());break;case 23:t.push("+"+t.pop());break;case 22:t.push("NOT("+t.pop()+")");break;case 20:case 21:d=t.pop(),i=t.pop(),t.push(["AND","OR"][m-20]+"("+i+","+d+")");break;default:if(m<32&&o[m])d=t.pop(),i=t.pop(),t.push(i+o[m]+d);else{if(!c[m])return;if(69==(a=c[m][1])&&(a=e[e.l++]),a>t.length)return;var p=t.slice(-a);t.length-=a,t.push(c[m][0]+"("+p.join(",")+")")}}}1==t.length&&(s[1].f=""+t[0])}(e.slice(e.l,e.l+i),n),e.l+=i}return n}},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:a},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:p},222:{n:"SHEETNAMELP",f:function(e,s){var t=e[e.l++];t>s-1&&(t=s-1);for(var a="";a.length<t;)a+=String.fromCharCode(e[e.l++]);return a}},65535:{n:""}},v={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:function(e,s){var t=d(e);return t[1].t="s",t[1].v=e.read_shift(s-4,"cstr"),t}},23:{n:"NUMBER17",f:h},24:{n:"NUMBER18",f:function(e,s){var t=d(e);t[1].v=e.read_shift(2);var a=t[1].v>>1;if(1&t[1].v)switch(7&a){case 0:a=5e3*(a>>3);break;case 1:a=500*(a>>3);break;case 2:a=(a>>3)/20;break;case 3:a=(a>>3)/200;break;case 4:a=(a>>3)/2e3;break;case 5:a=(a>>3)/2e4;break;case 6:a=(a>>3)/16;break;case 7:a=(a>>3)/64}return t[1].v=a,t}},25:{n:"FORMULA19",f:function(e,s){var t=h(e);return e.l+=s-14,t}},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:function(e,s){for(var t={},a=e.l+s;e.l<a;){var r=e.read_shift(2);if(14e3==r){for(t[r]=[0,""],t[r][0]=e.read_shift(2);e[e.l];)t[r][1]+=String.fromCharCode(e[e.l]),e.l++;e.l++}}return t}},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:function(e,s){var t=d(e),a=e.read_shift(4);return t[1].v=a>>6,t}},38:{n:"??"},39:{n:"NUMBER27",f:x},40:{n:"FORMULA28",f:function(e,s){var t=x(e);return e.l+=s-10,t}},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:p},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:function(e,s,t){if(t.qpro&&!(s<21)){var a=e.read_shift(1);return e.l+=17,e.l+=1,e.l+=2,[a,e.read_shift(s-21,"cstr")]}}},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:function(e,s){var t=s||{};if(+t.codepage>=0&&hl(+t.codepage),"string"==t.type)throw new Error("Cannot write WK1 to JS string");var a,l,c=bd(),o=Dd(e["!ref"]),d=Array.isArray(e),m=[];Cp(c,0,(a=1030,(l=jd(2)).write_shift(2,a),l)),Cp(c,6,function(e){var s=jd(8);return s.write_shift(2,e.s.c),s.write_shift(2,e.s.r),s.write_shift(2,e.e.c),s.write_shift(2,e.e.r),s}(o));for(var h=Math.min(o.e.r,8191),u=o.s.r;u<=h;++u)for(var x=Ed(u),p=o.s.c;p<=o.e.c;++p){u===o.s.r&&(m[p]=Cd(p));var f=m[p]+x,g=d?(e[u]||[])[p]:e[f];if(g&&"z"!=g.t)if("n"==g.t)(0|g.v)==g.v&&g.v>=-32768&&g.v<=32767?Cp(c,13,n(u,p,g.v)):Cp(c,14,i(u,p,g.v));else Cp(c,15,r(u,p,Od(g).slice(0,239)))}return Cp(c,1),c.end()},book_to_wk3:function(e,s){var t=s||{};if(+t.codepage>=0&&hl(+t.codepage),"string"==t.type)throw new Error("Cannot write WK3 to JS string");var a=bd();Cp(a,0,function(e){var s=jd(26);s.write_shift(2,4096),s.write_shift(2,4),s.write_shift(4,0);for(var t=0,a=0,r=0,n=0;n<e.SheetNames.length;++n){var i=e.SheetNames[n],l=e.Sheets[i];if(l&&l["!ref"]){++r;var c=Id(l["!ref"]);t<c.e.r&&(t=c.e.r),a<c.e.c&&(a=c.e.c)}}t>8191&&(t=8191);return s.write_shift(2,t),s.write_shift(1,r),s.write_shift(1,a),s.write_shift(2,0),s.write_shift(2,0),s.write_shift(1,1),s.write_shift(1,2),s.write_shift(4,0),s.write_shift(4,0),s}(e));for(var r=0,n=0;r<e.SheetNames.length;++r)(e.Sheets[e.SheetNames[r]]||{})["!ref"]&&Cp(a,27,f(e.SheetNames[r],n++));var i=0;for(r=0;r<e.SheetNames.length;++r){var l=e.Sheets[e.SheetNames[r]];if(l&&l["!ref"]){for(var c=Dd(l["!ref"]),o=Array.isArray(l),d=[],h=Math.min(c.e.r,8191),x=c.s.r;x<=h;++x)for(var p=Ed(x),g=c.s.c;g<=c.e.c;++g){x===c.s.r&&(d[g]=Cd(g));var v=d[g]+p,j=o?(l[x]||[])[g]:l[v];if(j&&"z"!=j.t)if("n"==j.t)Cp(a,23,u(x,g,i,j.v));else Cp(a,22,m(x,g,i,Od(j).slice(0,239)))}++i}}return Cp(a,1),a.end()},to_workbook:function(e,t){switch(t.type){case"base64":return s(El(Nl(e)),t);case"binary":return s(El(e),t);case"buffer":case"array":return s(e,t)}throw"Unsupported type "+t.type}}}();var Sh=function(){var e=So("t"),s=So("rPr");function t(t){var a=t.match(e);if(!a)return{t:"s",v:""};var r={t:"s",v:xo(a[1])},n=t.match(s);return n&&(r.s=function(e){var s={},t=e.match(io),a=0,r=!1;if(t)for(;a!=t.length;++a){var n=oo(t[a]);switch(n[0].replace(/\w*:/g,"")){case"<condense":case"<extend":break;case"<shadow":if(!n.val)break;case"<shadow>":case"<shadow/>":s.shadow=1;break;case"</shadow>":break;case"<charset":if("1"==n.val)break;s.cp=dl[parseInt(n.val,10)];break;case"<outline":if(!n.val)break;case"<outline>":case"<outline/>":s.outline=1;break;case"</outline>":break;case"<rFont":s.name=n.val;break;case"<sz":s.sz=n.val;break;case"<strike":if(!n.val)break;case"<strike>":case"<strike/>":s.strike=1;break;case"</strike>":break;case"<u":if(!n.val)break;switch(n.val){case"double":s.uval="double";break;case"singleAccounting":s.uval="single-accounting";break;case"doubleAccounting":s.uval="double-accounting"}case"<u>":case"<u/>":s.u=1;break;case"</u>":break;case"<b":if("0"==n.val)break;case"<b>":case"<b/>":s.b=1;break;case"</b>":break;case"<i":if("0"==n.val)break;case"<i>":case"<i/>":s.i=1;break;case"</i>":break;case"<color":n.rgb&&(s.color=n.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":s.family=n.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":s.valign=n.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":case"<scheme":case"<scheme>":case"<scheme/>":case"</scheme>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(47!==n[0].charCodeAt(1)&&!r)throw new Error("Unrecognized rich format "+n[0])}}return s}(n[1])),r}var a=/<(?:\w+:)?r>/g,r=/<\/(?:\w+:)?r>/;return function(e){return e.replace(a,"").split(r).map(t).filter(function(e){return e.v})}}(),Eh=function(){var e=/(\r\n|\n)/g;function s(s){var t=[[],s.v,[]];return s.v?(s.s&&function(e,s,t){var a=[];e.u&&a.push("text-decoration: underline;"),e.uval&&a.push("text-underline-style:"+e.uval+";"),e.sz&&a.push("font-size:"+e.sz+"pt;"),e.outline&&a.push("text-effect: outline;"),e.shadow&&a.push("text-shadow: auto;"),s.push('<span style="'+a.join("")+'">'),e.b&&(s.push("<b>"),t.push("</b>")),e.i&&(s.push("<i>"),t.push("</i>")),e.strike&&(s.push("<s>"),t.push("</s>"));var r=e.valign||"";"superscript"==r||"super"==r?r="sup":"subscript"==r&&(r="sub"),""!=r&&(s.push("<"+r+">"),t.push("</"+r+">")),t.push("</span>")}(s.s,t[0],t[2]),t[0].join("")+t[1].replace(e,"<br/>")+t[2].join("")):""}return function(e){return e.map(s).join("")}}(),Th=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Ch=/<(?:\w+:)?r>/,Ah=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function Rh(e,s){var t=!s||s.cellHTML,a={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(a.t=xo(_o(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),a.r=_o(e),t&&(a.h=go(a.t))):e.match(Ch)&&(a.r=_o(e),a.t=xo(_o((e.replace(Ah,"").match(Th)||[]).join("").replace(io,""))),t&&(a.h=Eh(Sh(a.r)))),a):{t:""}}var Ih=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,Ph=/<(?:\w+:)?(?:si|sstItem)>/g,Dh=/<\/(?:\w+:)?(?:si|sstItem)>/;function Mh(e){for(var s=[],t=e.split(""),a=0;a<t.length;++a)s[a]=t[a].charCodeAt(0);return s}function Oh(e,s){var t={};return t.Major=e.read_shift(2),t.Minor=e.read_shift(2),s>=4&&(e.l+=s-4),t}function Fh(e){for(var s=e.read_shift(4),t=e.l+s-4,a={},r=e.read_shift(4),n=[];r-- >0;)n.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(a.name=e.read_shift(0,"lpp4"),a.comps=n,e.l!=t)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+t);return a}function Lh(e){var s=function(e){var s={};return e.read_shift(4),e.l+=4,s.id=e.read_shift(0,"lpp4"),s.name=e.read_shift(0,"lpp4"),s.R=Oh(e,4),s.U=Oh(e,4),s.W=Oh(e,4),s}(e);if(s.ename=e.read_shift(0,"8lpp4"),s.blksz=e.read_shift(4),s.cmode=e.read_shift(4),4!=e.read_shift(4))throw new Error("Bad !Primary record");return s}function zh(e,s){var t=e.l+s,a={};a.Flags=63&e.read_shift(4),e.l+=4,a.AlgID=e.read_shift(4);var r=!1;switch(a.AlgID){case 26126:case 26127:case 26128:r=36==a.Flags;break;case 26625:r=4==a.Flags;break;case 0:r=16==a.Flags||4==a.Flags||36==a.Flags;break;default:throw"Unrecognized encryption algorithm: "+a.AlgID}if(!r)throw new Error("Encryption Flags/AlgID mismatch");return a.AlgIDHash=e.read_shift(4),a.KeySize=e.read_shift(4),a.ProviderType=e.read_shift(4),e.l+=8,a.CSPName=e.read_shift(t-e.l>>1,"utf16le"),e.l=t,a}function Uh(e,s){var t={},a=e.l+s;return e.l+=4,t.Salt=e.slice(e.l,e.l+16),e.l+=16,t.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),t.VerifierHash=e.slice(e.l,a),e.l=a,t}function Bh(e){if(36!=(63&e.read_shift(4)))throw new Error("EncryptionInfo mismatch");var s=e.read_shift(4);return{t:"Std",h:zh(e,s),v:Uh(e,e.length-e.l)}}function $h(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Hh(e){var s=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var t=e.read_shift(e.length-e.l,"utf8"),a={};return t.replace(io,function(e){var t=oo(e);switch(mo(t[0])){case"<?xml":case"<encryption":case"</encryption>":case"</keyEncryptors>":case"</keyEncryptor>":break;case"<keyData":s.forEach(function(e){a[e]=t[e]});break;case"<dataIntegrity":a.encryptedHmacKey=t.encryptedHmacKey,a.encryptedHmacValue=t.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":a.encs=[];break;case"<keyEncryptor":a.uri=t.uri;break;case"<encryptedKey":a.encs.push(t);break;default:throw t[0]}}),a}var Vh=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],s=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],t=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],a=function(e,s){return 255&((t=e^s)/2|128*t);var t};return function(r){for(var n,i,l,c=Mh(r),o=function(e){for(var a=s[e.length-1],r=104,n=e.length-1;n>=0;--n)for(var i=e[n],l=0;7!=l;++l)64&i&&(a^=t[r]),i*=2,--r;return a}(c),d=c.length,m=kl(16),h=0;16!=h;++h)m[h]=0;for(1&~d||(n=o>>8,m[d]=a(e[0],n),--d,n=255&o,i=c[c.length-1],m[d]=a(i,n));d>0;)n=o>>8,m[--d]=a(c[d],n),n=255&o,m[--d]=a(c[d],n);for(d=15,l=15-c.length;l>0;)n=o>>8,m[d]=a(e[l],n),--l,n=255&o,m[--d]=a(c[d],n),--d,--l;return m}}(),Gh=function(e){var s=0,t=Vh(e);return function(e){var a=function(e,s,t,a,r){var n,i;for(r||(r=s),a||(a=Vh(e)),n=0;n!=s.length;++n)i=s[n],i=255&((i^=a[t])>>5|i<<3),r[n]=i,++t;return[r,t,a]}("",e,s,t);return s=a[1],a[0]}};function qh(e,s,t,a){var r={key:Fm(e),verificationBytes:Fm(e)};return t.password&&(r.verifier=function(e){var s,t,a=0,r=Mh(e),n=r.length+1;for((s=kl(n))[0]=r.length,t=1;t!=n;++t)s[t]=r[t-1];for(t=n-1;t>=0;--t)a=((16384&a?1:0)|a<<1&32767)^s[t];return 52811^a}(t.password)),a.valid=r.verificationBytes===r.verifier,a.valid&&(a.insitu=Gh(t.password)),r}function Wh(e,s,t){var a=t||{};return a.Info=e.read_shift(2),e.l-=2,1===a.Info?a.Data=function(e){var s={},t=s.EncryptionVersionInfo=Oh(e,4);if(1!=t.Major||1!=t.Minor)throw"unrecognized version code "+t.Major+" : "+t.Minor;return s.Salt=e.read_shift(16),s.EncryptedVerifier=e.read_shift(16),s.EncryptedVerifierHash=e.read_shift(16),s}(e):a.Data=function(e,s){var t={},a=t.EncryptionVersionInfo=Oh(e,4);if(s-=4,2!=a.Minor)throw new Error("unrecognized minor version code: "+a.Minor);if(a.Major>4||a.Major<2)throw new Error("unrecognized major version code: "+a.Major);t.Flags=e.read_shift(4),s-=4;var r=e.read_shift(4);return s-=4,t.EncryptionHeader=zh(e,r),s-=r,t.EncryptionVerifier=Uh(e,s),t}(e,s),a}var Yh=function(){function e(e,t){switch(t.type){case"base64":return s(Nl(e),t);case"binary":return s(e,t);case"buffer":return s(wl&&Buffer.isBuffer(e)?e.toString("binary"):Tl(e),t);case"array":return s(Uc(e),t)}throw new Error("Unrecognized type "+t.type)}function s(e,s){var t=(s||{}).dense?[]:{},a=e.match(/\\trowd.*?\\row\b/g);if(!a.length)throw new Error("RTF missing table");var r={s:{c:0,r:0},e:{c:0,r:a.length-1}};return a.forEach(function(e,s){Array.isArray(t)&&(t[s]=[]);for(var a,n=/\\\w+\b/g,i=0,l=-1;a=n.exec(e);){if("\\cell"===a[0]){var c=e.slice(i,n.lastIndex-a[0].length);if(" "==c[0]&&(c=c.slice(1)),++l,c.length){var o={v:c,t:"s"};Array.isArray(t)?t[s][l]=o:t[Rd({r:s,c:l})]=o}}i=n.lastIndex}l>r.e.c&&(r.e.c=l)}),t["!ref"]=Pd(r),t}return{to_workbook:function(s,t){return Fd(e(s,t),t)},to_sheet:e,from_sheet:function(e){for(var s,t=["{\\rtf1\\ansi"],a=Dd(e["!ref"]),r=Array.isArray(e),n=a.s.r;n<=a.e.r;++n){t.push("\\trowd\\trautofit1");for(var i=a.s.c;i<=a.e.c;++i)t.push("\\cellx"+(i+1));for(t.push("\\pard\\intbl"),i=a.s.c;i<=a.e.c;++i){var l=Rd({r:n,c:i});(s=r?(e[n]||[])[i]:e[l])&&(null!=s.v||s.f&&!s.F)&&(t.push(" "+(s.w||(Od(s),s.w))),t.push("\\cell"))}t.push("\\pard\\intbl\\row")}return t.join("")+"}"}}}();function Kh(e){for(var s=0,t=1;3!=s;++s)t=256*t+(e[s]>255?255:e[s]<0?0:e[s]);return t.toString(16).toUpperCase().slice(1)}function Jh(e,s){if(0===s)return e;var t,a,r=function(e){var s=e[0]/255,t=e[1]/255,a=e[2]/255,r=Math.max(s,t,a),n=Math.min(s,t,a),i=r-n;if(0===i)return[0,0,s];var l,c=0,o=r+n;switch(l=i/(o>1?2-o:o),r){case s:c=((t-a)/i+6)%6;break;case t:c=(a-s)/i+2;break;case a:c=(s-t)/i+4}return[c/6,l,o/2]}((a=(t=e).slice("#"===t[0]?1:0).slice(0,6),[parseInt(a.slice(0,2),16),parseInt(a.slice(2,4),16),parseInt(a.slice(4,6),16)]));return r[2]=s<0?r[2]*(1+s):1-(1-r[2])*(1-s),Kh(function(e){var s,t=e[0],a=e[1],r=e[2],n=2*a*(r<.5?r:1-r),i=r-n/2,l=[i,i,i],c=6*t;if(0!==a)switch(0|c){case 0:case 6:s=n*c,l[0]+=n,l[1]+=s;break;case 1:s=n*(2-c),l[0]+=s,l[1]+=n;break;case 2:s=n*(c-2),l[1]+=n,l[2]+=s;break;case 3:s=n*(4-c),l[1]+=s,l[2]+=n;break;case 4:s=n*(c-4),l[2]+=n,l[0]+=s;break;case 5:s=n*(6-c),l[2]+=s,l[0]+=n}for(var o=0;3!=o;++o)l[o]=Math.round(255*l[o]);return l}(r))}var Xh=6;function Zh(e){return Math.floor((e+Math.round(128/Xh)/256)*Xh)}function Qh(e){return Math.floor((e-5)/Xh*100+.5)/100}function eu(e){return Math.round((e*Xh+5)/Xh*256)/256}function su(e){return eu(Qh(Zh(e)))}function tu(e){var s=Math.abs(e-su(e)),t=Xh;if(s>.005)for(Xh=1;Xh<15;++Xh)Math.abs(e-su(e))<=s&&(s=Math.abs(e-su(e)),t=Xh);Xh=t}function au(e){e.width?(e.wpx=Zh(e.width),e.wch=Qh(e.wpx),e.MDW=Xh):e.wpx?(e.wch=Qh(e.wpx),e.width=eu(e.wch),e.MDW=Xh):"number"==typeof e.wch&&(e.width=eu(e.wch),e.wpx=Zh(e.width),e.MDW=Xh),e.customWidth&&delete e.customWidth}var ru=96;function nu(e){return 96*e/ru}function iu(e){return e*ru/96}var lu={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};var cu=["numFmtId","fillId","fontId","borderId","xfId"],ou=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];var du=function(){var e=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,s=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,t=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,r=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(n,i,l){var c,o={};return n?((c=(n=n.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"")).match(e))&&function(e,s,t){s.NumberFmt=[];for(var a=Ec($l),r=0;r<a.length;++r)s.NumberFmt[a[r]]=$l[a[r]];var n=e[0].match(io);if(n)for(r=0;r<n.length;++r){var i=oo(n[r]);switch(mo(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":case"</numFmt>":break;case"<numFmt":var l=xo(_o(i.formatCode)),c=parseInt(i.numFmtId,10);if(s.NumberFmt[c]=l,c>0){if(c>392){for(c=392;c>60&&null!=s.NumberFmt[c];--c);s.NumberFmt[c]=l}bc(l,c)}break;default:if(t.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}(c,o,l),(c=n.match(a))&&function(e,s,t,a){s.Fonts=[];var r={},n=!1;(e[0].match(io)||[]).forEach(function(e){var i=oo(e);switch(mo(i[0])){case"<fonts":case"<fonts>":case"</fonts>":case"<font":case"<font>":case"<name/>":case"</name>":case"<sz/>":case"</sz>":case"<vertAlign/>":case"</vertAlign>":case"<family/>":case"</family>":case"<scheme/>":case"</scheme>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"</font>":case"<font/>":s.Fonts.push(r),r={};break;case"<name":i.val&&(r.name=_o(i.val));break;case"<b":r.bold=i.val?jo(i.val):1;break;case"<b/>":r.bold=1;break;case"<i":r.italic=i.val?jo(i.val):1;break;case"<i/>":r.italic=1;break;case"<u":switch(i.val){case"none":r.underline=0;break;case"single":r.underline=1;break;case"double":r.underline=2;break;case"singleAccounting":r.underline=33;break;case"doubleAccounting":r.underline=34}break;case"<u/>":r.underline=1;break;case"<strike":r.strike=i.val?jo(i.val):1;break;case"<strike/>":r.strike=1;break;case"<outline":r.outline=i.val?jo(i.val):1;break;case"<outline/>":r.outline=1;break;case"<shadow":r.shadow=i.val?jo(i.val):1;break;case"<shadow/>":r.shadow=1;break;case"<condense":r.condense=i.val?jo(i.val):1;break;case"<condense/>":r.condense=1;break;case"<extend":r.extend=i.val?jo(i.val):1;break;case"<extend/>":r.extend=1;break;case"<sz":i.val&&(r.sz=+i.val);break;case"<vertAlign":i.val&&(r.vertAlign=i.val);break;case"<family":i.val&&(r.family=parseInt(i.val,10));break;case"<scheme":i.val&&(r.scheme=i.val);break;case"<charset":if("1"==i.val)break;i.codepage=dl[parseInt(i.val,10)];break;case"<color":if(r.color||(r.color={}),i.auto&&(r.color.auto=jo(i.auto)),i.rgb)r.color.rgb=i.rgb.slice(-6);else if(i.indexed){r.color.index=parseInt(i.indexed,10);var l=cm[r.color.index];81==r.color.index&&(l=cm[1]),l||(l=cm[1]),r.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else i.theme&&(r.color.theme=parseInt(i.theme,10),i.tint&&(r.color.tint=parseFloat(i.tint)),i.theme&&t.themeElements&&t.themeElements.clrScheme&&(r.color.rgb=Jh(t.themeElements.clrScheme[r.color.theme].rgb,r.color.tint||0)));break;case"<AlternateContent":case"<ext":n=!0;break;case"</AlternateContent>":case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+i[0]+" in fonts")}})}(c,o,i,l),(c=n.match(t))&&function(e,s,t,a){s.Fills=[];var r={},n=!1;(e[0].match(io)||[]).forEach(function(e){var t=oo(e);switch(mo(t[0])){case"<fills":case"<fills>":case"</fills>":case"</fill>":case"<gradientFill>":case"<patternFill/>":case"</patternFill>":case"<bgColor/>":case"</bgColor>":case"<fgColor/>":case"</fgColor>":case"<stop":case"<stop/>":case"</stop>":case"<color":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<fill>":case"<fill":case"<fill/>":r={},s.Fills.push(r);break;case"<gradientFill":case"</gradientFill>":s.Fills.push(r),r={};break;case"<patternFill":case"<patternFill>":t.patternType&&(r.patternType=t.patternType);break;case"<bgColor":r.bgColor||(r.bgColor={}),t.indexed&&(r.bgColor.indexed=parseInt(t.indexed,10)),t.theme&&(r.bgColor.theme=parseInt(t.theme,10)),t.tint&&(r.bgColor.tint=parseFloat(t.tint)),t.rgb&&(r.bgColor.rgb=t.rgb.slice(-6));break;case"<fgColor":r.fgColor||(r.fgColor={}),t.theme&&(r.fgColor.theme=parseInt(t.theme,10)),t.tint&&(r.fgColor.tint=parseFloat(t.tint)),null!=t.rgb&&(r.fgColor.rgb=t.rgb.slice(-6));break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+t[0]+" in fills")}})}(c,o,0,l),(c=n.match(r))&&function(e,s,t,a){s.Borders=[];var r={},n=!1;(e[0].match(io)||[]).forEach(function(e){var t=oo(e);switch(mo(t[0])){case"<borders":case"<borders>":case"</borders>":case"</border>":case"<left/>":case"<left":case"<left>":case"</left>":case"<right/>":case"<right":case"<right>":case"</right>":case"<top/>":case"<top":case"<top>":case"</top>":case"<bottom/>":case"<bottom":case"<bottom>":case"</bottom>":case"<diagonal":case"<diagonal>":case"<diagonal/>":case"</diagonal>":case"<horizontal":case"<horizontal>":case"<horizontal/>":case"</horizontal>":case"<vertical":case"<vertical>":case"<vertical/>":case"</vertical>":case"<start":case"<start>":case"<start/>":case"</start>":case"<end":case"<end>":case"<end/>":case"</end>":case"<color":case"<color>":case"<color/>":case"</color>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<border":case"<border>":case"<border/>":r={},t.diagonalUp&&(r.diagonalUp=jo(t.diagonalUp)),t.diagonalDown&&(r.diagonalDown=jo(t.diagonalDown)),s.Borders.push(r);break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(a&&a.WTF&&!n)throw new Error("unrecognized "+t[0]+" in borders")}})}(c,o,0,l),(c=n.match(s))&&function(e,s,t){var a;s.CellXf=[];var r=!1;(e[0].match(io)||[]).forEach(function(e){var n=oo(e),i=0;switch(mo(n[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":case"</xf>":case"</alignment>":case"<protection":case"</protection>":case"<protection/>":case"<extLst":case"<extLst>":case"</extLst>":break;case"<xf":case"<xf/>":for(delete(a=n)[0],i=0;i<cu.length;++i)a[cu[i]]&&(a[cu[i]]=parseInt(a[cu[i]],10));for(i=0;i<ou.length;++i)a[ou[i]]&&(a[ou[i]]=jo(a[ou[i]]));if(s.NumberFmt&&a.numFmtId>392)for(i=392;i>60;--i)if(s.NumberFmt[a.numFmtId]==s.NumberFmt[i]){a.numFmtId=i;break}s.CellXf.push(a);break;case"<alignment":case"<alignment/>":var l={};n.vertical&&(l.vertical=n.vertical),n.horizontal&&(l.horizontal=n.horizontal),null!=n.textRotation&&(l.textRotation=n.textRotation),n.indent&&(l.indent=n.indent),n.wrapText&&(l.wrapText=jo(n.wrapText)),a.alignment=l;break;case"<AlternateContent":case"<ext":r=!0;break;case"</AlternateContent>":case"</ext>":r=!1;break;default:if(t&&t.WTF&&!r)throw new Error("unrecognized "+n[0]+" in cellXfs")}})}(c,o,l),o):o}}();var mu=vd;var hu=vd;var uu=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function xu(e,s,t){s.themeElements.clrScheme=[];var a={};(e[0].match(io)||[]).forEach(function(e){var r=oo(e);switch(r[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":a.rgb=r.val;break;case"<a:sysClr":a.rgb=r.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":"/"===r[0].charAt(1)?(s.themeElements.clrScheme[uu.indexOf(r[0])]=a,a={}):a.name=r[0].slice(3,r[0].length-1);break;default:if(t&&t.WTF)throw new Error("Unrecognized "+r[0]+" in clrScheme")}})}function pu(){}function fu(){}var gu=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,vu=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,ju=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;var yu=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function bu(e,s){var t,a;e&&0!==e.length||((t=[ao])[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",e=t.join(""));var r={};if(!(a=e.match(yu)))throw new Error("themeElements not found in theme");return function(e,s,t){var a;s.themeElements={},[["clrScheme",gu,xu],["fontScheme",vu,pu],["fmtScheme",ju,fu]].forEach(function(r){if(!(a=e.match(r[1])))throw new Error(r[0]+" not found in themeElements");r[2](a,s,t)})}(a[0],r,s),r.raw=e,r}function Nu(e){var s={};switch(s.xclrType=e.read_shift(2),s.nTintShade=e.read_shift(2),s.xclrType){case 0:case 4:e.l+=4;break;case 1:s.xclrValue=function(e,s){return vd(e,s)}(e,4);break;case 2:s.xclrValue=qm(e);break;case 3:s.xclrValue=function(e){return e.read_shift(4)}(e)}return e.l+=8,s}function wu(e){var s=e.read_shift(2),t=e.read_shift(2)-4,a=[s];switch(s){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:a[1]=Nu(e);break;case 6:a[1]=function(e,s){return vd(e,s)}(e,t);break;case 14:case 15:a[1]=e.read_shift(1===t?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+s+" "+t)}return a}function _u(e,s){s.forEach(function(e){e[0]})}function ku(e,s,t,a){var r,n=Array.isArray(e);s.forEach(function(s){var i=Ad(s.ref);if(n?(e[i.r]||(e[i.r]=[]),r=e[i.r][i.c]):r=e[s.ref],!r){r={t:"z"},n?e[i.r][i.c]=r:e[s.ref]=r;var l=Dd(e["!ref"]||"BDWGO1000001:A1");l.s.r>i.r&&(l.s.r=i.r),l.e.r<i.r&&(l.e.r=i.r),l.s.c>i.c&&(l.s.c=i.c),l.e.c<i.c&&(l.e.c=i.c);var c=Pd(l);c!==e["!ref"]&&(e["!ref"]=c)}r.c||(r.c=[]);var o={a:s.author,t:s.t,r:s.r,T:t};s.h&&(o.h=s.h);for(var d=r.c.length-1;d>=0;--d){if(!t&&r.c[d].T)return;t&&!r.c[d].T&&r.c.splice(d,1)}if(t&&a)for(d=0;d<a.length;++d)if(o.a==a[d].id){o.a=a[d].name||o.a;break}r.c.push(o)})}var Su=Ud;var Eu=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,s={r:0,c:0};function t(e,t,a,r){var n=!1,i=!1;0==a.length?i=!0:"["==a.charAt(0)&&(i=!0,a=a.slice(1,-1)),0==r.length?n=!0:"["==r.charAt(0)&&(n=!0,r=r.slice(1,-1));var l=a.length>0?0|parseInt(a,10):0,c=r.length>0?0|parseInt(r,10):0;return n?c+=s.c:--c,i?l+=s.r:--l,t+(n?"":"$")+Cd(c)+(i?"":"$")+Ed(l)}return function(a,r){return s=r,a.replace(e,t)}}(),Tu=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Cu=function(){return function(e,s){return e.replace(Tu,function(e,t,a,r,n,i){var l=Td(r)-(a?0:s.c),c=Sd(i)-(n?0:s.r);return t+"R"+(0==c?"":n?c+1:"["+c+"]")+"C"+(0==l?"":a?l+1:"["+l+"]")})}}();function Au(e,s){return e.replace(Tu,function(e,t,a,r,n,i){return t+("$"==a?a+r:Cd(Td(r)+s.c))+("$"==n?n+i:Ed(Sd(i)+s.r))})}function Ru(e,s,t){var a=Id(s).s,r=Ad(t);return Au(e,{r:r.r-a.r,c:r.c-a.c})}function Iu(e){return e.replace(/_xlfn\./g,"")}function Pu(e){e.l+=1}function Du(e,s){var t=e.read_shift(2);return[16383&t,t>>14&1,t>>15&1]}function Mu(e,s,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return Ou(e);12==t.biff&&(a=4)}var r=e.read_shift(a),n=e.read_shift(a),i=Du(e),l=Du(e);return{s:{r:r,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:l[0],cRel:l[1],rRel:l[2]}}}function Ou(e){var s=Du(e),t=Du(e),a=e.read_shift(1),r=e.read_shift(1);return{s:{r:s[0],c:a,cRel:s[1],rRel:s[2]},e:{r:t[0],c:r,cRel:t[1],rRel:t[2]}}}function Fu(e,s,t){if(t&&t.biff>=2&&t.biff<=5)return function(e){var s=Du(e),t=e.read_shift(1);return{r:s[0],c:t,cRel:s[1],rRel:s[2]}}(e);var a=e.read_shift(t&&12==t.biff?4:2),r=Du(e);return{r:a,c:r[0],cRel:r[1],rRel:r[2]}}function Lu(e){var s=e.read_shift(2),t=e.read_shift(2);return{r:s,c:255&t,fQuoted:!!(16384&t),cRel:t>>15,rRel:t>>15}}function zu(e){var s=1&e[e.l+1];return e.l+=4,[s,1]}function Uu(e){return[e.read_shift(1),e.read_shift(1)]}function Bu(e,s){var t=[e.read_shift(1)];if(12==s)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2}switch(t[0]){case 4:t[1]=Om(e,1)?"TRUE":"FALSE",12!=s&&(e.l+=7);break;case 37:case 16:t[1]=om[e[e.l]],e.l+=12==s?4:8;break;case 0:e.l+=8;break;case 1:t[1]=Qd(e);break;case 2:t[1]=Hm(e,0,{biff:s>0&&s<8?2:s});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function $u(e,s,t){for(var a=e.read_shift(12==t.biff?4:2),r=[],n=0;n!=a;++n)r.push((12==t.biff?Zd:Xm)(e));return r}function Hu(e,s,t){var a=0,r=0;12==t.biff?(a=e.read_shift(4),r=e.read_shift(4)):(r=1+e.read_shift(1),a=1+e.read_shift(2)),t.biff>=2&&t.biff<8&&(--a,0==--r&&(r=256));for(var n=0,i=[];n!=a&&(i[n]=[]);++n)for(var l=0;l!=r;++l)i[n][l]=Bu(e,t.biff);return i}function Vu(e,s,t){return e.l+=2,[Lu(e)]}function Gu(e){return e.l+=6,[]}function qu(e){return e.l+=2,[Fm(e),1&e.read_shift(2)]}var Wu=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];var Yu={1:{n:"PtgExp",f:function(e,s,t){return e.l++,t&&12==t.biff?[e.read_shift(4,"i"),0]:[e.read_shift(2),e.read_shift(t&&2==t.biff?1:2)]}},2:{n:"PtgTbl",f:vd},3:{n:"PtgAdd",f:Pu},4:{n:"PtgSub",f:Pu},5:{n:"PtgMul",f:Pu},6:{n:"PtgDiv",f:Pu},7:{n:"PtgPower",f:Pu},8:{n:"PtgConcat",f:Pu},9:{n:"PtgLt",f:Pu},10:{n:"PtgLe",f:Pu},11:{n:"PtgEq",f:Pu},12:{n:"PtgGe",f:Pu},13:{n:"PtgGt",f:Pu},14:{n:"PtgNe",f:Pu},15:{n:"PtgIsect",f:Pu},16:{n:"PtgUnion",f:Pu},17:{n:"PtgRange",f:Pu},18:{n:"PtgUplus",f:Pu},19:{n:"PtgUminus",f:Pu},20:{n:"PtgPercent",f:Pu},21:{n:"PtgParen",f:Pu},22:{n:"PtgMissArg",f:Pu},23:{n:"PtgStr",f:function(e,s,t){return e.l++,zm(e,0,t)}},26:{n:"PtgSheet",f:function(e,s,t){return e.l+=5,e.l+=2,e.l+=2==t.biff?1:4,["PTGSHEET"]}},27:{n:"PtgEndSheet",f:function(e,s,t){return e.l+=2==t.biff?4:5,["PTGENDSHEET"]}},28:{n:"PtgErr",f:function(e){return e.l++,om[e.read_shift(1)]}},29:{n:"PtgBool",f:function(e){return e.l++,0!==e.read_shift(1)}},30:{n:"PtgInt",f:function(e){return e.l++,e.read_shift(2)}},31:{n:"PtgNum",f:function(e){return e.l++,Qd(e)}},32:{n:"PtgArray",f:function(e,s,t){var a=(96&e[e.l++])>>5;return e.l+=2==t.biff?6:12==t.biff?14:7,[a]}},33:{n:"PtgFunc",f:function(e,s,t){var a=(96&e[e.l])>>5;e.l+=1;var r=e.read_shift(t&&t.biff<=3?1:2);return[px[r],xx[r],a]}},34:{n:"PtgFuncVar",f:function(e,s,t){var a=e[e.l++],r=e.read_shift(1),n=t&&t.biff<=3?[88==a?-1:0,e.read_shift(1)]:function(e){return[e[e.l+1]>>7,32767&e.read_shift(2)]}(e);return[r,(0===n[0]?xx:ux)[n[1]]]}},35:{n:"PtgName",f:function(e,s,t){var a=e.read_shift(1)>>>5&3,r=!t||t.biff>=8?4:2,n=e.read_shift(r);switch(t.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12}return[a,0,n]}},36:{n:"PtgRef",f:function(e,s,t){var a=(96&e[e.l])>>5;return e.l+=1,[a,Fu(e,0,t)]}},37:{n:"PtgArea",f:function(e,s,t){return[(96&e[e.l++])>>5,Mu(e,t.biff>=2&&t.biff,t)]}},38:{n:"PtgMemArea",f:function(e,s,t){var a=e.read_shift(1)>>>5&3;return e.l+=t&&2==t.biff?3:4,[a,e.read_shift(t&&2==t.biff?1:2)]}},39:{n:"PtgMemErr",f:vd},40:{n:"PtgMemNoMem",f:vd},41:{n:"PtgMemFunc",f:function(e,s,t){return[e.read_shift(1)>>>5&3,e.read_shift(t&&2==t.biff?1:2)]}},42:{n:"PtgRefErr",f:function(e,s,t){var a=e.read_shift(1)>>>5&3;return e.l+=4,t.biff<8&&e.l--,12==t.biff&&(e.l+=2),[a]}},43:{n:"PtgAreaErr",f:function(e,s,t){var a=(96&e[e.l++])>>5;return e.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}},44:{n:"PtgRefN",f:function(e,s,t){var a=(96&e[e.l])>>5;e.l+=1;var r=function(e,s,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return function(e){var s=e.read_shift(2),t=e.read_shift(1),a=(32768&s)>>15,r=(16384&s)>>14;return s&=16383,1==a&&s>=8192&&(s-=16384),1==r&&t>=128&&(t-=256),{r:s,c:t,cRel:r,rRel:a}}(e);var r=e.read_shift(a>=12?4:2),n=e.read_shift(2),i=(16384&n)>>14,l=(32768&n)>>15;if(n&=16383,1==l)for(;r>524287;)r-=1048576;if(1==i)for(;n>8191;)n-=16384;return{r:r,c:n,cRel:i,rRel:l}}(e,0,t);return[a,r]}},45:{n:"PtgAreaN",f:function(e,s,t){var a=(96&e[e.l++])>>5,r=function(e,s,t){if(t.biff<8)return Ou(e);var a=e.read_shift(12==t.biff?4:2),r=e.read_shift(12==t.biff?4:2),n=Du(e),i=Du(e);return{s:{r:a,c:n[0],cRel:n[1],rRel:n[2]},e:{r:r,c:i[0],cRel:i[1],rRel:i[2]}}}(e,0,t);return[a,r]}},46:{n:"PtgMemAreaN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},47:{n:"PtgMemNoMemN",f:function(e){return[e.read_shift(1)>>>5&3,e.read_shift(2)]}},57:{n:"PtgNameX",f:function(e,s,t){return 5==t.biff?function(e){var s=e.read_shift(1)>>>5&3,t=e.read_shift(2,"i");e.l+=8;var a=e.read_shift(2);return e.l+=12,[s,t,a]}(e):[e.read_shift(1)>>>5&3,e.read_shift(2),e.read_shift(4)]}},58:{n:"PtgRef3d",f:function(e,s,t){var a=(96&e[e.l])>>5;e.l+=1;var r=e.read_shift(2);return t&&5==t.biff&&(e.l+=12),[a,r,Fu(e,0,t)]}},59:{n:"PtgArea3d",f:function(e,s,t){var a=(96&e[e.l++])>>5,r=e.read_shift(2,"i");if(t)switch(t.biff){case 5:e.l+=12;break;case 12:0}return[a,r,Mu(e,0,t)]}},60:{n:"PtgRefErr3d",f:function(e,s,t){var a=(96&e[e.l++])>>5,r=e.read_shift(2),n=4;if(t)switch(t.biff){case 5:n=15;break;case 12:n=6}return e.l+=n,[a,r]}},61:{n:"PtgAreaErr3d",f:function(e,s,t){var a=(96&e[e.l++])>>5,r=e.read_shift(2),n=8;if(t)switch(t.biff){case 5:e.l+=12,n=6;break;case 12:n=12}return e.l+=n,[a,r]}},255:{}},Ku={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Ju={1:{n:"PtgElfLel",f:qu},2:{n:"PtgElfRw",f:Vu},3:{n:"PtgElfCol",f:Vu},6:{n:"PtgElfRwV",f:Vu},7:{n:"PtgElfColV",f:Vu},10:{n:"PtgElfRadical",f:Vu},11:{n:"PtgElfRadicalS",f:Gu},13:{n:"PtgElfColS",f:Gu},15:{n:"PtgElfColSV",f:Gu},16:{n:"PtgElfRadicalLel",f:qu},25:{n:"PtgList",f:function(e){e.l+=2;var s=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),r=e.read_shift(2),n=e.read_shift(2);return{ixti:s,coltype:3&t,rt:Wu[t>>2&31],idx:a,c:r,C:n}}},29:{n:"PtgSxName",f:function(e){return e.l+=2,[e.read_shift(4)]}},255:{}},Xu={0:{n:"PtgAttrNoop",f:function(e){return e.l+=4,[0,0]}},1:{n:"PtgAttrSemi",f:function(e,s,t){var a=255&e[e.l+1]?1:0;return e.l+=t&&2==t.biff?3:4,[a]}},2:{n:"PtgAttrIf",f:function(e,s,t){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(t&&2==t.biff?1:2)]}},4:{n:"PtgAttrChoose",f:function(e,s,t){e.l+=2;for(var a=e.read_shift(t&&2==t.biff?1:2),r=[],n=0;n<=a;++n)r.push(e.read_shift(t&&2==t.biff?1:2));return r}},8:{n:"PtgAttrGoto",f:function(e,s,t){var a=255&e[e.l+1]?1:0;return e.l+=2,[a,e.read_shift(t&&2==t.biff?1:2)]}},16:{n:"PtgAttrSum",f:function(e,s,t){e.l+=t&&2==t.biff?3:4}},32:{n:"PtgAttrBaxcel",f:zu},33:{n:"PtgAttrBaxcel",f:zu},64:{n:"PtgAttrSpace",f:function(e){return e.read_shift(2),Uu(e)}},65:{n:"PtgAttrSpaceSemi",f:function(e){return e.read_shift(2),Uu(e)}},128:{n:"PtgAttrIfError",f:function(e){var s=255&e[e.l+1]?1:0;return e.l+=2,[s,e.read_shift(2)]}},255:{}};function Zu(e,s,t,a){if(a.biff<8)return vd(e,s);for(var r=e.l+s,n=[],i=0;i!==t.length;++i)switch(t[i][0]){case"PtgArray":t[i][1]=Hu(e,0,a),n.push(t[i][1]);break;case"PtgMemArea":t[i][2]=$u(e,t[i][1],a),n.push(t[i][2]);break;case"PtgExp":a&&12==a.biff&&(t[i][1][1]=e.read_shift(4),n.push(t[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[i][0]}return 0!==(s=r-e.l)&&n.push(vd(e,s)),n}function Qu(e,s,t){for(var a,r,n=e.l+s,i=[];n!=e.l;)s=n-e.l,r=e[e.l],a=Yu[r]||Yu[Ku[r]],24!==r&&25!==r||(a=(24===r?Ju:Xu)[e[e.l+1]]),a&&a.f?i.push([a.n,a.f(e,s,t)]):vd(e,s);return i}function ex(e){for(var s=[],t=0;t<e.length;++t){for(var a=e[t],r=[],n=0;n<a.length;++n){var i=a[n];if(i)if(2===i[0])r.push('"'+i[1].replace(/"/g,'""')+'"');else r.push(i[1]);else r.push("")}s.push(r.join(","))}return s.join(";")}var sx={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function tx(e,s,t){if(!e)return"SH33TJSERR0";if(t.biff>8&&(!e.XTI||!e.XTI[s]))return e.SheetNames[s];if(!e.XTI)return"SH33TJSERR6";var a=e.XTI[s];if(t.biff<8)return s>1e4&&(s-=65536),s<0&&(s=-s),0==s?"":e.XTI[s-1];if(!a)return"SH33TJSERR1";var r="";if(t.biff>8)switch(e[a[0]][0]){case 357:return r=-1==a[1]?"#REF":e.SheetNames[a[1]],a[1]==a[2]?r:r+":"+e.SheetNames[a[2]];case 358:return null!=t.SID?e.SheetNames[t.SID]:"SH33TJSSAME"+e[a[0]][0];default:return"SH33TJSSRC"+e[a[0]][0]}switch(e[a[0]][0][0]){case 1025:return r=-1==a[1]?"#REF":e.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?r:r+":"+e.SheetNames[a[2]];case 14849:return e[a[0]].slice(1).map(function(e){return e.Name}).join(";;");default:return e[a[0]][0][3]?(r=-1==a[1]?"#REF":e[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?r:r+":"+e[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function ax(e,s,t){var a=tx(e,s,t);return"#REF"==a?a:function(e,s){if(!(e||s&&s.biff<=5&&s.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}(a,t)}function rx(e,s,t,a,r){var n,i,l,c,o=r&&r.biff||8,d={s:{c:0,r:0},e:{c:0,r:0}},m=[],h=0,u=0,x="";if(!e[0]||!e[0][0])return"";for(var p=-1,f="",g=0,v=e[0].length;g<v;++g){var j=e[0][g];switch(j[0]){case"PtgUminus":m.push("-"+m.pop());break;case"PtgUplus":m.push("+"+m.pop());break;case"PtgPercent":m.push(m.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(n=m.pop(),i=m.pop(),p>=0){switch(e[0][p][1][0]){case 0:f=$c(" ",e[0][p][1][1]);break;case 1:f=$c("\r",e[0][p][1][1]);break;default:if(f="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}i+=f,p=-1}m.push(i+sx[j[0]]+n);break;case"PtgIsect":n=m.pop(),i=m.pop(),m.push(i+" "+n);break;case"PtgUnion":n=m.pop(),i=m.pop(),m.push(i+","+n);break;case"PtgRange":n=m.pop(),i=m.pop(),m.push(i+":"+n);break;case"PtgAttrChoose":case"PtgAttrGoto":case"PtgAttrIf":case"PtgAttrIfError":case"PtgAttrBaxcel":case"PtgAttrSemi":case"PtgMemArea":case"PtgTbl":case"PtgMemErr":case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":case"PtgMemFunc":case"PtgMemNoMem":break;case"PtgRef":l=Nd(j[1][1],d,r),m.push(_d(l,o));break;case"PtgRefN":l=t?Nd(j[1][1],t,r):j[1][1],m.push(_d(l,o));break;case"PtgRef3d":h=j[1][1],l=Nd(j[1][2],d,r),x=ax(a,h,r),m.push(x+"!"+_d(l,o));break;case"PtgFunc":case"PtgFuncVar":var y=j[1][0],b=j[1][1];y||(y=0);var N=0==(y&=127)?[]:m.slice(-y);m.length-=y,"User"===b&&(b=N.shift()),m.push(b+"("+N.join(",")+")");break;case"PtgBool":m.push(j[1]?"TRUE":"FALSE");break;case"PtgInt":case"PtgErr":m.push(j[1]);break;case"PtgNum":m.push(String(j[1]));break;case"PtgStr":m.push('"'+j[1].replace(/"/g,'""')+'"');break;case"PtgAreaN":c=wd(j[1][1],t?{s:t}:d,r),m.push(kd(c,r));break;case"PtgArea":c=wd(j[1][1],d,r),m.push(kd(c,r));break;case"PtgArea3d":h=j[1][1],c=j[1][2],x=ax(a,h,r),m.push(x+"!"+kd(c,r));break;case"PtgAttrSum":m.push("SUM("+m.pop()+")");break;case"PtgName":u=j[1][2];var w=(a.names||[])[u-1]||(a[0]||[])[u],_=w?w.Name:"SH33TJSNAME"+String(u);_&&"_xlfn."==_.slice(0,6)&&!r.xlfn&&(_=_.slice(6)),m.push(_);break;case"PtgNameX":var k,S=j[1][1];if(u=j[1][2],!(r.biff<=5)){var E="";if(14849==((a[S]||[])[0]||[])[0]||(1025==((a[S]||[])[0]||[])[0]?a[S][u]&&a[S][u].itab>0&&(E=a.SheetNames[a[S][u].itab-1]+"!"):E=a.SheetNames[u-1]+"!"),a[S]&&a[S][u])E+=a[S][u].Name;else if(a[0]&&a[0][u])E+=a[0][u].Name;else{var T=(tx(a,S,r)||"").split(";;");T[u-1]?E=T[u-1]:E+="SH33TJSERRX"}m.push(E);break}S<0&&(S=-S),a[S]&&(k=a[S][u]),k||(k={Name:"SH33TJSERRY"}),m.push(k.Name);break;case"PtgParen":var C="(",A=")";if(p>=0){switch(f="",e[0][p][1][0]){case 2:C=$c(" ",e[0][p][1][1])+C;break;case 3:C=$c("\r",e[0][p][1][1])+C;break;case 4:A=$c(" ",e[0][p][1][1])+A;break;case 5:A=$c("\r",e[0][p][1][1])+A;break;default:if(r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][p][1][0])}p=-1}m.push(C+m.pop()+A);break;case"PtgRefErr":case"PtgRefErr3d":case"PtgAreaErr":case"PtgAreaErr3d":m.push("#REF!");break;case"PtgExp":l={c:j[1][1],r:j[1][0]};var R={c:t.c,r:t.r};if(a.sharedf[Rd(l)]){var I=a.sharedf[Rd(l)];m.push(rx(I,d,R,a,r))}else{var P=!1;for(n=0;n!=a.arrayf.length;++n)if(i=a.arrayf[n],!(l.c<i[0].s.c||l.c>i[0].e.c||l.r<i[0].s.r||l.r>i[0].e.r)){m.push(rx(i[1],d,R,a,r)),P=!0;break}P||m.push(j[1])}break;case"PtgArray":m.push("{"+ex(j[1])+"}");break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":p=g;break;case"PtgMissArg":m.push("");break;case"PtgList":m.push("Table"+j[1].idx+"[#"+j[1].rt+"]");break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");default:throw new Error("Unrecognized Formula Token: "+String(j))}if(3!=r.biff&&p>=0&&-1==["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"].indexOf(e[0][g][0])){var D=!0;switch((j=e[0][p])[1][0]){case 4:D=!1;case 0:f=$c(" ",j[1][1]);break;case 5:D=!1;case 1:f=$c("\r",j[1][1]);break;default:if(f="",r.WTF)throw new Error("Unexpected PtgAttrSpaceType "+j[1][0])}m.push((D?f:"")+m.pop()+(D?"":f)),p=-1}}if(m.length>1&&r.WTF)throw new Error("bad formula stack");return m[0]}function nx(e,s,t){var a,r=e.l+s,n=2==t.biff?1:2,i=e.read_shift(n);if(65535==i)return[[],vd(e,s-2)];var l=Qu(e,i,t);return s!==i+n&&(a=Zu(e,s-i-n,l,t)),e.l=r,[l,a]}function ix(e,s,t){var a,r=e.l+s,n=e.read_shift(2),i=Qu(e,n,t);return 65535==n?[[],vd(e,s-2)]:(s!==n+2&&(a=Zu(e,r-n-2,i,t)),[i,a])}function lx(e,s,t){var a=e.l+s,r=Ym(e);2==t.biff&&++e.l;var n=function(e){var s;if(65535!==id(e,e.l+6))return[Qd(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return s=1===e[e.l+2],e.l+=8,[s,"b"];case 2:return s=e[e.l+2],e.l+=8,[s,"e"];case 3:return e.l+=8,["","s"]}return[]}(e),i=e.read_shift(1);2!=t.biff&&(e.read_shift(1),t.biff>=5&&e.read_shift(4));var l=function(e,s,t){var a,r=e.l+s,n=2==t.biff?1:2,i=e.read_shift(n);if(65535==i)return[[],vd(e,s-2)];var l=Qu(e,i,t);return s!==i+n&&(a=Zu(e,s-i-n,l,t)),e.l=r,[l,a]}(e,a-e.l,t);return{cell:r,val:n[0],formula:l,shared:i>>3&1,tt:n[1]}}function cx(e,s,t){var a=e.read_shift(4),r=Qu(e,a,t),n=e.read_shift(4);return[r,n>0?Zu(e,n,r,t):null]}var ox=cx,dx=cx,mx=cx,hx=cx,ux={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},xx={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},px={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function fx(e){return"of:"==e.slice(0,3)&&(e=e.slice(3)),61==e.charCodeAt(0)&&61==(e=e.slice(1)).charCodeAt(0)&&(e=e.slice(1)),(e=(e=(e=e.replace(/COM\.MICROSOFT\./g,"")).replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(e,s){return s.replace(/\./g,"")})).replace(/\[.(#[A-Z]*[?!])\]/g,"$1")).replace(/[;~]/g,",").replace(/\|/g,";")}function gx(e){var s=e.split(":");return[s[0].split(".")[0],s[0].split(".")[1]+(s.length>1?":"+(s[1].split(".")[1]||s[1].split(".")[0]):"")]}var vx={},jx={};function yx(e,s){if(e){var t=[.7,.7,.75,.75,.3,.3];"xlml"==s&&(t=[1,1,1,1,.5,.5]),null==e.left&&(e.left=t[0]),null==e.right&&(e.right=t[1]),null==e.top&&(e.top=t[2]),null==e.bottom&&(e.bottom=t[3]),null==e.header&&(e.header=t[4]),null==e.footer&&(e.footer=t[5])}}function bx(e,s,t,a,r,n){try{a.cellNF&&(e.z=$l[s])}catch(l){if(a.WTF)throw l}if("z"!==e.t||a.cellStyles){if("d"===e.t&&"string"==typeof e.v&&(e.v=zc(e.v)),(!a||!1!==a.cellText)&&"z"!==e.t)try{if(null==$l[s]&&bc(wc[s]||"General",s),"e"===e.t)e.w=e.w||om[e.v];else if(0===s)if("n"===e.t)(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Zl(e.v);else if("d"===e.t){var i=Ac(e.v);e.w=(0|i)===i?i.toString(10):Zl(i)}else{if(void 0===e.v)return"";e.w=Ql(e.v,jx)}else"d"===e.t?e.w=yc(s,Ac(e.v),jx):e.w=yc(s,e.v,jx)}catch(l){if(a.WTF)throw l}if(a.cellStyles&&null!=t)try{e.s=n.Fills[t],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=Jh(r.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),a.WTF&&(e.s.fgColor.raw_rgb=r.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=Jh(r.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),a.WTF&&(e.s.bgColor.raw_rgb=r.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(l){if(a.WTF&&n.Fills)throw l}}}var Nx=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,wx=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,_x=/<(?:\w:)?hyperlink [^>]*>/gm,kx=/"(\w*:\w*)"/,Sx=/<(?:\w:)?col\b[^>]*[\/]?>/g,Ex=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Tx=/<(?:\w:)?pageMargins[^>]*\/>/g,Cx=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Ax=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Rx=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Ix(e,s,t,a,r,n,i){if(!e)return e;a||(a={"!id":{}});var l=s.dense?[]:{},c={s:{r:2e6,c:2e6},e:{r:0,c:0}},o="",d="",m=e.match(wx);m?(o=e.slice(0,m.index),d=e.slice(m.index+m[0].length)):o=d=e;var h=o.match(Cx);h?Px(h[0],l,r,t):(h=o.match(Ax))&&function(e,s,t,a,r){Px(e.slice(0,e.indexOf(">")),t,a,r)}(h[0],h[1],l,r,t);var u=(o.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(u>0){var x=o.slice(u,u+50).match(kx);x&&function(e,s){var t=Dd(s);t.s.r<=t.e.r&&t.s.c<=t.e.c&&t.s.r>=0&&t.s.c>=0&&(e["!ref"]=Pd(t))}(l,x[1])}var p=o.match(Rx);p&&p[1]&&function(e,s){s.Views||(s.Views=[{}]);(e.match(Dx)||[]).forEach(function(e,t){var a=oo(e);s.Views[t]||(s.Views[t]={}),+a.zoomScale&&(s.Views[t].zoom=+a.zoomScale),jo(a.rightToLeft)&&(s.Views[t].RTL=!0)})}(p[1],r);var f=[];if(s.cellStyles){var g=o.match(Sx);g&&function(e,s){for(var t=!1,a=0;a!=s.length;++a){var r=oo(s[a],!0);r.hidden&&(r.hidden=jo(r.hidden));var n=parseInt(r.min,10)-1,i=parseInt(r.max,10)-1;for(r.outlineLevel&&(r.level=+r.outlineLevel||0),delete r.min,delete r.max,r.width=+r.width,!t&&r.width&&(t=!0,tu(r.width)),au(r);n<=i;)e[n++]=Bc(r)}}(f,g)}m&&Mx(m[1],l,s,c,n,i);var v=d.match(Ex);v&&(l["!autofilter"]=function(e){var s={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return s}(v[0]));var j=[],y=d.match(Nx);if(y)for(u=0;u!=y.length;++u)j[u]=Dd(y[u].slice(y[u].indexOf('"')+1));var b=d.match(_x);b&&function(e,s,t){for(var a=Array.isArray(e),r=0;r!=s.length;++r){var n=oo(_o(s[r]),!0);if(!n.ref)return;var i=((t||{})["!id"]||[])[n.id];i?(n.Target=i.Target,n.location&&(n.Target+="#"+xo(n.location))):(n.Target="#"+xo(n.location),i={Target:n.Target,TargetMode:"Internal"}),n.Rel=i,n.tooltip&&(n.Tooltip=n.tooltip,delete n.tooltip);for(var l=Dd(n.ref),c=l.s.r;c<=l.e.r;++c)for(var o=l.s.c;o<=l.e.c;++o){var d=Rd({c:o,r:c});a?(e[c]||(e[c]=[]),e[c][o]||(e[c][o]={t:"z",v:void 0}),e[c][o].l=n):(e[d]||(e[d]={t:"z",v:void 0}),e[d].l=n)}}}(l,b,a);var N,w,_=d.match(Tx);if(_&&(l["!margins"]=(N=oo(_[0]),w={},["left","right","top","bottom","header","footer"].forEach(function(e){N[e]&&(w[e]=parseFloat(N[e]))}),w)),!l["!ref"]&&c.e.c>=c.s.c&&c.e.r>=c.s.r&&(l["!ref"]=Pd(c)),s.sheetRows>0&&l["!ref"]){var k=Dd(l["!ref"]);s.sheetRows<=+k.e.r&&(k.e.r=s.sheetRows-1,k.e.r>c.e.r&&(k.e.r=c.e.r),k.e.r<k.s.r&&(k.s.r=k.e.r),k.e.c>c.e.c&&(k.e.c=c.e.c),k.e.c<k.s.c&&(k.s.c=k.e.c),l["!fullref"]=l["!ref"],l["!ref"]=Pd(k))}return f.length>0&&(l["!cols"]=f),j.length>0&&(l["!merges"]=j),l}function Px(e,s,t,a){var r=oo(e);t.Sheets[a]||(t.Sheets[a]={}),r.codeName&&(t.Sheets[a].CodeName=xo(_o(r.codeName)))}var Dx=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;var Mx=function(){var e=/<(?:\w+:)?c[ \/>]/,s=/<\/(?:\w+:)?row>/,t=/r=["']([^"']*)["']/,a=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,r=/ref=["']([^"']*)["']/,n=So("v"),i=So("f");return function(l,c,o,d,m,h){for(var u,x,p,f,g,v=0,j="",y=[],b=[],N=0,w=0,_=0,k="",S=0,E=0,T=0,C=0,A=Array.isArray(h.CellXf),R=[],I=[],P=Array.isArray(c),D=[],M={},O=!1,F=!!o.sheetStubs,L=l.split(s),z=0,U=L.length;z!=U;++z){var B=(j=L[z].trim()).length;if(0!==B){var $=0;e:for(v=0;v<B;++v)switch(j[v]){case">":if("/"!=j[v-1]){++v;break e}if(o&&o.cellStyles){if(S=null!=(x=oo(j.slice($,v),!0)).r?parseInt(x.r,10):S+1,E=-1,o.sheetRows&&o.sheetRows<S)continue;M={},O=!1,x.ht&&(O=!0,M.hpt=parseFloat(x.ht),M.hpx=iu(M.hpt)),"1"==x.hidden&&(O=!0,M.hidden=!0),null!=x.outlineLevel&&(O=!0,M.level=+x.outlineLevel),O&&(D[S-1]=M)}break;case"<":$=v}if($>=v)break;if(S=null!=(x=oo(j.slice($,v),!0)).r?parseInt(x.r,10):S+1,E=-1,!(o.sheetRows&&o.sheetRows<S)){d.s.r>S-1&&(d.s.r=S-1),d.e.r<S-1&&(d.e.r=S-1),o&&o.cellStyles&&(M={},O=!1,x.ht&&(O=!0,M.hpt=parseFloat(x.ht),M.hpx=iu(M.hpt)),"1"==x.hidden&&(O=!0,M.hidden=!0),null!=x.outlineLevel&&(O=!0,M.level=+x.outlineLevel),O&&(D[S-1]=M)),y=j.slice(v).split(e);for(var H=0;H!=y.length&&"<"==y[H].trim().charAt(0);++H);for(y=y.slice(H),v=0;v!=y.length;++v)if(0!==(j=y[v].trim()).length){if(b=j.match(t),N=v,w=0,_=0,j="<c "+("<"==j.slice(0,1)?">":"")+j,null!=b&&2===b.length){for(N=0,k=b[1],w=0;w!=k.length&&!((_=k.charCodeAt(w)-64)<1||_>26);++w)N=26*N+_;E=--N}else++E;for(w=0;w!=j.length&&62!==j.charCodeAt(w);++w);if(++w,(x=oo(j.slice(0,w),!0)).r||(x.r=Rd({r:S-1,c:E})),u={t:""},null!=(b=(k=j.slice(w)).match(n))&&""!==b[1]&&(u.v=xo(b[1])),o.cellFormula){if(null!=(b=k.match(i))&&""!==b[1]){if(u.f=xo(_o(b[1])).replace(/\r\n/g,"\n"),o.xlfn||(u.f=Iu(u.f)),b[0].indexOf('t="array"')>-1)u.F=(k.match(r)||[])[1],u.F.indexOf(":")>-1&&R.push([Dd(u.F),u.F]);else if(b[0].indexOf('t="shared"')>-1){f=oo(b[0]);var V=xo(_o(b[1]));o.xlfn||(V=Iu(V)),I[parseInt(f.si,10)]=[f,V,x.r]}}else(b=k.match(/<f[^>]*\/>/))&&I[(f=oo(b[0])).si]&&(u.f=Ru(I[f.si][1],I[f.si][2],x.r));var G=Ad(x.r);for(w=0;w<R.length;++w)G.r>=R[w][0].s.r&&G.r<=R[w][0].e.r&&G.c>=R[w][0].s.c&&G.c<=R[w][0].e.c&&(u.F=R[w][1])}if(null==x.t&&void 0===u.v)if(u.f||u.F)u.v=0,u.t="n";else{if(!F)continue;u.t="z"}else u.t=x.t||"n";switch(d.s.c>E&&(d.s.c=E),d.e.c<E&&(d.e.c=E),u.t){case"n":if(""==u.v||null==u.v){if(!F)continue;u.t="z"}else u.v=parseFloat(u.v);break;case"s":if(void 0===u.v){if(!F)continue;u.t="z"}else p=vx[parseInt(u.v,10)],u.v=p.t,u.r=p.r,o.cellHTML&&(u.h=p.h);break;case"str":u.t="s",u.v=null!=u.v?_o(u.v):"",o.cellHTML&&(u.h=go(u.v));break;case"inlineStr":b=k.match(a),u.t="s",null!=b&&(p=Rh(b[1]))?(u.v=p.t,o.cellHTML&&(u.h=p.h)):u.v="";break;case"b":u.v=jo(u.v);break;case"d":o.cellDates?u.v=zc(u.v,1):(u.v=Ac(zc(u.v,1)),u.t="n");break;case"e":o&&!1===o.cellText||(u.w=u.v),u.v=dm[u.v]}if(T=C=0,g=null,A&&void 0!==x.s&&null!=(g=h.CellXf[x.s])&&(null!=g.numFmtId&&(T=g.numFmtId),o.cellStyles&&null!=g.fillId&&(C=g.fillId)),bx(u,T,C,o,m,h),o.cellDates&&A&&"n"==u.t&&fc($l[T])&&(u.t="d",u.v=Dc(u.v)),x.cm&&o.xlmeta){var q=(o.xlmeta.Cell||[])[+x.cm-1];q&&"XLDAPR"==q.type&&(u.D=!0)}if(P){var W=Ad(x.r);c[W.r]||(c[W.r]=[]),c[W.r][W.c]=u}else c[x.r]=u}}}}D.length>0&&(c["!rows"]=D)}}();var Ox=Zd;function Fx(e){return[Gd(e),Qd(e),"n"]}var Lx=Zd;var zx=["left","right","top","bottom","header","footer"];function Ux(e,s,t,a,r,n){var i=n||{"!type":"chart"};if(!e)return n;var l=0,c=0,o="A",d={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(e){var s=function(e){var s,t=[],a=e.match(/^<c:numCache>/);(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/gm)||[]).forEach(function(e){var s=e.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);s&&(t[+s[1]]=a?+s[2]:s[2])});var r=xo((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/gm)||[]).forEach(function(e){s=e.replace(/<.*?>/g,"")}),[t,r,s]}(e);d.s.r=d.s.c=0,d.e.c=l,o=Cd(l),s[0].forEach(function(e,t){i[o+Ed(t)]={t:"n",v:e,z:s[1]},c=t}),d.e.r<c&&(d.e.r=c),++l}),l>0&&(i["!ref"]=Pd(d)),i}var Bx=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],$x=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Hx=[],Vx=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function Gx(e,s){for(var t=0;t!=e.length;++t)for(var a=e[t],r=0;r!=s.length;++r){var n=s[r];if(null==a[n[0]])a[n[0]]=n[1];else switch(n[2]){case"bool":"string"==typeof a[n[0]]&&(a[n[0]]=jo(a[n[0]]));break;case"int":"string"==typeof a[n[0]]&&(a[n[0]]=parseInt(a[n[0]],10))}}}function qx(e,s){for(var t=0;t!=s.length;++t){var a=s[t];if(null==e[a[0]])e[a[0]]=a[1];else switch(a[2]){case"bool":"string"==typeof e[a[0]]&&(e[a[0]]=jo(e[a[0]]));break;case"int":"string"==typeof e[a[0]]&&(e[a[0]]=parseInt(e[a[0]],10))}}}function Wx(e){qx(e.WBProps,Bx),qx(e.CalcPr,Vx),Gx(e.WBView,$x),Gx(e.Sheets,Hx),jx.date1904=jo(e.WBProps.date1904)}var Yx="][*?/\\".split("");var Kx=/<\w+:workbook/;function Jx(e,s){var t={};return e.read_shift(4),t.ArchID=e.read_shift(4),e.l+=s-8,t}function Xx(e,s,t){return".bin"===s.slice(-4)?function(e,s){var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},a=[],r=!1;s||(s={}),s.biff=12;var n=[],i=[[]];return i.SheetNames=[],i.XTI=[],Ep[16]={n:"BrtFRTArchID$",f:Jx},yd(e,function(e,l,c){switch(c){case 156:i.SheetNames.push(e.name),t.Sheets.push(e);break;case 153:t.WBProps=e;break;case 39:null!=e.Sheet&&(s.SID=e.Sheet),e.Ref=rx(e.Ptg,0,null,i,s),delete s.SID,delete e.Ptg,n.push(e);break;case 1036:case 361:case 2071:case 158:case 143:case 664:case 353:case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:case 16:break;case 357:case 358:case 355:case 667:i[0].length?i.push([c,e]):i[0]=[c,e],i[i.length-1].XTI=[];break;case 362:0===i.length&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(e),i.XTI=i.XTI.concat(e);break;case 35:case 37:a.push(c),r=!0;break;case 36:case 38:a.pop(),r=!1;break;default:if(l.T);else if(!r||s.WTF&&37!=a[a.length-1]&&35!=a[a.length-1])throw new Error("Unexpected record 0x"+c.toString(16))}},s),Wx(t),t.Names=n,t.supbooks=i,t}(e,t):function(e,s){if(!e)throw new Error("Could not find file");var t={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},a=!1,r="xmlns",n={},i=0;if(e.replace(io,function(l,c){var o=oo(l);switch(mo(o[0])){case"<?xml":case"</workbook>":case"<fileVersion/>":case"</fileVersion>":case"<fileSharing":case"<fileSharing/>":case"</workbookPr>":case"<workbookProtection":case"<workbookProtection/>":case"<bookViews":case"<bookViews>":case"</bookViews>":case"</workbookView>":case"<sheets":case"<sheets>":case"</sheets>":case"</sheet>":case"<functionGroups":case"<functionGroups/>":case"<functionGroup":case"<externalReferences":case"</externalReferences>":case"<externalReferences>":case"<externalReference":case"<definedNames/>":case"<definedName/>":case"</calcPr>":case"<oleSize":case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":case"<customWorkbookView":case"</customWorkbookView>":case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":case"<pivotCache":case"<smartTagPr":case"<smartTagPr/>":case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":case"<smartTagType":case"<webPublishing":case"<webPublishing/>":case"<fileRecoveryPr":case"<fileRecoveryPr/>":case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":case"<webPublishObject":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":case"<ArchID":case"<revisionPtr":break;case"<workbook":l.match(Kx)&&(r="xmlns"+l.match(/<(\w+):/)[1]),t.xmlns=o[r];break;case"<fileVersion":delete o[0],t.AppVersion=o;break;case"<workbookPr":case"<workbookPr/>":Bx.forEach(function(e){if(null!=o[e[0]])switch(e[2]){case"bool":t.WBProps[e[0]]=jo(o[e[0]]);break;case"int":t.WBProps[e[0]]=parseInt(o[e[0]],10);break;default:t.WBProps[e[0]]=o[e[0]]}}),o.codeName&&(t.WBProps.CodeName=_o(o.codeName));break;case"<workbookView":case"<workbookView/>":delete o[0],t.WBView.push(o);break;case"<sheet":switch(o.state){case"hidden":o.Hidden=1;break;case"veryHidden":o.Hidden=2;break;default:o.Hidden=0}delete o.state,o.name=xo(_o(o.name)),delete o[0],t.Sheets.push(o);break;case"<definedNames>":case"<definedNames":case"<ext":case"<AlternateContent":case"<AlternateContent>":a=!0;break;case"</definedNames>":case"</ext>":case"</AlternateContent>":a=!1;break;case"<definedName":(n={}).Name=_o(o.name),o.comment&&(n.Comment=o.comment),o.localSheetId&&(n.Sheet=+o.localSheetId),jo(o.hidden||"0")&&(n.Hidden=!0),i=c+l.length;break;case"</definedName>":n.Ref=xo(_o(e.slice(i,c))),t.Names.push(n);break;case"<calcPr":case"<calcPr/>":delete o[0],t.CalcPr=o;break;default:if(!a&&s.WTF)throw new Error("unrecognized "+o[0]+" in workbook")}return l}),-1===Fo.indexOf(t.xmlns))throw new Error("Unknown Namespace: "+t.xmlns);return Wx(t),t}(e,t)}function Zx(e,s,t,a,r,n,i,l){return".bin"===s.slice(-4)?function(e,s,t,a,r,n,i){if(!e)return e;var l=s||{};a||(a={"!id":{}});var c,o,d,m,h,u,x,p,f,g,v=l.dense?[]:{},j={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=!1,b=!1,N=[];l.biff=12,l["!row"]=0;var w=0,_=!1,k=[],S={},E=l.supbooks||r.supbooks||[[]];if(E.sharedf=S,E.arrayf=k,E.SheetNames=r.SheetNames||r.Sheets.map(function(e){return e.name}),!l.supbooks&&(l.supbooks=E,r.Names))for(var T=0;T<r.Names.length;++T)E[0][T+1]=r.Names[T];var C,A=[],R=[],I=!1;if(Ep[16]={n:"BrtShortReal",f:Fx},yd(e,function(e,s,T){if(!b)switch(T){case 148:c=e;break;case 0:o=e,l.sheetRows&&l.sheetRows<=o.r&&(b=!0),f=Ed(h=o.r),l["!row"]=o.r,(e.hidden||e.hpt||null!=e.level)&&(e.hpt&&(e.hpx=iu(e.hpt)),R[e.r]=e);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(d={t:e[2]},e[2]){case"n":d.v=e[1];break;case"s":p=vx[e[1]],d.v=p.t,d.r=p.r;break;case"b":d.v=!!e[1];break;case"e":d.v=e[1],!1!==l.cellText&&(d.w=om[d.v]);break;case"str":d.t="s",d.v=e[1];break;case"is":d.t="s",d.v=e[1].t}if((m=i.CellXf[e[0].iStyleRef])&&bx(d,m.numFmtId,null,l,n,i),u=-1==e[0].c?u+1:e[0].c,l.dense?(v[h]||(v[h]=[]),v[h][u]=d):v[Cd(u)+f]=d,l.cellFormula){for(_=!1,w=0;w<k.length;++w){var P=k[w];o.r>=P[0].s.r&&o.r<=P[0].e.r&&u>=P[0].s.c&&u<=P[0].e.c&&(d.F=Pd(P[0]),_=!0)}!_&&e.length>3&&(d.f=e[3])}if(j.s.r>o.r&&(j.s.r=o.r),j.s.c>u&&(j.s.c=u),j.e.r<o.r&&(j.e.r=o.r),j.e.c<u&&(j.e.c=u),l.cellDates&&m&&"n"==d.t&&fc($l[m.numFmtId])){var D=ql(d.v);D&&(d.t="d",d.v=new Date(D.y,D.m-1,D.d,D.H,D.M,D.S,D.u))}C&&("XLDAPR"==C.type&&(d.D=!0),C=void 0);break;case 1:case 12:if(!l.sheetStubs||y)break;d={t:"z",v:void 0},u=-1==e[0].c?u+1:e[0].c,l.dense?(v[h]||(v[h]=[]),v[h][u]=d):v[Cd(u)+f]=d,j.s.r>o.r&&(j.s.r=o.r),j.s.c>u&&(j.s.c=u),j.e.r<o.r&&(j.e.r=o.r),j.e.c<u&&(j.e.c=u),C&&("XLDAPR"==C.type&&(d.D=!0),C=void 0);break;case 176:N.push(e);break;case 49:C=((l.xlmeta||{}).Cell||[])[e-1];break;case 494:var M=a["!id"][e.relId];for(M?(e.Target=M.Target,e.loc&&(e.Target+="#"+e.loc),e.Rel=M):""==e.relId&&(e.Target="#"+e.loc),h=e.rfx.s.r;h<=e.rfx.e.r;++h)for(u=e.rfx.s.c;u<=e.rfx.e.c;++u)l.dense?(v[h]||(v[h]=[]),v[h][u]||(v[h][u]={t:"z",v:void 0}),v[h][u].l=e):(x=Rd({c:u,r:h}),v[x]||(v[x]={t:"z",v:void 0}),v[x].l=e);break;case 426:if(!l.cellFormula)break;k.push(e),(g=l.dense?v[h][u]:v[Cd(u)+f]).f=rx(e[1],0,{r:o.r,c:u},E,l),g.F=Pd(e[0]);break;case 427:if(!l.cellFormula)break;S[Rd(e[0].s)]=e[1],(g=l.dense?v[h][u]:v[Cd(u)+f]).f=rx(e[1],0,{r:o.r,c:u},E,l);break;case 60:if(!l.cellStyles)break;for(;e.e>=e.s;)A[e.e--]={width:e.w/256,hidden:!!(1&e.flags),level:e.level},I||(I=!0,tu(e.w/256)),au(A[e.e+1]);break;case 161:v["!autofilter"]={ref:Pd(e)};break;case 476:v["!margins"]=e;break;case 147:r.Sheets[t]||(r.Sheets[t]={}),e.name&&(r.Sheets[t].CodeName=e.name),(e.above||e.left)&&(v["!outline"]={above:e.above,left:e.left});break;case 137:r.Views||(r.Views=[{}]),r.Views[0]||(r.Views[0]={}),e.RTL&&(r.Views[0].RTL=!0);break;case 485:case 64:case 1053:case 151:case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:case 37:y=!0;break;case 36:case 38:y=!1;break;default:if(s.T);else if(!y||l.WTF)throw new Error("Unexpected record 0x"+T.toString(16))}},l),delete l.supbooks,delete l["!row"],!v["!ref"]&&(j.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(v["!ref"]=Pd(c||j)),l.sheetRows&&v["!ref"]){var P=Dd(v["!ref"]);l.sheetRows<=+P.e.r&&(P.e.r=l.sheetRows-1,P.e.r>j.e.r&&(P.e.r=j.e.r),P.e.r<P.s.r&&(P.s.r=P.e.r),P.e.c>j.e.c&&(P.e.c=j.e.c),P.e.c<P.s.c&&(P.s.c=P.e.c),v["!fullref"]=v["!ref"],v["!ref"]=Pd(P))}return N.length>0&&(v["!merges"]=N),A.length>0&&(v["!cols"]=A),R.length>0&&(v["!rows"]=R),v}(e,a,t,r,n,i,l):Ix(e,a,t,r,n,i,l)}function Qx(e,s,t,a,r,n,i,l){return".bin"===s.slice(-4)?function(e,s,t,a,r){if(!e)return e;a||(a={"!id":{}});var n={"!type":"chart","!drawel":null,"!rel":""},i=!1;return yd(e,function(e,a,l){switch(l){case 550:n["!rel"]=e;break;case 651:r.Sheets[t]||(r.Sheets[t]={}),e.name&&(r.Sheets[t].CodeName=e.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:case 37:case 38:break;case 35:i=!0;break;case 36:i=!1;break;default:if(a.T>0);else if(a.T<0);else if(!i||s.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}},s),a["!id"][n["!rel"]]&&(n["!drawel"]=a["!id"][n["!rel"]]),n}(e,a,t,r,n):function(e,s,t,a,r){if(!e)return e;a||(a={"!id":{}});var n,i={"!type":"chart","!drawel":null,"!rel":""},l=e.match(Cx);return l&&Px(l[0],0,r,t),(n=e.match(/drawing r:id="(.*?)"/))&&(i["!rel"]=n[1]),a["!id"][i["!rel"]]&&(i["!drawel"]=a["!id"][i["!rel"]]),i}(e,0,t,r,n)}function ep(e,s,t,a){return".bin"===s.slice(-4)?function(e,s,t){var a={NumberFmt:[]};for(var r in $l)a.NumberFmt[r]=$l[r];a.CellXf=[],a.Fonts=[];var n=[],i=!1;return yd(e,function(e,r,l){switch(l){case 44:a.NumberFmt[e[0]]=e[1],bc(e[1],e[0]);break;case 43:a.Fonts.push(e),null!=e.color.theme&&s&&s.themeElements&&s.themeElements.clrScheme&&(e.color.rgb=Jh(s.themeElements.clrScheme[e.color.theme].rgb,e.color.tint||0));break;case 1025:case 45:case 46:case 48:case 507:case 572:case 475:case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 47:617==n[n.length-1]&&a.CellXf.push(e);break;case 35:i=!0;break;case 36:i=!1;break;case 37:n.push(l),i=!0;break;case 38:n.pop(),i=!1;break;default:if(r.T>0)n.push(l);else if(r.T<0)n.pop();else if(!i||t.WTF&&37!=n[n.length-1])throw new Error("Unexpected record 0x"+l.toString(16))}}),a}(e,t,a):du(e,t,a)}function sp(e,s,t){return".bin"===s.slice(-4)?function(e,s){var t=[],a=!1;return yd(e,function(e,r,n){switch(n){case 159:t.Count=e[0],t.Unique=e[1];break;case 19:t.push(e);break;case 160:return!0;case 35:a=!0;break;case 36:a=!1;break;default:if(r.T,!a||s.WTF)throw new Error("Unexpected record 0x"+n.toString(16))}}),t}(e,t):function(e,s){var t=[],a="";if(!e)return t;var r=e.match(Ih);if(r){a=r[2].replace(Ph,"").split(Dh);for(var n=0;n!=a.length;++n){var i=Rh(a[n].trim(),s);null!=i&&(t[t.length]=i)}r=oo(r[1]),t.Count=r.count,t.Unique=r.uniqueCount}return t}(e,t)}function tp(e,s,t){return".bin"===s.slice(-4)?function(e,s){var t=[],a=[],r={},n=!1;return yd(e,function(e,i,l){switch(l){case 632:a.push(e);break;case 635:r=e;break;case 637:r.t=e.t,r.h=e.h,r.r=e.r;break;case 636:if(r.author=a[r.iauthor],delete r.iauthor,s.sheetRows&&r.rfx&&s.sheetRows<=r.rfx.r)break;r.t||(r.t=""),delete r.rfx,t.push(r);break;case 3072:case 37:case 38:break;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T);else if(!n||s.WTF)throw new Error("Unexpected record 0x"+l.toString(16))}}),t}(e,t):function(e,s){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var t=[],a=[],r=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);r&&r[1]&&r[1].split(/<\/\w*:?author>/).forEach(function(e){if(""!==e&&""!==e.trim()){var s=e.match(/<(?:\w+:)?author[^>]*>(.*)/);s&&t.push(s[1])}});var n=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return n&&n[1]&&n[1].split(/<\/\w*:?comment>/).forEach(function(e){if(""!==e&&""!==e.trim()){var r=e.match(/<(?:\w+:)?comment[^>]*>/);if(r){var n=oo(r[0]),i={author:n.authorId&&t[n.authorId]||"sheetjsghost",ref:n.ref,guid:n.guid},l=Ad(n.ref);if(!(s.sheetRows&&s.sheetRows<=l.r)){var c=e.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),o=!!c&&!!c[1]&&Rh(c[1])||{r:"",t:"",h:""};i.r=o.r,"<t></t>"==o.r&&(o.t=o.h=""),i.t=(o.t||"").replace(/\r\n/g,"\n").replace(/\r/g,"\n"),s.cellHTML&&(i.h=o.h),a.push(i)}}}}),a}(e,t)}function ap(e,s,t){return".bin"===s.slice(-4)?function(e){var s=[];return yd(e,function(e,t,a){if(63===a)s.push(e);else if(!t.T)throw new Error("Unexpected record 0x"+a.toString(16))}),s}(e):function(e){var s=[];if(!e)return s;var t=1;return(e.match(io)||[]).forEach(function(e){var a=oo(e);switch(a[0]){case"<?xml":case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?t=a.i:a.i=t,s.push(a)}}),s}(e)}function rp(e,s,t,a){if(".bin"===t.slice(-4))return function(e,s,t,a){if(!e)return e;var r=a||{},n=!1;yd(e,function(e,s,t){switch(t){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:n=!0;break;case 36:n=!1;break;default:if(s.T);else if(!n||r.WTF)throw new Error("Unexpected record 0x"+t.toString(16))}},r)}(e,0,0,a)}function np(e,s,t){return".bin"===s.slice(-4)?function(e,s,t){var a={Types:[],Cell:[],Value:[]},r=t||{},n=[],i=!1,l=2;return yd(e,function(e,s,t){switch(t){case 335:a.Types.push({name:e.name});break;case 51:e.forEach(function(e){1==l?a.Cell.push({type:a.Types[e[0]-1].name,index:e[1]}):0==l&&a.Value.push({type:a.Types[e[0]-1].name,index:e[1]})});break;case 337:l=e?1:0;break;case 338:l=2;break;case 35:n.push(t),i=!0;break;case 36:n.pop(),i=!1;break;default:if(s.T);else if(!i||r.WTF&&35!=n[n.length-1])throw new Error("Unexpected record 0x"+t.toString(16))}}),a}(e,0,t):function(e,s,t){var a={Types:[],Cell:[],Value:[]};if(!e)return a;var r,n=!1,i=2;return e.replace(io,function(e){var s=oo(e);switch(mo(s[0])){case"<?xml":case"<metadata":case"</metadata>":case"<metadataTypes":case"</metadataTypes>":case"</metadataType>":case"</futureMetadata>":case"<bk>":case"</bk>":case"</rc>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<metadataType":a.Types.push({name:s.name});break;case"<futureMetadata":for(var l=0;l<a.Types.length;++l)a.Types[l].name==s.name&&(r=a.Types[l]);break;case"<rc":1==i?a.Cell.push({type:a.Types[s.t-1].name,index:+s.v}):0==i&&a.Value.push({type:a.Types[s.t-1].name,index:+s.v});break;case"<cellMetadata":i=1;break;case"</cellMetadata>":case"</valueMetadata>":i=2;break;case"<valueMetadata":i=0;break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<rvb":if(!r)break;r.offsets||(r.offsets=[]),r.offsets.push(+s.i);break;default:if(!n&&t.WTF)throw new Error("unrecognized "+s[0]+" in metadata")}return e}),a}(e,0,t)}var ip,lp=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,cp=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function op(e,s){var t=e.split(/\s+/),a=[];if(a[0]=t[0],1===t.length)return a;var r,n,i,l=e.match(lp);if(l)for(i=0;i!=l.length;++i)-1===(n=(r=l[i].match(cp))[1].indexOf(":"))?a[r[1]]=r[2].slice(1,r[2].length-1):a["xmlns:"===r[1].slice(0,6)?"xmlns"+r[1].slice(6):r[1].slice(n+1)]=r[2].slice(1,r[2].length-1);return a}function dp(e){var s={};if(1===e.split(/\s+/).length)return s;var t,a,r,n=e.match(lp);if(n)for(r=0;r!=n.length;++r)-1===(a=(t=n[r].match(cp))[1].indexOf(":"))?s[t[1]]=t[2].slice(1,t[2].length-1):s["xmlns:"===t[1].slice(0,6)?"xmlns"+t[1].slice(6):t[1].slice(a+1)]=t[2].slice(1,t[2].length-1);return s}function mp(e,s,t,a){var r=a;switch((t[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":r=jo(a);break;case"i2":case"int":r=parseInt(a,10);break;case"r4":case"float":r=parseFloat(a);break;case"date":case"dateTime.tz":r=zc(a);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+t[0])}e[xo(s)]=r}function hp(e,s,t){if("z"!==e.t){if(!t||!1!==t.cellText)try{"e"===e.t?e.w=e.w||om[e.v]:"General"===s?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Zl(e.v):e.w=Ql(e.v):e.w=(a=s||"General",r=e.v,"General"===(n=ip[a]||xo(a))?Ql(r):yc(n,r))}catch(c){if(t.WTF)throw c}var a,r,n;try{var i=ip[s]||s||"General";if(t.cellNF&&(e.z=i),t.cellDates&&"n"==e.t&&fc(i)){var l=ql(e.v);l&&(e.t="d",e.v=new Date(l.y,l.m-1,l.d,l.H,l.M,l.S,l.u))}}catch(c){if(t.WTF)throw c}}}function up(e,s,t){if(t.cellStyles&&s.Interior){var a=s.Interior;a.Pattern&&(a.patternType=lu[a.Pattern]||a.Pattern)}e[s.ID]=s}function xp(e,s,t,a,r,n,i,l,c,o){var d="General",m=a.StyleID,h={};o=o||{};var u=[],x=0;for(void 0===m&&l&&(m=l.StyleID),void 0===m&&i&&(m=i.StyleID);void 0!==n[m]&&(n[m].nf&&(d=n[m].nf),n[m].Interior&&u.push(n[m].Interior),n[m].Parent);)m=n[m].Parent;switch(t.Type){case"Boolean":a.t="b",a.v=jo(e);break;case"String":a.t="s",a.r=vo(xo(e)),a.v=e.indexOf("<")>-1?xo(s||e).replace(/<.*?>/g,""):a.r;break;case"DateTime":"Z"!=e.slice(-1)&&(e+="Z"),a.v=(zc(e)-new Date(Date.UTC(1899,11,30)))/864e5,a.v!=a.v?a.v=xo(e):a.v<60&&(a.v=a.v-1),d&&"General"!=d||(d="yyyy-mm-dd");case"Number":void 0===a.v&&(a.v=+e),a.t||(a.t="n");break;case"Error":a.t="e",a.v=dm[e],!1!==o.cellText&&(a.w=e);break;default:""==e&&""==s?a.t="z":(a.t="s",a.v=vo(s||e))}if(hp(a,d,o),!1!==o.cellFormula)if(a.Formula){var p=xo(a.Formula);61==p.charCodeAt(0)&&(p=p.slice(1)),a.f=Eu(p,r),delete a.Formula,"RC"==a.ArrayRange?a.F=Eu("RC:RC",r):a.ArrayRange&&(a.F=Eu(a.ArrayRange,r),c.push([Dd(a.F),a.F]))}else for(x=0;x<c.length;++x)r.r>=c[x][0].s.r&&r.r<=c[x][0].e.r&&r.c>=c[x][0].s.c&&r.c<=c[x][0].e.c&&(a.F=c[x][1]);o.cellStyles&&(u.forEach(function(e){!h.patternType&&e.patternType&&(h.patternType=e.patternType)}),a.s=h),void 0!==a.StyleID&&(a.ixfe=a.StyleID)}function pp(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,"\n").replace(/\r/g,"\n"),e.v=e.w=e.ixfe=void 0}function fp(e,s){var t=s||{};Nc();var a=gl(Do(e));"binary"!=t.type&&"array"!=t.type&&"base64"!=t.type||(a=_o(a));var r,n=a.slice(0,1024).toLowerCase(),i=!1;if((1023&(n=n.replace(/".*?"/g,"")).indexOf(">"))>Math.min(1023&n.indexOf(","),1023&n.indexOf(";"))){var l=Bc(t);return l.type="string",_h.to_workbook(a,l)}if(-1==n.indexOf("<?xml")&&["html","table","head","meta","script","style","div"].forEach(function(e){n.indexOf("<"+e)>=0&&(i=!0)}),i)return function(e,s){var t=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!t||0==t.length)throw new Error("Invalid HTML: could not find <table>");if(1==t.length)return Fd(Ap(t[0],s),s);var a={SheetNames:[],Sheets:{}};return t.forEach(function(e,t){bf(a,Ap(e,s),"Sheet"+(t+1))}),a}(a,t);ip={"General Number":"General","General Date":$l[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":$l[15],"Short Date":$l[14],"Long Time":$l[19],"Medium Time":$l[18],"Short Time":$l[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:$l[2],Standard:$l[4],Percent:$l[10],Scientific:$l[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var c,o,d=[],m={},h=[],u=t.dense?[]:{},x="",p={},f={},g=op('<Data ss:Type="String">'),v=0,j=0,y=0,b={s:{r:2e6,c:2e6},e:{r:0,c:0}},N={},w={},_="",k=0,S=[],E={},T={},C=0,A=[],R=[],I={},P=[],D=!1,M=[],O=[],F={},L=0,z=0,U={Sheets:[],WBProps:{date1904:!1}},B={};Mo.lastIndex=0,a=a.replace(/<!--([\s\S]*?)-->/gm,"");for(var $="";r=Mo.exec(a);)switch(r[3]=($=r[3]).toLowerCase()){case"data":if("data"==$){if("/"===r[1]){if((c=d.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&d.push([r[3],!0]);break}if(d[d.length-1][1])break;"/"===r[1]?xp(a.slice(v,r.index),_,g,"comment"==d[d.length-1][0]?I:p,{c:j,r:y},N,P[j],f,M,t):(_="",g=op(r[0]),v=r.index+r[0].length);break;case"cell":if("/"===r[1])if(R.length>0&&(p.c=R),(!t.sheetRows||t.sheetRows>y)&&void 0!==p.v&&(t.dense?(u[y]||(u[y]=[]),u[y][j]=p):u[Cd(j)+Ed(y)]=p),p.HRef&&(p.l={Target:xo(p.HRef)},p.HRefScreenTip&&(p.l.Tooltip=p.HRefScreenTip),delete p.HRef,delete p.HRefScreenTip),(p.MergeAcross||p.MergeDown)&&(L=j+(0|parseInt(p.MergeAcross,10)),z=y+(0|parseInt(p.MergeDown,10)),S.push({s:{c:j,r:y},e:{c:L,r:z}})),t.sheetStubs)if(p.MergeAcross||p.MergeDown){for(var H=j;H<=L;++H)for(var V=y;V<=z;++V)(H>j||V>y)&&(t.dense?(u[V]||(u[V]=[]),u[V][H]={t:"z"}):u[Cd(H)+Ed(V)]={t:"z"});j=L+1}else++j;else p.MergeAcross?j=L+1:++j;else(p=dp(r[0])).Index&&(j=+p.Index-1),j<b.s.c&&(b.s.c=j),j>b.e.c&&(b.e.c=j),"/>"===r[0].slice(-2)&&++j,R=[];break;case"row":"/"===r[1]||"/>"===r[0].slice(-2)?(y<b.s.r&&(b.s.r=y),y>b.e.r&&(b.e.r=y),"/>"===r[0].slice(-2)&&(f=op(r[0])).Index&&(y=+f.Index-1),j=0,++y):((f=op(r[0])).Index&&(y=+f.Index-1),F={},("0"==f.AutoFitHeight||f.Height)&&(F.hpx=parseInt(f.Height,10),F.hpt=nu(F.hpx),O[y]=F),"1"==f.Hidden&&(F.hidden=!0,O[y]=F));break;case"worksheet":if("/"===r[1]){if((c=d.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"));h.push(x),b.s.r<=b.e.r&&b.s.c<=b.e.c&&(u["!ref"]=Pd(b),t.sheetRows&&t.sheetRows<=b.e.r&&(u["!fullref"]=u["!ref"],b.e.r=t.sheetRows-1,u["!ref"]=Pd(b))),S.length&&(u["!merges"]=S),P.length>0&&(u["!cols"]=P),O.length>0&&(u["!rows"]=O),m[x]=u}else b={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=j=0,d.push([r[3],!1]),c=op(r[0]),x=xo(c.Name),u=t.dense?[]:{},S=[],M=[],O=[],B={name:x,Hidden:0},U.Sheets.push(B);break;case"table":if("/"===r[1]){if((c=d.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else{if("/>"==r[0].slice(-2))break;d.push([r[3],!1]),P=[],D=!1}break;case"style":"/"===r[1]?up(N,w,t):w=op(r[0]);break;case"numberformat":w.nf=xo(op(r[0]).Format||"General"),ip[w.nf]&&(w.nf=ip[w.nf]);for(var G=0;392!=G&&$l[G]!=w.nf;++G);if(392==G)for(G=57;392!=G;++G)if(null==$l[G]){bc(w.nf,G);break}break;case"column":if("table"!==d[d.length-1][0])break;if((o=op(r[0])).Hidden&&(o.hidden=!0,delete o.Hidden),o.Width&&(o.wpx=parseInt(o.Width,10)),!D&&o.wpx>10){D=!0,Xh=6;for(var q=0;q<P.length;++q)P[q]&&au(P[q])}D&&au(o),P[o.Index-1||P.length]=o;for(var W=0;W<+o.Span;++W)P[P.length]=Bc(o);break;case"namedrange":if("/"===r[1])break;U.Names||(U.Names=[]);var Y=oo(r[0]),K={Name:Y.Name,Ref:Eu(Y.RefersTo.slice(1),{r:0,c:0})};U.Sheets.length>0&&(K.Sheet=U.Sheets.length-1),U.Names.push(K);break;case"namedcell":case"b":case"i":case"u":case"s":case"em":case"h2":case"h3":case"sub":case"sup":case"span":case"alignment":case"borders":case"border":case"protection":case"paragraphs":case"name":case"pixelsperinch":case"null":break;case"font":if("/>"===r[0].slice(-2))break;"/"===r[1]?_+=a.slice(k,r.index):k=r.index+r[0].length;break;case"interior":if(!t.cellStyles)break;w.Interior=op(r[0]);break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if("/>"===r[0].slice(-2))break;"/"===r[1]?wm(E,$,a.slice(C,r.index)):C=r.index+r[0].length;break;case"styles":case"workbook":if("/"===r[1]){if((c=d.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else d.push([r[3],!1]);break;case"comment":if("/"===r[1]){if((c=d.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"));pp(I),R.push(I)}else d.push([r[3],!1]),I={a:(c=op(r[0])).Author};break;case"autofilter":if("/"===r[1]){if((c=d.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else if("/"!==r[0].charAt(r[0].length-2)){var J=op(r[0]);u["!autofilter"]={ref:Eu(J.Range).replace(/\$/g,"")},d.push([r[3],!0])}break;case"datavalidation":if("/"===r[1]){if((c=d.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&d.push([r[3],!0]);break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if("/"===r[1]){if((c=d.pop())[0]!==r[3])throw new Error("Bad state: "+c.join("|"))}else"/"!==r[0].charAt(r[0].length-2)&&d.push([r[3],!0]);break;default:if(0==d.length&&"document"==r[3])return zp(a,t);if(0==d.length&&"uof"==r[3])return zp(a,t);var X=!0;switch(d[d.length-1][0]){case"officedocumentsettings":switch(r[3]){case"allowpng":case"removepersonalinformation":case"downloadcomponents":case"locationofcomponents":case"colors":case"color":case"index":case"rgb":case"targetscreensize":case"readonlyrecommended":break;default:X=!1}break;case"componentoptions":switch(r[3]){case"toolbar":case"hideofficelogo":case"spreadsheetautofit":case"label":case"caption":case"maxheight":case"maxwidth":case"nextsheetnumber":break;default:X=!1}break;case"excelworkbook":switch(r[3]){case"date1904":U.WBProps.date1904=!0;break;case"windowheight":case"windowwidth":case"windowtopx":case"windowtopy":case"tabratio":case"protectstructure":case"protectwindow":case"protectwindows":case"activesheet":case"displayinknotes":case"firstvisiblesheet":case"supbook":case"sheetname":case"sheetindex":case"sheetindexfirst":case"sheetindexlast":case"dll":case"acceptlabelsinformulas":case"donotsavelinkvalues":case"iteration":case"maxiterations":case"maxchange":case"path":case"xct":case"count":case"selectedsheets":case"calculation":case"uncalced":case"startupprompt":case"crn":case"externname":case"formula":case"colfirst":case"collast":case"wantadvise":case"boolean":case"error":case"text":case"ole":case"noautorecover":case"publishobjects":case"donotcalculatebeforesave":case"number":case"refmoder1c1":case"embedsavesmarttags":break;default:X=!1}break;case"workbookoptions":switch(r[3]){case"owcversion":case"height":case"width":break;default:X=!1}break;case"worksheetoptions":switch(r[3]){case"visible":if("/>"===r[0].slice(-2));else if("/"===r[1])switch(a.slice(C,r.index)){case"SheetHidden":B.Hidden=1;break;case"SheetVeryHidden":B.Hidden=2}else C=r.index+r[0].length;break;case"header":u["!margins"]||yx(u["!margins"]={},"xlml"),isNaN(+oo(r[0]).Margin)||(u["!margins"].header=+oo(r[0]).Margin);break;case"footer":u["!margins"]||yx(u["!margins"]={},"xlml"),isNaN(+oo(r[0]).Margin)||(u["!margins"].footer=+oo(r[0]).Margin);break;case"pagemargins":var Z=oo(r[0]);u["!margins"]||yx(u["!margins"]={},"xlml"),isNaN(+Z.Top)||(u["!margins"].top=+Z.Top),isNaN(+Z.Left)||(u["!margins"].left=+Z.Left),isNaN(+Z.Right)||(u["!margins"].right=+Z.Right),isNaN(+Z.Bottom)||(u["!margins"].bottom=+Z.Bottom);break;case"displayrighttoleft":U.Views||(U.Views=[]),U.Views[0]||(U.Views[0]={}),U.Views[0].RTL=!0;break;case"freezepanes":case"frozennosplit":case"splithorizontal":case"splitvertical":case"donotdisplaygridlines":case"activerow":case"activecol":case"toprowbottompane":case"leftcolumnrightpane":case"unsynced":case"print":case"printerrors":case"panes":case"scale":case"pane":case"number":case"layout":case"pagesetup":case"selected":case"protectobjects":case"enableselection":case"protectscenarios":case"validprinterinfo":case"horizontalresolution":case"verticalresolution":case"numberofcopies":case"activepane":case"toprowvisible":case"leftcolumnvisible":case"fittopage":case"rangeselection":case"papersizeindex":case"pagelayoutzoom":case"pagebreakzoom":case"filteron":case"fitwidth":case"fitheight":case"commentslayout":case"zoom":case"lefttoright":case"gridlines":case"allowsort":case"allowfilter":case"allowinsertrows":case"allowdeleterows":case"allowinsertcols":case"allowdeletecols":case"allowinserthyperlinks":case"allowformatcells":case"allowsizecols":case"allowsizerows":case"tabcolorindex":case"donotdisplayheadings":case"showpagelayoutzoom":case"blackandwhite":case"donotdisplayzeros":case"displaypagebreak":case"rowcolheadings":case"donotdisplayoutline":case"noorientation":case"allowusepivottables":case"zeroheight":case"viewablerange":case"selection":case"protectcontents":break;case"nosummaryrowsbelowdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].above=!0;break;case"nosummarycolumnsrightdetail":u["!outline"]||(u["!outline"]={}),u["!outline"].left=!0;break;default:X=!1}break;case"pivottable":case"pivotcache":switch(r[3]){case"immediateitemsondrop":case"showpagemultipleitemlabel":case"compactrowindent":case"location":case"pivotfield":case"orientation":case"layoutform":case"layoutsubtotallocation":case"layoutcompactrow":case"position":case"pivotitem":case"datatype":case"datafield":case"sourcename":case"parentfield":case"ptlineitems":case"ptlineitem":case"countofsameitems":case"item":case"itemtype":case"ptsource":case"cacheindex":case"consolidationreference":case"filename":case"reference":case"nocolumngrand":case"norowgrand":case"blanklineafteritems":case"hidden":case"subtotal":case"basefield":case"mapchilditems":case"function":case"refreshonfileopen":case"printsettitles":case"mergelabels":case"defaultversion":case"refreshname":case"refreshdate":case"refreshdatecopy":case"versionlastrefresh":case"versionlastupdate":case"versionupdateablemin":case"versionrefreshablemin":case"calculation":break;default:X=!1}break;case"pagebreaks":switch(r[3]){case"colbreaks":case"colbreak":case"rowbreaks":case"rowbreak":case"colstart":case"colend":case"rowend":break;default:X=!1}break;case"autofilter":switch(r[3]){case"autofiltercolumn":case"autofiltercondition":case"autofilterand":case"autofilteror":break;default:X=!1}break;case"querytable":switch(r[3]){case"id":case"autoformatfont":case"autoformatpattern":case"querysource":case"querytype":case"enableredirections":case"refreshedinxl9":case"urlstring":case"htmltables":case"connection":case"commandtext":case"refreshinfo":case"notitles":case"nextid":case"columninfo":case"overwritecells":case"donotpromptforfile":case"textwizardsettings":case"source":case"number":case"decimal":case"thousandseparator":case"trailingminusnumbers":case"formatsettings":case"fieldtype":case"delimiters":case"tab":case"comma":case"autoformatname":case"versionlastedit":case"versionlastrefresh":break;default:X=!1}break;case"datavalidation":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":case"cellrangelist":break;default:X=!1}break;case"sorting":case"conditionalformatting":switch(r[3]){case"range":case"type":case"min":case"max":case"sort":case"descending":case"order":case"casesensitive":case"value":case"errorstyle":case"errormessage":case"errortitle":case"cellrangelist":case"inputmessage":case"inputtitle":case"combohide":case"inputhide":case"condition":case"qualifier":case"useblank":case"value1":case"value2":case"format":break;default:X=!1}break;case"mapinfo":case"schema":case"data":switch(r[3]){case"map":case"entry":case"range":case"xpath":case"field":case"xsdtype":case"filteron":case"aggregate":case"elementtype":case"attributetype":case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":case"row":break;default:X=!1}break;case"smarttags":break;default:X=!1}if(X)break;if(r[3].match(/!\[CDATA/))break;if(!d[d.length-1][1])throw"Unrecognized tag: "+r[3]+"|"+d.join("|");if("customdocumentproperties"===d[d.length-1][0]){if("/>"===r[0].slice(-2))break;"/"===r[1]?mp(T,$,A,a.slice(C,r.index)):(A=r,C=r.index+r[0].length);break}if(t.WTF)throw"Unrecognized tag: "+r[3]+"|"+d.join("|")}var Q={};return t.bookSheets||t.bookProps||(Q.Sheets=m),Q.SheetNames=h,Q.Workbook=U,Q.SSF=Bc($l),Q.Props=E,Q.Custprops=T,Q}function gp(e,s){switch(af(s=s||{}),s.type||"base64"){case"base64":return fp(Nl(e),s);case"binary":case"buffer":case"file":return fp(e,s);case"array":return fp(Tl(e),s)}}function vp(e){var s={},t=e.content;if(t.l=28,s.AnsiUserType=t.read_shift(0,"lpstr-ansi"),s.AnsiClipboardFormat=function(e){return em(e,1)}(t),t.length-t.l<=4)return s;var a=t.read_shift(4);return 0==a||a>40?s:(t.l-=4,s.Reserved1=t.read_shift(0,"lpstr-ansi"),t.length-t.l<=4||1907505652!==(a=t.read_shift(4))?s:(s.UnicodeClipboardFormat=function(e){return em(e,2)}(t),0==(a=t.read_shift(4))||a>40?s:(t.l-=4,void(s.Reserved2=t.read_shift(0,"lpwstr")))))}var jp=[60,1084,2066,2165,2175];function yp(e,s,t,a,r){var n=a,i=[],l=t.slice(t.l,t.l+n);if(r&&r.enc&&r.enc.insitu&&l.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:case 133:break;default:r.enc.insitu(l)}i.push(l),t.l+=n;for(var c=id(t,t.l),o=Tp[c],d=0;null!=o&&jp.indexOf(c)>-1;)n=id(t,t.l+2),d=t.l+4,2066==c?d+=4:2165!=c&&2175!=c||(d+=12),l=t.slice(d,t.l+4+n),i.push(l),t.l+=4+n,o=Tp[c=id(t,t.l)];var m=Al(i);gd(m,0);var h=0;m.lens=[];for(var u=0;u<i.length;++u)m.lens.push(h),h+=i[u].length;if(m.length<a)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+m.length+" < "+a;return s.f(m,m.length,r)}function bp(e,s,t){if("z"!==e.t&&e.XF){var a=0;try{a=e.z||e.XF.numFmtId||0,s.cellNF&&(e.z=$l[a])}catch(n){if(s.WTF)throw n}if(!s||!1!==s.cellText)try{"e"===e.t?e.w=e.w||om[e.v]:0===a||"General"==a?"n"===e.t?(0|e.v)===e.v?e.w=e.v.toString(10):e.w=Zl(e.v):e.w=Ql(e.v):e.w=yc(a,e.v,{date1904:!!t,dateNF:s&&s.dateNF})}catch(n){if(s.WTF)throw n}if(s.cellDates&&a&&"n"==e.t&&fc($l[a]||String(a))){var r=ql(e.v);r&&(e.t="d",e.v=new Date(r.y,r.m-1,r.d,r.H,r.M,r.S,r.u))}}}function Np(e,s,t){return{v:e,ixfe:s,t:t}}function wp(e,s){var t,a,r,n,i,l,c,o,d={opts:{}},m={},h=s.dense?[]:{},u={},x={},p=null,f=[],g="",v={},j="",y={},b=[],N=[],w=[],_={Sheets:[],WBProps:{date1904:!1},Views:[{}]},k={},S=function(e){return e<8?cm[e]:e<64&&w[e-8]||cm[e]},E=function(e,s,a){if(!(F>1||a.sheetRows&&e.r>=a.sheetRows)){if(a.cellStyles&&s.XF&&s.XF.data&&function(e,s,t){var a,r=s.XF.data;r&&r.patternType&&t&&t.cellStyles&&(s.s={},s.s.patternType=r.patternType,(a=Kh(S(r.icvFore)))&&(s.s.fgColor={rgb:a}),(a=Kh(S(r.icvBack)))&&(s.s.bgColor={rgb:a}))}(0,s,a),delete s.ixfe,delete s.XF,t=e,j=Rd(e),x&&x.s&&x.e||(x={s:{r:0,c:0},e:{r:0,c:0}}),e.r<x.s.r&&(x.s.r=e.r),e.c<x.s.c&&(x.s.c=e.c),e.r+1>x.e.r&&(x.e.r=e.r+1),e.c+1>x.e.c&&(x.e.c=e.c+1),a.cellFormula&&s.f)for(var r=0;r<b.length;++r)if(!(b[r][0].s.c>e.c||b[r][0].s.r>e.r||b[r][0].e.c<e.c||b[r][0].e.r<e.r)){s.F=Pd(b[r][0]),b[r][0].s.c==e.c&&b[r][0].s.r==e.r||delete s.f,s.f&&(s.f=""+rx(b[r][1],0,e,D,T));break}a.dense?(h[e.r]||(h[e.r]=[]),h[e.r][e.c]=s):h[j]=s}},T={enc:!1,sbcch:0,snames:[],sharedf:y,arrayf:b,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!s&&!!s.cellStyles,WTF:!!s&&!!s.wtf};s.password&&(T.password=s.password);var C=[],A=[],R=[],I=[],P=!1,D=[];D.SheetNames=T.snames,D.sharedf=T.sharedf,D.arrayf=T.arrayf,D.names=[],D.XTI=[];var M,O=0,F=0,L=0,z=[],U=[];T.codepage=1200,hl(1200);for(var B=!1;e.l<e.length-1;){var $=e.l,H=e.read_shift(2);if(0===H&&10===O)break;var V=e.l===e.length?0:e.read_shift(2),G=Tp[H];if(G&&G.f){if(s.bookSheets&&133===O&&133!==H)break;if(O=H,2===G.r||12==G.r){var q=e.read_shift(2);if(V-=2,!T.enc&&q!==H&&((255&q)<<8|q>>8)!==H)throw new Error("rt mismatch: "+q+"!="+H);12==G.r&&(e.l+=10,V-=10)}var W={};if(W=10===H?G.f(e,V,T):yp(H,G,e,V,T),0==F&&-1===[9,521,1033,2057].indexOf(O))continue;switch(H){case 34:d.opts.Date1904=_.WBProps.date1904=W;break;case 134:d.opts.WriteProtect=!0;break;case 47:if(T.enc||(e.l=0),T.enc=W,!s.password)throw new Error("File is password-protected");if(null==W.valid)throw new Error("Encryption scheme unsupported");if(!W.valid)throw new Error("Password is incorrect");break;case 92:T.lastuser=W;break;case 66:var Y=Number(W);switch(Y){case 21010:Y=1200;break;case 32768:Y=1e4;break;case 32769:Y=1252}hl(T.codepage=Y),B=!0;break;case 317:T.rrtabid=W;break;case 25:T.winlocked=W;break;case 439:d.opts.RefreshAll=W;break;case 12:d.opts.CalcCount=W;break;case 16:d.opts.CalcDelta=W;break;case 17:d.opts.CalcIter=W;break;case 13:d.opts.CalcMode=W;break;case 14:d.opts.CalcPrecision=W;break;case 95:d.opts.CalcSaveRecalc=W;break;case 15:T.CalcRefMode=W;break;case 2211:d.opts.FullCalc=W;break;case 129:W.fDialog&&(h["!type"]="dialog"),W.fBelow||((h["!outline"]||(h["!outline"]={})).above=!0),W.fRight||((h["!outline"]||(h["!outline"]={})).left=!0);break;case 224:N.push(W);break;case 430:D.push([W]),D[D.length-1].XTI=[];break;case 35:case 547:D[D.length-1].push(W);break;case 24:case 536:M={Name:W.Name,Ref:rx(W.rgce,0,null,D,T)},W.itab>0&&(M.Sheet=W.itab-1),D.names.push(M),D[0]||(D[0]=[],D[0].XTI=[]),D[D.length-1].push(W),"_xlnm._FilterDatabase"==W.Name&&W.itab>0&&W.rgce&&W.rgce[0]&&W.rgce[0][0]&&"PtgArea3d"==W.rgce[0][0][0]&&(U[W.itab-1]={ref:Pd(W.rgce[0][0][1][2])});break;case 22:T.ExternCount=W;break;case 23:0==D.length&&(D[0]=[],D[0].XTI=[]),D[D.length-1].XTI=D[D.length-1].XTI.concat(W),D.XTI=D.XTI.concat(W);break;case 2196:if(T.biff<8)break;null!=M&&(M.Comment=W[1]);break;case 18:h["!protect"]=W;break;case 19:0!==W&&T.WTF;break;case 133:u[W.pos]=W,T.snames.push(W.name);break;case 10:if(--F)break;if(x.e){if(x.e.r>0&&x.e.c>0){if(x.e.r--,x.e.c--,h["!ref"]=Pd(x),s.sheetRows&&s.sheetRows<=x.e.r){var K=x.e.r;x.e.r=s.sheetRows-1,h["!fullref"]=h["!ref"],h["!ref"]=Pd(x),x.e.r=K}x.e.r++,x.e.c++}C.length>0&&(h["!merges"]=C),A.length>0&&(h["!objects"]=A),R.length>0&&(h["!cols"]=R),I.length>0&&(h["!rows"]=I),_.Sheets.push(k)}""===g?v=h:m[g]=h,h=s.dense?[]:{};break;case 9:case 521:case 1033:case 2057:if(8===T.biff&&(T.biff={9:2,521:3,1033:4}[H]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[W.BIFFVer]||8),T.biffguess=0==W.BIFFVer,0==W.BIFFVer&&4096==W.dt&&(T.biff=5,B=!0,hl(T.codepage=28591)),8==T.biff&&0==W.BIFFVer&&16==W.dt&&(T.biff=2),F++)break;if(h=s.dense?[]:{},T.biff<8&&!B&&(B=!0,hl(T.codepage=s.codepage||1252)),T.biff<5||0==W.BIFFVer&&4096==W.dt){""===g&&(g="Sheet1"),x={s:{r:0,c:0},e:{r:0,c:0}};var J={pos:e.l-V,name:g};u[J.pos]=J,T.snames.push(g)}else g=(u[$]||{name:""}).name;32==W.dt&&(h["!type"]="chart"),64==W.dt&&(h["!type"]="macro"),C=[],A=[],T.arrayf=b=[],R=[],I=[],P=!1,k={Hidden:(u[$]||{hs:0}).hs,name:g};break;case 515:case 3:case 2:"chart"==h["!type"]&&(s.dense?(h[W.r]||[])[W.c]:h[Rd({c:W.c,r:W.r})])&&++W.c,l={ixfe:W.ixfe,XF:N[W.ixfe]||{},v:W.val,t:"n"},L>0&&(l.z=z[l.ixfe>>8&63]),bp(l,s,d.opts.Date1904),E({c:W.c,r:W.r},l,s);break;case 5:case 517:l={ixfe:W.ixfe,XF:N[W.ixfe],v:W.val,t:W.t},L>0&&(l.z=z[l.ixfe>>8&63]),bp(l,s,d.opts.Date1904),E({c:W.c,r:W.r},l,s);break;case 638:l={ixfe:W.ixfe,XF:N[W.ixfe],v:W.rknum,t:"n"},L>0&&(l.z=z[l.ixfe>>8&63]),bp(l,s,d.opts.Date1904),E({c:W.c,r:W.r},l,s);break;case 189:for(var X=W.c;X<=W.C;++X){var Z=W.rkrec[X-W.c][0];l={ixfe:Z,XF:N[Z],v:W.rkrec[X-W.c][1],t:"n"},L>0&&(l.z=z[l.ixfe>>8&63]),bp(l,s,d.opts.Date1904),E({c:X,r:W.r},l,s)}break;case 6:case 518:case 1030:if("String"==W.val){p=W;break}if((l=Np(W.val,W.cell.ixfe,W.tt)).XF=N[l.ixfe],s.cellFormula){var Q=W.formula;if(Q&&Q[0]&&Q[0][0]&&"PtgExp"==Q[0][0][0]){var ee=Q[0][0][1][0],se=Q[0][0][1][1],te=Rd({r:ee,c:se});y[te]?l.f=""+rx(W.formula,0,W.cell,D,T):l.F=((s.dense?(h[ee]||[])[se]:h[te])||{}).F}else l.f=""+rx(W.formula,0,W.cell,D,T)}L>0&&(l.z=z[l.ixfe>>8&63]),bp(l,s,d.opts.Date1904),E(W.cell,l,s),p=W;break;case 7:case 519:if(!p)throw new Error("String record expects Formula");p.val=W,(l=Np(W,p.cell.ixfe,"s")).XF=N[l.ixfe],s.cellFormula&&(l.f=""+rx(p.formula,0,p.cell,D,T)),L>0&&(l.z=z[l.ixfe>>8&63]),bp(l,s,d.opts.Date1904),E(p.cell,l,s),p=null;break;case 33:case 545:b.push(W);var ae=Rd(W[0].s);if(a=s.dense?(h[W[0].s.r]||[])[W[0].s.c]:h[ae],s.cellFormula&&a){if(!p)break;if(!ae||!a)break;a.f=""+rx(W[1],0,W[0],D,T),a.F=Pd(W[0])}break;case 1212:if(!s.cellFormula)break;if(j){if(!p)break;y[Rd(p.cell)]=W[0],((a=s.dense?(h[p.cell.r]||[])[p.cell.c]:h[Rd(p.cell)])||{}).f=""+rx(W[0],0,t,D,T)}break;case 253:l=Np(f[W.isst].t,W.ixfe,"s"),f[W.isst].h&&(l.h=f[W.isst].h),l.XF=N[l.ixfe],L>0&&(l.z=z[l.ixfe>>8&63]),bp(l,s,d.opts.Date1904),E({c:W.c,r:W.r},l,s);break;case 513:s.sheetStubs&&(l={ixfe:W.ixfe,XF:N[W.ixfe],t:"z"},L>0&&(l.z=z[l.ixfe>>8&63]),bp(l,s,d.opts.Date1904),E({c:W.c,r:W.r},l,s));break;case 190:if(s.sheetStubs)for(var re=W.c;re<=W.C;++re){var ne=W.ixfe[re-W.c];l={ixfe:ne,XF:N[ne],t:"z"},L>0&&(l.z=z[l.ixfe>>8&63]),bp(l,s,d.opts.Date1904),E({c:re,r:W.r},l,s)}break;case 214:case 516:case 4:(l=Np(W.val,W.ixfe,"s")).XF=N[l.ixfe],L>0&&(l.z=z[l.ixfe>>8&63]),bp(l,s,d.opts.Date1904),E({c:W.c,r:W.r},l,s);break;case 0:case 512:1===F&&(x=W);break;case 252:f=W;break;case 1054:if(4==T.biff){z[L++]=W[1];for(var ie=0;ie<L+163&&$l[ie]!=W[1];++ie);ie>=163&&bc(W[1],L+163)}else bc(W[1],W[0]);break;case 30:z[L++]=W;for(var le=0;le<L+163&&$l[le]!=W;++le);le>=163&&bc(W,L+163);break;case 229:C=C.concat(W);break;case 93:A[W.cmo[0]]=T.lastobj=W;break;case 438:T.lastobj.TxO=W;break;case 127:T.lastobj.ImData=W;break;case 440:for(i=W[0].s.r;i<=W[0].e.r;++i)for(n=W[0].s.c;n<=W[0].e.c;++n)(a=s.dense?(h[i]||[])[n]:h[Rd({c:n,r:i})])&&(a.l=W[1]);break;case 2048:for(i=W[0].s.r;i<=W[0].e.r;++i)for(n=W[0].s.c;n<=W[0].e.c;++n)(a=s.dense?(h[i]||[])[n]:h[Rd({c:n,r:i})])&&a.l&&(a.l.Tooltip=W[1]);break;case 28:if(T.biff<=5&&T.biff>=2)break;a=s.dense?(h[W[0].r]||[])[W[0].c]:h[Rd(W[0])];var ce=A[W[2]];a||(s.dense?(h[W[0].r]||(h[W[0].r]=[]),a=h[W[0].r][W[0].c]={t:"z"}):a=h[Rd(W[0])]={t:"z"},x.e.r=Math.max(x.e.r,W[0].r),x.s.r=Math.min(x.s.r,W[0].r),x.e.c=Math.max(x.e.c,W[0].c),x.s.c=Math.min(x.s.c,W[0].c)),a.c||(a.c=[]),r={a:W[1],t:ce.TxO.t},a.c.push(r);break;case 2173:_u(N[W.ixfe],W.ext);break;case 125:if(!T.cellStyles)break;for(;W.e>=W.s;)R[W.e--]={width:W.w/256,level:W.level||0,hidden:!!(1&W.flags)},P||(P=!0,tu(W.w/256)),au(R[W.e+1]);break;case 520:var oe={};null!=W.level&&(I[W.r]=oe,oe.level=W.level),W.hidden&&(I[W.r]=oe,oe.hidden=!0),W.hpt&&(I[W.r]=oe,oe.hpt=W.hpt,oe.hpx=iu(W.hpt));break;case 38:case 39:case 40:case 41:h["!margins"]||yx(h["!margins"]={}),h["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[H]]=W;break;case 161:h["!margins"]||yx(h["!margins"]={}),h["!margins"].header=W.header,h["!margins"].footer=W.footer;break;case 574:W.RTL&&(_.Views[0].RTL=!0);break;case 146:w=W;break;case 2198:o=W;break;case 140:c=W;break;case 442:g?k.CodeName=W||k.name:_.WBProps.CodeName=W||"ThisWorkbook"}}else e.l+=V}return d.SheetNames=Ec(u).sort(function(e,s){return Number(e)-Number(s)}).map(function(e){return u[e].name}),s.bookSheets||(d.Sheets=m),!d.SheetNames.length&&v["!ref"]?(d.SheetNames.push("Sheet1"),d.Sheets&&(d.Sheets.Sheet1=v)):d.Preamble=v,d.Sheets&&U.forEach(function(e,s){d.Sheets[d.SheetNames[s]]["!autofilter"]=e}),d.Strings=f,d.SSF=Bc($l),T.enc&&(d.Encryption=T.enc),o&&(d.Themes=o),d.Metadata={},void 0!==c&&(d.Metadata.Country=c),D.names.length>0&&(_.Names=D.names),d.Workbook=_,d}var _p="e0859ff2f94f6810ab9108002b27b3d9",kp="02d5cdd59c2e1b10939708002b2cf9ae";function Sp(e,s){var t,a,r,n;if(s||(s={}),af(s),ul(),s.codepage&&ml(s.codepage),e.FullPaths){if(Sc.find(e,"/encryption"))throw new Error("File is password-protected");t=Sc.find(e,"!CompObj"),a=Sc.find(e,"/Workbook")||Sc.find(e,"/Book")}else{switch(s.type){case"base64":e=El(Nl(e));break;case"binary":e=El(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e))}gd(e,0),a={content:e}}if(t&&vp(t),s.bookProps&&!s.bookSheets)r={};else{var i=wl?"buffer":"array";if(a&&a.content)r=wp(a.content,s);else if((n=Sc.find(e,"PerfectOffice_MAIN"))&&n.content)r=kh.to_workbook(n.content,(s.type=i,s));else{if(!(n=Sc.find(e,"NativeContent_MAIN"))||!n.content)throw(n=Sc.find(e,"MN0"))&&n.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");r=kh.to_workbook(n.content,(s.type=i,s))}s.bookVBA&&e.FullPaths&&Sc.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(r.vbaraw=function(e){var s=Sc.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(t,a){if("/"!==t.slice(-1)&&t.match(/_VBA_PROJECT_CUR/)){var r=t.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Sc.utils.cfb_add(s,r,e.FileIndex[a].content)}}),Sc.write(s)}(e))}var l={};return e.FullPaths&&function(e,s,t){var a=Sc.find(e,"/!DocumentSummaryInformation");if(a&&a.size>0)try{var r=Dm(a,am,kp);for(var n in r)s[n]=r[n]}catch(o){if(t.WTF)throw o}var i=Sc.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var l=Dm(i,rm,_p);for(var c in l)null==s[c]&&(s[c]=l[c])}catch(o){if(t.WTF)throw o}s.HeadingPairs&&s.TitlesOfParts&&(jm(s.HeadingPairs,s.TitlesOfParts,s,t),delete s.HeadingPairs,delete s.TitlesOfParts)}(e,l,s),r.Props=r.Custprops=l,s.bookFiles&&(r.cfb=e),r}var Ep={0:{f:function(e,s){var t={},a=e.l+s;t.r=e.read_shift(4),e.l+=4;var r=e.read_shift(2);e.l+=1;var n=e.read_shift(1);return e.l=a,7&n&&(t.level=7&n),16&n&&(t.hidden=!0),32&n&&(t.hpt=r/20),t}},1:{f:function(e){return[Vd(e)]}},2:{f:function(e){return[Vd(e),Jd(e),"n"]}},3:{f:function(e){return[Vd(e),e.read_shift(1),"e"]}},4:{f:function(e){return[Vd(e),e.read_shift(1),"b"]}},5:{f:function(e){return[Vd(e),Qd(e),"n"]}},6:{f:function(e){return[Vd(e),Ud(e),"str"]}},7:{f:function(e){return[Vd(e),e.read_shift(4),"s"]}},8:{f:function(e,s,t){var a=e.l+s,r=Vd(e);r.r=t["!row"];var n=[r,Ud(e),"str"];if(t.cellFormula){e.l+=2;var i=dx(e,a-e.l,t);n[3]=rx(i,0,r,t.supbooks,t)}else e.l=a;return n}},9:{f:function(e,s,t){var a=e.l+s,r=Vd(e);r.r=t["!row"];var n=[r,Qd(e),"n"];if(t.cellFormula){e.l+=2;var i=dx(e,a-e.l,t);n[3]=rx(i,0,r,t.supbooks,t)}else e.l=a;return n}},10:{f:function(e,s,t){var a=e.l+s,r=Vd(e);r.r=t["!row"];var n=[r,e.read_shift(1),"b"];if(t.cellFormula){e.l+=2;var i=dx(e,a-e.l,t);n[3]=rx(i,0,r,t.supbooks,t)}else e.l=a;return n}},11:{f:function(e,s,t){var a=e.l+s,r=Vd(e);r.r=t["!row"];var n=[r,e.read_shift(1),"e"];if(t.cellFormula){e.l+=2;var i=dx(e,a-e.l,t);n[3]=rx(i,0,r,t.supbooks,t)}else e.l=a;return n}},12:{f:function(e){return[Gd(e)]}},13:{f:function(e){return[Gd(e),Jd(e),"n"]}},14:{f:function(e){return[Gd(e),e.read_shift(1),"e"]}},15:{f:function(e){return[Gd(e),e.read_shift(1),"b"]}},16:{f:Fx},17:{f:function(e){return[Gd(e),Ud(e),"str"]}},18:{f:function(e){return[Gd(e),e.read_shift(4),"s"]}},19:{f:$d},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:function(e,s,t){var a=e.l+s;e.l+=4,e.l+=1;var r=e.read_shift(4),n=Yd(e),i=mx(e,0,t),l=Wd(e);e.l=a;var c={Name:n,Ptg:i};return r<268435455&&(c.Sheet=r),l&&(c.Comment=l),c}},40:{},42:{},43:{f:function(e,s,t){var a={};a.sz=e.read_shift(2)/20;var r=function(e){var s=e.read_shift(1);return e.l++,{fBold:1&s,fItalic:2&s,fUnderline:4&s,fStrikeout:8&s,fOutline:16&s,fShadow:32&s,fCondense:64&s,fExtend:128&s}}(e);switch(r.fItalic&&(a.italic=1),r.fCondense&&(a.condense=1),r.fExtend&&(a.extend=1),r.fShadow&&(a.shadow=1),r.fOutline&&(a.outline=1),r.fStrikeout&&(a.strike=1),700===e.read_shift(2)&&(a.bold=1),e.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript"}var n=e.read_shift(1);0!=n&&(a.underline=n);var i=e.read_shift(1);i>0&&(a.family=i);var l=e.read_shift(1);switch(l>0&&(a.charset=l),e.l++,a.color=function(e){var s={},t=e.read_shift(1)>>>1,a=e.read_shift(1),r=e.read_shift(2,"i"),n=e.read_shift(1),i=e.read_shift(1),l=e.read_shift(1);switch(e.l++,t){case 0:s.auto=1;break;case 1:s.index=a;var c=cm[a];c&&(s.rgb=Kh(c));break;case 2:s.rgb=Kh([n,i,l]);break;case 3:s.theme=a}return 0!=r&&(s.tint=r>0?r/32767:r/32768),s}(e),e.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor"}return a.name=Ud(e),a}},44:{f:function(e,s){return[e.read_shift(2),Ud(e)]}},45:{f:mu},46:{f:hu},47:{f:function(e,s){var t=e.l+s,a=e.read_shift(2),r=e.read_shift(2);return e.l=t,{ixfe:a,numFmtId:r}}},48:{},49:{f:function(e){return e.read_shift(4,"i")}},50:{},51:{f:function(e){for(var s=[],t=e.read_shift(4);t-- >0;)s.push([e.read_shift(4),e.read_shift(4)]);return s}},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:ph},62:{f:function(e){return[Vd(e),$d(e),"is"]}},63:{f:function(e){var s={};s.i=e.read_shift(4);var t={};t.r=e.read_shift(4),t.c=e.read_shift(4),s.r=Rd(t);var a=e.read_shift(1);return 2&a&&(s.l="1"),8&a&&(s.a="1"),s}},64:{f:function(){}},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:vd,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:function(e){var s=e.read_shift(2);return e.l+=28,{RTL:32&s}}},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:function(e,s){var t={},a=e[e.l];return++e.l,t.above=!(64&a),t.left=!(128&a),e.l+=18,t.name=qd(e),t}},148:{f:Ox,p:16},151:{f:function(){}},152:{},153:{f:function(e,s){var t={},a=e.read_shift(4);t.defaultThemeVersion=e.read_shift(4);var r=s>8?Ud(e):"";return r.length>0&&(t.CodeName=r),t.autoCompressPictures=!!(65536&a),t.backupFile=!!(64&a),t.checkCompatibility=!!(4096&a),t.date1904=!!(1&a),t.filterPrivacy=!!(8&a),t.hidePivotFieldList=!!(1024&a),t.promptedSolutions=!!(16&a),t.publishItems=!!(2048&a),t.refreshAllConnections=!!(262144&a),t.saveExternalLinkValues=!!(128&a),t.showBorderUnselectedTables=!!(4&a),t.showInkAnnotation=!!(32&a),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(32768&a),t.updateLinks=["userSet","never","always"][a>>8&3],t}},154:{},155:{},156:{f:function(e,s){var t={};return t.Hidden=e.read_shift(4),t.iTabID=e.read_shift(4),t.strRelID=Kd(e),t.name=Ud(e),t}},157:{},158:{},159:{T:1,f:function(e){return[e.read_shift(4),e.read_shift(4)]}},160:{T:-1},161:{T:1,f:Zd},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:Lx},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:function(e,s){return{flags:e.read_shift(4),version:e.read_shift(4),name:Ud(e)}}},336:{T:-1},337:{f:function(e){return e.l+=4,0!=e.read_shift(4)},T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Kd},357:{},358:{},359:{},360:{T:1},361:{},362:{f:hh},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:function(e,s,t){var a=e.l+s,r=Xd(e),n=e.read_shift(1),i=[r];if(i[2]=n,t.cellFormula){var l=ox(e,a-e.l,t);i[1]=l}else e.l=a;return i}},427:{f:function(e,s,t){var a=e.l+s,r=[Zd(e)];if(t.cellFormula){var n=hx(e,a-e.l,t);r[1]=n,e.l=a}else e.l=a;return r}},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:function(e){var s={};return zx.forEach(function(t){s[t]=Qd(e)}),s}},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:function(){}},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:function(e,s){var t=e.l+s,a=Zd(e),r=Wd(e),n=Ud(e),i=Ud(e),l=Ud(e);e.l=t;var c={rfx:a,relId:r,loc:n,display:l};return i&&(c.Tooltip=i),c}},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Kd},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Su},633:{T:1},634:{T:-1},635:{T:1,f:function(e){var s={};s.iauthor=e.read_shift(4);var t=Zd(e);return s.rfx=t.s,s.ref=Rd(t.s),e.l+=16,s}},636:{T:-1},637:{f:Hd},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:function(e,s){return e.l+=10,{name:Ud(e)}}},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:function(){}},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Tp={6:{f:lx},10:{f:Mm},12:{f:Fm},13:{f:Fm},14:{f:Om},15:{f:Om},16:{f:Qd},17:{f:Om},18:{f:Om},19:{f:Fm},20:{f:ch},21:{f:ch},23:{f:hh},24:{f:mh},25:{f:Om},26:{},27:{},28:{f:function(e,s,t){return function(e,s,t){if(!(t.biff<8)){var a=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),i=e.read_shift(2),l=Hm(e,0,t);return t.biff<8&&e.read_shift(1),[{r:a,c:r},l,i,n]}}(e,0,t)}},29:{},34:{f:Om},35:{f:oh},38:{f:Qd},39:{f:Qd},40:{f:Qd},41:{f:Qd},42:{f:Om},43:{f:Om},47:{f:function(e,s,t){var a={Type:t.biff>=8?e.read_shift(2):0};return a.Type?Wh(e,s-2,a):qh(e,t.biff,t,a),a}},49:{f:function(e,s,t){var a={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(t&&t.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10}return a.name=zm(e,0,t),a}},51:{f:Fm},60:{},61:{f:function(e){return{Pos:[e.read_shift(2),e.read_shift(2)],Dim:[e.read_shift(2),e.read_shift(2)],Flags:e.read_shift(2),CurTab:e.read_shift(2),FirstTab:e.read_shift(2),Selected:e.read_shift(2),TabRatio:e.read_shift(2)}}},64:{f:Om},65:{f:function(){}},66:{f:Fm},77:{},80:{},81:{},82:{},85:{f:Fm},89:{},90:{},91:{},92:{f:function(e,s,t){if(t.enc)return e.l+=s,"";var a=e.l,r=Hm(e,0,t);return e.read_shift(s+a-e.l),r}},93:{f:function(e,s,t){if(t&&t.biff<8)return function(e,s,t){e.l+=4;var a=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,s-=36;var i=[];return i.push((xh[a]||vd)(e,s,t)),{cmo:[r,a,n],ft:i}}(e,s,t);var a=eh(e),r=function(e,s){for(var t=e.l+s,a=[];e.l<t;){var r=e.read_shift(2);e.l-=2;try{a.push(th[r](e,t-e.l))}catch(n){return e.l=t,a}}return e.l!=t&&(e.l=t),a}(e,s-22,a[1]);return{cmo:a,ft:r}}},94:{},95:{f:Om},96:{},97:{},99:{f:Om},125:{f:ph},128:{f:function(e){e.l+=4;var s=[e.read_shift(2),e.read_shift(2)];if(0!==s[0]&&s[0]--,0!==s[1]&&s[1]--,s[0]>7||s[1]>7)throw new Error("Bad Gutters: "+s.join("|"));return s}},129:{f:function(e,s,t){var a=t&&8==t.biff||2==s?e.read_shift(2):(e.l+=s,0);return{fDialog:16&a,fBelow:64&a,fRight:128&a}}},130:{f:Fm},131:{f:Om},132:{f:Om},133:{f:function(e,s,t){var a=e.read_shift(4),r=3&e.read_shift(1),n=e.read_shift(1);switch(n){case 0:n="Worksheet";break;case 1:n="Macrosheet";break;case 2:n="Chartsheet";break;case 6:n="VBAModule"}var i=zm(e,0,t);return 0===i.length&&(i="Sheet1"),{pos:a,hs:r,dt:n,name:i}}},134:{},140:{f:function(e){var s,t=[0,0];return s=e.read_shift(2),t[0]=nm[s]||s,s=e.read_shift(2),t[1]=nm[s]||s,t}},141:{f:Fm},144:{},146:{f:function(e){for(var s=e.read_shift(2),t=[];s-- >0;)t.push(Wm(e));return t}},151:{},152:{},153:{},154:{},155:{},156:{f:Fm},157:{},158:{},160:{f:gh},161:{f:function(e,s){var t={};return s<32||(e.l+=16,t.header=Qd(e),t.footer=Qd(e),e.l+=2),t}},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:function(e,s){for(var t=e.l+s-2,a=e.read_shift(2),r=e.read_shift(2),n=[];e.l<t;)n.push(Jm(e));if(e.l!==t)throw new Error("MulRK read error");var i=e.read_shift(2);if(n.length!=i-r+1)throw new Error("MulRK length mismatch");return{r:a,c:r,C:i,rkrec:n}}},190:{f:function(e,s){for(var t=e.l+s-2,a=e.read_shift(2),r=e.read_shift(2),n=[];e.l<t;)n.push(e.read_shift(2));if(e.l!==t)throw new Error("MulBlank read error");var i=e.read_shift(2);if(n.length!=i-r+1)throw new Error("MulBlank length mismatch");return{r:a,c:r,C:i,ixfe:n}}},193:{f:Mm},197:{},198:{},199:{},200:{},201:{},202:{f:Om},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:Fm},220:{},221:{f:Om},222:{},224:{f:function(e,s,t){var a={};return a.ifnt=e.read_shift(2),a.numFmtId=e.read_shift(2),a.flags=e.read_shift(2),a.fStyle=a.flags>>2&1,a.data=function(e,s,t,a){var r={},n=e.read_shift(4),i=e.read_shift(4),l=e.read_shift(4),c=e.read_shift(2);return r.patternType=im[l>>26],a.cellStyles?(r.alc=7&n,r.fWrap=n>>3&1,r.alcV=n>>4&7,r.fJustLast=n>>7&1,r.trot=n>>8&255,r.cIndent=n>>16&15,r.fShrinkToFit=n>>20&1,r.iReadOrder=n>>22&2,r.fAtrNum=n>>26&1,r.fAtrFnt=n>>27&1,r.fAtrAlc=n>>28&1,r.fAtrBdr=n>>29&1,r.fAtrPat=n>>30&1,r.fAtrProt=n>>31&1,r.dgLeft=15&i,r.dgRight=i>>4&15,r.dgTop=i>>8&15,r.dgBottom=i>>12&15,r.icvLeft=i>>16&127,r.icvRight=i>>23&127,r.grbitDiag=i>>30&3,r.icvTop=127&l,r.icvBottom=l>>7&127,r.icvDiag=l>>14&127,r.dgDiag=l>>21&15,r.icvFore=127&c,r.icvBack=c>>7&127,r.fsxButton=c>>14&1,r):r}(e,0,a.fStyle,t),a}},225:{f:function(e,s){return 0===s||e.read_shift(2),1200}},226:{f:Mm},227:{},229:{f:function(e,s){for(var t=[],a=e.read_shift(2);a--;)t.push(Xm(e));return t}},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:function(e,s){for(var t=e.l+s,a=e.read_shift(4),r=e.read_shift(4),n=[],i=0;i!=r&&e.l<t;++i)n.push(Um(e));return n.Count=a,n.Unique=r,n}},253:{f:function(e){var s=Ym(e);return s.isst=e.read_shift(4),s}},255:{f:function(e,s){var t={};return t.dsst=e.read_shift(2),e.l+=s-2,t}},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:Lm},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Om},353:{f:Mm},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:function(e,s,t){var a=e.l+s,r=e.read_shift(2),n=e.read_shift(2);if(t.sbcch=n,1025==n||14849==n)return[n,r];if(n<1||n>255)throw new Error("Unexpected SupBook type: "+n);for(var i=Bm(e,n),l=[];a>e.l;)l.push($m(e));return[n,r,i,l]}},431:{f:Om},432:{},433:{},434:{},437:{},438:{f:function(e,s,t){var a=e.l,r="";try{e.l+=4;var n=(t.lastobj||{cmo:[0,0]}).cmo[1];-1==[0,5,7,11,12,14].indexOf(n)?e.l+=6:function(e){var s=e.read_shift(1);e.l++;var t=e.read_shift(2);return e.l+=2,[s,t]}(e);var i=e.read_shift(2);e.read_shift(2),Fm(e);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-a!=e.lens[c])throw new Error("TxO: bad continue record");var o=e[e.l];if((r+=Bm(e,e.lens[c+1]-e.lens[c]-1)).length>=(o?i:2*i))break}if(r.length!==i&&r.length!==2*i)throw new Error("cchText: "+i+" != "+r.length);return e.l=a+s,{t:r}}catch(d){return e.l=a+s,{t:r}}}},439:{f:Om},440:{f:function(e,s){var t=Xm(e);e.l+=16;var a=function(e,s){var t=e.l+s,a=e.read_shift(4);if(2!==a)throw new Error("Unrecognized streamVersion: "+a);var r=e.read_shift(2);e.l+=2;var n,i,l,c,o,d,m="";16&r&&(n=Gm(e,e.l)),128&r&&(i=Gm(e,e.l)),257&~r||(l=Gm(e,e.l)),1==(257&r)&&(c=Vm(e,e.l)),8&r&&(m=Gm(e,e.l)),32&r&&(o=e.read_shift(16)),64&r&&(d=_m(e)),e.l=t;var h=i||l||c||"";h&&m&&(h+="#"+m),h||(h="#"+m),2&r&&"/"==h.charAt(0)&&"/"!=h.charAt(1)&&(h="file://"+h);var u={Target:h};return o&&(u.guid=o),d&&(u.time=d),n&&(u.Tooltip=n),u}(e,s-24);return[t,a]}},441:{},442:{f:$m},443:{},444:{f:Fm},445:{},446:{},448:{f:Mm},449:{f:function(e){return e.read_shift(2),e.read_shift(4)},r:2},450:{f:Mm},512:{f:ih},513:{f:fh},515:{f:function(e,s,t){t.biffguess&&2==t.biff&&(t.biff=5);var a=Ym(e),r=Qd(e);return a.val=r,a}},516:{f:function(e,s,t){t.biffguess&&2==t.biff&&(t.biff=5),e.l;var a=Ym(e);2==t.biff&&e.l++;var r=$m(e,e.l,t);return a.val=r,a}},517:{f:lh},519:{f:vh},520:{f:function(e){var s={};s.r=e.read_shift(2),s.c=e.read_shift(2),s.cnt=e.read_shift(2)-s.c;var t=e.read_shift(2);e.l+=4;var a=e.read_shift(1);return e.l+=3,7&a&&(s.level=7&a),32&a&&(s.hidden=!0),64&a&&(s.hpt=t/20),s}},523:{},545:{f:uh},549:{f:rh},566:{},574:{f:function(e,s,t){return t&&t.biff>=2&&t.biff<5?{}:{RTL:64&e.read_shift(2)}}},638:{f:function(e){var s=e.read_shift(2),t=e.read_shift(2),a=Jm(e);return{r:s,c:t,ixfe:a[0],rknum:a[1]}}},659:{},1048:{},1054:{f:function(e,s,t){return[e.read_shift(2),Hm(e,0,t)]}},1084:{},1212:{f:function(e,s,t){var a=Zm(e);e.l++;var r=e.read_shift(1);return[ix(e,s-=8,t),r,a]}},2048:{f:function(e,s){e.read_shift(2);var t=Xm(e),a=e.read_shift((s-10)/2,"dbcs-cont");return[t,a=a.replace(Rl,"")]}},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:ah},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Mm},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:function(e){e.l+=2;var s={cxfs:0,crc:0};return s.cxfs=e.read_shift(2),s.crc=e.read_shift(4),s},r:12},2173:{f:function(e,s){e.l,e.l+=2;var t=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),r=[];a-- >0;)r.push(wu(e,e.l));return{ixfe:t,ext:r}},r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Om,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:function(e,s,t){if(!(t.biff<8)){var a=e.read_shift(2),r=e.read_shift(2);return[Bm(e,a,t),Bm(e,r,t)]}e.l+=s},r:12},2197:{},2198:{f:function(e,s,t){var a=e.l+s;if(124226!==e.read_shift(4))if(t.cellStyles){var r,n=e.slice(e.l);e.l=a;try{r=so(n,{type:"array"})}catch(l){return}var i=Zc(r,"theme/theme/theme1.xml",!0);if(i)return bu(i,t)}else e.l=a},r:12},2199:{},2200:{},2201:{},2202:{f:function(e){return[0!==e.read_shift(4),0!==e.read_shift(4),e.read_shift(4)]},r:12},2203:{f:Mm},2204:{},2205:{},2206:{},2207:{},2211:{f:function(e){var s=function(e){var s=e.read_shift(2),t=e.read_shift(2);return e.l+=8,{type:s,flags:t}}(e);if(2211!=s.type)throw new Error("Invalid Future Record "+s.type);return 0!==e.read_shift(4)}},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:Fm},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:function(e,s,t){var a={area:!1};if(5!=t.biff)return e.l+=s,a;var r=e.read_shift(1);return e.l+=3,16&r&&(a.area=!0),a}},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:function(e){for(var s=e.read_shift(2),t=[];s-- >0;)t.push(Wm(e));return t}},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:ih},1:{},2:{f:function(e){var s=Ym(e);++e.l;var t=e.read_shift(2);return s.t="n",s.val=t,s}},3:{f:function(e){var s=Ym(e);++e.l;var t=Qd(e);return s.t="n",s.val=t,s}},4:{f:function(e,s,t){t.biffguess&&5==t.biff&&(t.biff=2);var a=Ym(e);++e.l;var r=Hm(e,0,t);return a.t="str",a.val=r,a}},5:{f:lh},7:{f:function(e){var s=e.read_shift(1);return 0===s?(e.l++,""):e.read_shift(s,"sbcs-cont")}},8:{},9:{f:ah},11:{},22:{f:Fm},30:{f:nh},31:{},32:{},33:{f:uh},36:{},37:{f:rh},50:{f:function(e,s){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=s-13}},62:{},52:{},67:{},68:{f:Fm},69:{},86:{},126:{},127:{f:function(e){var s=e.read_shift(2),t=e.read_shift(2),a=e.read_shift(4),r={fmt:s,env:t,len:a,data:e.slice(e.l,e.l+a)};return e.l+=a,r}},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:function(e,s,t){var a=e.l+s,r=Ym(e),n=e.read_shift(2),i=Bm(e,n,t);return e.l=a,r.t="str",r.val=i,r}},223:{},234:{},354:{},421:{},518:{f:lx},521:{f:ah},536:{f:mh},547:{f:oh},561:{},579:{},1030:{f:lx},1033:{f:ah},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Cp(e,s,t,a){var r=s;if(!isNaN(r)){var n=(t||[]).length||0,i=e.next(4);i.write_shift(2,r),i.write_shift(2,n),n>0&&rd(t)&&e.push(t)}}function Ap(e,s){var t=s||{},a=t.dense?[]:{},r=(e=e.replace(/<!--.*?-->/g,"")).match(/<table/i);if(!r)throw new Error("Invalid HTML: could not find <table>");var n=e.match(/<\/table/i),i=r.index,l=n&&n.index||e.length,c=qc(e.slice(i,l),/(:?<tr[^>]*>)/i,"<tr>"),o=-1,d=0,m=0,h=0,u={s:{r:1e7,c:1e7},e:{r:0,c:0}},x=[];for(i=0;i<c.length;++i){var p=c[i].trim(),f=p.slice(0,3).toLowerCase();if("<tr"!=f){if("<td"==f||"<th"==f){var g=p.split(/<\/t[dh]>/i);for(l=0;l<g.length;++l){var v=g[l].trim();if(v.match(/<t[dh]/i)){for(var j=v,y=0;"<"==j.charAt(0)&&(y=j.indexOf(">"))>-1;)j=j.slice(y+1);for(var b=0;b<x.length;++b){var N=x[b];N.s.c==d&&N.s.r<o&&o<=N.e.r&&(d=N.e.c+1,b=-1)}var w=oo(v.slice(0,v.indexOf(">")));h=w.colspan?+w.colspan:1,((m=+w.rowspan)>1||h>1)&&x.push({s:{r:o,c:d},e:{r:o+(m||1)-1,c:d+h-1}});var _=w.t||w["data-t"]||"";if(j.length)if(j=Eo(j),u.s.r>o&&(u.s.r=o),u.e.r<o&&(u.e.r=o),u.s.c>d&&(u.s.c=d),u.e.c<d&&(u.e.c=d),j.length){var k={t:"s",v:j};t.raw||!j.trim().length||"s"==_||("TRUE"===j?k={t:"b",v:!0}:"FALSE"===j?k={t:"b",v:!1}:isNaN(Hc(j))?isNaN(Gc(j).getDate())||(k={t:"d",v:zc(j)},t.cellDates||(k={t:"n",v:Ac(k.v)}),k.z=t.dateNF||$l[14]):k={t:"n",v:Hc(j)}),t.dense?(a[o]||(a[o]=[]),a[o][d]=k):a[Rd({r:o,c:d})]=k,d+=h}else d+=h;else d+=h}}}}else{if(++o,t.sheetRows&&t.sheetRows<=o){--o;break}d=0}}return a["!ref"]=Pd(u),x.length&&(a["!merges"]=x),a}function Rp(e,s,t,a){for(var r=e["!merges"]||[],n=[],i=s.s.c;i<=s.e.c;++i){for(var l=0,c=0,o=0;o<r.length;++o)if(!(r[o].s.r>t||r[o].s.c>i||r[o].e.r<t||r[o].e.c<i)){if(r[o].s.r<t||r[o].s.c<i){l=-1;break}l=r[o].e.r-r[o].s.r+1,c=r[o].e.c-r[o].s.c+1;break}if(!(l<0)){var d=Rd({r:t,c:i}),m=a.dense?(e[t]||[])[i]:e[d],h=m&&null!=m.v&&(m.h||go(m.w||(Od(m),m.w)||""))||"",u={};l>1&&(u.rowspan=l),c>1&&(u.colspan=c),a.editable?h='<span contenteditable="true">'+h+"</span>":m&&(u["data-t"]=m&&m.t||"z",null!=m.v&&(u["data-v"]=m.v),null!=m.z&&(u["data-z"]=m.z),m.l&&"#"!=(m.l.Target||"#").charAt(0)&&(h='<a href="'+m.l.Target+'">'+h+"</a>")),u.id=(a.id||"sjs")+"-"+d,n.push(Po("td",h,u))}}return"<tr>"+n.join("")+"</tr>"}function Ip(e,s,t){var a=t||{},r=0,n=0;if(null!=a.origin)if("number"==typeof a.origin)r=a.origin;else{var i="string"==typeof a.origin?Ad(a.origin):a.origin;r=i.r,n=i.c}var l=s.getElementsByTagName("tr"),c=Math.min(a.sheetRows||1e7,l.length),o={s:{r:0,c:0},e:{r:r,c:n}};if(e["!ref"]){var d=Id(e["!ref"]);o.s.r=Math.min(o.s.r,d.s.r),o.s.c=Math.min(o.s.c,d.s.c),o.e.r=Math.max(o.e.r,d.e.r),o.e.c=Math.max(o.e.c,d.e.c),-1==r&&(o.e.r=r=d.e.r+1)}var m=[],h=0,u=e["!rows"]||(e["!rows"]=[]),x=0,p=0,f=0,g=0,v=0,j=0;for(e["!cols"]||(e["!cols"]=[]);x<l.length&&p<c;++x){var y=l[x];if(Dp(y)){if(a.display)continue;u[p]={hidden:!0}}var b=y.children;for(f=g=0;f<b.length;++f){var N=b[f];if(!a.display||!Dp(N)){var w=N.hasAttribute("data-v")?N.getAttribute("data-v"):N.hasAttribute("v")?N.getAttribute("v"):Eo(N.innerHTML),_=N.getAttribute("data-z")||N.getAttribute("z");for(h=0;h<m.length;++h){var k=m[h];k.s.c==g+n&&k.s.r<p+r&&p+r<=k.e.r&&(g=k.e.c+1-n,h=-1)}j=+N.getAttribute("colspan")||1,((v=+N.getAttribute("rowspan")||1)>1||j>1)&&m.push({s:{r:p+r,c:g+n},e:{r:p+r+(v||1)-1,c:g+n+(j||1)-1}});var S={t:"s",v:w},E=N.getAttribute("data-t")||N.getAttribute("t")||"";null!=w&&(0==w.length?S.t=E||"z":a.raw||0==w.trim().length||"s"==E||("TRUE"===w?S={t:"b",v:!0}:"FALSE"===w?S={t:"b",v:!1}:isNaN(Hc(w))?isNaN(Gc(w).getDate())||(S={t:"d",v:zc(w)},a.cellDates||(S={t:"n",v:Ac(S.v)}),S.z=a.dateNF||$l[14]):S={t:"n",v:Hc(w)})),void 0===S.z&&null!=_&&(S.z=_);var T="",C=N.getElementsByTagName("A");if(C&&C.length)for(var A=0;A<C.length&&(!C[A].hasAttribute("href")||"#"==(T=C[A].getAttribute("href")).charAt(0));++A);T&&"#"!=T.charAt(0)&&(S.l={Target:T}),a.dense?(e[p+r]||(e[p+r]=[]),e[p+r][g+n]=S):e[Rd({c:g+n,r:p+r})]=S,o.e.c<g+n&&(o.e.c=g+n),g+=j}}++p}return m.length&&(e["!merges"]=(e["!merges"]||[]).concat(m)),o.e.r=Math.max(o.e.r,p-1+r),e["!ref"]=Pd(o),p>=c&&(e["!fullref"]=Pd((o.e.r=l.length-x+p-1+r,o))),e}function Pp(e,s){return Ip((s||{}).dense?[]:{},e,s)}function Dp(e){var s="",t=function(e){return e.ownerDocument.defaultView&&"function"==typeof e.ownerDocument.defaultView.getComputedStyle?e.ownerDocument.defaultView.getComputedStyle:"function"==typeof getComputedStyle?getComputedStyle:null}(e);return t&&(s=t(e).getPropertyValue("display")),s||(s=e.style&&e.style.display),"none"===s}function Mp(e){var s=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(e,s){return Array(parseInt(s,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"\t").replace(/<text:line-break\/>/g,"\n");return[xo(s.replace(/<[^>]*>/g,""))]}var Op={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function Fp(e,s){var t,a,r,n,i,l,c=s||{},o=Do(e),d=[],m={name:""},h="",u=0,x={},p=[],f=c.dense?[]:{},g={value:""},v="",j=0,y=[],b=-1,N=-1,w={s:{r:1e6,c:1e7},e:{r:0,c:0}},_=0,k={},S=[],E={},T=[],C=1,A=1,R=[],I={Names:[]},P={},D=["",""],M=[],O={},F="",L=0,z=!1,U=!1,B=0;for(Mo.lastIndex=0,o=o.replace(/<!--([\s\S]*?)-->/gm,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");i=Mo.exec(o);)switch(i[3]=i[3].replace(/_.*$/,"")){case"table":case"工作表":"/"===i[1]?(w.e.c>=w.s.c&&w.e.r>=w.s.r?f["!ref"]=Pd(w):f["!ref"]="A1:A1",c.sheetRows>0&&c.sheetRows<=w.e.r&&(f["!fullref"]=f["!ref"],w.e.r=c.sheetRows-1,f["!ref"]=Pd(w)),S.length&&(f["!merges"]=S),T.length&&(f["!rows"]=T),r.name=r["名称"]||r.name,"undefined"!=typeof JSON&&JSON.stringify(r),p.push(r.name),x[r.name]=f,U=!1):"/"!==i[0].charAt(i[0].length-2)&&(r=oo(i[0],!1),b=N=-1,w.s.r=w.s.c=1e7,w.e.r=w.e.c=0,f=c.dense?[]:{},S=[],T=[],U=!0);break;case"table-row-group":"/"===i[1]?--_:++_;break;case"table-row":case"行":if("/"===i[1]){b+=C,C=1;break}if((n=oo(i[0],!1))["行号"]?b=n["行号"]-1:-1==b&&(b=0),(C=+n["number-rows-repeated"]||1)<10)for(B=0;B<C;++B)_>0&&(T[b+B]={level:_});N=-1;break;case"covered-table-cell":"/"!==i[1]&&++N,c.sheetStubs&&(c.dense?(f[b]||(f[b]=[]),f[b][N]={t:"z"}):f[Rd({r:b,c:N})]={t:"z"}),v="",y=[];break;case"table-cell":case"数据":if("/"===i[0].charAt(i[0].length-2))++N,g=oo(i[0],!1),A=parseInt(g["number-columns-repeated"]||"1",10),l={t:"z",v:null},g.formula&&0!=c.cellFormula&&(l.f=fx(xo(g.formula))),"string"==(g["数据类型"]||g["value-type"])&&(l.t="s",l.v=xo(g["string-value"]||""),c.dense?(f[b]||(f[b]=[]),f[b][N]=l):f[Rd({r:b,c:N})]=l),N+=A-1;else if("/"!==i[1]){v="",j=0,y=[],A=1;var $=C?b+C-1:b;if(++N>w.e.c&&(w.e.c=N),N<w.s.c&&(w.s.c=N),b<w.s.r&&(w.s.r=b),$>w.e.r&&(w.e.r=$),M=[],O={},l={t:(g=oo(i[0],!1))["数据类型"]||g["value-type"],v:null},c.cellFormula)if(g.formula&&(g.formula=xo(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(E={s:{r:b,c:N},e:{r:b+(parseInt(g["number-matrix-rows-spanned"],10)||0)-1,c:N+(parseInt(g["number-matrix-columns-spanned"],10)||0)-1}},l.F=Pd(E),R.push([E,l.F])),g.formula)l.f=fx(g.formula);else for(B=0;B<R.length;++B)b>=R[B][0].s.r&&b<=R[B][0].e.r&&N>=R[B][0].s.c&&N<=R[B][0].e.c&&(l.F=R[B][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(E={s:{r:b,c:N},e:{r:b+(parseInt(g["number-rows-spanned"],10)||0)-1,c:N+(parseInt(g["number-columns-spanned"],10)||0)-1}},S.push(E)),g["number-columns-repeated"]&&(A=parseInt(g["number-columns-repeated"],10)),l.t){case"boolean":l.t="b",l.v=jo(g["boolean-value"]);break;case"float":case"percentage":case"currency":l.t="n",l.v=parseFloat(g.value);break;case"date":l.t="d",l.v=zc(g["date-value"]),c.cellDates||(l.t="n",l.v=Ac(l.v)),l.z="m/d/yy";break;case"time":l.t="n",l.v=Mc(g["time-value"])/86400,c.cellDates&&(l.t="d",l.v=Dc(l.v)),l.z="HH:MM:SS";break;case"number":l.t="n",l.v=parseFloat(g["数据数值"]);break;default:if("string"!==l.t&&"text"!==l.t&&l.t)throw new Error("Unsupported value type "+l.t);l.t="s",null!=g["string-value"]&&(v=xo(g["string-value"]),y=[])}}else{if(z=!1,"s"===l.t&&(l.v=v||"",y.length&&(l.R=y),z=0==j),P.Target&&(l.l=P),M.length>0&&(l.c=M,M=[]),v&&!1!==c.cellText&&(l.w=v),z&&(l.t="z",delete l.v),(!z||c.sheetStubs)&&!(c.sheetRows&&c.sheetRows<=b))for(var H=0;H<C;++H){if(A=parseInt(g["number-columns-repeated"]||"1",10),c.dense)for(f[b+H]||(f[b+H]=[]),f[b+H][N]=0==H?l:Bc(l);--A>0;)f[b+H][N+A]=Bc(l);else for(f[Rd({r:b+H,c:N})]=l;--A>0;)f[Rd({r:b+H,c:N+A})]=Bc(l);w.e.c<=N&&(w.e.c=N)}N+=(A=parseInt(g["number-columns-repeated"]||"1",10))-1,A=0,l={},v="",y=[]}P={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if("/"===i[1]){if((t=d.pop())[0]!==i[3])throw"Bad state: "+t}else"/"!==i[0].charAt(i[0].length-2)&&d.push([i[3],!0]);break;case"annotation":if("/"===i[1]){if((t=d.pop())[0]!==i[3])throw"Bad state: "+t;O.t=v,y.length&&(O.R=y),O.a=F,M.push(O)}else"/"!==i[0].charAt(i[0].length-2)&&d.push([i[3],!1]);F="",L=0,v="",j=0,y=[];break;case"creator":"/"===i[1]?F=o.slice(L,i.index):L=i.index+i[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if("/"===i[1]){if((t=d.pop())[0]!==i[3])throw"Bad state: "+t}else"/"!==i[0].charAt(i[0].length-2)&&d.push([i[3],!1]);v="",j=0,y=[];break;case"scientific-number":case"currency-symbol":case"currency-style":case"script":case"libraries":case"automatic-styles":case"default-style":case"page-layout":case"style":case"map":case"font-face":case"paragraph-properties":case"table-properties":case"table-column-properties":case"table-row-properties":case"table-cell-properties":case"fraction":case"boolean-style":case"boolean":case"text-style":case"text-content":case"text-properties":case"embedded-text":case"body":case"电子表格":case"forms":case"table-column":case"table-header-rows":case"table-rows":case"table-column-group":case"table-header-columns":case"table-columns":case"null-date":case"graphic-properties":case"calculation-settings":case"named-expressions":case"label-range":case"label-ranges":case"named-expression":case"sort":case"sort-by":case"sort-groups":case"tab":case"line-break":case"span":case"s":case"date":case"object":case"title":case"标题":case"desc":case"binary-data":case"table-source":case"scenario":case"iteration":case"content-validations":case"content-validation":case"help-message":case"error-message":case"database-ranges":case"filter":case"filter-and":case"filter-or":case"filter-condition":case"list-level-style-bullet":case"list-level-style-number":case"list-level-properties":case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":case"event-listener":case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":case"config-item":case"page-number":case"page-count":case"time":case"cell-range-source":case"detective":case"operation":case"highlighted-range":case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":case"rect":case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":case"properties":case"property":case"table-protection":case"data-pilot-grand-total":case"office-document-common-attrs":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if("/"===i[1]){if(k[m.name]=h,(t=d.pop())[0]!==i[3])throw"Bad state: "+t}else"/"!==i[0].charAt(i[0].length-2)&&(h="",m=oo(i[0],!1),d.push([i[3],!0]));break;case"number":case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(d[d.length-1][0]){case"time-style":case"date-style":a=oo(i[0],!1),h+=Op[i[3]]["long"===a.style?1:0]}break;case"text":if("/>"===i[0].slice(-2))break;if("/"===i[1])switch(d[d.length-1][0]){case"number-style":case"date-style":case"time-style":h+=o.slice(u,i.index)}else u=i.index+i[0].length;break;case"named-range":D=gx((a=oo(i[0],!1))["cell-range-address"]);var V={Name:a.name,Ref:D[0]+"!"+D[1]};U&&(V.Sheet=p.length),I.Names.push(V);break;case"p":case"文本串":if(["master-styles"].indexOf(d[d.length-1][0])>-1)break;if("/"!==i[1]||g&&g["string-value"])oo(i[0],!1),j=i.index+i[0].length;else{var G=Mp(o.slice(j,i.index));v=(v.length>0?v+"\n":"")+G[0]}break;case"database-range":if("/"===i[1])break;try{x[(D=gx(oo(i[0])["target-range-address"]))[0]]["!autofilter"]={ref:D[1]}}catch(W){}break;case"a":if("/"!==i[1]){if(!(P=oo(i[0],!1)).href)break;P.Target=xo(P.href),delete P.href,"#"==P.Target.charAt(0)&&P.Target.indexOf(".")>-1?(D=gx(P.Target.slice(1)),P.Target="#"+D[0]+"!"+D[1]):P.Target.match(/^\.\.[\\\/]/)&&(P.Target=P.Target.slice(3))}break;default:switch(i[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(c.WTF)throw new Error(i)}}var q={Sheets:x,SheetNames:p,Workbook:I};return c.bookSheets&&delete q.Sheets,q}function Lp(e,s){s=s||{},Kc(e,"META-INF/manifest.xml")&&function(e,s){for(var t,a,r=Do(e);t=Mo.exec(r);)switch(t[3]){case"manifest":break;case"file-entry":if("/"==(a=oo(t[0],!1)).path&&"application/vnd.oasis.opendocument.spreadsheet"!==a.type)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(s&&s.WTF)throw t}}(Xc(e,"META-INF/manifest.xml"),s);var t=Zc(e,"content.xml");if(!t)throw new Error("Missing content.xml in ODS / UOF file");var a=Fp(_o(t),s);return Kc(e,"meta.xml")&&(a.Props=gm(Xc(e,"meta.xml"))),a}function zp(e,s){return Fp(e,s)}
/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Up(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Bp(e){return"undefined"!=typeof TextDecoder?(new TextDecoder).decode(e):_o(Tl(e))}function $p(e){var s=e.reduce(function(e,s){return e+s.length},0),t=new Uint8Array(s),a=0;return e.forEach(function(e){t.set(e,a),a+=e.length}),t}function Hp(e){return 16843009*((e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135)>>>24}function Vp(e,s){var t=s?s[0]:0,a=127&e[t];e:if(e[t++]>=128){if(a|=(127&e[t])<<7,e[t++]<128)break e;if(a|=(127&e[t])<<14,e[t++]<128)break e;if(a|=(127&e[t])<<21,e[t++]<128)break e;if(a+=(127&e[t])*Math.pow(2,28),++t,e[t++]<128)break e;if(a+=(127&e[t])*Math.pow(2,35),++t,e[t++]<128)break e;if(a+=(127&e[t])*Math.pow(2,42),++t,e[t++]<128)break e}return s&&(s[0]=t),a}function Gp(e){var s=0,t=127&e[s];e:if(e[s++]>=128){if(t|=(127&e[s])<<7,e[s++]<128)break e;if(t|=(127&e[s])<<14,e[s++]<128)break e;if(t|=(127&e[s])<<21,e[s++]<128)break e;t|=(127&e[s])<<28}return t}function qp(e){for(var s=[],t=[0];t[0]<e.length;){var a,r=t[0],n=Vp(e,t),i=7&n,l=0;if(0==(n=Math.floor(n/8)))break;switch(i){case 0:for(var c=t[0];e[t[0]++]>=128;);a=e.slice(c,t[0]);break;case 5:l=4,a=e.slice(t[0],t[0]+l),t[0]+=l;break;case 1:l=8,a=e.slice(t[0],t[0]+l),t[0]+=l;break;case 2:l=Vp(e,t),a=e.slice(t[0],t[0]+l),t[0]+=l;break;default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(r))}var o={data:a,type:i};null==s[n]?s[n]=[o]:s[n].push(o)}return s}function Wp(e,s){return(null==e?void 0:e.map(function(e){return s(e.data)}))||[]}function Yp(e,s){if(0!=e)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var t=[0],a=Vp(s,t),r=[];t[0]<s.length;){var n=3&s[t[0]];if(0!=n){var i=0,l=0;if(1==n?(l=4+(s[t[0]]>>2&7),i=(224&s[t[0]++])<<3,i|=s[t[0]++]):(l=1+(s[t[0]++]>>2),2==n?(i=s[t[0]]|s[t[0]+1]<<8,t[0]+=2):(i=(s[t[0]]|s[t[0]+1]<<8|s[t[0]+2]<<16|s[t[0]+3]<<24)>>>0,t[0]+=4)),r=[$p(r)],0==i)throw new Error("Invalid offset 0");if(i>r[0].length)throw new Error("Invalid offset beyond length");if(l>=i)for(r.push(r[0].slice(-i)),l-=i;l>=r[r.length-1].length;)r.push(r[r.length-1]),l-=r[r.length-1].length;r.push(r[0].slice(-i,-i+l))}else{var c=s[t[0]++]>>2;if(c<60)++c;else{var o=c-59;c=s[t[0]],o>1&&(c|=s[t[0]+1]<<8),o>2&&(c|=s[t[0]+2]<<16),o>3&&(c|=s[t[0]+3]<<24),c>>>=0,c++,t[0]+=o}r.push(s.slice(t[0],t[0]+c)),t[0]+=c}}var d=$p(r);if(d.length!=a)throw new Error("Unexpected length: ".concat(d.length," != ").concat(a));return d}function Kp(e,s,t){var a,r=Up(e),n=r.getUint32(8,!0),i=12,l=-1,c=-1,o=NaN,d=NaN,m=new Date(2001,0,1);switch(1&n&&(o=function(e,s){for(var t=(127&e[s+15])<<7|e[s+14]>>1,a=1&e[s+14],r=s+13;r>=s;--r)a=256*a+e[r];return(128&e[s+15]?-a:a)*Math.pow(10,t-6176)}(e,i),i+=16),2&n&&(d=r.getFloat64(i,!0),i+=8),4&n&&(m.setTime(m.getTime()+1e3*r.getFloat64(i,!0)),i+=8),8&n&&(c=r.getUint32(i,!0),i+=4),16&n&&(l=r.getUint32(i,!0),i+=4),e[1]){case 0:break;case 2:case 10:a={t:"n",v:o};break;case 3:a={t:"s",v:s[c]};break;case 5:a={t:"d",v:m};break;case 6:a={t:"b",v:d>0};break;case 7:a={t:"n",v:d/86400};break;case 8:a={t:"e",v:0};break;case 9:if(!(l>-1))throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&n," : ").concat(e.slice(0,4)));a={t:"s",v:t[l]};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(31&n," : ").concat(e.slice(0,4)))}return a}function Jp(e,s,t){switch(e[0]){case 0:case 1:case 2:case 3:return function(e,s,t,a){var r,n=Up(e),i=n.getUint32(4,!0),l=(a>1?12:8)+4*Hp(i&(a>1?3470:398)),c=-1,o=-1,d=NaN,m=new Date(2001,0,1);switch(512&i&&(c=n.getUint32(l,!0),l+=4),l+=4*Hp(i&(a>1?12288:4096)),16&i&&(o=n.getUint32(l,!0),l+=4),32&i&&(d=n.getFloat64(l,!0),l+=8),64&i&&(m.setTime(m.getTime()+1e3*n.getFloat64(l,!0)),l+=8),e[2]){case 0:break;case 2:r={t:"n",v:d};break;case 3:r={t:"s",v:s[o]};break;case 5:r={t:"d",v:m};break;case 6:r={t:"b",v:d>0};break;case 7:r={t:"n",v:d/86400};break;case 8:r={t:"e",v:0};break;case 9:if(c>-1)r={t:"s",v:t[c]};else if(o>-1)r={t:"s",v:s[o]};else{if(isNaN(d))throw new Error("Unsupported cell type ".concat(e.slice(0,4)));r={t:"n",v:d}}break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return r}(e,s,t,e[0]);case 5:return Kp(e,s,t);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Xp(e){return Vp(qp(e)[1][0].data)}function Zp(e,s){var t=qp(s.data),a=Gp(t[1][0].data),r=t[3],n=[];return(r||[]).forEach(function(s){var t=qp(s.data),r=Gp(t[1][0].data)>>>0;switch(a){case 1:n[r]=Bp(t[3][0].data);break;case 8:var i=qp(e[Xp(t[9][0].data)][0].data),l=e[Xp(i[1][0].data)][0],c=Gp(l.meta[1][0].data);if(2001!=c)throw new Error("2000 unexpected reference to ".concat(c));var o=qp(l.data);n[r]=o[3].map(function(e){return Bp(e.data)}).join("")}}),n}function Qp(e,s){var t,a=qp(s.data),r=(null==(t=null==a?void 0:a[7])?void 0:t[0])?Gp(a[7][0].data)>>>0>0?1:0:-1,n=Wp(a[5],function(e){return function(e,s){var t,a,r,n,i,l,c,o,d,m,h,u,x,p,f,g,v=qp(e),j=Gp(v[1][0].data)>>>0,y=Gp(v[2][0].data)>>>0,b=(null==(a=null==(t=v[8])?void 0:t[0])?void 0:a.data)&&Gp(v[8][0].data)>0||!1;if((null==(n=null==(r=v[7])?void 0:r[0])?void 0:n.data)&&0!=s)f=null==(l=null==(i=v[7])?void 0:i[0])?void 0:l.data,g=null==(o=null==(c=v[6])?void 0:c[0])?void 0:o.data;else{if(!(null==(m=null==(d=v[4])?void 0:d[0])?void 0:m.data)||1==s)throw"NUMBERS Tile missing ".concat(s," cell storage");f=null==(u=null==(h=v[4])?void 0:h[0])?void 0:u.data,g=null==(p=null==(x=v[3])?void 0:x[0])?void 0:p.data}for(var N=b?4:1,w=Up(f),_=[],k=0;k<f.length/2;++k){var S=w.getUint16(2*k,!0);S<65535&&_.push([k,S])}if(_.length!=y)throw"Expected ".concat(y," cells, found ").concat(_.length);var E=[];for(k=0;k<_.length-1;++k)E[_[k][0]]=g.subarray(_[k][1]*N,_[k+1][1]*N);return _.length>=1&&(E[_[_.length-1][0]]=g.subarray(_[_.length-1][1]*N)),{R:j,cells:E}}(e,r)});return{nrows:Gp(a[4][0].data)>>>0,data:n.reduce(function(e,s){return e[s.R]||(e[s.R]=[]),s.cells.forEach(function(t,a){if(e[s.R][a])throw new Error("Duplicate cell r=".concat(s.R," c=").concat(a));e[s.R][a]=t}),e},[])}}function ef(e,s){var t={"!ref":"A1"},a=e[Xp(qp(s.data)[2][0].data)],r=Gp(a[0].meta[1][0].data);if(6001!=r)throw new Error("6000 unexpected reference to ".concat(r));return function(e,s,t){var a,r=qp(s.data),n={s:{r:0,c:0},e:{r:0,c:0}};if(n.e.r=(Gp(r[6][0].data)>>>0)-1,n.e.r<0)throw new Error("Invalid row varint ".concat(r[6][0].data));if(n.e.c=(Gp(r[7][0].data)>>>0)-1,n.e.c<0)throw new Error("Invalid col varint ".concat(r[7][0].data));t["!ref"]=Pd(n);var i=qp(r[4][0].data),l=Zp(e,e[Xp(i[4][0].data)][0]),c=(null==(a=i[17])?void 0:a[0])?Zp(e,e[Xp(i[17][0].data)][0]):[],o=qp(i[3][0].data),d=0;o[1].forEach(function(s){var a=qp(s.data),r=e[Xp(a[2][0].data)][0],n=Gp(r.meta[1][0].data);if(6002!=n)throw new Error("6001 unexpected reference to ".concat(n));var i=Qp(0,r);i.data.forEach(function(e,s){e.forEach(function(e,a){var r=Rd({r:d+s,c:a}),n=Jp(e,l,c);n&&(t[r]=n)})}),d+=i.nrows})}(e,a[0],t),t}function sf(e,s){var t={SheetNames:[],Sheets:{}};if(Wp(qp(s.data)[1],Xp).forEach(function(s){e[s].forEach(function(s){if(2==Gp(s.meta[1][0].data)){var a=function(e,s){var t,a=qp(s.data),r={name:(null==(t=a[1])?void 0:t[0])?Bp(a[1][0].data):"",sheets:[]};return Wp(a[2],Xp).forEach(function(s){e[s].forEach(function(s){6e3==Gp(s.meta[1][0].data)&&r.sheets.push(ef(e,s))})}),r}(e,s);a.sheets.forEach(function(e,s){bf(t,e,0==s?a.name:a.name+"_"+s,!0)})}})}),0==t.SheetNames.length)throw new Error("Empty NUMBERS file");return t}function tf(e){var s,t,a,r,n={},i=[];if(e.FullPaths.forEach(function(e){if(e.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(e){if(e.name.match(/\.iwa$/)){var s,t;try{s=function(e){for(var s=[],t=0;t<e.length;){var a=e[t++],r=e[t]|e[t+1]<<8|e[t+2]<<16;t+=3,s.push(Yp(a,e.slice(t,t+r))),t+=r}if(t!==e.length)throw new Error("data is not a valid framed stream!");return $p(s)}(e.content)}catch(a){return}try{t=function(e){for(var s,t=[],a=[0];a[0]<e.length;){var r=Vp(e,a),n=qp(e.slice(a[0],a[0]+r));a[0]+=r;var i={id:Gp(n[1][0].data),messages:[]};n[2].forEach(function(s){var t=qp(s.data),r=Gp(t[3][0].data);i.messages.push({meta:t,data:e.slice(a[0],a[0]+r)}),a[0]+=r}),(null==(s=n[3])?void 0:s[0])&&(i.merge=Gp(n[3][0].data)>>>0>0),t.push(i)}return t}(s)}catch(a){return}t.forEach(function(e){n[e.id]=e.messages,i.push(e.id)})}}),!i.length)throw new Error("File has no messages");var l=(null==(r=null==(a=null==(t=null==(s=null==n?void 0:n[1])?void 0:s[0])?void 0:t.meta)?void 0:a[1])?void 0:r[0].data)&&1==Gp(n[1][0].meta[1][0].data)&&n[1][0];if(l||i.forEach(function(e){n[e].forEach(function(e){if(1==Gp(e.meta[1][0].data)>>>0){if(l)throw new Error("Document has multiple roots");l=e}})}),!l)throw new Error("Cannot find Document root");return sf(n,l)}function af(e){var s;(s=[["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]],function(e){for(var t=0;t!=s.length;++t){var a=s[t];void 0===e[a[0]]&&(e[a[0]]=a[1]),"n"===a[2]&&(e[a[0]]=Number(e[a[0]]))}})(e)}function rf(e,s,t,a,r,n,i,l,c,o,d,m){try{n[a]=xm(Zc(e,t,!0),s);var h,u=Xc(e,s);switch(l){case"sheet":h=Zx(u,s,r,c,n[a],o,d,m);break;case"chart":if(!(h=Qx(u,s,r,c,n[a],o))||!h["!drawel"])break;var x=to(h["!drawel"].Target,s),p=um(x),f=function(e,s){if(!e)return"??";var t=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return s["!id"][t].Target}(Zc(e,x,!0),xm(Zc(e,p,!0),x)),g=to(f,x),v=um(g);h=Ux(Zc(e,g,!0),0,0,xm(Zc(e,v,!0),g),0,h);break;case"macro":y=s,n[a],y.slice(-4),h={"!type":"macro"};break;case"dialog":h=function(e,s){return s.slice(-4),{"!type":"dialog"}}(0,s,0,0,n[a]);break;default:throw new Error("Unrecognized sheet type "+l)}i[a]=h;var j=[];n&&n[a]&&Ec(n[a]).forEach(function(t){var r="";if(n[a][t].Type==hm.CMNT){r=to(n[a][t].Target,s);var i=tp(Xc(e,r,!0),r,c);if(!i||!i.length)return;ku(h,i,!1)}n[a][t].Type==hm.TCMNT&&(r=to(n[a][t].Target,s),j=j.concat(function(e,s){var t=[],a=!1,r={},n=0;return e.replace(io,function(i,l){var c=oo(i);switch(mo(c[0])){case"<?xml":case"<ThreadedComments":case"</ThreadedComments>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<threadedComment":r={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":null!=r.t&&t.push(r);break;case"<text>":case"<text":n=l+i.length;break;case"</text>":r.t=e.slice(n,l).replace(/\r\n/g,"\n").replace(/\r/g,"\n");break;case"<mentions":case"<mentions>":case"<ext":a=!0;break;case"</mentions>":case"</ext>":a=!1;break;default:if(!a&&s.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return i}),t}(Xc(e,r,!0),c)))}),j&&j.length&&ku(h,j,!0,c.people||[])}catch(b){if(c.WTF)throw b}var y}function nf(e){return"/"==e.charAt(0)?e.slice(1):e}function lf(e,s){if(Nc(),af(s=s||{}),Kc(e,"META-INF/manifest.xml"))return Lp(e,s);if(Kc(e,"objectdata.xml"))return Lp(e,s);if(Kc(e,"Index/Document.iwa")){if("undefined"==typeof Uint8Array)throw new Error("NUMBERS file parsing requires Uint8Array support");if(void 0!==tf){if(e.FileIndex)return tf(e);var t=Sc.utils.cfb_new();return Qc(e).forEach(function(s){eo(t,s,function(e,s){return Yc(Jc(e,s))}(e,s))}),tf(t)}throw new Error("Unsupported NUMBERS file")}if(!Kc(e,"[Content_Types].xml")){if(Kc(e,"index.xml.gz"))throw new Error("Unsupported NUMBERS 08 file");if(Kc(e,"index.xml"))throw new Error("Unsupported NUMBERS 09 file");throw new Error("Unsupported ZIP file")}var a,r,n=Qc(e),i=function(e){var s={workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""};if(!e||!e.match)return s;var t={};if((e.match(io)||[]).forEach(function(e){var a=oo(e);switch(a[0].replace(lo,"<")){case"<?xml":break;case"<Types":s.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":t[a.Extension]=a.ContentType;break;case"<Override":void 0!==s[mm[a.ContentType]]&&s[mm[a.ContentType]].push(a.PartName)}}),s.xmlns!==Oo)throw new Error("Unknown Namespace: "+s.xmlns);return s.calcchain=s.calcchains.length>0?s.calcchains[0]:"",s.sst=s.strs.length>0?s.strs[0]:"",s.style=s.styles.length>0?s.styles[0]:"",s.defaults=t,delete s.calcchains,s}(Zc(e,"[Content_Types].xml")),l=!1;if(0===i.workbooks.length&&Xc(e,r="xl/workbook.xml",!0)&&i.workbooks.push(r),0===i.workbooks.length){if(!Xc(e,r="xl/workbook.bin",!0))throw new Error("Could not find workbook");i.workbooks.push(r),l=!0}"bin"==i.workbooks[0].slice(-3)&&(l=!0);var c={},o={};if(!s.bookSheets&&!s.bookProps){if(vx=[],i.sst)try{vx=sp(Xc(e,nf(i.sst)),i.sst,s)}catch(A){if(s.WTF)throw A}s.cellStyles&&i.themes.length&&(c=function(e,s,t){return bu(e,t)}(Zc(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],s)),i.style&&(o=ep(Xc(e,nf(i.style)),i.style,c,s))}i.links.map(function(t){try{xm(Zc(e,um(nf(t))),t);return rp(Xc(e,nf(t)),0,t,s)}catch(A){}});var d=Xx(Xc(e,nf(i.workbooks[0])),i.workbooks[0],s),m={},h="";i.coreprops.length&&((h=Xc(e,nf(i.coreprops[0]),!0))&&(m=gm(h)),0!==i.extprops.length&&(h=Xc(e,nf(i.extprops[0]),!0))&&function(e,s,t){var a={};s||(s={}),e=_o(e),vm.forEach(function(t){var r=(e.match(So(t[0]))||[])[1];switch(t[2]){case"string":r&&(s[t[1]]=xo(r));break;case"bool":s[t[1]]="true"===r;break;case"raw":var n=e.match(new RegExp("<"+t[0]+"[^>]*>([\\s\\S]*?)</"+t[0]+">"));n&&n.length>0&&(a[t[1]]=n[1])}}),a.HeadingPairs&&a.TitlesOfParts&&jm(a.HeadingPairs,a.TitlesOfParts,s,t)}(h,m,s));var u={};s.bookSheets&&!s.bookProps||0!==i.custprops.length&&(h=Zc(e,nf(i.custprops[0]),!0))&&(u=function(e,s){var t={},a="",r=e.match(ym);if(r)for(var n=0;n!=r.length;++n){var i=r[n],l=oo(i);switch(l[0]){case"<?xml":case"<Properties":break;case"<property":a=xo(l.name);break;case"</property>":a=null;break;default:if(0===i.indexOf("<vt:")){var c=i.split(">"),o=c[0].slice(4),d=c[1];switch(o){case"lpstr":case"bstr":case"lpwstr":case"cy":case"error":t[a]=xo(d);break;case"bool":t[a]=jo(d);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":t[a]=parseInt(d,10);break;case"r4":case"r8":case"decimal":t[a]=parseFloat(d);break;case"filetime":case"date":t[a]=zc(d);break;default:if("/"==o.slice(-1))break;s.WTF}}else if("</"===i.slice(0,2));else if(s.WTF)throw new Error(i)}}return t}(h,s));var x={};if((s.bookSheets||s.bookProps)&&(d.Sheets?a=d.Sheets.map(function(e){return e.name}):m.Worksheets&&m.SheetNames.length>0&&(a=m.SheetNames),s.bookProps&&(x.Props=m,x.Custprops=u),s.bookSheets&&void 0!==a&&(x.SheetNames=a),s.bookSheets?x.SheetNames:s.bookProps))return x;a={};var p={};s.bookDeps&&i.calcchain&&(p=ap(Xc(e,nf(i.calcchain)),i.calcchain));var f,g,v=0,j={},y=d.Sheets;m.Worksheets=y.length,m.SheetNames=[];for(var b=0;b!=y.length;++b)m.SheetNames[b]=y[b].name;var N=l?"bin":"xml",w=i.workbooks[0].lastIndexOf("/"),_=(i.workbooks[0].slice(0,w+1)+"_rels/"+i.workbooks[0].slice(w+1)+".rels").replace(/^\//,"");Kc(e,_)||(_="xl/_rels/workbook."+N+".rels");var k=xm(Zc(e,_,!0),_.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(s.xlmeta=np(Xc(e,nf(i.metadata[0])),i.metadata[0],s)),(i.people||[]).length>=1&&(s.people=function(e,s){var t=[],a=!1;return e.replace(io,function(e){var r=oo(e);switch(mo(r[0])){case"<?xml":case"<personList":case"</personList>":case"</person>":case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<person":t.push({name:r.displayname,id:r.id});break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(!a&&s.WTF)throw new Error("unrecognized "+r[0]+" in threaded comments")}return e}),t}(Xc(e,nf(i.people[0])),s)),k&&(k=function(e,s){if(!e)return 0;try{e=s.map(function(s){return s.id||(s.id=s.strRelID),[s.name,e["!id"][s.id].Target,(t=e["!id"][s.id].Type,hm.WS.indexOf(t)>-1?"sheet":t==hm.CS?"chart":t==hm.DS?"dialog":t==hm.MS?"macro":t&&t.length?t:"sheet")];var t})}catch(A){return null}return e&&0!==e.length?e:null}(k,d.Sheets));var S=Xc(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(v=0;v!=m.Worksheets;++v){var E="sheet";if(k&&k[v]?(f="xl/"+k[v][1].replace(/[\/]?xl\//,""),Kc(e,f)||(f=k[v][1]),Kc(e,f)||(f=_.replace(/_rels\/.*$/,"")+k[v][1]),E=k[v][2]):f=(f="xl/worksheets/sheet"+(v+1-S)+"."+N).replace(/sheet0\./,"sheet."),g=f.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),s&&null!=s.sheets)switch(typeof s.sheets){case"number":if(v!=s.sheets)continue e;break;case"string":if(m.SheetNames[v].toLowerCase()!=s.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(s.sheets)){for(var T=!1,C=0;C!=s.sheets.length;++C)"number"==typeof s.sheets[C]&&s.sheets[C]==v&&(T=1),"string"==typeof s.sheets[C]&&s.sheets[C].toLowerCase()==m.SheetNames[v].toLowerCase()&&(T=1);if(!T)continue e}}rf(e,f,g,m.SheetNames[v],v,j,a,E,s,d,c,o)}return x={Directory:i,Workbook:d,Props:m,Custprops:u,Deps:p,Sheets:a,SheetNames:m.SheetNames,Strings:vx,Styles:o,Themes:c,SSF:Bc($l)},s&&s.bookFiles&&(e.files?(x.keys=n,x.files=e.files):(x.keys=[],x.files={},e.FullPaths.forEach(function(s,t){s=s.replace(/^Root Entry[\/]/,""),x.keys.push(s),x.files[s]=e.FileIndex[t]}))),s&&s.bookVBA&&(i.vba.length>0?x.vbaraw=Xc(e,nf(i.vba[0]),!0):i.defaults&&"application/vnd.ms-office.vbaProject"===i.defaults.bin&&(x.vbaraw=Xc(e,"xl/vbaProject.bin",!0))),x}function cf(e,s){var t,a,r=s||{},n="Workbook",i=Sc.find(e,n);try{if(n="/!DataSpaces/Version",!(i=Sc.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(t=i.content,(a={}).id=t.read_shift(0,"lpp4"),a.R=Oh(t,4),a.U=Oh(t,4),a.W=Oh(t,4),n="/!DataSpaces/DataSpaceMap",!(i=Sc.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var l=function(e){var s=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)s.push(Fh(e));return s}(i.content);if(1!==l.length||1!==l[0].comps.length||0!==l[0].comps[0].t||"StrongEncryptionDataSpace"!==l[0].name||"EncryptedPackage"!==l[0].comps[0].v)throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",!(i=Sc.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var c=function(e){var s=[];e.l+=4;for(var t=e.read_shift(4);t-- >0;)s.push(e.read_shift(0,"lpp4"));return s}(i.content);if(1!=c.length||"StrongEncryptionTransform"!=c[0])throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",!(i=Sc.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);Lh(i.content)}catch(d){}if(n="/EncryptionInfo",!(i=Sc.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=function(e){var s=Oh(e);switch(s.Minor){case 2:return[s.Minor,Bh(e)];case 3:return[s.Minor,$h()];case 4:return[s.Minor,Hh(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+s.Minor)}(i.content);if(n="/EncryptedPackage",!(i=Sc.find(e,n))||!i.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(4==o[0]&&"undefined"!=typeof decrypt_agile)return decrypt_agile(o[1],i.content,r.password||"",r);if(2==o[0]&&"undefined"!=typeof decrypt_std76)return decrypt_std76(o[1],i.content,r.password||"",r);throw new Error("File is password-protected")}function of(e,s){var t="";switch((s||{}).type||"base64"){case"buffer":case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":t=Nl(e.slice(0,12));break;case"binary":t=e;break;default:throw new Error("Unrecognized type "+(s&&s.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function df(e,s){var t=0;e:for(;t<e.length;)switch(e.charCodeAt(t)){case 10:case 13:case 32:++t;break;case 60:return gp(e.slice(t),s);default:break e}return _h.to_workbook(e,s)}function mf(e,s,t,a){return a?(t.type="string",_h.to_workbook(e,t)):_h.to_workbook(s,t)}function hf(e,s){ul();var t=s||{};if("undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer)return hf(new Uint8Array(e),((t=Bc(t)).type="array",t));"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&!t.type&&(t.type="undefined"!=typeof Deno?"buffer":"array");var a,r=e,n=!1;if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),jx={},t.dateNF&&(jx.dateNF=t.dateNF),t.type||(t.type=wl&&Buffer.isBuffer(e)?"buffer":"base64"),"file"==t.type&&(t.type=wl?"buffer":"binary",r=function(e){if("undefined"!=typeof Deno)return Deno.readFileSync(e);if("undefined"!=typeof $&&"undefined"!=typeof File&&"undefined"!=typeof Folder)try{var s=File(e);s.open("r"),s.encoding="binary";var t=s.read();return s.close(),t}catch(a){if(!a.message||!a.message.match(/onstruct/))throw a}throw new Error("Cannot access file "+e)}(e),"undefined"==typeof Uint8Array||wl||(t.type="array")),"string"==t.type&&(n=!0,t.type="binary",t.codepage=65001,r=function(e){return e.match(/[^\x00-\x7F]/)?ko(e):e}(e)),"array"==t.type&&"undefined"!=typeof Uint8Array&&e instanceof Uint8Array&&"undefined"!=typeof ArrayBuffer){var i=new ArrayBuffer(3),l=new Uint8Array(i);if(l.foo="bar",!l.foo)return(t=Bc(t)).type="array",hf(Cl(r),t)}switch((a=of(r,t))[0]){case 208:if(207===a[1]&&17===a[2]&&224===a[3]&&161===a[4]&&177===a[5]&&26===a[6]&&225===a[7])return function(e,s){return Sc.find(e,"EncryptedPackage")?cf(e,s):Sp(e,s)}(Sc.read(r,t),t);break;case 9:if(a[1]<=8)return Sp(r,t);break;case 60:return gp(r,t);case 73:if(73===a[1]&&42===a[2]&&0===a[3])throw new Error("TIFF Image File is not a spreadsheet");if(68===a[1])return function(e,s){var t=s||{},a=!!t.WTF;t.WTF=!0;try{var r=bh.to_workbook(e,t);return t.WTF=a,r}catch(n){if(t.WTF=a,!n.message.match(/SYLK bad record ID/)&&a)throw n;return _h.to_workbook(e,s)}}(r,t);break;case 84:if(65===a[1]&&66===a[2]&&76===a[3])return Nh.to_workbook(r,t);break;case 80:return 75===a[1]&&a[2]<9&&a[3]<9?function(e,s){var t=e,a=s||{};return a.type||(a.type=wl&&Buffer.isBuffer(e)?"buffer":"base64"),lf(so(t,a),a)}(r,t):mf(e,r,t,n);case 239:return 60===a[3]?gp(r,t):mf(e,r,t,n);case 255:if(254===a[1])return function(e,s){var t=e;return"base64"==s.type&&(t=Nl(t)),t=fl.utils.decode(1200,t.slice(2),"str"),s.type="binary",df(t,s)}(r,t);if(0===a[1]&&2===a[2]&&0===a[3])return kh.to_workbook(r,t);break;case 0:if(0===a[1]){if(a[2]>=2&&0===a[3])return kh.to_workbook(r,t);if(0===a[2]&&(8===a[3]||9===a[3]))return kh.to_workbook(r,t)}break;case 3:case 131:case 139:case 140:return yh.to_workbook(r,t);case 123:if(92===a[1]&&114===a[2]&&116===a[3])return Yh.to_workbook(r,t);break;case 10:case 13:case 32:return function(e,s){var t="",a=of(e,s);switch(s.type){case"base64":t=Nl(e);break;case"binary":t=e;break;case"buffer":t=e.toString("binary");break;case"array":t=Uc(e);break;default:throw new Error("Unrecognized type "+s.type)}return 239==a[0]&&187==a[1]&&191==a[2]&&(t=_o(t)),s.type="binary",df(t,s)}(r,t);case 137:if(80===a[1]&&78===a[2]&&71===a[3])throw new Error("PNG Image File is not a spreadsheet")}return jh.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?yh.to_workbook(r,t):mf(e,r,t,n)}function uf(e,s,t,a,r,n,i,l){var c=Ed(t),o=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),m=!0,h=1===r?[]:{};if(1!==r)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:t,enumerable:!1})}catch(f){h.__rowNum__=t}else h.__rowNum__=t;if(!i||e[t])for(var u=s.s.c;u<=s.e.c;++u){var x=i?e[t][u]:e[a[u]+c];if(void 0!==x&&void 0!==x.t){var p=x.v;switch(x.t){case"z":if(null==p)break;continue;case"e":p=0==p?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+x.t)}if(null!=n[u]){if(null==p)if("e"==x.t&&null===p)h[n[u]]=null;else if(void 0!==o)h[n[u]]=o;else{if(!d||null!==p)continue;h[n[u]]=null}else h[n[u]]=d&&("n"!==x.t||"n"===x.t&&!1!==l.rawNumbers)?p:Od(x,p,l);null!=p&&(m=!1)}}else{if(void 0===o)continue;null!=n[u]&&(h[n[u]]=o)}}return{row:h,isempty:m}}function xf(e,s){if(null==e||null==e["!ref"])return[];var t={t:"n",v:0},a=0,r=1,n=[],i=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},o=s||{},d=null!=o.range?o.range:e["!ref"];switch(1===o.header?a=1:"A"===o.header?a=2:Array.isArray(o.header)?a=3:null==o.header&&(a=0),typeof d){case"string":c=Dd(d);break;case"number":(c=Dd(e["!ref"])).s.r=d;break;default:c=d}a>0&&(r=0);var m=Ed(c.s.r),h=[],u=[],x=0,p=0,f=Array.isArray(e),g=c.s.r,v=0,j={};f&&!e[g]&&(e[g]=[]);var y=o.skipHidden&&e["!cols"]||[],b=o.skipHidden&&e["!rows"]||[];for(v=c.s.c;v<=c.e.c;++v)if(!(y[v]||{}).hidden)switch(h[v]=Cd(v),t=f?e[g][v]:e[h[v]+m],a){case 1:n[v]=v-c.s.c;break;case 2:n[v]=h[v];break;case 3:n[v]=o.header[v-c.s.c];break;default:if(null==t&&(t={w:"__EMPTY",t:"s"}),l=i=Od(t,null,o),p=j[i]||0){do{l=i+"_"+p++}while(j[l]);j[i]=p,j[l]=1}else j[i]=1;n[v]=l}for(g=c.s.r+r;g<=c.e.r;++g)if(!(b[g]||{}).hidden){var N=uf(e,c,g,h,a,n,f,o);(!1===N.isempty||(1===a?!1!==o.blankrows:o.blankrows))&&(u[x++]=N.row)}return u.length=x,u}var pf=/"/g;function ff(e,s,t,a,r,n,i,l){for(var c=!0,o=[],d="",m=Ed(t),h=s.s.c;h<=s.e.c;++h)if(a[h]){var u=l.dense?(e[t]||[])[h]:e[a[h]+m];if(null==u)d="";else if(null!=u.v){c=!1,d=""+(l.rawNumbers&&"n"==u.t?u.v:Od(u,null,l));for(var x=0,p=0;x!==d.length;++x)if((p=d.charCodeAt(x))===r||p===n||34===p||l.forceQuotes){d='"'+d.replace(pf,'""')+'"';break}"ID"==d&&(d='"ID"')}else null==u.f||u.F?d="":(c=!1,(d="="+u.f).indexOf(",")>=0&&(d='"'+d.replace(pf,'""')+'"'));o.push(d)}return!1===l.blankrows&&c?null:o.join(i)}function gf(e,s){var t=[],a=null==s?{}:s;if(null==e||null==e["!ref"])return"";var r=Dd(e["!ref"]),n=void 0!==a.FS?a.FS:",",i=n.charCodeAt(0),l=void 0!==a.RS?a.RS:"\n",c=l.charCodeAt(0),o=new RegExp(("|"==n?"\\|":n)+"+$"),d="",m=[];a.dense=Array.isArray(e);for(var h=a.skipHidden&&e["!cols"]||[],u=a.skipHidden&&e["!rows"]||[],x=r.s.c;x<=r.e.c;++x)(h[x]||{}).hidden||(m[x]=Cd(x));for(var p=0,f=r.s.r;f<=r.e.r;++f)(u[f]||{}).hidden||null!=(d=ff(e,r,f,m,i,c,n,a))&&(a.strip&&(d=d.replace(o,"")),(d||!1!==a.blankrows)&&t.push((p++?l:"")+d));return delete a.dense,t.join("")}function vf(e,s,t){var a,r=t||{},n=+!r.skipHeader,i=e||{},l=0,c=0;if(i&&null!=r.origin)if("number"==typeof r.origin)l=r.origin;else{var o="string"==typeof r.origin?Ad(r.origin):r.origin;l=o.r,c=o.c}var d={s:{c:0,r:0},e:{c:c,r:l+s.length-1+n}};if(i["!ref"]){var m=Dd(i["!ref"]);d.e.c=Math.max(d.e.c,m.e.c),d.e.r=Math.max(d.e.r,m.e.r),-1==l&&(l=m.e.r+1,d.e.r=l+s.length-1+n)}else-1==l&&(l=0,d.e.r=s.length-1+n);var h=r.header||[],u=0;s.forEach(function(e,s){Ec(e).forEach(function(t){-1==(u=h.indexOf(t))&&(h[u=h.length]=t);var o=e[t],d="z",m="",x=Rd({c:c+u,r:l+s+n});a=jf(i,x),!o||"object"!=typeof o||o instanceof Date?("number"==typeof o?d="n":"boolean"==typeof o?d="b":"string"==typeof o?d="s":o instanceof Date?(d="d",r.cellDates||(d="n",o=Ac(o)),m=r.dateNF||$l[14]):null===o&&r.nullError&&(d="e",o=0),a?(a.t=d,a.v=o,delete a.w,delete a.R,m&&(a.z=m)):i[x]=a={t:d,v:o},m&&(a.z=m)):i[x]=o})}),d.e.c=Math.max(d.e.c,c+h.length-1);var x=Ed(l);if(n)for(u=0;u<h.length;++u)i[Cd(u+c)+x]={t:"s",v:h[u]};return i["!ref"]=Pd(d),i}function jf(e,s,t){if("string"==typeof s){if(Array.isArray(e)){var a=Ad(s);return e[a.r]||(e[a.r]=[]),e[a.r][a.c]||(e[a.r][a.c]={t:"z"})}return e[s]||(e[s]={t:"z"})}return jf(e,Rd("number"!=typeof s?s:{r:s,c:t||0}))}function yf(){return{SheetNames:[],Sheets:{}}}function bf(e,s,t,a){var r=1;if(!t)for(;r<=65535&&-1!=e.SheetNames.indexOf(t="Sheet"+r);++r,t=void 0);if(!t||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&e.SheetNames.indexOf(t)>=0){var n=t.match(/(^.*?)(\d+)$/);r=n&&+n[2]||0;var i=n&&n[1]||t;for(++r;r<=65535&&-1!=e.SheetNames.indexOf(t=i+r);++r);}if(function(e){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");Yx.forEach(function(s){if(-1!=e.indexOf(s))throw new Error("Sheet name cannot contain : \\ / ? * [ ]")})}(t),e.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return e.SheetNames.push(t),e.Sheets[t]=s,t}function Nf(e,s,t){return s?(e.l={Target:s},t&&(e.l.Tooltip=t)):delete e.l,e}var wf={encode_col:Cd,encode_row:Ed,encode_cell:Rd,encode_range:Pd,decode_col:Td,decode_row:Sd,split_cell:function(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")},decode_cell:Ad,decode_range:Id,format_cell:Od,sheet_add_aoa:Ld,sheet_add_json:vf,sheet_add_dom:Ip,aoa_to_sheet:zd,json_to_sheet:function(e,s){return vf(null,e,s)},table_to_sheet:Pp,table_to_book:function(e,s){return Fd(Pp(e,s),s)},sheet_to_csv:gf,sheet_to_txt:function(e,s){return s||(s={}),s.FS="\t",s.RS="\n",gf(e,s)},sheet_to_json:xf,sheet_to_html:function(e,s){var t=s||{},a=null!=t.header?t.header:'<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',r=null!=t.footer?t.footer:"</body></html>",n=[a],i=Id(e["!ref"]);t.dense=Array.isArray(e),n.push(function(e,s,t){return[].join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}(0,0,t));for(var l=i.s.r;l<=i.e.r;++l)n.push(Rp(e,i,l,t));return n.push("</table>"+r),n.join("")},sheet_to_formulae:function(e){var s,t="",a="";if(null==e||null==e["!ref"])return[];var r,n=Dd(e["!ref"]),i="",l=[],c=[],o=Array.isArray(e);for(r=n.s.c;r<=n.e.c;++r)l[r]=Cd(r);for(var d=n.s.r;d<=n.e.r;++d)for(i=Ed(d),r=n.s.c;r<=n.e.c;++r)if(t=l[r]+i,a="",void 0!==(s=o?(e[d]||[])[r]:e[t])){if(null!=s.F){if(t=s.F,!s.f)continue;a=s.f,-1==t.indexOf(":")&&(t=t+":"+t)}if(null!=s.f)a=s.f;else{if("z"==s.t)continue;if("n"==s.t&&null!=s.v)a=""+s.v;else if("b"==s.t)a=s.v?"TRUE":"FALSE";else if(void 0!==s.w)a="'"+s.w;else{if(void 0===s.v)continue;a="s"==s.t?"'"+s.v:""+s.v}}c[c.length]=t+"="+a}return c},sheet_to_row_object_array:xf,sheet_get_cell:jf,book_new:yf,book_append_sheet:bf,book_set_sheet_visibility:function(e,s,t){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var a=function(e,s){if("number"==typeof s){if(s>=0&&e.SheetNames.length>s)return s;throw new Error("Cannot find sheet # "+s)}if("string"==typeof s){var t=e.SheetNames.indexOf(s);if(t>-1)return t;throw new Error("Cannot find sheet name |"+s+"|")}throw new Error("Cannot find sheet |"+s+"|")}(e,s);switch(e.Workbook.Sheets[a]||(e.Workbook.Sheets[a]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}e.Workbook.Sheets[a].Hidden=t},cell_set_number_format:function(e,s){return e.z=s,e},cell_set_hyperlink:Nf,cell_set_internal_link:function(e,s,t){return Nf(e,"#"+s,t)},cell_add_comment:function(e,s,t){e.c||(e.c=[]),e.c.push({t:s,a:t||"SheetJS"})},sheet_set_array_formula:function(e,s,t,a){for(var r="string"!=typeof s?s:Dd(s),n="string"==typeof s?s:Pd(s),i=r.s.r;i<=r.e.r;++i)for(var l=r.s.c;l<=r.e.c;++l){var c=jf(e,i,l);c.t="n",c.F=n,delete c.v,i==r.s.r&&l==r.s.c&&(c.f=t,a&&(c.D=!0))}return e},consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const _f=()=>{const{toast:e}=De(),{user:s}=tn(),[t,a]=ce.useState([]),[r,n]=ce.useState([]),[l,c]=ce.useState([]),[o,d]=ce.useState([]),[m,h]=ce.useState(!1),[u,x]=ce.useState(0),[p,f]=ce.useState(""),[g,v]=ce.useState(null),[j,y]=ce.useState(""),[b,N]=ce.useState(!1),[w,_]=ce.useState(!1),[k,S]=ce.useState(!1),E=ce.useCallback((e,s)=>new Promise((t,a)=>{const r=new FileReader;r.onload=r=>{var n;try{const a=hf(null==(n=r.target)?void 0:n.result,{type:"array"}),i=a.SheetNames[0],l=a.Sheets[i],c=wf.sheet_to_json(l,{header:1}),o=c[0],d=c.slice(1);t({fileName:e.name,headers:o.filter(e=>e&&String(e).trim()),rows:d.filter(e=>e.some(e=>e&&String(e).trim())),type:s})}catch(i){a(i)}},r.onerror=()=>a(new Error("File reading failed")),r.readAsArrayBuffer(e)}),[]),T=ce.useCallback((e,s,t)=>{const r=Array.from(e.target.files||[]);"upload-only"===t?"xl"===s?a(r):n(r):"xl"===s?c(r):d(r)},[]);return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("h2",{className:"text-2xl font-bold flex items-center justify-center gap-3",children:[i.jsx($t,{className:"h-6 w-6 text-primary"}),"Role Management Options"]}),i.jsx("p",{className:"text-muted-foreground mt-2",children:"Choose how you want to process your role data"}),i.jsxs("div",{className:"flex items-center justify-center gap-2 mt-4",children:[i.jsxs(nn,{variant:"outline",size:"sm",onClick:()=>_(!0),className:"flex items-center gap-2",children:[i.jsx(Js,{className:"h-4 w-4"}),"🔍 Upload Debugger"]}),i.jsxs(nn,{variant:"outline",size:"sm",onClick:()=>S(!0),className:"flex items-center gap-2",children:[i.jsx(Qs,{className:"h-4 w-4"}),"📋 View Uploaded Roles"]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-4xl mx-auto",children:[i.jsxs(fn,{className:"hover:shadow-lg transition-shadow duration-200",children:[i.jsxs(gn,{className:"text-center",children:[i.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:i.jsx(Js,{className:"h-6 w-6 text-blue-600"})}),i.jsx(vn,{className:"text-xl",children:"Upload Only"}),i.jsx("p",{className:"text-muted-foreground text-sm",children:"Simply upload your role data to the system without AI processing"})]}),i.jsx(yn,{className:"space-y-4",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs(hn,{defaultValue:"xl",className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-2",children:[i.jsxs(xn,{value:"xl",className:"flex items-center gap-2",children:[i.jsx(st,{className:"h-4 w-4"}),"XL Roles"]}),i.jsxs(xn,{value:"smart",className:"flex items-center gap-2",children:[i.jsx(Zt,{className:"h-4 w-4"}),"Smart Roles"]})]}),i.jsxs(pn,{value:"xl",className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"xl-files-upload",children:"XL Role Catalog Files"}),i.jsx(ln,{id:"xl-files-upload",type:"file",accept:Gi.ALLOWED_TYPES.map(e=>e.includes("spreadsheetml")?".xlsx":e.includes("ms-excel")?".xls":"").filter(Boolean).join(","),multiple:!0,onChange:e=>T(e,"xl","upload-only"),disabled:m})]}),t.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm font-medium",children:"Selected XL files:"}),t.map((e,s)=>i.jsxs("div",{className:"flex items-center gap-2 text-sm p-2 bg-blue-50 rounded",children:[i.jsx(st,{className:"h-4 w-4 text-blue-600"}),i.jsx("span",{children:e.name}),i.jsxs(zn,{variant:"outline",className:"text-xs",children:[(e.size/1024).toFixed(1)," KB"]})]},s))]})]}),i.jsxs(pn,{value:"smart",className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"smart-files-upload",children:"Smart Role Catalog Files"}),i.jsx(ln,{id:"smart-files-upload",type:"file",accept:Gi.ALLOWED_TYPES.map(e=>e.includes("spreadsheetml")?".xlsx":e.includes("ms-excel")?".xls":"").filter(Boolean).join(","),multiple:!0,onChange:e=>T(e,"smart","upload-only"),disabled:m})]}),r.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm font-medium",children:"Selected Smart files:"}),r.map((e,s)=>i.jsxs("div",{className:"flex items-center gap-2 text-sm p-2 bg-green-50 rounded",children:[i.jsx(st,{className:"h-4 w-4 text-green-600"}),i.jsx("span",{children:e.name}),i.jsxs(zn,{variant:"outline",className:"text-xs",children:[(e.size/1024).toFixed(1)," KB"]})]},s))]})]})]}),i.jsx(nn,{onClick:()=>(async(a="upload-only")=>{const n="upload-only"===a?t:l,i="upload-only"===a?r:o;if(0===n.length&&0===i.length)return void e({title:"No files selected",description:"Please select at least one Excel file",variant:"destructive"});if(!s)return void e({title:"Authentication Required",description:"Please log in to use this feature",variant:"destructive"});const{data:{user:c},error:d}=await en.auth.getUser();if(!d&&c){h(!0),x(0),v(null);try{f("📊 Parsing Excel files..."),x(20);const t=[...n,...i],a=[];for(const e of n){const s=await E(e,"xl");a.push(s)}for(const e of i){const s=await E(e,"smart");a.push(s)}f("🔐 Creating upload session..."),x(40);const{data:r,error:l}=await en.from("xlsmart_upload_sessions").insert({session_name:`Role Upload ${(new Date).toISOString()}: ${t.map(e=>e.name).join(", ")}`,file_names:t.map(e=>e.name),temp_table_names:[],total_rows:a.reduce((e,s)=>e+s.rows.length,0),status:"uploading",created_by:s.id,ai_analysis:{step:"upload_started",xl_files:a.filter(e=>"xl"===e.type).length,smart_files:a.filter(e=>"smart"===e.type).length,raw_data:a}}).select().single();if(l)throw l;y(r.id),f("💾 Uploading to database..."),x(60);const c=a.filter(e=>"xl"===e.type).flatMap(e=>e.rows.map(s=>{const t={};return e.headers.forEach((e,a)=>{t[e]=s[a]}),t})),o=a.filter(e=>"smart"===e.type).flatMap(e=>e.rows.map(s=>{const t={};return e.headers.forEach((e,a)=>{t[e]=s[a]}),t})),{data:d,error:m}=await en.functions.invoke("upload-role-data",{body:{sessionId:r.id,xlData:c,smartData:o}});if(m)throw new Error(`Upload failed: ${m.message}`);if(!(null==d?void 0:d.success))throw new Error((null==d?void 0:d.error)||"Upload failed");x(100),f("✅ Upload completed!"),N(!0),d.skipped?e({title:"ℹ️ Data Already Exists",description:`${d.xlCount+d.smartCount} roles already uploaded for this session`,duration:5e3}):e({title:"🎉 Upload Success!",description:`Uploaded ${d.totalInserted} new roles to database. Click "View Uploaded Roles" to see and standardize them.`,duration:8e3})}catch(m){e({title:"❌ Upload Failed",description:m instanceof Error?m.message:"Unknown error occurred",variant:"destructive"})}finally{h(!1),f("")}}else e({title:"Session Expired",description:"Please refresh the page and log in again",variant:"destructive"})})("upload-only"),disabled:0===t.length&&0===r.length||!s||m,className:"w-full",variant:"outline",children:m?i.jsxs(i.Fragment,{children:[i.jsx(Js,{className:"mr-2 h-4 w-4 animate-spin"}),"Uploading..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Js,{className:"mr-2 h-4 w-4"}),"Upload to System"]})}),i.jsxs(nn,{variant:"outline",onClick:()=>S(!0),className:"w-full",children:[i.jsx(Qs,{className:"mr-2 h-4 w-4"}),"View Uploaded Roles"]})]})})]}),i.jsxs(fn,{className:"hover:shadow-lg transition-shadow duration-200 border-primary/20",children:[i.jsxs(gn,{className:"text-center",children:[i.jsx("div",{className:"mx-auto w-12 h-12 bg-gradient-to-br from-primary/10 to-primary/20 rounded-full flex items-center justify-center mb-4",children:i.jsx(Rs,{className:"h-6 w-6 text-primary"})}),i.jsx(vn,{className:"text-xl",children:"Upload & Standardize"}),i.jsx("p",{className:"text-muted-foreground text-sm",children:"Upload and let AI standardize your roles automatically"})]}),i.jsx(yn,{className:"space-y-4",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs(hn,{defaultValue:"xl-std",className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-2",children:[i.jsxs(xn,{value:"xl-std",className:"flex items-center gap-2",children:[i.jsx(st,{className:"h-4 w-4"}),"XL Roles"]}),i.jsxs(xn,{value:"smart-std",className:"flex items-center gap-2",children:[i.jsx(Zt,{className:"h-4 w-4"}),"Smart Roles"]})]}),i.jsxs(pn,{value:"xl-std",className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"xl-files-std",children:"XL Role Catalog Files"}),i.jsx(ln,{id:"xl-files-std",type:"file",accept:Gi.ALLOWED_TYPES.map(e=>e.includes("spreadsheetml")?".xlsx":e.includes("ms-excel")?".xls":"").filter(Boolean).join(","),multiple:!0,onChange:e=>T(e,"xl","standardize"),disabled:m})]}),l.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm font-medium",children:"Selected XL files:"}),l.map((e,s)=>i.jsxs("div",{className:"flex items-center gap-2 text-sm p-2 bg-blue-50 rounded",children:[i.jsx(st,{className:"h-4 w-4 text-blue-600"}),i.jsx("span",{children:e.name}),i.jsxs(zn,{variant:"outline",className:"text-xs",children:[(e.size/1024).toFixed(1)," KB"]})]},s))]})]}),i.jsxs(pn,{value:"smart-std",className:"space-y-3",children:[i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"smart-files-std",children:"Smart Role Catalog Files"}),i.jsx(ln,{id:"smart-files-std",type:"file",accept:Gi.ALLOWED_TYPES.map(e=>e.includes("spreadsheetml")?".xlsx":e.includes("ms-excel")?".xls":"").filter(Boolean).join(","),multiple:!0,onChange:e=>T(e,"smart","standardize"),disabled:m})]}),o.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm font-medium",children:"Selected Smart files:"}),o.map((e,s)=>i.jsxs("div",{className:"flex items-center gap-2 text-sm p-2 bg-green-50 rounded",children:[i.jsx(st,{className:"h-4 w-4 text-green-600"}),i.jsx("span",{children:e.name}),i.jsxs(zn,{variant:"outline",className:"text-xs",children:[(e.size/1024).toFixed(1)," KB"]})]},s))]})]})]}),i.jsx(nn,{onClick:async()=>{await(async()=>{if(0!==l.length||0!==o.length)if(s){h(!0),x(0),v(null);try{f("📊 Parsing Excel files..."),x(20);const t=[...l,...o],a=[];for(const e of l){const s=await E(e,"xl");a.push(s)}for(const e of o){const s=await E(e,"smart");a.push(s)}f("🔐 Creating upload session..."),x(40);const{data:r,error:n}=await en.from("xlsmart_upload_sessions").insert({session_name:`AI Standardization ${(new Date).toISOString()}: ${t.map(e=>e.name).join(", ")}`,file_names:t.map(e=>e.name),temp_table_names:[],total_rows:a.reduce((e,s)=>e+s.rows.length,0),status:"processing",created_by:s.id,ai_analysis:{step:"ready_for_standardization",xl_files:a.filter(e=>"xl"===e.type).length,smart_files:a.filter(e=>"smart"===e.type).length,raw_data:a}}).select().single();if(n)throw n;y(r.id),f("🧠 AI standardizing roles..."),x(70);const{data:i,error:c}=await en.functions.invoke("ai-role-standardization",{body:{sessionId:r.id}});if(c)throw new Error(`Standardization failed: ${c.message}`);if(!(null==i?void 0:i.success))throw new Error((null==i?void 0:i.error)||"Standardization failed");x(100),f("✅ Standardization completed!"),v({standardizedRolesCreated:i.standardRolesCreated,mappingsCreated:i.mappingsCreated,xlDataProcessed:i.xlDataProcessed,smartDataProcessed:i.smartDataProcessed}),e({title:"🎉 Complete Success!",description:`Created ${i.standardRolesCreated} standardized roles with ${i.mappingsCreated} mappings`,duration:5e3}),setTimeout(()=>{_(!0)},1e3)}catch(t){e({title:"❌ Process Failed",description:t instanceof Error?t.message:"Unknown error occurred",variant:"destructive"})}finally{h(!1),f("")}}else e({title:"Authentication Required",description:"Please log in to use this feature",variant:"destructive"});else e({title:"No files selected",description:"Please select at least one Excel file",variant:"destructive"})})()},disabled:0===l.length&&0===o.length||!s||m,className:"w-full",children:m?i.jsxs(i.Fragment,{children:[i.jsx(Rs,{className:"mr-2 h-4 w-4 animate-spin"}),"Processing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rs,{className:"mr-2 h-4 w-4"}),"Upload & Standardize"]})})]})})]})]}),m&&i.jsx(fn,{className:"max-w-2xl mx-auto",children:i.jsxs(yn,{className:"space-y-3 pt-6",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:p}),i.jsxs("span",{children:[u,"%"]})]}),i.jsx(Bi,{value:u,className:"w-full"})]})}),g&&i.jsx(fn,{className:"max-w-2xl mx-auto",children:i.jsx(yn,{className:"pt-6",children:i.jsxs(Hi,{className:"bg-green-50 border-green-200",children:[i.jsx(Gs,{className:"h-4 w-4 text-green-600"}),i.jsx(Vi,{className:"text-green-800",children:i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"font-medium",children:"Process completed successfully!"}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsxs("p",{children:["• XL Roles Processed: ",i.jsx("strong",{children:g.xlDataProcessed||0})]}),i.jsxs("p",{children:["• Smart Roles Processed: ",i.jsx("strong",{children:g.smartDataProcessed||0})]})]}),i.jsxs("div",{children:[i.jsxs("p",{children:["• Standardized Roles Created: ",i.jsx("strong",{children:g.standardizedRolesCreated||0})]}),i.jsxs("p",{children:["• Mappings Generated: ",i.jsx("strong",{children:g.mappingsCreated||0})]})]})]})]})})]})})}),i.jsx(Cn,{open:w,onOpenChange:_,children:i.jsxs(Pn,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[i.jsx(Dn,{children:i.jsx(On,{children:"🎉 Standardization Complete - Upload Status"})}),i.jsx(Zi,{})]})}),i.jsx(Cn,{open:k,onOpenChange:S,children:i.jsxs(Pn,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[i.jsx(Dn,{children:i.jsx(On,{children:"📋 Uploaded Roles"})}),i.jsx(ll,{})]})})]})},kf=ce.forwardRef(({className:e,...s},t)=>i.jsx("textarea",{className:Ga("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...s}));function Sf(){const[e,s]=ce.useState(!1),[t,a]=ce.useState("Test LiteLLM connection"),[r,n]=ce.useState([]),{toast:l}=De(),c=[{name:"test-litellm-direct",description:"Test basic LiteLLM connection"},{name:"ai-chat",description:"General AI chat functionality"},{name:"ai-skills-assessment",description:"Employee skills assessment"},{name:"ai-employee-engagement",description:"Employee engagement analysis"},{name:"ai-succession-planning",description:"Succession planning analysis"},{name:"ai-diversity-inclusion",description:"Diversity & inclusion analysis"},{name:"ai-advanced-role-intelligence",description:"Advanced role intelligence"},{name:"ai-compensation-intelligence",description:"Compensation analysis"},{name:"ai-learning-development",description:"Learning development analysis"},{name:"ai-job-descriptions-intelligence",description:"Job description analysis"}],o=async e=>{try{let s;s="test-litellm-direct"===e?{message:t}:"ai-chat"===e?{message:t,context:"hr_assistant"}:"ai-skills-assessment"===e?{employeeId:"test-employee-id",targetRoleId:"test-role-id",assessmentType:"role_fit",additionalSkills:[]}:{analysisType:d(e),departmentFilter:null,timeFrame:"3_months"};const{data:a,error:r}=await en.functions.invoke(e,{body:s});if(r)throw r;return{function:e,status:"success",response:a,timestamp:(new Date).toISOString()}}catch(s){return{function:e,status:"error",error:s.message,timestamp:(new Date).toISOString()}}},d=e=>({"ai-employee-engagement":"sentiment_analysis","ai-succession-planning":"leadership_pipeline","ai-diversity-inclusion":"diversity_metrics","ai-advanced-role-intelligence":"role_evolution","ai-compensation-intelligence":"pay_equity","ai-learning-development":"personalized_learning","ai-job-descriptions-intelligence":"jd_optimization"}[e]||"default");return i.jsxs("div",{className:"space-y-6",children:[i.jsxs(fn,{children:[i.jsxs(gn,{children:[i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Zt,{className:"h-5 w-5"}),"LiteLLM AI Functions Test"]}),i.jsxs(jn,{children:["Test all ",c.length," AI functions to ensure they're using LiteLLM correctly and the API key is working"]})]}),i.jsxs(yn,{className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{htmlFor:"test-message",className:"text-sm font-medium",children:"Test Message:"}),i.jsx(kf,{id:"test-message",value:t,onChange:e=>a(e.target.value),placeholder:"Enter a test message for AI functions...",className:"min-h-[80px]"})]}),i.jsx(nn,{onClick:async()=>{s(!0),n([]);try{const e=3,s=[];for(let r=0;r<c.length;r+=e){const t=c.slice(r,r+e).map(e=>o(e.name)),a=await Promise.all(t);s.push(...a),n([...s]),r+e<c.length&&await new Promise(e=>setTimeout(e,1e3))}const t=s.filter(e=>"success"===e.status).length,a=s.filter(e=>"error"===e.status).length;l({title:"Testing Complete",description:`${t} functions working, ${a} functions have issues`,variant:t===s.length?"default":"destructive"})}catch(e){l({title:"Test Failed",description:e.message,variant:"destructive"})}finally{s(!1)}},disabled:e,className:"w-full",size:"lg",children:e?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Testing AI Functions..."]}):`Test All ${c.length} AI Functions`})]})]}),r.length>0&&i.jsxs(fn,{children:[i.jsxs(gn,{children:[i.jsx(vn,{children:"Test Results"}),i.jsxs(jn,{children:["Results from testing AI functions (",r.length,"/",c.length," completed)"]})]}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:r.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium",children:e.function}),"success"===e.status?i.jsxs(zn,{variant:"default",className:"flex items-center gap-1",children:[i.jsx(Gs,{className:"h-3 w-3"}),"Success"]}):i.jsxs(zn,{variant:"destructive",className:"flex items-center gap-1",children:[i.jsx(Vs,{className:"h-3 w-3"}),"Error"]})]}),i.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(e.timestamp).toLocaleTimeString()})]}),"success"===e.status?i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm text-green-600",children:"✅ Function working correctly with LiteLLM"}),e.response&&i.jsxs("details",{className:"text-xs",children:[i.jsx("summary",{className:"cursor-pointer text-muted-foreground",children:"View response details"}),i.jsx("pre",{className:"mt-2 p-2 bg-muted rounded text-xs overflow-auto max-h-32",children:JSON.stringify(e.response,null,2)})]})]}):i.jsx("div",{className:"space-y-2",children:i.jsxs("p",{className:"text-sm text-red-600",children:["❌ Error: ",e.error]})})]},s))})})]})]})}kf.displayName="Textarea";const Ef=({onJDGenerated:e})=>{var s,t,a,r,n,l,c,o,d,m,h;const{toast:u}=De(),[x,p]=ce.useState("bulk"),[f,g]=ce.useState([]),[v,j]=ce.useState([]),[y,b]=ce.useState(!1),[N,w]=ce.useState(0),[_,k]=ce.useState({success:0,failed:0,total:0}),[S,E]=ce.useState([]),[T,C]=ce.useState(""),[A,R]=ce.useState(!1),[I,P]=ce.useState(null),[D,M]=ce.useState([]),[O,F]=ce.useState(""),[L,z]=ce.useState(!1);ce.useEffect(()=>{U(),B()},[]);const U=async()=>{try{const{data:e,error:s}=await en.from("xlsmart_standard_roles").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(s)throw s;const{data:t,error:a}=await en.from("xlsmart_job_descriptions").select("standard_role_id").not("standard_role_id","is",null);if(a)throw a;const r=new Set((t||[]).map(e=>e.standard_role_id).filter(Boolean)),n=(e||[]).filter(e=>!r.has(e.id));g(n),0===n.length&&u({title:"All Roles Have Job Descriptions",description:"All active standard roles already have job descriptions created. No roles available for bulk generation.",variant:"default"})}catch(e){u({title:"Error Loading Roles",description:e instanceof Error?e.message:"Failed to load standard roles. Please check your permissions.",variant:"destructive"})}},B=async()=>{try{const{data:e,error:s}=await en.from("xlsmart_job_descriptions").select("*").order("created_at",{ascending:!1});if(s)throw s;const t=(e||[]).map(e=>({id:e.id,title:e.title,summary:e.summary||"",responsibilities:Array.isArray(e.responsibilities)?e.responsibilities:[],requiredQualifications:Array.isArray(e.required_qualifications)?e.required_qualifications:[],preferredQualifications:Array.isArray(e.preferred_qualifications)?e.preferred_qualifications:[],requiredSkills:Array.isArray(e.required_skills)?e.required_skills:[],preferredSkills:Array.isArray(e.preferred_skills)?e.preferred_skills:[],benefits:[],fullDescription:e.full_description||`${e.summary||""}\n\nResponsibilities:\n${Array.isArray(e.responsibilities)?e.responsibilities.join("\n"):""}\n\nQualifications:\n${Array.isArray(e.required_qualifications)?e.required_qualifications.join("\n"):""}`,keywords:[],estimatedSalary:{min:e.salary_range_min||0,max:e.salary_range_max||0,currency:e.currency||"IDR"},experienceLevel:e.experience_level||"",educationLevel:e.education_level||"",employmentType:e.employment_type||"full_time",locationType:e.location_type||"office",jobIdentity:e.job_identity||void 0,keyContacts:e.key_contacts||void 0,competencies:e.competencies||void 0}));M(t)}catch(e){}},$=async()=>{if(!T.trim()||!I)return;const e={id:Date.now().toString(),role:"user",content:T,timestamp:new Date};E(s=>[...s,e]),C(""),R(!0);try{const{data:e,error:s}=await en.functions.invoke("ai-jd-updater",{body:{currentContent:O||I.fullDescription,updateRequest:T,jobDescription:{title:I.title,summary:I.summary,responsibilities:I.responsibilities,required_qualifications:I.requiredQualifications,preferred_qualifications:I.preferredQualifications,required_skills:I.requiredSkills||[],preferred_skills:I.preferredSkills||[],salary_range_min:I.estimatedSalary.min,salary_range_max:I.estimatedSalary.max,currency:I.estimatedSalary.currency,experience_level:I.experienceLevel||"",education_level:I.educationLevel||"",employment_type:I.employmentType||"full_time",location_type:I.locationType||"office",job_identity:I.jobIdentity,key_contacts:I.keyContacts,competencies:I.competencies}}});if(s)throw s;if(!e.success)throw new Error(e.message);F(e.updatedContent),e.updatedJobDescription&&P(s=>s?{...s,...e.updatedJobDescription,fullDescription:e.updatedContent}:null);const t=/show|display|view|see|preview/i.test(T);let a="";a=t?`Here's the current job description for "${I.title}":\n\n`:`I've updated the job description based on your request: "${T}"\n\n`,e.updatedContent?a+=e.updatedContent:a+="The job description content is ready for review.";const r={id:(Date.now()+1).toString(),role:"assistant",content:a,timestamp:new Date};E(e=>[...e,r])}catch(s){u({title:"Chat Error",description:"Failed to get response from AI assistant",variant:"destructive"})}finally{R(!1)}};return i.jsx("div",{className:"w-full max-w-7xl mx-auto space-y-6",children:i.jsxs(fn,{className:"border-border bg-card",children:[i.jsxs(gn,{className:"border-b border-border",children:[i.jsxs(vn,{className:"flex items-center gap-2 text-card-foreground",children:[i.jsx(Pt,{className:"h-6 w-6 text-primary"}),"AI-Powered Job Description Generator"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Generate JDs in bulk for standardized roles or update existing JDs with AI assistance"})]}),i.jsx(yn,{className:"p-6",children:i.jsxs(hn,{value:x,onValueChange:p,className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-2",children:[i.jsxs(xn,{value:"bulk",className:"flex items-center gap-2",children:[i.jsx(Wt,{className:"h-4 w-4"}),"Bulk Generation"]}),i.jsxs(xn,{value:"chat",className:"flex items-center gap-2",children:[i.jsx(ut,{className:"h-4 w-4"}),"Update with AI"]})]}),i.jsx(pn,{value:"bulk",className:"space-y-6",children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-medium",children:"Standard Roles"}),i.jsxs(zn,{variant:"secondary",children:[f.length," available"]})]}),i.jsx(wi,{className:"h-96 border rounded-md p-4",children:i.jsx("div",{className:"space-y-2",children:f.map(e=>{var s;return i.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg",children:[i.jsx("input",{type:"checkbox",checked:v.includes(e.id),onChange:s=>{s.target.checked?j(s=>[...s,e.id]):j(s=>s.filter(s=>s!==e.id))},className:"mt-1"}),i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium text-sm",children:e.role_title}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.department," • ",e.role_level]}),i.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[null==(s=e.standard_description)?void 0:s.substring(0,100),"..."]})]})]},e.id)})})}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(nn,{variant:"outline",onClick:()=>j(f.map(e=>e.id)),disabled:y,children:"Select All"}),i.jsx(nn,{variant:"outline",onClick:()=>j([]),disabled:y,children:"Clear All"})]}),i.jsx(nn,{onClick:async()=>{if(0===v.length)return void u({title:"No Roles Selected",description:"Please select at least one role for bulk generation",variant:"destructive"});b(!0),w(0),k({success:0,failed:0,total:v.length});const s=f.filter(e=>v.includes(e.id));let t=0,a=0;for(let e=0;e<s.length;e++){const n=s[e];try{const{data:e,error:s}=await en.functions.invoke("ai-job-description-generator",{body:{roleTitle:n.role_title,department:n.department,level:n.role_level,standardRoleId:n.id,employmentType:"full_time",locationStatus:"office",requirements:Array.isArray(n.required_skills)?n.required_skills.join(", "):"",customInstructions:`Based on standardized role: ${n.standard_description}`,tone:"professional",language:"en"}});if(s)throw s;if(!e.success)throw new Error(e.message);t++}catch(r){a++}const i=(e+1)/s.length*100;w(i),k({success:t,failed:a,total:v.length}),await new Promise(e=>setTimeout(e,1e3))}await B(),b(!1),e&&t>0&&e(),u({title:"🎉 Bulk Generation Complete!",description:`Generated ${t} JDs successfully. ${a} failed.`,duration:8e3})},disabled:y||0===v.length,className:"w-full xl-button-primary",size:"lg",children:y?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating ",v.length," JDs..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Zt,{className:"mr-2 h-4 w-4"}),"Generate ",v.length," Job Descriptions"]})})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium",children:"Bulk Generation Progress"}),y&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Progress"}),i.jsxs("span",{children:[Math.round(N),"%"]})]}),i.jsx(Bi,{value:N,className:"w-full"}),i.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:_.success}),i.jsx("div",{className:"text-xs text-muted-foreground",children:"Success"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-red-600",children:_.failed}),i.jsx("div",{className:"text-xs text-muted-foreground",children:"Failed"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:_.total}),i.jsx("div",{className:"text-xs text-muted-foreground",children:"Total"})]})]})]}),!y&&v.length>0&&i.jsx(fn,{className:"border-border",children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[i.jsx(qs,{className:"h-4 w-4 text-green-600"}),"Ready to generate ",v.length," job descriptions"]})})})]})]})}),i.jsx(pn,{value:"chat",className:"space-y-6",children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h3",{className:"text-lg font-medium",children:"Select Job Description to Update"}),i.jsx(wi,{className:"h-96 border rounded-md p-4",children:i.jsx("div",{className:"space-y-2",children:D.map(e=>i.jsx(fn,{className:"cursor-pointer transition-colors "+((null==I?void 0:I.id)===e.id?"border-primary":"border-border"),onClick:()=>{P(e),F(e.fullDescription),E([{id:"welcome",role:"assistant",content:`I'll help you with the job description for "${e.title}". You can ask me to show you the current JD or make updates. What would you like to do?`,timestamp:new Date}])},children:i.jsxs(yn,{className:"p-4",children:[i.jsx("h4",{className:"font-medium text-sm",children:e.title}),i.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.summary.substring(0,100),"..."]})]})},e.id))})})]}),i.jsx("div",{className:"space-y-4",children:I?i.jsxs(i.Fragment,{children:[i.jsxs("h3",{className:"text-lg font-medium flex items-center gap-2",children:[i.jsx(As,{className:"h-5 w-5 text-primary"}),"AI Assistant - ",I.title]}),i.jsx(fn,{className:"border-border",children:i.jsxs(yn,{className:"p-0",children:[i.jsx(wi,{className:"h-80 p-4",children:i.jsxs("div",{className:"space-y-4",children:[S.map(e=>i.jsx("div",{className:"flex gap-3 "+("user"===e.role?"justify-end":"justify-start"),children:i.jsxs("div",{className:"max-w-[80%] rounded-lg px-4 py-2 "+("user"===e.role?"bg-primary text-primary-foreground":"bg-muted text-card-foreground"),children:[i.jsx("div",{className:"text-sm whitespace-pre-wrap",children:"assistant"===e.role?i.jsx("div",{className:"prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:e.content.replace(/\*\*(.*?)\*\*/g,'<strong style="font-weight: 700; color: inherit;">$1</strong>').replace(/\n/g,"<br>")}}):i.jsx("p",{children:e.content})}),i.jsx("p",{className:"text-xs opacity-70 mt-1",children:e.timestamp.toLocaleTimeString()})]})},e.id)),A&&i.jsx("div",{className:"flex gap-3 justify-start",children:i.jsx("div",{className:"bg-muted rounded-lg px-4 py-2",children:i.jsx(ot,{className:"h-4 w-4 animate-spin"})})})]})}),i.jsxs("div",{className:"flex gap-2 p-4 border-t border-border",children:[i.jsx(ln,{value:T,onChange:e=>C(e.target.value),onKeyPress:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),$())},placeholder:"Ask me to show or update the job description...",disabled:A,className:"flex-1 bg-background border-border"}),i.jsx(nn,{onClick:$,disabled:A||!T.trim(),size:"icon",className:"xl-button-primary",children:i.jsx(At,{className:"h-4 w-4"})}),i.jsx(nn,{onClick:()=>{F("TEST UPDATE: "+(new Date).toISOString())},variant:"outline",size:"icon",title:"Debug: Test Update",children:"🐛"})]})]})}),O&&i.jsxs(fn,{className:"border-border bg-muted/50",children:[i.jsx(gn,{className:"pb-3",children:i.jsxs(vn,{className:"text-lg flex items-center justify-between",children:["Updated Job Description ",O!==I.fullDescription&&"(Modified)",i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(nn,{onClick:()=>((e,s)=>{const t=new Blob([e],{type:"text/plain"}),a=URL.createObjectURL(t),r=document.createElement("a");r.href=a,r.download=s,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(a)})(O,`${I.title}_updated.txt`),variant:"outline",size:"sm",children:[i.jsx(Zs,{className:"mr-2 h-4 w-4"}),"Download"]}),i.jsx(nn,{onClick:async()=>{if(I&&O){z(!0);try{const e={title:I.title,summary:I.summary,responsibilities:I.responsibilities,required_qualifications:I.requiredQualifications,preferred_qualifications:I.preferredQualifications,required_skills:I.requiredSkills||[],preferred_skills:I.preferredSkills||[],salary_range_min:I.estimatedSalary.min,salary_range_max:I.estimatedSalary.max,currency:I.estimatedSalary.currency,experience_level:I.experienceLevel||"",education_level:I.educationLevel||"",employment_type:I.employmentType||"full_time",location_type:I.locationType||"office",status:"draft",updated_at:(new Date).toISOString(),reviewed_by:null,approved_by:null};I.jobIdentity&&(e.job_identity=I.jobIdentity),I.keyContacts&&(e.key_contacts=I.keyContacts),I.competencies&&(e.competencies=I.competencies);const{error:s}=await en.from("xlsmart_job_descriptions").update(e).eq("id",I.id);if(s)throw s;await B(),u({title:"✅ Job Description Updated!",description:"Your changes have been saved and sent for re-approval",duration:5e3}),P(e=>e?{...e,fullDescription:O}:null)}catch(e){u({title:"❌ Save Failed",description:e instanceof Error?e.message:"Failed to save job description",variant:"destructive"})}finally{z(!1)}}},disabled:L,className:"xl-button-primary",children:L?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Saving..."]}):i.jsxs(i.Fragment,{children:[i.jsx(qs,{className:"mr-2 h-4 w-4"}),"Save Changes"]})})]})]})}),i.jsx(yn,{children:i.jsxs(hn,{defaultValue:"formatted",className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-2",children:[i.jsx(xn,{value:"formatted",children:"Formatted View"}),i.jsx(xn,{value:"structured",children:"Structured Template"})]}),i.jsx(pn,{value:"formatted",className:"mt-4",children:i.jsx(wi,{className:"h-60 p-4 bg-background rounded border",children:i.jsx("pre",{className:"text-sm whitespace-pre-wrap",children:O})})}),i.jsx(pn,{value:"structured",className:"mt-4",children:i.jsx(wi,{className:"h-60 p-4 bg-background rounded border",children:i.jsxs("div",{className:"space-y-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2 text-blue-600",children:"1. JOB IDENTITY"}),i.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("span",{className:"font-medium",children:"Position Title:"}),i.jsx("span",{children:(null==(s=I.jobIdentity)?void 0:s.positionTitle)||I.title}),i.jsx("span",{className:"font-medium",children:"Directorate:"}),i.jsx("span",{children:(null==(t=I.jobIdentity)?void 0:t.directorate)||"Not specified"}),(null==(a=I.jobIdentity)?void 0:a.division)&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-medium",children:"Division:"}),i.jsx("span",{children:I.jobIdentity.division})]}),(null==(r=I.jobIdentity)?void 0:r.department)&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-medium",children:"Department:"}),i.jsx("span",{children:I.jobIdentity.department})]}),i.jsx("span",{className:"font-medium",children:"Direct Supervisor:"}),i.jsx("span",{children:(null==(n=I.jobIdentity)?void 0:n.directSupervisor)||"Not specified"})]}),(null==(l=I.jobIdentity)?void 0:l.directSubordinate)&&I.jobIdentity.directSubordinate.length>0&&i.jsxs("div",{className:"mt-2",children:[i.jsx("span",{className:"font-medium",children:"Direct Subordinate:"}),i.jsx("ol",{className:"list-decimal list-inside mt-1",children:I.jobIdentity.directSubordinate.map((e,s)=>i.jsx("li",{children:e},s))})]})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2 text-blue-600",children:"2. JOB PURPOSES"}),i.jsx("p",{className:"bg-muted/50 p-3 rounded-lg",children:I.summary||"Not specified"})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2 text-blue-600",children:"3. MAIN RESPONSIBILITY"}),i.jsx("div",{className:"bg-muted/50 p-3 rounded-lg",children:I.responsibilities.length>0?i.jsx("ol",{className:"list-decimal list-inside space-y-2",children:I.responsibilities.map((e,s)=>i.jsx("li",{children:e},s))}):i.jsx("p",{className:"text-muted-foreground",children:"Not specified"})})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2 text-blue-600",children:"5. KEY CONTACTS & RELATIONSHIP"}),i.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg space-y-3",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Internal:"}),(null==(c=I.keyContacts)?void 0:c.internal)&&I.keyContacts.internal.length>0?i.jsx("ol",{className:"list-decimal list-inside mt-1",children:I.keyContacts.internal.map((e,s)=>i.jsx("li",{children:e},s))}):i.jsx("p",{className:"text-muted-foreground ml-4",children:"Not specified"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"External:"}),(null==(o=I.keyContacts)?void 0:o.external)&&I.keyContacts.external.length>0?i.jsx("ol",{className:"list-decimal list-inside mt-1",children:I.keyContacts.external.map((e,s)=>i.jsx("li",{children:e},s))}):i.jsx("p",{className:"text-muted-foreground ml-4",children:"Not specified"})]})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2 text-blue-600",children:"6. COMPETENCY SECTION"}),i.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg space-y-4",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-green-600",children:"A. FUNCTIONAL COMPETENCY"}),(null==(d=I.competencies)?void 0:d.functional)?i.jsxs("div",{className:"mt-2 space-y-1",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Academy Qualifications:"})," ",I.competencies.functional.academyQualifications]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Professional Experience:"})," ",I.competencies.functional.professionalExperience]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Certification/License:"})," ",I.competencies.functional.certificationLicense]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Expertise:"})," ",null==(m=I.competencies.functional.expertise)?void 0:m.join(", ")]})]}):i.jsx("p",{className:"text-muted-foreground",children:"Not specified"})]}),i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-purple-600",children:"B. LEADERSHIP COMPETENCY"}),(null==(h=I.competencies)?void 0:h.leadership)?i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Strategic accountability:"})," ",I.competencies.leadership.strategicAccountability]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Customer centric:"})," ",I.competencies.leadership.customerCentric]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Coalition Building:"})," ",I.competencies.leadership.coalitionBuilding]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"People First:"})," ",I.competencies.leadership.peopleFirst]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Agile Leadership:"})," ",I.competencies.leadership.agileLeadership]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Result Driven:"})," ",I.competencies.leadership.resultDriven]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Technology Savvy:"})," ",I.competencies.leadership.technologySavvy]})]}):i.jsx("p",{className:"text-muted-foreground",children:"Not specified"})]})]})]})]})})})]})})]})]}):i.jsx(fn,{className:"border-border border-dashed",children:i.jsx(yn,{className:"flex items-center justify-center h-80",children:i.jsxs("div",{className:"text-center text-muted-foreground",children:[i.jsx(ut,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),i.jsx("p",{children:"Select a job description to start updating with AI"})]})})})})]})})]})})]})})},Tf=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState([]),[r,n]=ce.useState([]),[l,c]=ce.useState(!0),[o,d]=ce.useState(!1),[m,h]=ce.useState(null),{toast:u}=De();ce.useEffect(()=>{x()},[]);const x=async()=>{try{c(!0);const{data:e,error:t}=await en.from("xlsmart_employees").select("*").eq("is_active",!0).order("first_name");if(t)throw t;const{data:r,error:i}=await en.from("xlsmart_standard_roles").select("*").eq("is_active",!0);if(i)throw i;const{data:l,error:o}=await en.from("xlsmart_skill_assessments").select("*").order("assessment_date",{ascending:!1});if(o)u({title:"Assessment Loading Error",description:`Error loading assessments: ${o.message}`,variant:"destructive"}),n([]);else{const e=l||[];n(e),e.length>0&&u({title:"Assessments Loaded",description:`Found ${e.length} skill assessments`})}s(e||[]),a(r||[])}catch(e){u({title:"Error",description:"Failed to load skills assessment data",variant:"destructive"})}finally{c(!1)}},p=e=>r.find(s=>s.employee_id===e),f=e=>e>=80?{level:"High",color:"bg-red-500",textColor:"text-red-700"}:e>=60?{level:"Medium",color:"bg-yellow-500",textColor:"text-yellow-700"}:{level:"Low",color:"bg-green-500",textColor:"text-green-700"},g=(()=>{const s=e.filter(e=>p(e.id)),t=s.length>0?s.reduce((e,s)=>{const t=p(s.id);return e+((null==t?void 0:t.overall_match_percentage)||0)},0)/s.length:0,a=s.filter(e=>{const s=p(e.id);return s&&(s.rotation_risk_score>70||s.churn_risk_score>70)});return{totalEmployees:e.length,assessedEmployees:s.length,avgMatchPercentage:Math.round(t),highRiskCount:a.length,assignedRoles:e.filter(e=>e.standard_role_id).length}})();return l?i.jsx(fn,{children:i.jsxs(yn,{className:"flex items-center justify-center p-8",children:[i.jsx(kt,{className:"h-6 w-6 animate-spin mr-2"}),"Loading skills assessment data..."]})}):i.jsxs("div",{className:"space-y-6",children:[i.jsx(fn,{children:i.jsxs(gn,{children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Rs,{className:"h-5 w-5"}),"AI-Powered Skills Assessment",i.jsxs(zn,{variant:"secondary",children:[e.length," employees"]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(nn,{onClick:async()=>{if(0===e.length)return void u({title:"No employees",description:"No employees found for assessment",variant:"destructive"});const s=new Set(r.map(e=>e.employee_id)),t=e.filter(e=>s.has(e.id));if(t.length>0){if(!window.confirm(`${t.length} employees already have recent assessments. Only employees without assessments from the last 30 days will be processed. Continue?`))return}try{d(!0),h({processed:0,total:e.length}),u({title:"AI Skills Assessment Started",description:`Analyzing up to ${e.length} employees for skills, role fit, and risk factors...`});const{data:s,error:t}=await en.functions.invoke("ai-skills-assessment-bulk",{body:{assessmentType:"all",identifier:"all",employees:e}});if(t)throw t;if(null==s?void 0:s.sessionId){const t=setInterval(async()=>{const{data:a}=await en.functions.invoke("ai-skills-assessment-progress",{body:{sessionId:s.sessionId}});if(null==a?void 0:a.progress)if(h({processed:a.progress.processed,total:a.progress.total}),"completed"===a.status)clearInterval(t),d(!1),h(null),await x(),u({title:"AI Assessment Completed",description:`Successfully analyzed ${e.length} employees`});else if("error"===a.status)throw clearInterval(t),d(!1),h(null),new Error(a.error||"Assessment failed")},2e3);setTimeout(()=>{clearInterval(t),o&&(d(!1),h(null))},3e5)}}catch(a){d(!1),h(null),u({title:"Assessment Failed",description:a.message||"Failed to run AI skills assessment",variant:"destructive"})}},disabled:o||0===e.length,children:o?i.jsxs(i.Fragment,{children:[i.jsx(kt,{className:"h-4 w-4 animate-spin mr-2"}),"Analyzing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Run AI Assessment"]})}),i.jsxs(nn,{variant:"outline",onClick:x,disabled:l,children:[i.jsx(kt,{className:"h-4 w-4 mr-2"}),"Refresh Data"]}),i.jsx(nn,{variant:"outline",onClick:async()=>{try{const{data:e,error:s}=await en.from("xlsmart_skill_assessments").select("employee_id, overall_match_percentage, assessment_date").limit(5),{count:t,error:a}=await en.from("xlsmart_skill_assessments").select("*",{count:"exact",head:!0});u({title:"Debug Info",description:`Found ${t||0} assessments in database. Check console for details.`})}catch(e){u({title:"Debug Error",description:"Error running debug queries",variant:"destructive"})}},size:"sm",children:"Debug"}),i.jsx(nn,{variant:"outline",onClick:()=>{const s=e.map(e=>({id:`assessment-${e.id}`,employee_id:e.id,job_description_id:e.standard_role_id||"mock-jd",overall_match_percentage:Math.floor(40*Math.random())+60,skill_gaps:{gaps:[{skill:"Advanced Analytics",current:2,required:4,gap:2},{skill:"Leadership",current:3,required:4,gap:1}]},level_fit_score:Math.floor(30*Math.random())+70,rotation_risk_score:Math.floor(60*Math.random())+20,churn_risk_score:Math.floor(50*Math.random())+10,ai_analysis:`AI analysis for ${e.first_name}: Strong technical skills with growth potential in leadership areas.`,recommendations:"Focus on developing leadership and advanced analytics skills for career progression.",assessment_date:(new Date).toISOString()}));n(s),u({title:"Mock Data Generated",description:`Generated ${s.length} mock assessments for testing`})},size:"sm",children:"Mock Data"})]})]}),m&&i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[i.jsx(Ms,{className:"h-4 w-4"}),"Progress: ",m.processed,"/",m.total," employees analyzed"]}),i.jsx("div",{className:"w-full bg-secondary rounded-full h-2 mt-1",children:i.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:m.processed/m.total*100+"%"}})})]})]})}),i.jsxs(hn,{defaultValue:"overview",className:"space-y-4",children:[i.jsxs(un,{children:[i.jsx(xn,{value:"overview",children:"Overview"}),i.jsx(xn,{value:"detailed",children:"Detailed Analysis"}),i.jsx(xn,{value:"risks",children:"Risk Analysis"}),i.jsx(xn,{value:"insights",children:"AI Insights"})]}),i.jsx(pn,{value:"overview",className:"space-y-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[i.jsxs(fn,{children:[i.jsx(gn,{className:"pb-2",children:i.jsxs(vn,{className:"text-sm font-medium flex items-center gap-1",children:[i.jsx(Wt,{className:"h-4 w-4"}),"Total Employees"]})}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:g.totalEmployees}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Active in system"})]})]}),i.jsxs(fn,{children:[i.jsx(gn,{className:"pb-2",children:i.jsxs(vn,{className:"text-sm font-medium flex items-center gap-1",children:[i.jsx(Ft,{className:"h-4 w-4"}),"Role Assigned"]})}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:g.assignedRoles}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Have standard roles"})]})]}),i.jsxs(fn,{children:[i.jsx(gn,{className:"pb-2",children:i.jsxs(vn,{className:"text-sm font-medium flex items-center gap-1",children:[i.jsx(Gs,{className:"h-4 w-4"}),"Assessed"]})}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:g.assessedEmployees}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"AI skill assessments"})]})]}),i.jsxs(fn,{children:[i.jsx(gn,{className:"pb-2",children:i.jsxs(vn,{className:"text-sm font-medium flex items-center gap-1",children:[i.jsx(Ut,{className:"h-4 w-4"}),"Avg Match"]})}),i.jsxs(yn,{children:[i.jsxs("div",{className:"text-2xl font-bold",children:[g.avgMatchPercentage,"%"]}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Role-skill alignment"})]})]}),i.jsxs(fn,{children:[i.jsx(gn,{className:"pb-2",children:i.jsxs(vn,{className:"text-sm font-medium flex items-center gap-1",children:[i.jsx(Bt,{className:"h-4 w-4"}),"At Risk"]})}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:g.highRiskCount}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"High risk employees"})]})]})]})}),i.jsx(pn,{value:"detailed",className:"space-y-4",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Employee Skills Analysis"})}),i.jsx(yn,{children:i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Employee"}),i.jsx(rl,{children:"Current Role"}),i.jsx(rl,{children:"Assigned Role"}),i.jsx(rl,{children:"Skills Match"}),i.jsx(rl,{children:"Experience"}),i.jsx(rl,{children:"Status"})]})}),i.jsx(tl,{children:e.map(e=>{const s=p(e.id),a=(e=>e.standard_role_id?t.find(s=>s.id===e.standard_role_id):null)(e),r=s?(n=s.overall_match_percentage)>=80?{level:"Excellent",color:"bg-green-500",textColor:"text-green-700"}:n>=60?{level:"Good",color:"bg-blue-500",textColor:"text-blue-700"}:n>=40?{level:"Fair",color:"bg-yellow-500",textColor:"text-yellow-700"}:{level:"Poor",color:"bg-red-500",textColor:"text-red-700"}:null;var n;return i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium",children:[e.first_name," ",e.last_name]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:e.employee_number})]})}),i.jsxs(nl,{children:[i.jsx("div",{className:"text-sm",children:e.current_position}),i.jsx("div",{className:"text-xs text-muted-foreground",children:e.current_department})]}),i.jsx(nl,{children:a?i.jsx(zn,{variant:"outline",children:a.role_title}):i.jsx(zn,{variant:"secondary",children:"Not assigned"})}),i.jsx(nl,{children:s?i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(zn,{variant:"outline",className:null==r?void 0:r.textColor,children:[Math.round(s.overall_match_percentage),"%"]}),i.jsx("span",{className:"text-xs text-muted-foreground",children:null==r?void 0:r.level})]}):i.jsx("span",{className:"text-sm text-muted-foreground",children:"Not assessed"})}),i.jsxs(nl,{children:[i.jsxs("div",{className:"text-sm",children:[e.years_of_experience," years"]}),i.jsxs("div",{className:"text-xs text-muted-foreground",children:["Rating: ",e.performance_rating||"N/A"]})]}),i.jsx(nl,{children:i.jsx(zn,{variant:"manually_assigned"===e.role_assignment_status||"ai_suggested"===e.role_assignment_status?"default":"secondary",children:e.role_assignment_status})})]},e.id)})})]})})]})}),i.jsx(pn,{value:"risks",className:"space-y-4",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Bt,{className:"h-5 w-5"}),"Risk Analysis Dashboard"]})}),i.jsx(yn,{children:i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Employee"}),i.jsx(rl,{children:"Current Role"}),i.jsx(rl,{children:"Rotation Risk"}),i.jsx(rl,{children:"Churn Risk"}),i.jsx(rl,{children:"Overall Status"}),i.jsx(rl,{children:"AI Recommendations"})]})}),i.jsx(tl,{children:e.map(e=>{const s=p(e.id);if(!s)return i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{className:"font-medium",children:[e.first_name," ",e.last_name]})}),i.jsx(nl,{children:e.current_position}),i.jsx(nl,{colSpan:4,children:i.jsx("span",{className:"text-sm text-muted-foreground",children:"Assessment pending"})})]},e.id);const t=f(s.rotation_risk_score||0),a=f(s.churn_risk_score||0);return i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{className:"font-medium",children:[e.first_name," ",e.last_name]})}),i.jsx(nl,{children:e.current_position}),i.jsx(nl,{children:i.jsxs(zn,{variant:"outline",className:t.textColor,children:[t.level," (",Math.round(s.rotation_risk_score||0),"%)"]})}),i.jsx(nl,{children:i.jsxs(zn,{variant:"outline",className:a.textColor,children:[a.level," (",Math.round(s.churn_risk_score||0),"%)"]})}),i.jsx(nl,{children:s.rotation_risk_score>70||s.churn_risk_score>70?i.jsx(zn,{variant:"destructive",children:"At Risk"}):i.jsx(zn,{variant:"default",children:"Stable"})}),i.jsx(nl,{children:i.jsx("div",{className:"text-xs max-w-xs truncate",children:s.recommendations||"No specific recommendations available"})})]},e.id)})})]})})]})}),i.jsx(pn,{value:"insights",className:"space-y-4",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{className:"text-lg",children:"AI Insights Summary"})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium",children:"Skills Coverage Analysis"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"AI analyzes employee skills against role requirements, identifying gaps and strengths across the organization"})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium",children:"Role Fit Evaluation"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Evaluates how well employees match their assigned or potential roles based on comprehensive criteria"})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium",children:"Risk Prediction"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Predicts rotation and churn risks using advanced algorithms that consider skills, performance, engagement, and market factors"})]})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{className:"text-lg",children:"Data Sources Used"})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Gs,{className:"h-4 w-4 text-green-500"}),i.jsx("span",{className:"text-sm",children:"Employee profiles and current skills"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Gs,{className:"h-4 w-4 text-green-500"}),i.jsx("span",{className:"text-sm",children:"Standard role definitions and requirements"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Gs,{className:"h-4 w-4 text-green-500"}),i.jsx("span",{className:"text-sm",children:"Performance ratings and evaluations"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Gs,{className:"h-4 w-4 text-green-500"}),i.jsx("span",{className:"text-sm",children:"Experience levels and certifications"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Gs,{className:"h-4 w-4 text-green-500"}),i.jsx("span",{className:"text-sm",children:"Job descriptions and role mappings"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Gs,{className:"h-4 w-4 text-green-500"}),i.jsx("span",{className:"text-sm",children:"Career aspirations and growth preferences"})]})]})})]})]})})]})]})};var Cf,Af,Rf;(Af=Cf||(Cf={})).assertEqual=e=>{},Af.assertIs=function(e){},Af.assertNever=function(e){throw new Error},Af.arrayToEnum=e=>{const s={};for(const t of e)s[t]=t;return s},Af.getValidEnumValues=e=>{const s=Af.objectKeys(e).filter(s=>"number"!=typeof e[e[s]]),t={};for(const a of s)t[a]=e[a];return Af.objectValues(t)},Af.objectValues=e=>Af.objectKeys(e).map(function(s){return e[s]}),Af.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const s=[];for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&s.push(t);return s},Af.find=(e,s)=>{for(const t of e)if(s(t))return t},Af.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&Number.isFinite(e)&&Math.floor(e)===e,Af.joinValues=function(e,s=" | "){return e.map(e=>"string"==typeof e?`'${e}'`:e).join(s)},Af.jsonStringifyReplacer=(e,s)=>"bigint"==typeof s?s.toString():s,(Rf||(Rf={})).mergeShapes=(e,s)=>({...e,...s});const If=Cf.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Pf=e=>{switch(typeof e){case"undefined":return If.undefined;case"string":return If.string;case"number":return Number.isNaN(e)?If.nan:If.number;case"boolean":return If.boolean;case"function":return If.function;case"bigint":return If.bigint;case"symbol":return If.symbol;case"object":return Array.isArray(e)?If.array:null===e?If.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?If.promise:"undefined"!=typeof Map&&e instanceof Map?If.map:"undefined"!=typeof Set&&e instanceof Set?If.set:"undefined"!=typeof Date&&e instanceof Date?If.date:If.object;default:return If.unknown}},Df=Cf.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Mf extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const s=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,s):this.__proto__=s,this.name="ZodError",this.issues=e}format(e){const s=e||function(e){return e.message},t={_errors:[]},a=e=>{for(const r of e.issues)if("invalid_union"===r.code)r.unionErrors.map(a);else if("invalid_return_type"===r.code)a(r.returnTypeError);else if("invalid_arguments"===r.code)a(r.argumentsError);else if(0===r.path.length)t._errors.push(s(r));else{let e=t,a=0;for(;a<r.path.length;){const t=r.path[a];a===r.path.length-1?(e[t]=e[t]||{_errors:[]},e[t]._errors.push(s(r))):e[t]=e[t]||{_errors:[]},e=e[t],a++}}};return a(this),t}static assert(e){if(!(e instanceof Mf))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Cf.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const s={},t=[];for(const a of this.issues)if(a.path.length>0){const t=a.path[0];s[t]=s[t]||[],s[t].push(e(a))}else t.push(e(a));return{formErrors:t,fieldErrors:s}}get formErrors(){return this.flatten()}}Mf.create=e=>new Mf(e);const Of=(e,s)=>{let t;switch(e.code){case Df.invalid_type:t=e.received===If.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case Df.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(e.expected,Cf.jsonStringifyReplacer)}`;break;case Df.unrecognized_keys:t=`Unrecognized key(s) in object: ${Cf.joinValues(e.keys,", ")}`;break;case Df.invalid_union:t="Invalid input";break;case Df.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Cf.joinValues(e.options)}`;break;case Df.invalid_enum_value:t=`Invalid enum value. Expected ${Cf.joinValues(e.options)}, received '${e.received}'`;break;case Df.invalid_arguments:t="Invalid function arguments";break;case Df.invalid_return_type:t="Invalid function return type";break;case Df.invalid_date:t="Invalid date";break;case Df.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(t=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(t=`${t} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?t=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?t=`Invalid input: must end with "${e.validation.endsWith}"`:Cf.assertNever(e.validation):t="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case Df.too_small:t="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type||"bigint"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case Df.too_big:t="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case Df.custom:t="Invalid input";break;case Df.invalid_intersection_types:t="Intersection results could not be merged";break;case Df.not_multiple_of:t=`Number must be a multiple of ${e.multipleOf}`;break;case Df.not_finite:t="Number must be finite";break;default:t=s.defaultError,Cf.assertNever(e)}return{message:t}};let Ff=Of;function Lf(e,s){const t=Ff,a=(e=>{const{data:s,path:t,errorMaps:a,issueData:r}=e,n=[...t,...r.path||[]],i={...r,path:n};if(void 0!==r.message)return{...r,path:n,message:r.message};let l="";const c=a.filter(e=>!!e).slice().reverse();for(const o of c)l=o(i,{data:s,defaultError:l}).message;return{...r,path:n,message:l}})({issueData:s,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,t,t===Of?void 0:Of].filter(e=>!!e)});e.common.issues.push(a)}class zf{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,s){const t=[];for(const a of s){if("aborted"===a.status)return Uf;"dirty"===a.status&&e.dirty(),t.push(a.value)}return{status:e.value,value:t}}static async mergeObjectAsync(e,s){const t=[];for(const a of s){const e=await a.key,s=await a.value;t.push({key:e,value:s})}return zf.mergeObjectSync(e,t)}static mergeObjectSync(e,s){const t={};for(const a of s){const{key:s,value:r}=a;if("aborted"===s.status)return Uf;if("aborted"===r.status)return Uf;"dirty"===s.status&&e.dirty(),"dirty"===r.status&&e.dirty(),"__proto__"===s.value||void 0===r.value&&!a.alwaysSet||(t[s.value]=r.value)}return{status:e.value,value:t}}}const Uf=Object.freeze({status:"aborted"}),Bf=e=>({status:"dirty",value:e}),$f=e=>({status:"valid",value:e}),Hf=e=>"aborted"===e.status,Vf=e=>"dirty"===e.status,Gf=e=>"valid"===e.status,qf=e=>"undefined"!=typeof Promise&&e instanceof Promise;var Wf,Yf;(Yf=Wf||(Wf={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},Yf.toString=e=>"string"==typeof e?e:null==e?void 0:e.message;class Kf{constructor(e,s,t,a){this._cachedPath=[],this.parent=e,this.data=s,this._path=t,this._key=a}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Jf=(e,s)=>{if(Gf(s))return{success:!0,data:s.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const s=new Mf(e.common.issues);return this._error=s,this._error}}};function Xf(e){if(!e)return{};const{errorMap:s,invalid_type_error:t,required_error:a,description:r}=e;if(s&&(t||a))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(s)return{errorMap:s,description:r};return{errorMap:(s,r)=>{const{message:n}=e;return"invalid_enum_value"===s.code?{message:n??r.defaultError}:void 0===r.data?{message:n??a??r.defaultError}:"invalid_type"!==s.code?{message:r.defaultError}:{message:n??t??r.defaultError}},description:r}}class Zf{get description(){return this._def.description}_getType(e){return Pf(e.data)}_getOrReturnCtx(e,s){return s||{common:e.parent.common,data:e.data,parsedType:Pf(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new zf,ctx:{common:e.parent.common,data:e.data,parsedType:Pf(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const s=this._parse(e);if(qf(s))throw new Error("Synchronous parse encountered promise.");return s}_parseAsync(e){const s=this._parse(e);return Promise.resolve(s)}parse(e,s){const t=this.safeParse(e,s);if(t.success)return t.data;throw t.error}safeParse(e,s){const t={common:{issues:[],async:(null==s?void 0:s.async)??!1,contextualErrorMap:null==s?void 0:s.errorMap},path:(null==s?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Pf(e)},a=this._parseSync({data:e,path:t.path,parent:t});return Jf(t,a)}"~validate"(e){var s,t;const a={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Pf(e)};if(!this["~standard"].async)try{const s=this._parseSync({data:e,path:[],parent:a});return Gf(s)?{value:s.value}:{issues:a.common.issues}}catch(r){(null==(t=null==(s=null==r?void 0:r.message)?void 0:s.toLowerCase())?void 0:t.includes("encountered"))&&(this["~standard"].async=!0),a.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:a}).then(e=>Gf(e)?{value:e.value}:{issues:a.common.issues})}async parseAsync(e,s){const t=await this.safeParseAsync(e,s);if(t.success)return t.data;throw t.error}async safeParseAsync(e,s){const t={common:{issues:[],contextualErrorMap:null==s?void 0:s.errorMap,async:!0},path:(null==s?void 0:s.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Pf(e)},a=this._parse({data:e,path:t.path,parent:t}),r=await(qf(a)?a:Promise.resolve(a));return Jf(t,r)}refine(e,s){const t=e=>"string"==typeof s||void 0===s?{message:s}:"function"==typeof s?s(e):s;return this._refinement((s,a)=>{const r=e(s),n=()=>a.addIssue({code:Df.custom,...t(s)});return"undefined"!=typeof Promise&&r instanceof Promise?r.then(e=>!!e||(n(),!1)):!!r||(n(),!1)})}refinement(e,s){return this._refinement((t,a)=>!!e(t)||(a.addIssue("function"==typeof s?s(t,a):s),!1))}_refinement(e){return new Xg({schema:this,typeName:lv.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return Zg.create(this,this._def)}nullable(){return Qg.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Mg.create(this)}promise(){return Jg.create(this,this._def)}or(e){return Lg.create([this,e],this._def)}and(e){return Ug.create(this,e,this._def)}transform(e){return new Xg({...Xf(this._def),schema:this,typeName:lv.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const s="function"==typeof e?e:()=>e;return new ev({...Xf(this._def),innerType:this,defaultValue:s,typeName:lv.ZodDefault})}brand(){return new av({typeName:lv.ZodBranded,type:this,...Xf(this._def)})}catch(e){const s="function"==typeof e?e:()=>e;return new sv({...Xf(this._def),innerType:this,catchValue:s,typeName:lv.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return rv.create(this,e)}readonly(){return nv.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Qf=/^c[^\s-]{8,}$/i,eg=/^[0-9a-z]+$/,sg=/^[0-9A-HJKMNP-TV-Z]{26}$/i,tg=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ag=/^[a-z0-9_-]{21}$/i,rg=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,ng=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,ig=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let lg;const cg=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,og=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,dg=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,mg=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,hg=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,ug=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,xg="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",pg=new RegExp(`^${xg}$`);function fg(e){let s="[0-5]\\d";e.precision?s=`${s}\\.\\d{${e.precision}}`:null==e.precision&&(s=`${s}(\\.\\d+)?`);return`([01]\\d|2[0-3]):[0-5]\\d(:${s})${e.precision?"+":"?"}`}function gg(e){return new RegExp(`^${fg(e)}$`)}function vg(e){let s=`${xg}T${fg(e)}`;const t=[];return t.push(e.local?"Z?":"Z"),e.offset&&t.push("([+-]\\d{2}:?\\d{2})"),s=`${s}(${t.join("|")})`,new RegExp(`^${s}$`)}function jg(e,s){return!("v4"!==s&&s||!cg.test(e))||!("v6"!==s&&s||!dg.test(e))}function yg(e,s){if(!rg.test(e))return!1;try{const[t]=e.split(".");if(!t)return!1;const a=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(a));return"object"==typeof r&&null!==r&&((!("typ"in r)||"JWT"===(null==r?void 0:r.typ))&&(!!r.alg&&(!s||r.alg===s)))}catch{return!1}}function bg(e,s){return!("v4"!==s&&s||!og.test(e))||!("v6"!==s&&s||!mg.test(e))}class Ng extends Zf{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==If.string){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.string,received:s.parsedType}),Uf}const s=new zf;let t;for(const a of this._def.checks)if("min"===a.kind)e.data.length<a.value&&(t=this._getOrReturnCtx(e,t),Lf(t,{code:Df.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),s.dirty());else if("max"===a.kind)e.data.length>a.value&&(t=this._getOrReturnCtx(e,t),Lf(t,{code:Df.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),s.dirty());else if("length"===a.kind){const r=e.data.length>a.value,n=e.data.length<a.value;(r||n)&&(t=this._getOrReturnCtx(e,t),r?Lf(t,{code:Df.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):n&&Lf(t,{code:Df.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),s.dirty())}else if("email"===a.kind)ig.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"email",code:Df.invalid_string,message:a.message}),s.dirty());else if("emoji"===a.kind)lg||(lg=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),lg.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"emoji",code:Df.invalid_string,message:a.message}),s.dirty());else if("uuid"===a.kind)tg.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"uuid",code:Df.invalid_string,message:a.message}),s.dirty());else if("nanoid"===a.kind)ag.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"nanoid",code:Df.invalid_string,message:a.message}),s.dirty());else if("cuid"===a.kind)Qf.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"cuid",code:Df.invalid_string,message:a.message}),s.dirty());else if("cuid2"===a.kind)eg.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"cuid2",code:Df.invalid_string,message:a.message}),s.dirty());else if("ulid"===a.kind)sg.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"ulid",code:Df.invalid_string,message:a.message}),s.dirty());else if("url"===a.kind)try{new URL(e.data)}catch{t=this._getOrReturnCtx(e,t),Lf(t,{validation:"url",code:Df.invalid_string,message:a.message}),s.dirty()}else if("regex"===a.kind){a.regex.lastIndex=0;a.regex.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"regex",code:Df.invalid_string,message:a.message}),s.dirty())}else if("trim"===a.kind)e.data=e.data.trim();else if("includes"===a.kind)e.data.includes(a.value,a.position)||(t=this._getOrReturnCtx(e,t),Lf(t,{code:Df.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),s.dirty());else if("toLowerCase"===a.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===a.kind)e.data=e.data.toUpperCase();else if("startsWith"===a.kind)e.data.startsWith(a.value)||(t=this._getOrReturnCtx(e,t),Lf(t,{code:Df.invalid_string,validation:{startsWith:a.value},message:a.message}),s.dirty());else if("endsWith"===a.kind)e.data.endsWith(a.value)||(t=this._getOrReturnCtx(e,t),Lf(t,{code:Df.invalid_string,validation:{endsWith:a.value},message:a.message}),s.dirty());else if("datetime"===a.kind){vg(a).test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{code:Df.invalid_string,validation:"datetime",message:a.message}),s.dirty())}else if("date"===a.kind){pg.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{code:Df.invalid_string,validation:"date",message:a.message}),s.dirty())}else if("time"===a.kind){gg(a).test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{code:Df.invalid_string,validation:"time",message:a.message}),s.dirty())}else"duration"===a.kind?ng.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"duration",code:Df.invalid_string,message:a.message}),s.dirty()):"ip"===a.kind?jg(e.data,a.version)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"ip",code:Df.invalid_string,message:a.message}),s.dirty()):"jwt"===a.kind?yg(e.data,a.alg)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"jwt",code:Df.invalid_string,message:a.message}),s.dirty()):"cidr"===a.kind?bg(e.data,a.version)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"cidr",code:Df.invalid_string,message:a.message}),s.dirty()):"base64"===a.kind?hg.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"base64",code:Df.invalid_string,message:a.message}),s.dirty()):"base64url"===a.kind?ug.test(e.data)||(t=this._getOrReturnCtx(e,t),Lf(t,{validation:"base64url",code:Df.invalid_string,message:a.message}),s.dirty()):Cf.assertNever(a);return{status:s.value,value:e.data}}_regex(e,s,t){return this.refinement(s=>e.test(s),{validation:s,code:Df.invalid_string,...Wf.errToObj(t)})}_addCheck(e){return new Ng({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Wf.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Wf.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Wf.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Wf.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Wf.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Wf.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Wf.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Wf.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Wf.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Wf.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Wf.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Wf.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Wf.errToObj(e)})}datetime(e){return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:(null==e?void 0:e.offset)??!1,local:(null==e?void 0:e.local)??!1,...Wf.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...Wf.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Wf.errToObj(e)})}regex(e,s){return this._addCheck({kind:"regex",regex:e,...Wf.errToObj(s)})}includes(e,s){return this._addCheck({kind:"includes",value:e,position:null==s?void 0:s.position,...Wf.errToObj(null==s?void 0:s.message)})}startsWith(e,s){return this._addCheck({kind:"startsWith",value:e,...Wf.errToObj(s)})}endsWith(e,s){return this._addCheck({kind:"endsWith",value:e,...Wf.errToObj(s)})}min(e,s){return this._addCheck({kind:"min",value:e,...Wf.errToObj(s)})}max(e,s){return this._addCheck({kind:"max",value:e,...Wf.errToObj(s)})}length(e,s){return this._addCheck({kind:"length",value:e,...Wf.errToObj(s)})}nonempty(e){return this.min(1,Wf.errToObj(e))}trim(){return new Ng({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Ng({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Ng({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>"datetime"===e.kind)}get isDate(){return!!this._def.checks.find(e=>"date"===e.kind)}get isTime(){return!!this._def.checks.find(e=>"time"===e.kind)}get isDuration(){return!!this._def.checks.find(e=>"duration"===e.kind)}get isEmail(){return!!this._def.checks.find(e=>"email"===e.kind)}get isURL(){return!!this._def.checks.find(e=>"url"===e.kind)}get isEmoji(){return!!this._def.checks.find(e=>"emoji"===e.kind)}get isUUID(){return!!this._def.checks.find(e=>"uuid"===e.kind)}get isNANOID(){return!!this._def.checks.find(e=>"nanoid"===e.kind)}get isCUID(){return!!this._def.checks.find(e=>"cuid"===e.kind)}get isCUID2(){return!!this._def.checks.find(e=>"cuid2"===e.kind)}get isULID(){return!!this._def.checks.find(e=>"ulid"===e.kind)}get isIP(){return!!this._def.checks.find(e=>"ip"===e.kind)}get isCIDR(){return!!this._def.checks.find(e=>"cidr"===e.kind)}get isBase64(){return!!this._def.checks.find(e=>"base64"===e.kind)}get isBase64url(){return!!this._def.checks.find(e=>"base64url"===e.kind)}get minLength(){let e=null;for(const s of this._def.checks)"min"===s.kind&&(null===e||s.value>e)&&(e=s.value);return e}get maxLength(){let e=null;for(const s of this._def.checks)"max"===s.kind&&(null===e||s.value<e)&&(e=s.value);return e}}function wg(e,s){const t=(e.toString().split(".")[1]||"").length,a=(s.toString().split(".")[1]||"").length,r=t>a?t:a;return Number.parseInt(e.toFixed(r).replace(".",""))%Number.parseInt(s.toFixed(r).replace(".",""))/10**r}Ng.create=e=>new Ng({checks:[],typeName:lv.ZodString,coerce:(null==e?void 0:e.coerce)??!1,...Xf(e)});class _g extends Zf{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==If.number){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.number,received:s.parsedType}),Uf}let s;const t=new zf;for(const a of this._def.checks)if("int"===a.kind)Cf.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),Lf(s,{code:Df.invalid_type,expected:"integer",received:"float",message:a.message}),t.dirty());else if("min"===a.kind){(a.inclusive?e.data<a.value:e.data<=a.value)&&(s=this._getOrReturnCtx(e,s),Lf(s,{code:Df.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),t.dirty())}else if("max"===a.kind){(a.inclusive?e.data>a.value:e.data>=a.value)&&(s=this._getOrReturnCtx(e,s),Lf(s,{code:Df.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),t.dirty())}else"multipleOf"===a.kind?0!==wg(e.data,a.value)&&(s=this._getOrReturnCtx(e,s),Lf(s,{code:Df.not_multiple_of,multipleOf:a.value,message:a.message}),t.dirty()):"finite"===a.kind?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),Lf(s,{code:Df.not_finite,message:a.message}),t.dirty()):Cf.assertNever(a);return{status:t.value,value:e.data}}gte(e,s){return this.setLimit("min",e,!0,Wf.toString(s))}gt(e,s){return this.setLimit("min",e,!1,Wf.toString(s))}lte(e,s){return this.setLimit("max",e,!0,Wf.toString(s))}lt(e,s){return this.setLimit("max",e,!1,Wf.toString(s))}setLimit(e,s,t,a){return new _g({...this._def,checks:[...this._def.checks,{kind:e,value:s,inclusive:t,message:Wf.toString(a)}]})}_addCheck(e){return new _g({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Wf.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Wf.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Wf.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Wf.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Wf.toString(e)})}multipleOf(e,s){return this._addCheck({kind:"multipleOf",value:e,message:Wf.toString(s)})}finite(e){return this._addCheck({kind:"finite",message:Wf.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Wf.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Wf.toString(e)})}get minValue(){let e=null;for(const s of this._def.checks)"min"===s.kind&&(null===e||s.value>e)&&(e=s.value);return e}get maxValue(){let e=null;for(const s of this._def.checks)"max"===s.kind&&(null===e||s.value<e)&&(e=s.value);return e}get isInt(){return!!this._def.checks.find(e=>"int"===e.kind||"multipleOf"===e.kind&&Cf.isInteger(e.value))}get isFinite(){let e=null,s=null;for(const t of this._def.checks){if("finite"===t.kind||"int"===t.kind||"multipleOf"===t.kind)return!0;"min"===t.kind?(null===s||t.value>s)&&(s=t.value):"max"===t.kind&&(null===e||t.value<e)&&(e=t.value)}return Number.isFinite(s)&&Number.isFinite(e)}}_g.create=e=>new _g({checks:[],typeName:lv.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...Xf(e)});class kg extends Zf{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==If.bigint)return this._getInvalidInput(e);let s;const t=new zf;for(const a of this._def.checks)if("min"===a.kind){(a.inclusive?e.data<a.value:e.data<=a.value)&&(s=this._getOrReturnCtx(e,s),Lf(s,{code:Df.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),t.dirty())}else if("max"===a.kind){(a.inclusive?e.data>a.value:e.data>=a.value)&&(s=this._getOrReturnCtx(e,s),Lf(s,{code:Df.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),t.dirty())}else"multipleOf"===a.kind?e.data%a.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),Lf(s,{code:Df.not_multiple_of,multipleOf:a.value,message:a.message}),t.dirty()):Cf.assertNever(a);return{status:t.value,value:e.data}}_getInvalidInput(e){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.bigint,received:s.parsedType}),Uf}gte(e,s){return this.setLimit("min",e,!0,Wf.toString(s))}gt(e,s){return this.setLimit("min",e,!1,Wf.toString(s))}lte(e,s){return this.setLimit("max",e,!0,Wf.toString(s))}lt(e,s){return this.setLimit("max",e,!1,Wf.toString(s))}setLimit(e,s,t,a){return new kg({...this._def,checks:[...this._def.checks,{kind:e,value:s,inclusive:t,message:Wf.toString(a)}]})}_addCheck(e){return new kg({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Wf.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Wf.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Wf.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Wf.toString(e)})}multipleOf(e,s){return this._addCheck({kind:"multipleOf",value:e,message:Wf.toString(s)})}get minValue(){let e=null;for(const s of this._def.checks)"min"===s.kind&&(null===e||s.value>e)&&(e=s.value);return e}get maxValue(){let e=null;for(const s of this._def.checks)"max"===s.kind&&(null===e||s.value<e)&&(e=s.value);return e}}kg.create=e=>new kg({checks:[],typeName:lv.ZodBigInt,coerce:(null==e?void 0:e.coerce)??!1,...Xf(e)});class Sg extends Zf{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==If.boolean){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.boolean,received:s.parsedType}),Uf}return $f(e.data)}}Sg.create=e=>new Sg({typeName:lv.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...Xf(e)});class Eg extends Zf{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==If.date){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.date,received:s.parsedType}),Uf}if(Number.isNaN(e.data.getTime())){return Lf(this._getOrReturnCtx(e),{code:Df.invalid_date}),Uf}const s=new zf;let t;for(const a of this._def.checks)"min"===a.kind?e.data.getTime()<a.value&&(t=this._getOrReturnCtx(e,t),Lf(t,{code:Df.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),s.dirty()):"max"===a.kind?e.data.getTime()>a.value&&(t=this._getOrReturnCtx(e,t),Lf(t,{code:Df.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),s.dirty()):Cf.assertNever(a);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Eg({...this._def,checks:[...this._def.checks,e]})}min(e,s){return this._addCheck({kind:"min",value:e.getTime(),message:Wf.toString(s)})}max(e,s){return this._addCheck({kind:"max",value:e.getTime(),message:Wf.toString(s)})}get minDate(){let e=null;for(const s of this._def.checks)"min"===s.kind&&(null===e||s.value>e)&&(e=s.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const s of this._def.checks)"max"===s.kind&&(null===e||s.value<e)&&(e=s.value);return null!=e?new Date(e):null}}Eg.create=e=>new Eg({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:lv.ZodDate,...Xf(e)});class Tg extends Zf{_parse(e){if(this._getType(e)!==If.symbol){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.symbol,received:s.parsedType}),Uf}return $f(e.data)}}Tg.create=e=>new Tg({typeName:lv.ZodSymbol,...Xf(e)});class Cg extends Zf{_parse(e){if(this._getType(e)!==If.undefined){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.undefined,received:s.parsedType}),Uf}return $f(e.data)}}Cg.create=e=>new Cg({typeName:lv.ZodUndefined,...Xf(e)});class Ag extends Zf{_parse(e){if(this._getType(e)!==If.null){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.null,received:s.parsedType}),Uf}return $f(e.data)}}Ag.create=e=>new Ag({typeName:lv.ZodNull,...Xf(e)});class Rg extends Zf{constructor(){super(...arguments),this._any=!0}_parse(e){return $f(e.data)}}Rg.create=e=>new Rg({typeName:lv.ZodAny,...Xf(e)});class Ig extends Zf{constructor(){super(...arguments),this._unknown=!0}_parse(e){return $f(e.data)}}Ig.create=e=>new Ig({typeName:lv.ZodUnknown,...Xf(e)});class Pg extends Zf{_parse(e){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.never,received:s.parsedType}),Uf}}Pg.create=e=>new Pg({typeName:lv.ZodNever,...Xf(e)});class Dg extends Zf{_parse(e){if(this._getType(e)!==If.undefined){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.void,received:s.parsedType}),Uf}return $f(e.data)}}Dg.create=e=>new Dg({typeName:lv.ZodVoid,...Xf(e)});class Mg extends Zf{_parse(e){const{ctx:s,status:t}=this._processInputParams(e),a=this._def;if(s.parsedType!==If.array)return Lf(s,{code:Df.invalid_type,expected:If.array,received:s.parsedType}),Uf;if(null!==a.exactLength){const e=s.data.length>a.exactLength.value,r=s.data.length<a.exactLength.value;(e||r)&&(Lf(s,{code:e?Df.too_big:Df.too_small,minimum:r?a.exactLength.value:void 0,maximum:e?a.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:a.exactLength.message}),t.dirty())}if(null!==a.minLength&&s.data.length<a.minLength.value&&(Lf(s,{code:Df.too_small,minimum:a.minLength.value,type:"array",inclusive:!0,exact:!1,message:a.minLength.message}),t.dirty()),null!==a.maxLength&&s.data.length>a.maxLength.value&&(Lf(s,{code:Df.too_big,maximum:a.maxLength.value,type:"array",inclusive:!0,exact:!1,message:a.maxLength.message}),t.dirty()),s.common.async)return Promise.all([...s.data].map((e,t)=>a.type._parseAsync(new Kf(s,e,s.path,t)))).then(e=>zf.mergeArray(t,e));const r=[...s.data].map((e,t)=>a.type._parseSync(new Kf(s,e,s.path,t)));return zf.mergeArray(t,r)}get element(){return this._def.type}min(e,s){return new Mg({...this._def,minLength:{value:e,message:Wf.toString(s)}})}max(e,s){return new Mg({...this._def,maxLength:{value:e,message:Wf.toString(s)}})}length(e,s){return new Mg({...this._def,exactLength:{value:e,message:Wf.toString(s)}})}nonempty(e){return this.min(1,e)}}function Og(e){if(e instanceof Fg){const s={};for(const t in e.shape){const a=e.shape[t];s[t]=Zg.create(Og(a))}return new Fg({...e._def,shape:()=>s})}return e instanceof Mg?new Mg({...e._def,type:Og(e.element)}):e instanceof Zg?Zg.create(Og(e.unwrap())):e instanceof Qg?Qg.create(Og(e.unwrap())):e instanceof Bg?Bg.create(e.items.map(e=>Og(e))):e}Mg.create=(e,s)=>new Mg({type:e,minLength:null,maxLength:null,exactLength:null,typeName:lv.ZodArray,...Xf(s)});class Fg extends Zf{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),s=Cf.objectKeys(e);return this._cached={shape:e,keys:s},this._cached}_parse(e){if(this._getType(e)!==If.object){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.object,received:s.parsedType}),Uf}const{status:s,ctx:t}=this._processInputParams(e),{shape:a,keys:r}=this._getCached(),n=[];if(!(this._def.catchall instanceof Pg&&"strip"===this._def.unknownKeys))for(const l in t.data)r.includes(l)||n.push(l);const i=[];for(const l of r){const e=a[l],s=t.data[l];i.push({key:{status:"valid",value:l},value:e._parse(new Kf(t,s,t.path,l)),alwaysSet:l in t.data})}if(this._def.catchall instanceof Pg){const e=this._def.unknownKeys;if("passthrough"===e)for(const s of n)i.push({key:{status:"valid",value:s},value:{status:"valid",value:t.data[s]}});else if("strict"===e)n.length>0&&(Lf(t,{code:Df.unrecognized_keys,keys:n}),s.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const s of n){const a=t.data[s];i.push({key:{status:"valid",value:s},value:e._parse(new Kf(t,a,t.path,s)),alwaysSet:s in t.data})}}return t.common.async?Promise.resolve().then(async()=>{const e=[];for(const s of i){const t=await s.key,a=await s.value;e.push({key:t,value:a,alwaysSet:s.alwaysSet})}return e}).then(e=>zf.mergeObjectSync(s,e)):zf.mergeObjectSync(s,i)}get shape(){return this._def.shape()}strict(e){return Wf.errToObj,new Fg({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(s,t)=>{var a,r;const n=(null==(r=(a=this._def).errorMap)?void 0:r.call(a,s,t).message)??t.defaultError;return"unrecognized_keys"===s.code?{message:Wf.errToObj(e).message??n}:{message:n}}}:{}})}strip(){return new Fg({...this._def,unknownKeys:"strip"})}passthrough(){return new Fg({...this._def,unknownKeys:"passthrough"})}extend(e){return new Fg({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Fg({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:lv.ZodObject})}setKey(e,s){return this.augment({[e]:s})}catchall(e){return new Fg({...this._def,catchall:e})}pick(e){const s={};for(const t of Cf.objectKeys(e))e[t]&&this.shape[t]&&(s[t]=this.shape[t]);return new Fg({...this._def,shape:()=>s})}omit(e){const s={};for(const t of Cf.objectKeys(this.shape))e[t]||(s[t]=this.shape[t]);return new Fg({...this._def,shape:()=>s})}deepPartial(){return Og(this)}partial(e){const s={};for(const t of Cf.objectKeys(this.shape)){const a=this.shape[t];e&&!e[t]?s[t]=a:s[t]=a.optional()}return new Fg({...this._def,shape:()=>s})}required(e){const s={};for(const t of Cf.objectKeys(this.shape))if(e&&!e[t])s[t]=this.shape[t];else{let e=this.shape[t];for(;e instanceof Zg;)e=e._def.innerType;s[t]=e}return new Fg({...this._def,shape:()=>s})}keyof(){return Wg(Cf.objectKeys(this.shape))}}Fg.create=(e,s)=>new Fg({shape:()=>e,unknownKeys:"strip",catchall:Pg.create(),typeName:lv.ZodObject,...Xf(s)}),Fg.strictCreate=(e,s)=>new Fg({shape:()=>e,unknownKeys:"strict",catchall:Pg.create(),typeName:lv.ZodObject,...Xf(s)}),Fg.lazycreate=(e,s)=>new Fg({shape:e,unknownKeys:"strip",catchall:Pg.create(),typeName:lv.ZodObject,...Xf(s)});class Lg extends Zf{_parse(e){const{ctx:s}=this._processInputParams(e),t=this._def.options;if(s.common.async)return Promise.all(t.map(async e=>{const t={...s,common:{...s.common,issues:[]},parent:null};return{result:await e._parseAsync({data:s.data,path:s.path,parent:t}),ctx:t}})).then(function(e){for(const s of e)if("valid"===s.result.status)return s.result;for(const a of e)if("dirty"===a.result.status)return s.common.issues.push(...a.ctx.common.issues),a.result;const t=e.map(e=>new Mf(e.ctx.common.issues));return Lf(s,{code:Df.invalid_union,unionErrors:t}),Uf});{let e;const a=[];for(const n of t){const t={...s,common:{...s.common,issues:[]},parent:null},r=n._parseSync({data:s.data,path:s.path,parent:t});if("valid"===r.status)return r;"dirty"!==r.status||e||(e={result:r,ctx:t}),t.common.issues.length&&a.push(t.common.issues)}if(e)return s.common.issues.push(...e.ctx.common.issues),e.result;const r=a.map(e=>new Mf(e));return Lf(s,{code:Df.invalid_union,unionErrors:r}),Uf}}get options(){return this._def.options}}function zg(e,s){const t=Pf(e),a=Pf(s);if(e===s)return{valid:!0,data:e};if(t===If.object&&a===If.object){const t=Cf.objectKeys(s),a=Cf.objectKeys(e).filter(e=>-1!==t.indexOf(e)),r={...e,...s};for(const n of a){const t=zg(e[n],s[n]);if(!t.valid)return{valid:!1};r[n]=t.data}return{valid:!0,data:r}}if(t===If.array&&a===If.array){if(e.length!==s.length)return{valid:!1};const t=[];for(let a=0;a<e.length;a++){const r=zg(e[a],s[a]);if(!r.valid)return{valid:!1};t.push(r.data)}return{valid:!0,data:t}}return t===If.date&&a===If.date&&+e===+s?{valid:!0,data:e}:{valid:!1}}Lg.create=(e,s)=>new Lg({options:e,typeName:lv.ZodUnion,...Xf(s)});class Ug extends Zf{_parse(e){const{status:s,ctx:t}=this._processInputParams(e),a=(e,a)=>{if(Hf(e)||Hf(a))return Uf;const r=zg(e.value,a.value);return r.valid?((Vf(e)||Vf(a))&&s.dirty(),{status:s.value,value:r.data}):(Lf(t,{code:Df.invalid_intersection_types}),Uf)};return t.common.async?Promise.all([this._def.left._parseAsync({data:t.data,path:t.path,parent:t}),this._def.right._parseAsync({data:t.data,path:t.path,parent:t})]).then(([e,s])=>a(e,s)):a(this._def.left._parseSync({data:t.data,path:t.path,parent:t}),this._def.right._parseSync({data:t.data,path:t.path,parent:t}))}}Ug.create=(e,s,t)=>new Ug({left:e,right:s,typeName:lv.ZodIntersection,...Xf(t)});class Bg extends Zf{_parse(e){const{status:s,ctx:t}=this._processInputParams(e);if(t.parsedType!==If.array)return Lf(t,{code:Df.invalid_type,expected:If.array,received:t.parsedType}),Uf;if(t.data.length<this._def.items.length)return Lf(t,{code:Df.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Uf;!this._def.rest&&t.data.length>this._def.items.length&&(Lf(t,{code:Df.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),s.dirty());const a=[...t.data].map((e,s)=>{const a=this._def.items[s]||this._def.rest;return a?a._parse(new Kf(t,e,t.path,s)):null}).filter(e=>!!e);return t.common.async?Promise.all(a).then(e=>zf.mergeArray(s,e)):zf.mergeArray(s,a)}get items(){return this._def.items}rest(e){return new Bg({...this._def,rest:e})}}Bg.create=(e,s)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Bg({items:e,typeName:lv.ZodTuple,rest:null,...Xf(s)})};class $g extends Zf{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:s,ctx:t}=this._processInputParams(e);if(t.parsedType!==If.object)return Lf(t,{code:Df.invalid_type,expected:If.object,received:t.parsedType}),Uf;const a=[],r=this._def.keyType,n=this._def.valueType;for(const i in t.data)a.push({key:r._parse(new Kf(t,i,t.path,i)),value:n._parse(new Kf(t,t.data[i],t.path,i)),alwaysSet:i in t.data});return t.common.async?zf.mergeObjectAsync(s,a):zf.mergeObjectSync(s,a)}get element(){return this._def.valueType}static create(e,s,t){return new $g(s instanceof Zf?{keyType:e,valueType:s,typeName:lv.ZodRecord,...Xf(t)}:{keyType:Ng.create(),valueType:e,typeName:lv.ZodRecord,...Xf(s)})}}class Hg extends Zf{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:s,ctx:t}=this._processInputParams(e);if(t.parsedType!==If.map)return Lf(t,{code:Df.invalid_type,expected:If.map,received:t.parsedType}),Uf;const a=this._def.keyType,r=this._def.valueType,n=[...t.data.entries()].map(([e,s],n)=>({key:a._parse(new Kf(t,e,t.path,[n,"key"])),value:r._parse(new Kf(t,s,t.path,[n,"value"]))}));if(t.common.async){const e=new Map;return Promise.resolve().then(async()=>{for(const t of n){const a=await t.key,r=await t.value;if("aborted"===a.status||"aborted"===r.status)return Uf;"dirty"!==a.status&&"dirty"!==r.status||s.dirty(),e.set(a.value,r.value)}return{status:s.value,value:e}})}{const e=new Map;for(const t of n){const a=t.key,r=t.value;if("aborted"===a.status||"aborted"===r.status)return Uf;"dirty"!==a.status&&"dirty"!==r.status||s.dirty(),e.set(a.value,r.value)}return{status:s.value,value:e}}}}Hg.create=(e,s,t)=>new Hg({valueType:s,keyType:e,typeName:lv.ZodMap,...Xf(t)});class Vg extends Zf{_parse(e){const{status:s,ctx:t}=this._processInputParams(e);if(t.parsedType!==If.set)return Lf(t,{code:Df.invalid_type,expected:If.set,received:t.parsedType}),Uf;const a=this._def;null!==a.minSize&&t.data.size<a.minSize.value&&(Lf(t,{code:Df.too_small,minimum:a.minSize.value,type:"set",inclusive:!0,exact:!1,message:a.minSize.message}),s.dirty()),null!==a.maxSize&&t.data.size>a.maxSize.value&&(Lf(t,{code:Df.too_big,maximum:a.maxSize.value,type:"set",inclusive:!0,exact:!1,message:a.maxSize.message}),s.dirty());const r=this._def.valueType;function n(e){const t=new Set;for(const a of e){if("aborted"===a.status)return Uf;"dirty"===a.status&&s.dirty(),t.add(a.value)}return{status:s.value,value:t}}const i=[...t.data.values()].map((e,s)=>r._parse(new Kf(t,e,t.path,s)));return t.common.async?Promise.all(i).then(e=>n(e)):n(i)}min(e,s){return new Vg({...this._def,minSize:{value:e,message:Wf.toString(s)}})}max(e,s){return new Vg({...this._def,maxSize:{value:e,message:Wf.toString(s)}})}size(e,s){return this.min(e,s).max(e,s)}nonempty(e){return this.min(1,e)}}Vg.create=(e,s)=>new Vg({valueType:e,minSize:null,maxSize:null,typeName:lv.ZodSet,...Xf(s)});class Gg extends Zf{get schema(){return this._def.getter()}_parse(e){const{ctx:s}=this._processInputParams(e);return this._def.getter()._parse({data:s.data,path:s.path,parent:s})}}Gg.create=(e,s)=>new Gg({getter:e,typeName:lv.ZodLazy,...Xf(s)});class qg extends Zf{_parse(e){if(e.data!==this._def.value){const s=this._getOrReturnCtx(e);return Lf(s,{received:s.data,code:Df.invalid_literal,expected:this._def.value}),Uf}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Wg(e,s){return new Yg({values:e,typeName:lv.ZodEnum,...Xf(s)})}qg.create=(e,s)=>new qg({value:e,typeName:lv.ZodLiteral,...Xf(s)});class Yg extends Zf{_parse(e){if("string"!=typeof e.data){const s=this._getOrReturnCtx(e),t=this._def.values;return Lf(s,{expected:Cf.joinValues(t),received:s.parsedType,code:Df.invalid_type}),Uf}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const s=this._getOrReturnCtx(e),t=this._def.values;return Lf(s,{received:s.data,code:Df.invalid_enum_value,options:t}),Uf}return $f(e.data)}get options(){return this._def.values}get enum(){const e={};for(const s of this._def.values)e[s]=s;return e}get Values(){const e={};for(const s of this._def.values)e[s]=s;return e}get Enum(){const e={};for(const s of this._def.values)e[s]=s;return e}extract(e,s=this._def){return Yg.create(e,{...this._def,...s})}exclude(e,s=this._def){return Yg.create(this.options.filter(s=>!e.includes(s)),{...this._def,...s})}}Yg.create=Wg;class Kg extends Zf{_parse(e){const s=Cf.getValidEnumValues(this._def.values),t=this._getOrReturnCtx(e);if(t.parsedType!==If.string&&t.parsedType!==If.number){const e=Cf.objectValues(s);return Lf(t,{expected:Cf.joinValues(e),received:t.parsedType,code:Df.invalid_type}),Uf}if(this._cache||(this._cache=new Set(Cf.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const e=Cf.objectValues(s);return Lf(t,{received:t.data,code:Df.invalid_enum_value,options:e}),Uf}return $f(e.data)}get enum(){return this._def.values}}Kg.create=(e,s)=>new Kg({values:e,typeName:lv.ZodNativeEnum,...Xf(s)});class Jg extends Zf{unwrap(){return this._def.type}_parse(e){const{ctx:s}=this._processInputParams(e);if(s.parsedType!==If.promise&&!1===s.common.async)return Lf(s,{code:Df.invalid_type,expected:If.promise,received:s.parsedType}),Uf;const t=s.parsedType===If.promise?s.data:Promise.resolve(s.data);return $f(t.then(e=>this._def.type.parseAsync(e,{path:s.path,errorMap:s.common.contextualErrorMap})))}}Jg.create=(e,s)=>new Jg({type:e,typeName:lv.ZodPromise,...Xf(s)});class Xg extends Zf{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===lv.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:s,ctx:t}=this._processInputParams(e),a=this._def.effect||null,r={addIssue:e=>{Lf(t,e),e.fatal?s.abort():s.dirty()},get path(){return t.path}};if(r.addIssue=r.addIssue.bind(r),"preprocess"===a.type){const e=a.transform(t.data,r);if(t.common.async)return Promise.resolve(e).then(async e=>{if("aborted"===s.value)return Uf;const a=await this._def.schema._parseAsync({data:e,path:t.path,parent:t});return"aborted"===a.status?Uf:"dirty"===a.status||"dirty"===s.value?Bf(a.value):a});{if("aborted"===s.value)return Uf;const a=this._def.schema._parseSync({data:e,path:t.path,parent:t});return"aborted"===a.status?Uf:"dirty"===a.status||"dirty"===s.value?Bf(a.value):a}}if("refinement"===a.type){const e=e=>{const s=a.refinement(e,r);if(t.common.async)return Promise.resolve(s);if(s instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===t.common.async){const a=this._def.schema._parseSync({data:t.data,path:t.path,parent:t});return"aborted"===a.status?Uf:("dirty"===a.status&&s.dirty(),e(a.value),{status:s.value,value:a.value})}return this._def.schema._parseAsync({data:t.data,path:t.path,parent:t}).then(t=>"aborted"===t.status?Uf:("dirty"===t.status&&s.dirty(),e(t.value).then(()=>({status:s.value,value:t.value}))))}if("transform"===a.type){if(!1===t.common.async){const e=this._def.schema._parseSync({data:t.data,path:t.path,parent:t});if(!Gf(e))return Uf;const n=a.transform(e.value,r);if(n instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:s.value,value:n}}return this._def.schema._parseAsync({data:t.data,path:t.path,parent:t}).then(e=>Gf(e)?Promise.resolve(a.transform(e.value,r)).then(e=>({status:s.value,value:e})):Uf)}Cf.assertNever(a)}}Xg.create=(e,s,t)=>new Xg({schema:e,typeName:lv.ZodEffects,effect:s,...Xf(t)}),Xg.createWithPreprocess=(e,s,t)=>new Xg({schema:s,effect:{type:"preprocess",transform:e},typeName:lv.ZodEffects,...Xf(t)});class Zg extends Zf{_parse(e){return this._getType(e)===If.undefined?$f(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Zg.create=(e,s)=>new Zg({innerType:e,typeName:lv.ZodOptional,...Xf(s)});class Qg extends Zf{_parse(e){return this._getType(e)===If.null?$f(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Qg.create=(e,s)=>new Qg({innerType:e,typeName:lv.ZodNullable,...Xf(s)});class ev extends Zf{_parse(e){const{ctx:s}=this._processInputParams(e);let t=s.data;return s.parsedType===If.undefined&&(t=this._def.defaultValue()),this._def.innerType._parse({data:t,path:s.path,parent:s})}removeDefault(){return this._def.innerType}}ev.create=(e,s)=>new ev({innerType:e,typeName:lv.ZodDefault,defaultValue:"function"==typeof s.default?s.default:()=>s.default,...Xf(s)});class sv extends Zf{_parse(e){const{ctx:s}=this._processInputParams(e),t={...s,common:{...s.common,issues:[]}},a=this._def.innerType._parse({data:t.data,path:t.path,parent:{...t}});return qf(a)?a.then(e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new Mf(t.common.issues)},input:t.data})})):{status:"valid",value:"valid"===a.status?a.value:this._def.catchValue({get error(){return new Mf(t.common.issues)},input:t.data})}}removeCatch(){return this._def.innerType}}sv.create=(e,s)=>new sv({innerType:e,typeName:lv.ZodCatch,catchValue:"function"==typeof s.catch?s.catch:()=>s.catch,...Xf(s)});class tv extends Zf{_parse(e){if(this._getType(e)!==If.nan){const s=this._getOrReturnCtx(e);return Lf(s,{code:Df.invalid_type,expected:If.nan,received:s.parsedType}),Uf}return{status:"valid",value:e.data}}}tv.create=e=>new tv({typeName:lv.ZodNaN,...Xf(e)});class av extends Zf{_parse(e){const{ctx:s}=this._processInputParams(e),t=s.data;return this._def.type._parse({data:t,path:s.path,parent:s})}unwrap(){return this._def.type}}class rv extends Zf{_parse(e){const{status:s,ctx:t}=this._processInputParams(e);if(t.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:t.data,path:t.path,parent:t});return"aborted"===e.status?Uf:"dirty"===e.status?(s.dirty(),Bf(e.value)):this._def.out._parseAsync({data:e.value,path:t.path,parent:t})})()}{const e=this._def.in._parseSync({data:t.data,path:t.path,parent:t});return"aborted"===e.status?Uf:"dirty"===e.status?(s.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:t.path,parent:t})}}static create(e,s){return new rv({in:e,out:s,typeName:lv.ZodPipeline})}}class nv extends Zf{_parse(e){const s=this._def.innerType._parse(e),t=e=>(Gf(e)&&(e.value=Object.freeze(e.value)),e);return qf(s)?s.then(e=>t(e)):t(s)}unwrap(){return this._def.innerType}}function iv(e,s){const t="function"==typeof e?e(s):"string"==typeof e?{message:e}:e;return"string"==typeof t?{message:t}:t}var lv,cv;nv.create=(e,s)=>new nv({innerType:e,typeName:lv.ZodReadonly,...Xf(s)}),Fg.lazycreate,(cv=lv||(lv={})).ZodString="ZodString",cv.ZodNumber="ZodNumber",cv.ZodNaN="ZodNaN",cv.ZodBigInt="ZodBigInt",cv.ZodBoolean="ZodBoolean",cv.ZodDate="ZodDate",cv.ZodSymbol="ZodSymbol",cv.ZodUndefined="ZodUndefined",cv.ZodNull="ZodNull",cv.ZodAny="ZodAny",cv.ZodUnknown="ZodUnknown",cv.ZodNever="ZodNever",cv.ZodVoid="ZodVoid",cv.ZodArray="ZodArray",cv.ZodObject="ZodObject",cv.ZodUnion="ZodUnion",cv.ZodDiscriminatedUnion="ZodDiscriminatedUnion",cv.ZodIntersection="ZodIntersection",cv.ZodTuple="ZodTuple",cv.ZodRecord="ZodRecord",cv.ZodMap="ZodMap",cv.ZodSet="ZodSet",cv.ZodFunction="ZodFunction",cv.ZodLazy="ZodLazy",cv.ZodLiteral="ZodLiteral",cv.ZodEnum="ZodEnum",cv.ZodEffects="ZodEffects",cv.ZodNativeEnum="ZodNativeEnum",cv.ZodOptional="ZodOptional",cv.ZodNullable="ZodNullable",cv.ZodDefault="ZodDefault",cv.ZodCatch="ZodCatch",cv.ZodPromise="ZodPromise",cv.ZodBranded="ZodBranded",cv.ZodPipeline="ZodPipeline",cv.ZodReadonly="ZodReadonly";const ov=(e,s={message:`Input not instance of ${e.name}`})=>function(e,s={},t){return e?Rg.create().superRefine((a,r)=>{const n=e(a);if(n instanceof Promise)return n.then(e=>{if(!e){const e=iv(s,a),n=e.fatal??t??!0;r.addIssue({code:"custom",...e,fatal:n})}});if(!n){const e=iv(s,a),n=e.fatal??t??!0;r.addIssue({code:"custom",...e,fatal:n})}}):Rg.create()}(s=>s instanceof e,s),dv=Ng.create,mv=_g.create;tv.create,kg.create;const hv=Sg.create;Eg.create,Tg.create,Cg.create,Ag.create;const uv=Rg.create;Ig.create,Pg.create,Dg.create;const xv=Mg.create,pv=Fg.create;Fg.strictCreate,Lg.create,Ug.create,Bg.create;const fv=$g.create;Hg.create,Vg.create,Gg.create,qg.create;const gv=Yg.create;Kg.create,Jg.create,Xg.create,Zg.create,Qg.create,Xg.createWithPreprocess;const vv=dv().email("Invalid email address"),jv=dv().optional().refine(e=>!e||/^[\+]?[1-9][\d]{0,15}$/.test(e),"Invalid phone number format"),yv=pv({employee_number:dv().min(1,"Employee number is required"),first_name:dv().min(1,"First name is required"),last_name:dv().min(1,"Last name is required"),email:vv,phone:jv,current_position:dv().min(1,"Current position is required"),source_company:dv().min(1,"Source company is required"),current_department:dv().optional(),current_level:dv().optional(),hire_date:dv().optional(),years_of_experience:mv().min(0).max(50).optional(),salary:mv().min(0).optional(),currency:dv().optional(),skills:xv(dv()).optional(),certifications:xv(dv()).optional(),performance_rating:mv().min(1).max(5).optional(),is_active:hv().default(!0)});yv.partial().extend({id:dv().uuid()});const bv=pv({role_title:dv().min(1,"Role title is required"),job_family:dv().min(1,"Job family is required"),role_level:dv().min(1,"Role level is required"),role_category:dv().min(1,"Role category is required"),department:dv().min(1,"Department is required"),standard_description:dv().optional(),core_responsibilities:xv(dv()).default([]),required_skills:xv(dv()).default([]),experience_range_min:mv().min(0).default(0),experience_range_max:mv().min(0).default(50),education_requirements:xv(dv()).default([]),salary_grade:dv().optional(),industry_alignment:dv().default("Telecommunications"),keywords:xv(dv()).default([]),is_active:hv().default(!0)});bv.partial().extend({id:dv().uuid()}),pv({name:dv().min(1,"Skill name is required"),category:dv().min(1,"Skill category is required"),description:dv().optional()}),pv({employee_id:dv().uuid(),skill_id:dv().uuid(),input_level:mv().min(1).max(5),ai_assessed_level:mv().min(1).max(5).optional()}),pv({title:dv().min(1,"Job title is required"),summary:dv().optional(),responsibilities:xv(dv()).default([]),required_qualifications:xv(dv()).default([]),preferred_qualifications:xv(dv()).default([]),required_skills:xv(dv()).default([]),preferred_skills:xv(dv()).default([]),experience_level:dv().optional(),education_level:dv().optional(),salary_range_min:mv().min(0).optional(),salary_range_max:mv().min(0).optional(),currency:dv().default("IDR"),employment_type:gv(["full_time","part_time","contract","internship"]).default("full_time"),location_type:gv(["office","remote","hybrid"]).default("office"),status:gv(["draft","review","approved","published"]).default("draft"),tone:gv(["professional","casual","innovative","corporate"]).default("professional"),language:gv(["en","id"]).default("id")}),pv({file:ov(File).refine(e=>e.size<=Gi.MAX_FILE_SIZE,"File size too large").refine(e=>Gi.ALLOWED_TYPES.includes(e.type),"Invalid file type")}),pv({files:xv(ov(File)).min(1,"At least one file is required"),session_name:dv().min(1,"Session name is required"),upload_mode:gv(["upload_only","upload_assign"]).default("upload_assign")}),pv({analysis_type:dv().min(1,"Analysis type is required"),input_parameters:fv(uv()),function_name:dv().min(1,"Function name is required")}),pv({query:dv().optional(),filters:fv(uv()).optional(),sort_by:dv().optional(),sort_order:gv(["asc","desc"]).default("desc"),page:mv().min(1).default(1),page_size:mv().min(1).max(100).default(10)}),pv({email:vv,password:dv().min(8,"Password must be at least 8 characters")}),pv({email:vv,password:dv().min(8,"Password must be at least 8 characters"),confirm_password:dv().min(8,"Password confirmation is required"),first_name:dv().min(1,"First name is required"),last_name:dv().min(1,"Last name is required"),role:gv(["hr_manager","super_admin","candidate"]).default("hr_manager")}).refine(e=>e.password===e.confirm_password,{message:"Passwords don't match",path:["confirm_password"]});const Nv=e=>{if(!e)return Yi;switch(e.code){case"PGRST116":return"No data found";case"23505":return"This record already exists";case"23503":return"Referenced record not found";case"42501":return Ki;default:return e.message||Yi}},wv={async get(e,s){try{let t=en.from(e).select((null==s?void 0:s.select)||"*");(null==s?void 0:s.filters)&&Object.entries(s.filters).forEach(([e,s])=>{null!=s&&(t=t.eq(e,s))}),(null==s?void 0:s.orderBy)&&(t=t.order(s.orderBy.column,{ascending:s.orderBy.ascending??!1})),(null==s?void 0:s.limit)&&(t=t.limit(s.limit)),(null==s?void 0:s.offset)&&(t=t.range(s.offset,s.offset+(s.limit||10)-1));const{data:a,error:r}=await t;return r?{data:null,error:Nv(r),success:!1}:{data:a,error:null,success:!0}}catch(t){return{data:null,error:t instanceof Error?t.message:Yi,success:!1}}},async create(e,s){try{const{data:t,error:a}=await en.from(e).insert(s).select().single();return a?{data:null,error:Nv(a),success:!1}:{data:t,error:null,success:!0}}catch(t){return{data:null,error:t instanceof Error?t.message:Yi,success:!1}}},async update(e,s,t){try{const{data:a,error:r}=await en.from(e).update(t).eq("id",s).select().single();return r?{data:null,error:Nv(r),success:!1}:{data:a,error:null,success:!0}}catch(a){return{data:null,error:a instanceof Error?a.message:Yi,success:!1}}},async delete(e,s){try{const{error:t}=await en.from(e).delete().eq("id",s);return t?{data:null,error:Nv(t),success:!1}:{data:null,error:null,success:!0}}catch(t){return{data:null,error:t instanceof Error?t.message:Yi,success:!1}}},async bulkInsert(e,s){try{const{data:t,error:a}=await en.from(e).insert(s).select();return a?{data:null,error:Nv(a),success:!1}:{data:t,error:null,success:!0}}catch(t){return{data:null,error:t instanceof Error?t.message:Yi,success:!1}}},async rpc(e,s){try{const{data:t,error:a}=await en.rpc(e,s);return a?{data:null,error:Nv(a),success:!1}:{data:t,error:null,success:!0}}catch(t){return{data:null,error:t instanceof Error?t.message:Yi,success:!1}}},async invokeFunction(e,s){try{const{data:t,error:a}=await en.functions.invoke(e,{body:s||{}});return a?{data:null,error:Nv(a),success:!1}:{data:t,error:null,success:!0}}catch(t){return{data:null,error:t instanceof Error?t.message:Yi,success:!1}}}},_v=(e,s)=>wv.update("xlsmart_employees",e,s),kv=(e,s)=>wv.update("xlsmart_standard_roles",e,s),Sv=({open:e,onOpenChange:s,employee:t,onSave:a})=>{const[r,n]=ce.useState(!1),[l,c]=ce.useState({}),{toast:o}=De();ce.useEffect(()=>{t&&c(t)},[t]);return i.jsx(Cn,{open:e,onOpenChange:s,children:i.jsxs(Pn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[i.jsx(Dn,{children:i.jsx(On,{children:"Edit Employee"})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 py-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"first_name",children:"First Name"}),i.jsx(ln,{id:"first_name",value:l.first_name||"",onChange:e=>c(s=>({...s,first_name:e.target.value})),placeholder:"Enter first name"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"last_name",children:"Last Name"}),i.jsx(ln,{id:"last_name",value:l.last_name||"",onChange:e=>c(s=>({...s,last_name:e.target.value})),placeholder:"Enter last name"})]}),i.jsxs("div",{className:"space-y-2 md:col-span-2",children:[i.jsx(mn,{htmlFor:"email",children:"Email"}),i.jsx(ln,{id:"email",type:"email",value:l.email||"",onChange:e=>c(s=>({...s,email:e.target.value})),placeholder:"Enter email address"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"current_position",children:"Position"}),i.jsx(ln,{id:"current_position",value:l.current_position||"",onChange:e=>c(s=>({...s,current_position:e.target.value})),placeholder:"Enter position"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"current_department",children:"Department"}),i.jsx(ln,{id:"current_department",value:l.current_department||"",onChange:e=>c(s=>({...s,current_department:e.target.value})),placeholder:"Enter department"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"phone",children:"Phone"}),i.jsx(ln,{id:"phone",value:l.phone||"",onChange:e=>c(s=>({...s,phone:e.target.value})),placeholder:"Enter phone number"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"current_location",children:"Location"}),i.jsx(ln,{id:"current_location",value:l.current_location||"",onChange:e=>c(s=>({...s,current_location:e.target.value})),placeholder:"Enter location"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"hire_date",children:"Hire Date"}),i.jsx(ln,{id:"hire_date",type:"date",value:l.hire_date||"",onChange:e=>c(s=>({...s,hire_date:e.target.value}))})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"years_of_experience",children:"Years of Experience"}),i.jsx(ln,{id:"years_of_experience",type:"number",value:l.years_of_experience||"",onChange:e=>c(s=>({...s,years_of_experience:parseInt(e.target.value)||0})),placeholder:"Enter years of experience"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"salary",children:"Salary"}),i.jsx(ln,{id:"salary",type:"number",value:l.salary||"",onChange:e=>c(s=>({...s,salary:parseFloat(e.target.value)||0})),placeholder:"Enter salary"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"employee_number",children:"Employee Number"}),i.jsx(ln,{id:"employee_number",value:l.employee_number||"",onChange:e=>c(s=>({...s,employee_number:e.target.value})),placeholder:"Enter employee number",disabled:!0}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Employee number cannot be changed"})]})]}),i.jsxs(Mn,{children:[i.jsx(nn,{variant:"outline",onClick:()=>s(!1),disabled:r,children:"Cancel"}),i.jsx(nn,{onClick:async()=>{var e;if(!t||!l.email)return;const r=(i=l,yv.safeParse(i));var i;if(r.success){n(!0);try{const e=await _v(t.id,r.data);if(!e.success)throw new Error(e.error||Yi);o({title:"Success",description:Xi}),a(),s(!1)}catch(c){o({title:"Error",description:c.message||Yi,variant:"destructive"})}finally{n(!1)}}else o({title:"Validation Error",description:(null==(e=r.error.issues[0])?void 0:e.message)||Ji,variant:"destructive"})},disabled:r,children:r?"Saving...":"Save Changes"})]})]})})};var Ev="AlertDialog",[Tv,Cv]=r(Ev,[ae]),Av=ae(),Rv=e=>{const{__scopeAlertDialog:s,...t}=e,a=Av(s);return i.jsx(Q,{...a,...t,modal:!0})};Rv.displayName=Ev;ce.forwardRef((e,s)=>{const{__scopeAlertDialog:t,...a}=e,r=Av(t);return i.jsx(ee,{...r,...a,ref:s})}).displayName="AlertDialogTrigger";var Iv=e=>{const{__scopeAlertDialog:s,...t}=e,a=Av(s);return i.jsx(Z,{...a,...t})};Iv.displayName="AlertDialogPortal";var Pv=ce.forwardRef((e,s)=>{const{__scopeAlertDialog:t,...a}=e,r=Av(t);return i.jsx(W,{...r,...a,ref:s})});Pv.displayName="AlertDialogOverlay";var Dv="AlertDialogContent",[Mv,Ov]=Tv(Dv),Fv=S("AlertDialogContent"),Lv=ce.forwardRef((e,s)=>{const{__scopeAlertDialog:t,children:a,...r}=e,l=Av(t),c=ce.useRef(null),o=n(s,c),d=ce.useRef(null);return i.jsx(re,{contentName:Dv,titleName:zv,docsSlug:"alert-dialog",children:i.jsx(Mv,{scope:t,cancelRef:d,children:i.jsxs(Y,{role:"alertdialog",...l,...r,ref:o,onOpenAutoFocus:u(r.onOpenAutoFocus,e=>{var s;e.preventDefault(),null==(s=d.current)||s.focus({preventScroll:!0})}),onPointerDownOutside:e=>e.preventDefault(),onInteractOutside:e=>e.preventDefault(),children:[i.jsx(Fv,{children:a}),i.jsx(qv,{contentRef:c})]})})})});Lv.displayName=Dv;var zv="AlertDialogTitle",Uv=ce.forwardRef((e,s)=>{const{__scopeAlertDialog:t,...a}=e,r=Av(t);return i.jsx(J,{...r,...a,ref:s})});Uv.displayName=zv;var Bv="AlertDialogDescription",$v=ce.forwardRef((e,s)=>{const{__scopeAlertDialog:t,...a}=e,r=Av(t);return i.jsx(X,{...r,...a,ref:s})});$v.displayName=Bv;var Hv=ce.forwardRef((e,s)=>{const{__scopeAlertDialog:t,...a}=e,r=Av(t);return i.jsx(K,{...r,...a,ref:s})});Hv.displayName="AlertDialogAction";var Vv="AlertDialogCancel",Gv=ce.forwardRef((e,s)=>{const{__scopeAlertDialog:t,...a}=e,{cancelRef:r}=Ov(Vv,t),l=Av(t),c=n(s,r);return i.jsx(K,{...l,...a,ref:c})});Gv.displayName=Vv;var qv=({contentRef:e})=>{const s=`\`${Dv}\` requires a description for the component to be accessible for screen reader users.\n\nYou can add a description to the \`${Dv}\` by passing a \`${Bv}\` component as a child, which also benefits sighted users by adding visible context to the dialog.\n\nAlternatively, you can use your own component as a description by assigning it an \`id\` and passing the same value to the \`aria-describedby\` prop in \`${Dv}\`. If the description is confusing or duplicative for sighted users, you can use the \`@radix-ui/react-visually-hidden\` primitive as a wrapper around your description component.\n\nFor more information, see https://radix-ui.com/primitives/docs/components/alert-dialog`;return ce.useEffect(()=>{var s;document.getElementById(null==(s=e.current)?void 0:s.getAttribute("aria-describedby"))},[s,e]),null},Wv=Pv,Yv=Lv,Kv=Hv,Jv=Gv,Xv=Uv,Zv=$v;const Qv=Rv,ej=Iv,sj=ce.forwardRef(({className:e,...s},t)=>i.jsx(Wv,{className:Ga("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s,ref:t}));sj.displayName=Wv.displayName;const tj=ce.forwardRef(({className:e,...s},t)=>i.jsxs(ej,{children:[i.jsx(sj,{}),i.jsx(Yv,{ref:t,className:Ga("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s})]}));tj.displayName=Yv.displayName;const aj=({className:e,...s})=>i.jsx("div",{className:Ga("flex flex-col space-y-2 text-center sm:text-left",e),...s});aj.displayName="AlertDialogHeader";const rj=({className:e,...s})=>i.jsx("div",{className:Ga("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});rj.displayName="AlertDialogFooter";const nj=ce.forwardRef(({className:e,...s},t)=>i.jsx(Xv,{ref:t,className:Ga("text-lg font-semibold",e),...s}));nj.displayName=Xv.displayName;const ij=ce.forwardRef(({className:e,...s},t)=>i.jsx(Zv,{ref:t,className:Ga("text-sm text-muted-foreground",e),...s}));ij.displayName=Zv.displayName;const lj=ce.forwardRef(({className:e,...s},t)=>i.jsx(Kv,{ref:t,className:Ga(rn(),e),...s}));lj.displayName=Kv.displayName;const cj=ce.forwardRef(({className:e,...s},t)=>i.jsx(Jv,{ref:t,className:Ga(rn({variant:"outline"}),"mt-2 sm:mt-0",e),...s}));cj.displayName=Jv.displayName;const oj=({open:e,onOpenChange:s,onConfirm:t,title:a,description:r,loading:n=!1})=>i.jsx(Qv,{open:e,onOpenChange:s,children:i.jsxs(tj,{children:[i.jsxs(aj,{children:[i.jsx(nj,{children:a}),i.jsx(ij,{children:r})]}),i.jsxs(rj,{children:[i.jsx(cj,{disabled:n,children:"Cancel"}),i.jsx(lj,{onClick:t,disabled:n,className:"bg-destructive text-destructive-foreground hover:bg-destructive/90",children:n?"Deleting...":"Delete"})]})]})}),dj=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(!0),[r,n]=ce.useState(""),[l,c]=ce.useState(1),[o,d]=ce.useState("card"),[m,h]=ce.useState(null),[u,x]=ce.useState(null),[p,f]=ce.useState(!1),{toast:g}=De(),[v,j]=ce.useState(10);ce.useEffect(()=>{y()},[]);const y=async()=>{try{const{data:e,error:t}=await en.from("xlsmart_employees").select("*").order("first_name");if(t)throw t;s(e||[])}catch(e){}finally{a(!1)}},b=e.filter(e=>{var s,t;return`${e.first_name} ${e.last_name}`.toLowerCase().includes(r.toLowerCase())||(null==(s=e.current_position)?void 0:s.toLowerCase().includes(r.toLowerCase()))||(null==(t=e.current_department)?void 0:t.toLowerCase().includes(r.toLowerCase()))}),N=Math.ceil(b.length/v),w=(l-1)*v,_=b.slice(w,w+v);return t?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx(Wt,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Employee Directory"})]}),[...Array(5)].map((e,s)=>i.jsx(Qi,{className:"h-20 w-full"},s))]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(Wt,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Employee Directory"}),i.jsxs(zn,{variant:"secondary",children:[e.length," Total Employees"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(nn,{variant:"card"===o?"default":"outline",size:"sm",onClick:()=>d("card"),children:i.jsx(rt,{className:"h-4 w-4"})}),i.jsx(nn,{variant:"list"===o?"default":"outline",size:"sm",onClick:()=>d("list"),children:i.jsx(ct,{className:"h-4 w-4"})})]})]}),i.jsxs("div",{className:"relative",children:[i.jsx(Ct,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),i.jsx(ln,{placeholder:"Search employees by name, role, or department...",value:r,onChange:e=>n(e.target.value),className:"pl-10"})]}),"card"===o?i.jsx("div",{className:"space-y-4",children:_.map(e=>i.jsx(fn,{className:"hover:shadow-md transition-shadow",children:i.jsx(yn,{className:"p-6",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsx("div",{className:"p-3 bg-primary/10 rounded-full",children:i.jsx(qt,{className:"h-5 w-5 text-primary"})}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("h3",{className:"font-semibold text-lg",children:[e.first_name," ",e.last_name]}),i.jsxs("div",{className:"space-y-1 text-sm text-muted-foreground",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(zn,{variant:"outline",children:e.current_position}),e.current_department&&i.jsx(zn,{variant:"secondary",children:e.current_department})]}),e.current_location&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(mt,{className:"h-3 w-3"}),i.jsx("span",{children:e.current_location})]}),e.email&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(dt,{className:"h-3 w-3"}),i.jsx("span",{children:e.email})]}),e.phone&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Nt,{className:"h-3 w-3"}),i.jsx("span",{children:e.phone})]})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[e.hire_date&&i.jsxs("div",{className:"text-right text-sm text-muted-foreground mr-4",children:[i.jsx("span",{children:"Hired"}),i.jsx("div",{className:"font-medium",children:new Date(e.hire_date).toLocaleDateString()})]}),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>h(e),children:i.jsx(Dt,{className:"h-4 w-4"})}),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>x(e),children:i.jsx(zt,{className:"h-4 w-4"})})]})]})})},e.id))}):i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Employee"}),i.jsx(rl,{children:"Position"}),i.jsx(rl,{children:"Department"}),i.jsx(rl,{children:"Contact"}),i.jsx(rl,{children:"Hire Date"}),i.jsx(rl,{children:"Actions"})]})}),i.jsx(tl,{children:_.map(e=>i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-primary/10 rounded-full",children:i.jsx(qt,{className:"h-4 w-4 text-primary"})}),i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium",children:[e.first_name," ",e.last_name]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:e.employee_number})]})]})}),i.jsx(nl,{children:i.jsx(zn,{variant:"outline",children:e.current_position})}),i.jsx(nl,{children:e.current_department?i.jsx(zn,{variant:"secondary",children:e.current_department}):i.jsx("span",{className:"text-muted-foreground",children:"-"})}),i.jsx(nl,{children:i.jsxs("div",{className:"space-y-1 text-sm",children:[e.email&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(dt,{className:"h-3 w-3"}),i.jsx("span",{children:e.email})]}),e.phone&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Nt,{className:"h-3 w-3"}),i.jsx("span",{children:e.phone})]})]})}),i.jsx(nl,{children:e.hire_date?i.jsx("span",{children:new Date(e.hire_date).toLocaleDateString()}):i.jsx("span",{className:"text-muted-foreground",children:"-"})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>h(e),children:i.jsx(Dt,{className:"h-4 w-4"})}),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>x(e),children:i.jsx(zt,{className:"h-4 w-4"})})]})})]},e.id))})]}),i.jsx(Sv,{open:!!m,onOpenChange:e=>!e&&h(null),employee:m,onSave:y}),i.jsx(oj,{open:!!u,onOpenChange:e=>!e&&x(null),onConfirm:async()=>{if(u){f(!0);try{const{error:e}=await en.from("xlsmart_employees").delete().eq("id",u.id);if(e)throw e;g({title:"Success",description:"Employee deleted successfully"}),y(),x(null)}catch(e){g({title:"Error",description:e.message||"Failed to delete employee",variant:"destructive"})}finally{f(!1)}}},title:"Delete Employee",description:`Are you sure you want to delete ${null==u?void 0:u.first_name} ${null==u?void 0:u.last_name}? This action cannot be undone.`,loading:p}),i.jsx(il,{currentPage:l,totalPages:N,pageSize:v,totalItems:b.length,onPageChange:c,onPageSizeChange:e=>{j(e),c(1)}})]})},mj=({open:e,onOpenChange:s,role:t,onSave:a})=>{const[r,n]=ce.useState(!1),[l,c]=ce.useState({}),[o,d]=ce.useState(""),[m,h]=ce.useState([]),{toast:u}=De();ce.useEffect(()=>{t&&(c(t),h(Array.isArray(t.required_skills)?t.required_skills:[]))},[t]);const x=()=>{o.trim()&&!m.includes(o.trim())&&(h([...m,o.trim()]),d(""))};return i.jsx(Cn,{open:e,onOpenChange:s,children:i.jsxs(Pn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[i.jsx(Dn,{children:i.jsx(On,{children:"Edit Standardized Role"})}),i.jsxs("div",{className:"space-y-4 py-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"role_title",children:"Role Title"}),i.jsx(ln,{id:"role_title",value:l.role_title||"",onChange:e=>c(s=>({...s,role_title:e.target.value})),placeholder:"Enter role title"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"role_level",children:"Role Level"}),i.jsx(ln,{id:"role_level",value:l.role_level||"",onChange:e=>c(s=>({...s,role_level:e.target.value})),placeholder:"Enter role level (e.g., M1, L3)"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"department",children:"Department"}),i.jsx(ln,{id:"department",value:l.department||"",onChange:e=>c(s=>({...s,department:e.target.value})),placeholder:"Enter department"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"standard_description",children:"Description"}),i.jsx(kf,{id:"standard_description",value:l.standard_description||"",onChange:e=>c(s=>({...s,standard_description:e.target.value})),placeholder:"Enter role description",rows:3})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{children:"Required Skills"}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(ln,{value:o,onChange:e=>d(e.target.value),placeholder:"Add a skill",onKeyPress:e=>"Enter"===e.key&&x()}),i.jsx(nn,{type:"button",onClick:x,children:"Add"})]}),i.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:m.map((e,s)=>i.jsxs(zn,{variant:"outline",className:"pr-1",children:[e,i.jsx("button",{onClick:()=>{return s=e,void h(m.filter(e=>e!==s));var s},className:"ml-1 hover:bg-destructive hover:text-destructive-foreground rounded-full",children:i.jsx(Xt,{className:"h-3 w-3"})})]},s))})]})]}),i.jsxs(Mn,{children:[i.jsx(nn,{variant:"outline",onClick:()=>s(!1),disabled:r,children:"Cancel"}),i.jsx(nn,{onClick:async()=>{var e;if(!t||!l.role_title)return;const r={...l,required_skills:m,role_category:l.department||Wi[0],job_family:l.role_title,role_level:l.role_level||qi[0]},i=(c=r,bv.safeParse(c));var c;if(i.success){n(!0);try{const e=await kv(t.id,i.data);if(!e.success)throw new Error(e.error||Yi);u({title:"Success",description:Xi}),a(),s(!1)}catch(o){u({title:"Error",description:o.message||Yi,variant:"destructive"})}finally{n(!1)}}else u({title:"Validation Error",description:(null==(e=i.error.issues[0])?void 0:e.message)||Ji,variant:"destructive"})},disabled:r,children:r?"Saving...":"Save Changes"})]})]})})},hj=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(!0),[r,n]=ce.useState(""),[l,c]=ce.useState(1),[o,d]=ce.useState("card"),[m,h]=ce.useState(null),[u,x]=ce.useState(null),[p,f]=ce.useState(!1),{toast:g}=De(),[v,j]=ce.useState(8);ce.useEffect(()=>{y()},[]);const y=async()=>{try{const{data:e,error:t}=await en.from("xlsmart_standard_roles").select("*").order("role_title");if(t)throw t;const a=await Promise.all((e||[]).map(async e=>{const{count:s}=await en.from("xlsmart_employees").select("*",{count:"exact",head:!0}).eq("current_position",e.role_title);return{...e,employee_count:s||0}}));s(a)}catch(e){}finally{a(!1)}},b=e.filter(e=>{var s,t,a;return(null==(s=e.role_title)?void 0:s.toLowerCase().includes(r.toLowerCase()))||(null==(t=e.department)?void 0:t.toLowerCase().includes(r.toLowerCase()))||(null==(a=e.role_level)?void 0:a.toLowerCase().includes(r.toLowerCase()))}),N=Math.ceil(b.length/v),w=(l-1)*v,_=b.slice(w,w+v);return t?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx(Ft,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Standardized Roles"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[...Array(6)].map((e,s)=>i.jsx(Qi,{className:"h-48 w-full"},s))})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(Ft,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Standardized Roles"}),i.jsxs(zn,{variant:"secondary",children:[e.length," Standard Roles"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(nn,{variant:"card"===o?"default":"outline",size:"sm",onClick:()=>d("card"),children:i.jsx(rt,{className:"h-4 w-4"})}),i.jsx(nn,{variant:"list"===o?"default":"outline",size:"sm",onClick:()=>d("list"),children:i.jsx(ct,{className:"h-4 w-4"})})]})]}),i.jsxs("div",{className:"relative",children:[i.jsx(Ct,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),i.jsx(ln,{placeholder:"Search roles by name, department, or level...",value:r,onChange:e=>n(e.target.value),className:"pl-10"})]}),"card"===o?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:_.map(e=>i.jsxs(fn,{className:"hover:shadow-lg transition-shadow",children:[i.jsx(gn,{className:"pb-3",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:i.jsx(Is,{className:"h-5 w-5 text-primary"})}),i.jsxs("div",{children:[i.jsx(vn,{className:"text-lg",children:e.role_title}),e.role_level&&i.jsx(zn,{variant:"outline",className:"mt-1",children:e.role_level})]})]}),i.jsx("div",{className:"text-right",children:i.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[i.jsx(Wt,{className:"h-3 w-3"}),i.jsx("span",{children:e.employee_count})]})})]})}),i.jsxs(yn,{className:"space-y-4",children:[e.department&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Department:"}),i.jsx(zn,{variant:"secondary",className:"ml-2",children:e.department})]}),e.standard_description&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Description:"}),i.jsx("p",{className:"text-sm mt-1 text-gray-700 line-clamp-2",children:e.standard_description})]}),e.required_skills&&Array.isArray(e.required_skills)&&e.required_skills.length>0&&i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Ot,{className:"h-4 w-4 text-yellow-500"}),i.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Required Skills:"})]}),i.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.required_skills.slice(0,4).map((e,s)=>i.jsx(zn,{variant:"outline",className:"text-xs",children:e},s)),e.required_skills.length>4&&i.jsxs(zn,{variant:"outline",className:"text-xs",children:["+",e.required_skills.length-4," more"]})]})]}),i.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.created_at&&i.jsxs("div",{className:"text-xs text-muted-foreground",children:["Created: ",new Date(e.created_at).toLocaleDateString()]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>h(e),children:i.jsx(Dt,{className:"h-3 w-3"})}),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>x(e),children:i.jsx(zt,{className:"h-3 w-3"})})]})]})]})]},e.id))}):i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Role Title"}),i.jsx(rl,{children:"Level"}),i.jsx(rl,{children:"Department"}),i.jsx(rl,{children:"Employees"}),i.jsx(rl,{children:"Created"}),i.jsx(rl,{children:"Actions"})]})}),i.jsx(tl,{children:_.map(e=>i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:i.jsx(Is,{className:"h-4 w-4 text-primary"})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:e.role_title}),e.standard_description&&i.jsx("div",{className:"text-sm text-muted-foreground line-clamp-1",children:e.standard_description})]})]})}),i.jsx(nl,{children:e.role_level?i.jsx(zn,{variant:"outline",children:e.role_level}):i.jsx("span",{className:"text-muted-foreground",children:"-"})}),i.jsx(nl,{children:e.department?i.jsx(zn,{variant:"secondary",children:e.department}):i.jsx("span",{className:"text-muted-foreground",children:"-"})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Wt,{className:"h-3 w-3"}),i.jsx("span",{children:e.employee_count})]})}),i.jsx(nl,{children:e.created_at?i.jsx("span",{className:"text-sm",children:new Date(e.created_at).toLocaleDateString()}):i.jsx("span",{className:"text-muted-foreground",children:"-"})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>h(e),children:i.jsx(Dt,{className:"h-4 w-4"})}),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>x(e),children:i.jsx(zt,{className:"h-4 w-4"})})]})})]},e.id))})]}),i.jsx(mj,{open:!!m,onOpenChange:e=>!e&&h(null),role:m,onSave:y}),i.jsx(oj,{open:!!u,onOpenChange:e=>!e&&x(null),onConfirm:async()=>{if(u){f(!0);try{const{error:e}=await en.from("xlsmart_standard_roles").delete().eq("id",u.id);if(e)throw e;g({title:"Success",description:"Role deleted successfully"}),y(),x(null)}catch(e){g({title:"Error",description:e.message||"Failed to delete role",variant:"destructive"})}finally{f(!1)}}},title:"Delete Role",description:`Are you sure you want to delete the role "${null==u?void 0:u.role_title}"? This action cannot be undone.`,loading:p}),i.jsx(il,{currentPage:l,totalPages:N,pageSize:v,totalItems:b.length,onPageChange:c,onPageSizeChange:e=>{j(e),c(1)}})]})},uj=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(null),[r,n]=ce.useState(!0),[l,c]=ce.useState(1),[o,d]=ce.useState(10),[m,h]=ce.useState(!1),{toast:u}=De();ce.useEffect(()=>{x()},[]);const x=async()=>{try{const{data:e,error:t}=await en.from("xlsmart_role_mappings").select("*").order("mapping_confidence",{ascending:!1});if(t)throw t;const r=e||[];s(r);const n=r.length,i=n>0?Math.round(r.reduce((e,s)=>e+(s.mapping_confidence||0),0)/n):0,l=r.filter(e=>(e.mapping_confidence||0)>=80).length,c=r.filter(e=>(e.mapping_confidence||0)>=60&&(e.mapping_confidence||0)<80).length,o=r.filter(e=>(e.mapping_confidence||0)<60).length,d=r.filter(e=>"pending_review"===e.mapping_status).length;a({averageAccuracy:i,totalMappings:n,highConfidence:l,mediumConfidence:c,lowConfidence:o,pendingReview:d})}catch(e){}finally{n(!1)}},p=e=>{const s=Math.round(e);return s>=80?i.jsxs(zn,{className:"bg-green-100 text-green-800 border-green-200",children:["High (",s,"%)"]}):s>=60?i.jsxs(zn,{className:"bg-yellow-100 text-yellow-800 border-yellow-200",children:["Medium (",s,"%)"]}):i.jsxs(zn,{className:"bg-red-100 text-red-800 border-red-200",children:["Low (",s,"%)"]})},f=e=>{switch(e){case"approved":return i.jsx(Gs,{className:"h-4 w-4 text-green-600"});case"pending_review":return i.jsx(Ys,{className:"h-4 w-4 text-yellow-600"});case"rejected":return i.jsx(Vs,{className:"h-4 w-4 text-red-600"});default:return i.jsx(Ys,{className:"h-4 w-4 text-gray-600"})}},g=Math.ceil(e.length/o),v=(l-1)*o,j=e.slice(v,v+o);return r?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx(Zt,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Mapping Accuracy Analysis"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[...Array(4)].map((e,s)=>i.jsx(Qi,{className:"h-24 w-full"},s))}),[...Array(5)].map((e,s)=>i.jsx(Qi,{className:"h-20 w-full"},s))]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx(Zt,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Mapping Accuracy Analysis"}),i.jsxs("div",{className:"ml-auto flex items-center gap-2",children:[e.length>0&&i.jsxs(nn,{onClick:async()=>{h(!0);try{const s=[];for(const a of e){if(!a.original_role_title||!a.standardized_role_title)continue;const e=a.original_role_title.toLowerCase().trim(),t=a.standardized_role_title.toLowerCase().trim();let r=0;if(e===t)r=100;else{const s=e.split(/\s+/),a=t.split(/\s+/);let n=0;for(const e of s)a.includes(e)&&n++;const i=n/Math.max(s.length,a.length),l=e.includes(t)||t.includes(e)?.2:0,c=["engineer","manager","analyst","specialist","coordinator","lead","senior","junior"];let o=0;for(const r of c)e.includes(r)&&t.includes(r)&&o++;const d=o/c.length*.3;r=Math.min(100*(i+l+d),95)}const n=Math.round(r),i=a.mapping_confidence||0;Math.abs(n-i)>5&&s.push({id:a.id,mapping_confidence:n,requires_manual_review:n<80})}let t=0;for(const e of s){const{error:s}=await en.from("xlsmart_role_mappings").update({mapping_confidence:e.mapping_confidence,requires_manual_review:e.requires_manual_review}).eq("id",e.id);s||t++}t>0?(u({title:"Mappings Fixed!",description:`Successfully updated ${t} mappings with realistic confidence values.`}),await x()):u({title:"No Updates Needed",description:"All mappings already have realistic confidence values."})}catch(s){u({title:"Error",description:"Failed to fix existing mappings. Please try again.",variant:"destructive"})}finally{h(!1)}},disabled:m,size:"sm",variant:"outline",className:"bg-blue-50 hover:bg-blue-100 border-blue-200",children:[i.jsx(kt,{className:"h-4 w-4 mr-2 "+(m?"animate-spin":"")}),m?"Fixing...":"Fix Confidence Values"]}),i.jsxs(zn,{variant:"secondary",children:[null==t?void 0:t.averageAccuracy,"% Average Accuracy"]})]})]}),t&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(Ut,{className:"h-5 w-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[t.averageAccuracy,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Overall Accuracy"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:i.jsx(Gs,{className:"h-5 w-5 text-green-600"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.highConfidence}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"High Confidence (≥80%)"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-yellow-100 rounded-lg",children:i.jsx(Vs,{className:"h-5 w-5 text-yellow-600"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:t.mediumConfidence}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Medium Confidence (60-79%)"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:i.jsx(Vs,{className:"h-5 w-5 text-red-600"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-red-600",children:t.lowConfidence}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Low Confidence (<60%)"})]})]})})})]}),t&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{className:"text-lg",children:"Confidence Distribution"})}),i.jsxs(yn,{className:"space-y-4",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium",children:"High Confidence (≥80%)"}),i.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.highConfidence," of ",t.totalMappings]})]}),i.jsx(Bi,{value:t.highConfidence/t.totalMappings*100,className:"h-2"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium",children:"Medium Confidence (60-79%)"}),i.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.mediumConfidence," of ",t.totalMappings]})]}),i.jsx(Bi,{value:t.mediumConfidence/t.totalMappings*100,className:"h-2"})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium",children:"Low Confidence (<60%)"}),i.jsxs("span",{className:"text-sm text-muted-foreground",children:[t.lowConfidence," of ",t.totalMappings]})]}),i.jsx(Bi,{value:t.lowConfidence/t.totalMappings*100,className:"h-2"})]})]})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{className:"text-lg",children:"Recent Role Mappings"})}),i.jsx(yn,{children:0===e.length?i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Zt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Role Mappings Found"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:"Role mappings will appear here after you upload and standardize role catalogs."}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 max-w-md mx-auto",children:[i.jsx("h4",{className:"font-medium text-blue-900 mb-2",children:"How to get started:"}),i.jsxs("ol",{className:"text-sm text-blue-800 space-y-1 text-left",children:[i.jsxs("li",{children:["1. Go to the ",i.jsx("strong",{children:"Standardization"})," tab"]}),i.jsx("li",{children:"2. Upload XL and SMART role files"}),i.jsx("li",{children:"3. Run the AI standardization process"}),i.jsx("li",{children:"4. View your mapping accuracy here"})]})]})]}):i.jsxs("div",{className:"space-y-4",children:[j.map(e=>i.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:bg-muted/50",children:[i.jsxs("div",{className:"flex-1 space-y-1",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[e.employee_name&&i.jsx("span",{className:"font-medium",children:e.employee_name}),f(e.mapping_status||"pending")]}),i.jsxs("div",{className:"text-sm text-muted-foreground",children:[i.jsx("span",{className:"font-medium",children:"Original:"})," ",e.original_role_title,(e.standardized_role_title||e.mapped_role)&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"mx-2",children:"→"}),i.jsx("span",{className:"font-medium",children:"Mapped:"})," ",e.standardized_role_title||e.mapped_role]})]}),e.created_at&&i.jsxs("div",{className:"text-xs text-muted-foreground",children:["Created: ",new Date(e.created_at).toLocaleDateString()]})]}),i.jsx("div",{className:"flex items-center gap-3",children:p(e.mapping_confidence)})]},e.id)),i.jsx(il,{currentPage:l,totalPages:g,pageSize:o,totalItems:e.length,onPageChange:c,onPageSizeChange:e=>{d(e),c(1)}})]})})]})]})},xj=["Technical","Leadership","Communication","Project Management","Data Analysis","Programming","Design","Marketing","Finance","Operations","Other"],pj=({open:e,onOpenChange:s,skill:t,onSave:a})=>{const[r,n]=ce.useState(!1),[l,c]=ce.useState({}),{toast:o}=De();ce.useEffect(()=>{t&&c(t)},[t]);return i.jsx(Cn,{open:e,onOpenChange:s,children:i.jsxs(Pn,{className:"max-w-lg",children:[i.jsx(Dn,{children:i.jsx(On,{children:"Edit Skill"})}),i.jsxs("div",{className:"space-y-4 py-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"name",children:"Skill Name"}),i.jsx(ln,{id:"name",value:l.name||"",onChange:e=>c(s=>({...s,name:e.target.value})),placeholder:"Enter skill name"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"category",children:"Category"}),i.jsxs(bn,{value:l.category||"",onValueChange:e=>c(s=>({...s,category:e})),children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select category"})}),i.jsx(Sn,{children:xj.map(e=>i.jsx(En,{value:e,children:e},e))})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"description",children:"Description"}),i.jsx(kf,{id:"description",value:l.description||"",onChange:e=>c(s=>({...s,description:e.target.value})),placeholder:"Enter skill description",rows:3})]})]}),i.jsxs(Mn,{children:[i.jsx(nn,{variant:"outline",onClick:()=>s(!1),disabled:r,children:"Cancel"}),i.jsx(nn,{onClick:async()=>{if(t&&l.name){n(!0);try{const{error:e}=await en.from("skills_master").update({name:l.name,category:l.category,description:l.description}).eq("id",t.id);if(e)throw e;o({title:"Success",description:"Skill updated successfully"}),a(),s(!1)}catch(e){o({title:"Error",description:e.message||"Failed to update skill",variant:"destructive"})}finally{n(!1)}}},disabled:r,children:r?"Saving...":"Save Changes"})]})]})})},fj=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(!0),[r,n]=ce.useState(""),[l,c]=ce.useState("all"),[o,d]=ce.useState(1),[m,h]=ce.useState("card"),[u,x]=ce.useState(null),[p,f]=ce.useState(null),[g,v]=ce.useState(!1),{toast:j}=De();ce.useEffect(()=>{y()},[]);const y=async()=>{try{const{data:e,error:t}=await en.from("skills_master").select("*").order("name");if(t)throw t;s(e||[])}catch(e){}finally{a(!1)}},b=[...new Set(e.map(e=>e.category).filter(Boolean))],N=e.filter(e=>{var s,t,a;const n=(null==(s=e.name)?void 0:s.toLowerCase().includes(r.toLowerCase()))||(null==(t=e.category)?void 0:t.toLowerCase().includes(r.toLowerCase()))||(null==(a=e.description)?void 0:a.toLowerCase().includes(r.toLowerCase())),i="all"===l||e.category===l;return n&&i}),w=Math.ceil(N.length/12),_=12*(o-1),k=N.slice(_,_+12);return t?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx(Ms,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Skills Inventory"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[...Array(9)].map((e,s)=>i.jsx(Qi,{className:"h-32 w-full"},s))})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(Ms,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Skills Inventory"}),i.jsxs(zn,{variant:"secondary",children:[e.length," Total Skills"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(nn,{variant:"card"===m?"default":"outline",size:"sm",onClick:()=>h("card"),children:i.jsx(rt,{className:"h-4 w-4"})}),i.jsx(nn,{variant:"list"===m?"default":"outline",size:"sm",onClick:()=>h("list"),children:i.jsx(ct,{className:"h-4 w-4"})})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs("div",{className:"relative flex-1",children:[i.jsx(Ct,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),i.jsx(ln,{placeholder:"Search skills by name, category, or description...",value:r,onChange:e=>n(e.target.value),className:"pl-10"})]}),i.jsxs("div",{className:"flex gap-2 flex-wrap",children:[i.jsx(nn,{variant:"all"===l?"default":"outline",size:"sm",onClick:()=>c("all"),children:"All Categories"}),b.map(e=>i.jsx(nn,{variant:l===e?"default":"outline",size:"sm",onClick:()=>c(e),children:e},e))]})]}),"card"===m?i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:k.map(e=>i.jsxs(fn,{className:"hover:shadow-md transition-shadow",children:[i.jsx(gn,{className:"pb-3",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-accent/10 rounded-lg",children:i.jsx(Ot,{className:"h-4 w-4 text-accent"})}),i.jsx("div",{children:i.jsx(vn,{className:"text-base font-semibold",children:e.name})})]}),e.usage_count&&i.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:[i.jsx(Wt,{className:"h-3 w-3"}),i.jsx("span",{children:e.usage_count})]})]})}),i.jsxs(yn,{className:"space-y-3",children:[i.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.category&&i.jsx(zn,{variant:"secondary",className:"text-xs",children:e.category}),e.proficiency_level&&i.jsx(zn,{variant:"outline",className:"text-xs "+("Expert"===e.proficiency_level?"border-green-500 text-green-600":"Advanced"===e.proficiency_level?"border-blue-500 text-blue-600":"Intermediate"===e.proficiency_level?"border-yellow-500 text-yellow-600":"border-gray-500 text-gray-600"),children:e.proficiency_level})]}),e.description&&i.jsx("p",{className:"text-xs text-muted-foreground line-clamp-3",children:e.description}),i.jsxs("div",{className:"flex items-center justify-between pt-2 border-t",children:[e.created_at&&i.jsxs("div",{className:"text-xs text-muted-foreground",children:["Added: ",new Date(e.created_at).toLocaleDateString()]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>x(e),children:i.jsx(Dt,{className:"h-3 w-3"})}),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>f(e),children:i.jsx(zt,{className:"h-3 w-3"})})]})]})]})]},e.id))}):i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Skill Name"}),i.jsx(rl,{children:"Category"}),i.jsx(rl,{children:"Proficiency"}),i.jsx(rl,{children:"Usage"}),i.jsx(rl,{children:"Added"}),i.jsx(rl,{children:"Actions"})]})}),i.jsx(tl,{children:k.map(e=>i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-accent/10 rounded-lg",children:i.jsx(Ot,{className:"h-3 w-3 text-accent"})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:e.name}),e.description&&i.jsx("div",{className:"text-sm text-muted-foreground line-clamp-1",children:e.description})]})]})}),i.jsx(nl,{children:e.category?i.jsx(zn,{variant:"secondary",className:"text-xs",children:e.category}):i.jsx("span",{className:"text-muted-foreground",children:"-"})}),i.jsx(nl,{children:e.proficiency_level?i.jsx(zn,{variant:"outline",className:"text-xs "+("Expert"===e.proficiency_level?"border-green-500 text-green-600":"Advanced"===e.proficiency_level?"border-blue-500 text-blue-600":"Intermediate"===e.proficiency_level?"border-yellow-500 text-yellow-600":"border-gray-500 text-gray-600"),children:e.proficiency_level}):i.jsx("span",{className:"text-muted-foreground",children:"-"})}),i.jsx(nl,{children:e.usage_count?i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Wt,{className:"h-3 w-3"}),i.jsx("span",{children:e.usage_count})]}):i.jsx("span",{className:"text-muted-foreground",children:"0"})}),i.jsx(nl,{children:e.created_at?i.jsx("span",{className:"text-sm",children:new Date(e.created_at).toLocaleDateString()}):i.jsx("span",{className:"text-muted-foreground",children:"-"})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>x(e),children:i.jsx(Dt,{className:"h-4 w-4"})}),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>f(e),children:i.jsx(zt,{className:"h-4 w-4"})})]})})]},e.id))})]}),i.jsx(pj,{open:!!u,onOpenChange:e=>!e&&x(null),skill:u,onSave:y}),i.jsx(oj,{open:!!p,onOpenChange:e=>!e&&f(null),onConfirm:async()=>{if(p){v(!0);try{const{error:e}=await en.from("skills_master").delete().eq("id",p.id);if(e)throw e;j({title:"Success",description:"Skill deleted successfully"}),y(),f(null)}catch(e){j({title:"Error",description:e.message||"Failed to delete skill",variant:"destructive"})}finally{v(!1)}}},title:"Delete Skill",description:`Are you sure you want to delete the skill "${null==p?void 0:p.name}"? This action cannot be undone.`,loading:g}),0===N.length&&i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Ms,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("p",{className:"text-muted-foreground",children:"No skills found matching your criteria."})]}),w>1&&i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing ",_+1," to ",Math.min(_+12,N.length)," of ",N.length," skills"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>d(e=>Math.max(1,e-1)),disabled:1===o,children:"Previous"}),i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>d(e=>Math.min(w,e+1)),disabled:o===w,children:"Next"})]})]})]})},gj=({sessionId:e})=>{const[s,t]=ce.useState([]),[a,r]=ce.useState([]),[n,l]=ce.useState({}),[c,o]=ce.useState(!0),[d,m]=ce.useState(null),[h,u]=ce.useState(null),[x,p]=ce.useState(""),[f,g]=ce.useState(""),{toast:v}=De();ce.useEffect(()=>{j()},[e]);const j=async()=>{try{o(!0);const{data:s}=await en.from("xlsmart_upload_sessions").select("*").eq("id",e).single();if(!s)return;const a=new Date(s.created_at),n=new Date(a.getTime()-6e5),i=new Date(a.getTime()+36e5),{data:c,error:d}=await en.from("xlsmart_employees").select("*").gte("created_at",n.toISOString()).lte("created_at",i.toISOString()).eq("uploaded_by",s.created_by);if(d)throw d;const{data:m,error:h}=await en.from("xlsmart_employees").select("*").eq("uploaded_by",s.created_by).is("standard_role_id",null).eq("is_active",!0);if(h)throw h;const u=[...c||[]].map(e=>({...e,uploadStatus:"newly_uploaded"})),x=new Set((null==c?void 0:c.map(e=>e.id))||[]);null==m||m.forEach(e=>{x.has(e.id)||u.push({...e,uploadStatus:"existing_no_role"})});const{data:p,error:f}=await en.from("xlsmart_standard_roles").select("*").eq("is_active",!0).order("role_title");if(f)throw f;t(u||[]),r(p||[]);const g={};null==u||u.forEach(e=>{if(e.ai_suggested_role_id){const s=null==p?void 0:p.find(s=>s.id===e.ai_suggested_role_id);s&&(g[e.id]=s)}}),l(g)}catch(s){v({title:"Error",description:"Failed to load employee data",variant:"destructive"})}finally{o(!1)}},y=async(e,s,a,r)=>{var n;try{m(e);const{error:i}=await en.from("xlsmart_employees").update({standard_role_id:s,role_assignment_status:"ai"===a?"ai_suggested":"manually_assigned",assigned_by:null==(n=(await en.auth.getUser()).data.user)?void 0:n.id,assignment_notes:r||""}).eq("id",e);if(i)throw i;t(t=>t.map(t=>t.id===e?{...t,standard_role_id:s,role_assignment_status:"ai"===a?"ai_suggested":"manually_assigned",assignment_notes:r||""}:t)),v({title:"Role Assigned",description:"Employee role has been updated successfully"})}catch(i){v({title:"Error",description:"Failed to assign role",variant:"destructive"})}finally{m(null)}},b=()=>{u(null),p(""),g("")},N=async()=>{h&&x&&(await y(h,x,"manual",f),u(null),p(""),g(""))},w=e=>{if(!e.standard_role_id)return null;const s=a.find(s=>s.id===e.standard_role_id);return(null==s?void 0:s.role_title)||"Unknown Role"},_=e=>{switch(e){case"pending":return i.jsx(zn,{variant:"outline",children:"Pending"});case"ai_suggested":return i.jsx(zn,{variant:"secondary",children:"AI Suggested"});case"manually_assigned":return i.jsx(zn,{variant:"default",children:"Manually Assigned"});case"approved":return i.jsx(zn,{variant:"outline",className:"bg-green-50 text-green-700",children:"Approved"});default:return i.jsx(zn,{variant:"outline",children:e})}};return c?i.jsx(fn,{children:i.jsx(yn,{className:"p-6",children:i.jsx("div",{className:"text-center",children:"Loading employee data..."})})}):i.jsxs(fn,{className:"w-full",children:[i.jsxs(gn,{children:[i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(qt,{className:"h-5 w-5"}),"Employee Role Assignment Review"]}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Review and assign roles to uploaded employees. You can choose from original role, AI suggestion, or manually select a different role.",i.jsx("br",{}),i.jsx("span",{className:"text-xs",children:'Note: "Existing" employees were already in the system but need role assignments.'})]})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"overflow-x-auto",children:i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{className:"min-w-[150px]",children:"Employee"}),i.jsx(rl,{className:"min-w-[150px]",children:"Current Position"}),i.jsx(rl,{className:"min-w-[120px]",children:"Original Role"}),i.jsx(rl,{className:"min-w-[120px]",children:"AI Suggested"}),i.jsx(rl,{className:"min-w-[150px]",children:"Assigned Role"}),i.jsx(rl,{className:"min-w-[100px]",children:"Status"}),i.jsx(rl,{className:"min-w-[100px]",children:"Actions"})]})}),i.jsx(tl,{children:s.map(e=>i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium",children:[e.first_name," ",e.last_name,"existing_no_role"===e.uploadStatus&&i.jsx(zn,{variant:"outline",className:"ml-2 text-xs",children:"Existing"})]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:e.employee_number})]})}),i.jsx(nl,{children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:e.current_position}),i.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.current_department," • ",e.current_level]})]})}),i.jsx(nl,{children:i.jsxs("div",{className:"space-y-1",children:[i.jsx("div",{className:"font-medium",children:e.original_role_title||e.current_position}),i.jsx(nn,{size:"sm",variant:"outline",onClick:()=>y(e.id,"","original"),disabled:d===e.id,children:"Use Original"})]})}),i.jsx(nl,{children:n[e.id]?i.jsxs("div",{className:"space-y-1",children:[i.jsx("div",{className:"font-medium",children:n[e.id].role_title}),i.jsxs("div",{className:"text-sm text-muted-foreground",children:[n[e.id].job_family," • ",n[e.id].role_level]}),i.jsxs(nn,{size:"sm",variant:"outline",onClick:()=>y(e.id,e.ai_suggested_role_id,"ai"),disabled:d===e.id,children:[i.jsx(Rs,{className:"h-3 w-3 mr-1"}),"Use AI Suggestion"]})]}):i.jsx("div",{className:"text-sm text-muted-foreground",children:"No AI suggestion"})}),i.jsx(nl,{children:h===e.id?i.jsxs("div",{className:"space-y-2",children:[i.jsxs(bn,{value:x,onValueChange:p,children:[i.jsx(wn,{className:"w-full",children:i.jsx(Nn,{placeholder:"Select a role"})}),i.jsx(Sn,{children:a.map(e=>i.jsxs(En,{value:e.id,children:[e.role_title," - ",e.job_family]},e.id))})]}),i.jsx(kf,{placeholder:"Assignment notes (optional)",value:f,onChange:e=>g(e.target.value),className:"min-h-[60px]"})]}):i.jsxs("div",{children:[w(e)||i.jsx("span",{className:"text-sm text-muted-foreground",children:"Not assigned"}),e.assignment_notes&&i.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:e.assignment_notes})]})}),i.jsx(nl,{children:_(e.role_assignment_status)}),i.jsx(nl,{children:i.jsx("div",{className:"flex gap-1",children:h===e.id?i.jsxs(i.Fragment,{children:[i.jsx(nn,{size:"sm",onClick:N,disabled:!x||d===e.id,children:i.jsx(Tt,{className:"h-3 w-3"})}),i.jsx(nn,{size:"sm",variant:"outline",onClick:b,children:i.jsx(Ws,{className:"h-3 w-3"})})]}):i.jsx(nn,{size:"sm",variant:"outline",onClick:()=>(e=>{u(e.id),p(e.standard_role_id||""),g(e.assignment_notes||"")})(e),disabled:d===e.id,children:i.jsx(Dt,{className:"h-3 w-3"})})})})]},e.id))})]})}),0===s.length&&i.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No employees found for this session."}),s.length>0&&i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mt-6 pt-6 border-t",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"text-sm text-muted-foreground",children:[s.filter(e=>e.standard_role_id).length," of ",s.length," employees have assigned roles"]})}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[i.jsxs(nn,{variant:"outline",onClick:async()=>{try{m("bulk");let e=0;for(const t of s)t.ai_suggested_role_id&&!t.standard_role_id&&(await y(t.id,t.ai_suggested_role_id,"ai","Bulk accepted AI suggestion"),e++);v({title:"AI Suggestions Accepted",description:`Successfully accepted ${e} AI role suggestions`})}catch(e){v({title:"Error",description:"Failed to accept all AI suggestions",variant:"destructive"})}finally{m(null)}},disabled:null!==d,className:"w-full sm:w-auto",children:[i.jsx(As,{className:"h-4 w-4 mr-2"}),"bulk"===d?"Accepting...":"Accept All AI Suggestions"]}),i.jsxs(nn,{onClick:async()=>{var t,a;try{m("finalize");const r=s.filter(e=>e.standard_role_id);for(const e of r)await y(e.id,e.standard_role_id,"ai","Finalized assignment");const{error:n}=await en.from("xlsmart_upload_sessions").update({status:"completed",ai_analysis:{...null==(a=null==(t=s[0])?void 0:t.uploadSession)?void 0:a.ai_analysis,finalized_at:(new Date).toISOString(),finalized_count:r.length}}).eq("id",e);v({title:"Assignments Finalized",description:`Successfully finalized ${r.length} role assignments. The upload process is now complete!`}),setTimeout(()=>{window.location.reload()},2e3)}catch(r){v({title:"Error",description:"Failed to finalize assignments",variant:"destructive"})}finally{m(null)}},disabled:null!==d||0===s.filter(e=>e.standard_role_id).length,className:"w-full sm:w-auto",children:[i.jsx(Gs,{className:"h-4 w-4 mr-2"}),"finalize"===d?"Finalizing...":"Finalize & Complete"]})]})]})]})]})};var vj="Checkbox",[jj,yj]=r(vj),[bj,Nj]=jj(vj);function wj(e){const{__scopeCheckbox:s,checked:t,children:a,defaultChecked:r,disabled:n,form:l,name:c,onCheckedChange:o,required:m,value:h="on",internal_do_not_use_render:u}=e,[x,p]=d({prop:t,defaultProp:r??!1,onChange:o,caller:vj}),[f,g]=ce.useState(null),[v,j]=ce.useState(null),y=ce.useRef(!1),b=!f||(!!l||!!f.closest("form")),N={checked:x,disabled:n,setChecked:p,control:f,setControl:g,name:c,form:l,value:h,hasConsumerStoppedPropagationRef:y,required:m,defaultChecked:!Ij(r)&&r,isFormControl:b,bubbleInput:v,setBubbleInput:j};return i.jsx(bj,{scope:s,...N,children:Rj(u)?u(N):a})}var _j="CheckboxTrigger",kj=ce.forwardRef(({__scopeCheckbox:e,onKeyDown:s,onClick:t,...a},r)=>{const{control:l,value:o,disabled:d,checked:m,required:h,setControl:x,setChecked:p,hasConsumerStoppedPropagationRef:f,isFormControl:g,bubbleInput:v}=Nj(_j,e),j=n(r,x),y=ce.useRef(m);return ce.useEffect(()=>{const e=null==l?void 0:l.form;if(e){const s=()=>p(y.current);return e.addEventListener("reset",s),()=>e.removeEventListener("reset",s)}},[l,p]),i.jsx(c.button,{type:"button",role:"checkbox","aria-checked":Ij(m)?"mixed":m,"aria-required":h,"data-state":Pj(m),"data-disabled":d?"":void 0,disabled:d,value:o,...a,ref:j,onKeyDown:u(s,e=>{"Enter"===e.key&&e.preventDefault()}),onClick:u(t,e=>{p(e=>!!Ij(e)||!e),v&&g&&(f.current=e.isPropagationStopped(),f.current||e.stopPropagation())})})});kj.displayName=_j;var Sj=ce.forwardRef((e,s)=>{const{__scopeCheckbox:t,name:a,checked:r,defaultChecked:n,required:l,disabled:c,value:o,onCheckedChange:d,form:m,...h}=e;return i.jsx(wj,{__scopeCheckbox:t,checked:r,defaultChecked:n,disabled:c,required:l,onCheckedChange:d,name:a,form:m,value:o,internal_do_not_use_render:({isFormControl:e})=>i.jsxs(i.Fragment,{children:[i.jsx(kj,{...h,ref:s,__scopeCheckbox:t}),e&&i.jsx(Aj,{__scopeCheckbox:t})]})})});Sj.displayName=vj;var Ej="CheckboxIndicator",Tj=ce.forwardRef((e,s)=>{const{__scopeCheckbox:t,forceMount:a,...r}=e,n=Nj(Ej,t);return i.jsx(m,{present:a||Ij(n.checked)||!0===n.checked,children:i.jsx(c.span,{"data-state":Pj(n.checked),"data-disabled":n.disabled?"":void 0,...r,ref:s,style:{pointerEvents:"none",...e.style}})})});Tj.displayName=Ej;var Cj="CheckboxBubbleInput",Aj=ce.forwardRef(({__scopeCheckbox:e,...s},t)=>{const{control:a,hasConsumerStoppedPropagationRef:r,checked:l,defaultChecked:o,required:d,disabled:m,name:h,value:u,form:x,bubbleInput:p,setBubbleInput:f}=Nj(Cj,e),g=n(t,f),v=ne(l),j=ie(a);ce.useEffect(()=>{const e=p;if(!e)return;const s=window.HTMLInputElement.prototype,t=Object.getOwnPropertyDescriptor(s,"checked").set,a=!r.current;if(v!==l&&t){const s=new Event("click",{bubbles:a});e.indeterminate=Ij(l),t.call(e,!Ij(l)&&l),e.dispatchEvent(s)}},[p,v,l,r]);const y=ce.useRef(!Ij(l)&&l);return i.jsx(c.input,{type:"checkbox","aria-hidden":!0,defaultChecked:o??y.current,required:d,disabled:m,name:h,value:u,form:x,...s,tabIndex:-1,ref:g,style:{...s.style,...j,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});function Rj(e){return"function"==typeof e}function Ij(e){return"indeterminate"===e}function Pj(e){return Ij(e)?"indeterminate":e?"checked":"unchecked"}Aj.displayName=Cj;const Dj=ce.forwardRef(({className:e,...s},t)=>i.jsx(Sj,{ref:t,className:Ga("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",e),...s,children:i.jsx(Tj,{className:Ga("flex items-center justify-center text-current"),children:i.jsx(Fs,{className:"h-4 w-4"})})}));Dj.displayName=Sj.displayName;const Mj=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState([]),[r,n]=ce.useState(!0),[l,c]=ce.useState(null),[o,d]=ce.useState(!1),[m,h]=ce.useState(null),[u,x]=ce.useState({}),[p,f]=ce.useState(new Set),[g,v]=ce.useState(!1),{toast:j}=De(),y=async()=>{try{const{data:e,error:t}=await en.from("xlsmart_employees").select("*").is("standard_role_id",null).order("created_at",{ascending:!1});if(t)throw t;s(e||[])}catch(e){j({title:"Error",description:"Failed to fetch unassigned employees",variant:"destructive"})}},b=async()=>{try{const{data:e,error:s}=await en.from("xlsmart_standard_roles").select("id, role_title, job_family, role_level, department, role_category").eq("is_active",!0).order("role_title");if(s)throw s;a(e||[])}catch(e){j({title:"Error",description:"Failed to fetch standard roles",variant:"destructive"})}},N=async(e,t)=>{try{c(e);const{data:{user:a},error:r}=await en.auth.getUser();if(r||!a)throw new Error("User not authenticated");const{error:n}=await en.from("xlsmart_employees").update({standard_role_id:t,role_assignment_status:"manually_assigned",assigned_by:a.id}).eq("id",e);if(n)throw n;j({title:"Success",description:"Role assigned successfully"}),s(s=>s.filter(s=>s.id!==e))}catch(a){j({title:"Error",description:`Failed to assign role: ${a.message}`,variant:"destructive"})}finally{c(null)}},w=async()=>{if(0===e.length)return void j({title:"No employees",description:"No unassigned employees found",variant:"destructive"});const s=p.size>0?e.filter(e=>p.has(e.id)):e;if(0!==s.length)try{d(!0),h({processed:0,total:s.length}),j({title:"AI Assignment Started",description:`Analyzing ${s.length} employees for role suggestions...`});const e=s.map(e=>e.id),{data:t,error:a}=await en.functions.invoke("ai-employee-assignment",{body:{employeeIds:e,assignImmediately:!0}});if(a)throw new Error(`AI assignment failed: ${a.message}`);if(!(null==t?void 0:t.success))throw new Error((null==t?void 0:t.error)||"AI assignment failed");h({processed:t.processed,total:t.processed}),await y(),f(new Set),v(!1),j({title:"AI Assignment Completed",description:t.message||`Assigned roles to ${t.assigned} employees`,variant:(t.errors,"default")})}catch(t){j({title:"AI Assignment Failed",description:t.message||"Failed to assign roles with AI",variant:"destructive"})}finally{d(!1),h(null)}else j({title:"No Selection",description:"Please select employees for AI assignment or use 'Assign All'",variant:"destructive"})};return ce.useEffect(()=>{(async()=>{n(!0);try{await Promise.all([y(),b()])}catch(e){}finally{n(!1)}})()},[]),ce.useEffect(()=>{if(!r){const e=setInterval(()=>{y()},3e4);return()=>clearInterval(e)}},[r]),r?i.jsx(fn,{children:i.jsxs(yn,{className:"flex items-center justify-center p-8",children:[i.jsx(kt,{className:"h-6 w-6 animate-spin mr-2"}),"Loading employees..."]})}):i.jsx("div",{className:"space-y-6",children:i.jsxs(fn,{children:[i.jsxs(gn,{children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ht,{className:"h-5 w-5"}),"Employees Pending Role Assignment",i.jsxs(zn,{variant:"secondary",children:[e.length," unassigned"]})]}),p.size>0&&i.jsxs(zn,{variant:"outline",children:[p.size," selected"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[p.size>0&&i.jsxs(i.Fragment,{children:[i.jsx(nn,{onClick:async()=>{const e=Array.from(p);if(0===e.length)return void j({title:"No Selection",description:"Please select employees to assign roles",variant:"destructive"});const s=e.filter(e=>!u[e]);if(s.length>0)j({title:"Missing Role Assignments",description:`Please assign roles to all selected employees (${s.length} missing)`,variant:"destructive"});else try{c("bulk");const{data:{user:s},error:t}=await en.auth.getUser();if(t||!s)throw new Error("User not authenticated");const a=e.map(e=>({id:e,standard_role_id:u[e],role_assignment_status:"manually_assigned",assigned_by:s.id}));for(const e of a){const{error:s}=await en.from("xlsmart_employees").update({standard_role_id:e.standard_role_id,role_assignment_status:e.role_assignment_status,assigned_by:e.assigned_by}).eq("id",e.id);if(s)throw s}j({title:"Bulk Assignment Successful",description:`Successfully assigned roles to ${e.length} employees`}),await y(),f(new Set),v(!1)}catch(t){j({title:"Bulk Assignment Failed",description:t.message||"Failed to assign roles to selected employees",variant:"destructive"})}finally{c(null)}},disabled:"bulk"===l||r,variant:"outline",children:"bulk"===l?i.jsxs(i.Fragment,{children:[i.jsx(kt,{className:"h-4 w-4 animate-spin mr-2"}),"Assigning..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ft,{className:"h-4 w-4 mr-2"}),"Assign Selected (",p.size,")"]})}),i.jsx(nn,{onClick:w,disabled:o||r,variant:"outline",children:o?i.jsxs(i.Fragment,{children:[i.jsx(kt,{className:"h-4 w-4 animate-spin mr-2"}),"AI Assigning..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rs,{className:"h-4 w-4 mr-2"}),"AI Assign Selected (",p.size,")"]})})]}),e.length>0&&i.jsx(nn,{onClick:w,disabled:o||r,className:"ml-auto",children:o?i.jsxs(i.Fragment,{children:[i.jsx(kt,{className:"h-4 w-4 animate-spin mr-2"}),"AI Assigning..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Zt,{className:"h-4 w-4 mr-2"}),"Assign All with AI"]})})]})]}),m&&i.jsxs("div",{className:"mt-2",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[i.jsx(Rs,{className:"h-4 w-4"}),"AI Progress: ",m.processed,"/",m.total," employees processed"]}),i.jsx("div",{className:"w-full bg-secondary rounded-full h-2 mt-1",children:i.jsx("div",{className:"bg-primary h-2 rounded-full transition-all duration-300",style:{width:m.processed/m.total*100+"%"}})})]})]}),i.jsx(yn,{children:0===e.length?i.jsxs("div",{className:"text-center p-8",children:[i.jsx(Gs,{className:"h-16 w-16 mx-auto text-green-500 mb-4"}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"All Employees Assigned!"}),i.jsx("p",{className:"text-muted-foreground",children:"All employees have been assigned to standard roles."})]}):i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{className:"w-[50px]",children:i.jsx(Dj,{checked:g,onCheckedChange:s=>{v(s),f(s?new Set(e.map(e=>e.id)):new Set)},"aria-label":"Select all employees"})}),i.jsx(rl,{children:"Employee"}),i.jsx(rl,{children:"Original Role"}),i.jsx(rl,{children:"Company"}),i.jsx(rl,{children:"Experience"}),i.jsx(rl,{children:"AI Suggestion"}),i.jsx(rl,{children:"Assign Role"}),i.jsx(rl,{children:"Action"})]})}),i.jsx(tl,{children:e.map(e=>{const s=(e=>e.ai_suggested_role_id?t.find(s=>s.id===e.ai_suggested_role_id):null)(e),a=u[e.id];return i.jsxs(al,{children:[i.jsx(nl,{children:i.jsx(Dj,{checked:p.has(e.id),onCheckedChange:s=>((e,s)=>{f(t=>{const a=new Set(t);return s?a.add(e):a.delete(e),a})})(e.id,s),"aria-label":`Select ${e.first_name} ${e.last_name}`})}),i.jsx(nl,{children:i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium",children:[e.first_name," ",e.last_name]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:e.employee_number})]})}),i.jsx(nl,{children:i.jsx("div",{className:"text-sm",children:e.original_role_title})}),i.jsx(nl,{children:i.jsx(zn,{variant:"outline",className:"capitalize",children:e.source_company})}),i.jsxs(nl,{children:[e.years_of_experience," years"]}),i.jsx(nl,{children:s?i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Rs,{className:"h-4 w-4 text-blue-500"}),i.jsx("span",{className:"text-sm font-medium",children:s.role_title})]}),i.jsxs(nn,{size:"sm",variant:"outline",onClick:()=>(async(e,s)=>{x(t=>({...t,[e]:s})),await N(e,s)})(e.id,s.id),disabled:l===e.id,children:[i.jsx(Gs,{className:"h-3 w-3 mr-1"}),"Accept"]})]}):i.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[i.jsx(Ys,{className:"h-4 w-4"}),i.jsx("span",{className:"text-sm",children:"No suggestion"})]})}),i.jsx(nl,{children:i.jsxs(bn,{value:a||"",onValueChange:s=>{return t=e.id,a=s,void x(e=>({...e,[t]:a}));var t,a},disabled:l===e.id,children:[i.jsx(wn,{className:"w-[250px]",children:i.jsx(Nn,{placeholder:"Select a standard role..."})}),i.jsx(Sn,{className:"bg-background border border-border shadow-md z-50",children:t.map(e=>i.jsx(En,{value:e.id,children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium",children:e.role_title}),i.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.job_family," • ",e.role_level," • ",e.department]})]})},e.id))})]})}),i.jsx(nl,{children:i.jsxs(nn,{size:"sm",onClick:()=>(async e=>{const s=u[e];s?await N(e,s):j({title:"Error",description:"Please select a role to assign",variant:"destructive"})})(e.id),disabled:!a||l===e.id,children:[l===e.id?i.jsx(kt,{className:"h-3 w-3 animate-spin mr-1"}):i.jsx(Tt,{className:"h-3 w-3 mr-1"}),"Assign"]})})]},e.id)})})]})})]})})},Oj=()=>{const[e,s]=ce.useState(null),[t,a]=ce.useState({total:0,processed:0,assigned:0,errors:0}),[r,n]=ce.useState(!1),[l,c]=ce.useState(!1),[o,d]=ce.useState(null),[m,h]=ce.useState(!1),[u,x]=ce.useState(!1),[p,f]=ce.useState({total:0,processed:0,assigned:0,errors:0}),[g,v]=ce.useState({total:0,processed:0,assigned:0,errors:0}),[j,y]=ce.useState(null),[b,N]=ce.useState(!1),[w,_]=ce.useState(!1),[k,S]=ce.useState([]),[E,T]=ce.useState(null),[C,A]=ce.useState("upload"),{toast:R}=De(),I=(e,t)=>{const r=e.target.files;"upload-only"===t?(s(r),n(!1),a({total:0,processed:0,assigned:0,errors:0})):(d(r),N(!1),f({total:0,processed:0,assigned:0,errors:0}))},P=async e=>{const s=[];for(let t=0;t<e.length;t++){const a=e[t],r=hf(await a.arrayBuffer(),{type:"array"});r.SheetNames.forEach(e=>{const t=r.Sheets[e],n=wf.sheet_to_json(t,{header:1});if(n.length>1){const t=n[0];n.slice(1).forEach(r=>{if(r.some(e=>null!=e&&""!==e)){const n={};t.forEach((e,s)=>{e&&void 0!==r[s]&&(n[e.toString().trim()]=r[s])}),s.push({...n,sourceFile:a.name,sourceSheet:e})}})}})}return s},D=async()=>{try{const{data:e,error:s}=await en.from("xlsmart_upload_sessions").select("*").eq("status","completed").order("created_at",{ascending:!1});if(s)throw s;const t=(null==e?void 0:e.filter(e=>e.session_name&&e.total_rows>0))||[];S(t)}catch(e){R({title:"Error",description:"Failed to load employee upload sessions",variant:"destructive"})}},M=e=>0===e.total?0:Math.round(e.processed/e.total*100);return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("h2",{className:"text-2xl font-bold flex items-center justify-center gap-3",children:[i.jsx(Wt,{className:"h-6 w-6 text-primary"}),"Employee Management Options"]}),i.jsx("p",{className:"text-muted-foreground mt-2",children:"Choose how you want to process your employee data"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 max-w-6xl mx-auto",children:[i.jsxs(fn,{className:"hover:shadow-lg transition-shadow duration-200",children:[i.jsxs(gn,{className:"text-center",children:[i.jsx("div",{className:"mx-auto w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:i.jsx($t,{className:"h-6 w-6 text-blue-600"})}),i.jsx(vn,{className:"text-xl",children:"Upload Only"}),i.jsx("p",{className:"text-muted-foreground text-sm",children:"Upload employee data without AI role assignment (roles already assigned)"})]}),i.jsx(yn,{className:"space-y-4",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"employee-files-upload-only",children:"Employee Data Files"}),i.jsx(ln,{id:"employee-files-upload-only",type:"file",multiple:!0,accept:Gi.ALLOWED_TYPES.map(e=>e.includes("spreadsheetml")?".xlsx":e.includes("ms-excel")?".xls":e.includes("csv")?".csv":"").join(","),onChange:e=>I(e,"upload-only"),disabled:l})]}),e&&e.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{children:"Selected Files:"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from(e).map((e,s)=>i.jsx(zn,{variant:"outline",children:e.name},s))})]}),i.jsx(nn,{onClick:async()=>{if(e&&0!==e.length)try{c(!0);const s=await P(e);a(e=>({...e,total:s.length})),R({title:"Processing employee data...",description:`Found ${s.length} employee records`});const{data:t,error:r}=await en.functions.invoke("employee-upload-data",{body:{employees:s,sessionName:`Employee Upload Only ${(new Date).toISOString()}: ${Array.from(e).map(e=>e.name).join(", ")}`,skipRoleAssignment:!0}});if(r)throw r;const i=setInterval(async()=>{const{data:e}=await en.functions.invoke("employee-upload-progress",{body:{sessionId:t.sessionId}});e&&(a(e.progress),"completed"===e.status?(clearInterval(i),n(!0),c(!1),R({title:"Upload Complete!",description:`Successfully uploaded ${e.progress.processed} employee records without role assignment`})):"error"===e.status&&(clearInterval(i),c(!1),R({title:"Upload Failed",description:e.error||"An error occurred during upload",variant:"destructive"})))},2e3)}catch(s){c(!1),R({title:"Upload Failed",description:s.message||"Failed to upload employee data",variant:"destructive"})}else R({title:"No files selected",description:"Please select Excel files to upload",variant:"destructive"})},disabled:!e||0===e.length||l,className:"w-full",variant:"outline",children:l?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Uploading..."]}):i.jsxs(i.Fragment,{children:[i.jsx($t,{className:"mr-2 h-4 w-4"}),"Upload Employee Data"]})}),l&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Upload Progress"}),i.jsxs("span",{children:[M(t),"%"]})]}),i.jsx(Bi,{value:M(t),className:"w-full"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:t.total}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-blue-500",children:t.processed}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Processed"})]})]})]}),r&&i.jsxs("div",{className:"space-y-4 p-4 bg-green-50 rounded-lg border border-green-200",children:[i.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[i.jsx(Gs,{className:"h-5 w-5"}),i.jsx("span",{className:"font-medium",children:"Upload Completed Successfully!"})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-medium",children:"Records Uploaded:"})," ",t.processed]})]})]})})]}),i.jsxs(fn,{className:"hover:shadow-lg transition-shadow duration-200 border-primary/20",children:[i.jsxs(gn,{className:"text-center",children:[i.jsx("div",{className:"mx-auto w-12 h-12 bg-gradient-to-br from-primary/10 to-primary/20 rounded-full flex items-center justify-center mb-4",children:i.jsx(Rs,{className:"h-6 w-6 text-primary"})}),i.jsx(vn,{className:"text-xl",children:"Upload & Assign"}),i.jsx("p",{className:"text-muted-foreground text-sm",children:"Upload employee data and use AI to suggest role assignments"})]}),i.jsx(yn,{children:i.jsxs(hn,{value:C,onValueChange:A,className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-4",children:[i.jsx(xn,{value:"upload",className:"text-xs",children:i.jsx($t,{className:"h-3 w-3"})}),i.jsx(xn,{value:"assign",className:"text-xs",children:i.jsx(Rs,{className:"h-3 w-3"})}),i.jsx(xn,{value:"review",className:"text-xs",children:i.jsx(Ht,{className:"h-3 w-3"})}),i.jsx(xn,{value:"manage",className:"text-xs",children:i.jsx(Wt,{className:"h-3 w-3"})})]}),i.jsxs(pn,{value:"upload",className:"space-y-4 mt-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"employee-files",children:"Employee Data Files"}),i.jsx(ln,{id:"employee-files",type:"file",multiple:!0,accept:Gi.ALLOWED_TYPES.map(e=>e.includes("spreadsheetml")?".xlsx":e.includes("ms-excel")?".xls":e.includes("csv")?".csv":"").join(","),onChange:e=>I(e,"upload-assign"),disabled:m})]}),o&&o.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{children:"Selected Files:"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from(o).map((e,s)=>i.jsx(zn,{variant:"outline",children:e.name},s))})]}),i.jsx(nn,{onClick:async()=>{if(o&&0!==o.length)try{h(!0);const e=await P(o);f(s=>({...s,total:e.length})),R({title:"Processing employee data...",description:`Found ${e.length} employee records`});const{data:s,error:t}=await en.functions.invoke("employee-upload-data",{body:{employees:e,sessionName:`Employee Upload ${(new Date).toISOString()}: ${Array.from(o).map(e=>e.name).join(", ")}`}});if(t)throw t;y(s.sessionId);const a=setInterval(async()=>{const{data:e}=await en.functions.invoke("employee-upload-progress",{body:{sessionId:s.sessionId}});e&&(f(e.progress),"completed"===e.status?(clearInterval(a),N(!0),h(!1),R({title:"Data Upload Complete!",description:`Successfully uploaded ${e.progress.processed} employee records`}),A("assign"),D()):"error"===e.status&&(clearInterval(a),h(!1),R({title:"Upload Failed",description:e.error||"An error occurred during upload",variant:"destructive"})))},2e3)}catch(e){h(!1),R({title:"Upload Failed",description:e.message||"Failed to upload employee data",variant:"destructive"})}else R({title:"No files selected",description:"Please select Excel files to upload",variant:"destructive"})},disabled:!o||0===o.length||m,className:"w-full",size:"sm",children:m?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-3 w-3 animate-spin"}),"Uploading..."]}):i.jsxs(i.Fragment,{children:[i.jsx($t,{className:"mr-2 h-3 w-3"}),"Upload Data"]})}),m&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Upload Progress"}),i.jsxs("span",{children:[M(p),"%"]})]}),i.jsx(Bi,{value:M(p),className:"w-full"})]}),b&&i.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[i.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[i.jsx(Gs,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium text-sm",children:"Upload Complete!"})]}),i.jsxs(nn,{onClick:()=>A("assign"),size:"sm",className:"mt-2 w-full",children:["Next: Assign Roles ",i.jsx(Es,{className:"h-3 w-3 ml-1"})]})]})]}),i.jsxs(pn,{value:"assign",className:"space-y-4 mt-4",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx(mn,{className:"text-sm",children:"Select Session"}),i.jsx(nn,{onClick:D,variant:"outline",size:"sm",children:"Refresh"})]}),i.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:k.slice(0,3).map(e=>i.jsxs("div",{className:"p-2 border rounded cursor-pointer text-sm "+(E===e.id?"border-primary bg-primary/5":"border-border hover:border-primary/50"),onClick:()=>T(e.id),children:[i.jsx("div",{className:"font-medium truncate",children:e.session_name}),i.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.total_rows," employees"]})]},e.id))})]}),i.jsx(nn,{onClick:async()=>{if(E)try{x(!0),v({total:0,processed:0,assigned:0,errors:0});const{data:e,error:s}=await en.functions.invoke("employee-role-assignment",{body:{sessionId:E}});if(s)throw s;R({title:"Starting AI role analysis...",description:"Analyzing employee data and generating role suggestions"});const t=setInterval(async()=>{const{data:e}=await en.functions.invoke("employee-upload-progress",{body:{sessionId:E}});e&&(v(e.progress),"roles_assigned"===e.status?(clearInterval(t),_(!0),x(!1),R({title:"AI Analysis Complete!",description:`Generated ${e.progress.assigned} role suggestions for review`}),A("review")):"error"===e.status&&(clearInterval(t),x(!1),R({title:"Assignment Failed",description:e.error||"An error occurred during role assignment",variant:"destructive"})))},2e3)}catch(e){x(!1),R({title:"Assignment Failed",description:e.message||"Failed to assign roles",variant:"destructive"})}else R({title:"No session selected",description:"Please select an upload session to assign roles",variant:"destructive"})},disabled:!E||u,className:"w-full",size:"sm",children:u?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-3 w-3 animate-spin"}),"Assigning..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rs,{className:"mr-2 h-3 w-3"}),"Generate AI Suggestions"]})}),u&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Assignment Progress"}),i.jsxs("span",{children:[M(g),"%"]})]}),i.jsx(Bi,{value:M(g),className:"w-full"})]}),w&&i.jsxs("div",{className:"p-3 bg-green-50 rounded-lg border border-green-200",children:[i.jsxs("div",{className:"flex items-center gap-2 text-green-700",children:[i.jsx(Gs,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium text-sm",children:"AI Analysis Complete!"})]}),i.jsxs(nn,{onClick:()=>A("review"),size:"sm",className:"mt-2 w-full",children:["Review Suggestions ",i.jsx(Es,{className:"h-3 w-3 ml-1"})]})]})]}),i.jsx(pn,{value:"review",className:"mt-4",children:E?i.jsx(gj,{sessionId:E}):i.jsx("div",{className:"text-center py-4",children:i.jsx("p",{className:"text-sm text-muted-foreground",children:"Please select a session first to review role assignments."})})}),i.jsx(pn,{value:"manage",className:"mt-4",children:i.jsxs("div",{className:"text-center py-4",children:[i.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage existing role assignments for all employees."}),i.jsx(Mj,{})]})})]})})]})]})]})},Fj=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState([]),[r,n]=ce.useState([]),[l,c]=ce.useState(!0),[o,d]=ce.useState(!1),[m,h]=ce.useState(null),{toast:u}=De();ce.useEffect(()=>{x()},[]);const x=async()=>{try{c(!0);const{data:e,error:t}=await en.from("xlsmart_employees").select("*").eq("is_active",!0).order("first_name");if(t)throw t;const{data:r,error:i}=await en.from("xlsmart_standard_roles").select("*").eq("is_active",!0);if(i)throw i;const{data:l,error:o}=await en.from("ai_analysis_results").select("*").eq("analysis_type","career_path").order("created_at",{ascending:!1});if(o)throw o;const d=(null==l?void 0:l.map(e=>{const s=e.input_parameters,t=e.analysis_result;return{id:e.id,employee_id:(null==s?void 0:s.employee_id)||"",lateralRoles:(null==t?void 0:t.lateralRoles)||[],nextRoles:(null==t?void 0:t.nextRoles)||[],requiredSkills:(null==t?void 0:t.requiredSkills)||[],certifications:(null==t?void 0:t.certifications)||[],actionsPlan:(null==t?void 0:t.actionsPlan)||{lateral:[],vertical:[]},recommendations:(null==t?void 0:t.recommendations)||"",created_at:e.created_at}}))||[];s(e||[]),a(r||[]),n(d)}catch(e){u({title:"Error",description:"Failed to load career path data",variant:"destructive"})}finally{c(!1)}},p=e=>r.find(s=>s.employee_id===e.id);return l?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsxs("div",{className:"text-center",children:[i.jsx(kt,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),i.jsx("p",{children:"Loading employee career path data..."})]})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"AI Employee Career Paths"}),i.jsx("p",{className:"text-muted-foreground",children:"AI-powered career path planning and progression mapping for all employees"})]}),i.jsx(nn,{onClick:async()=>{if(0!==e.length){d(!0),h({processed:0,total:e.length});try{const{data:s,error:a}=await en.functions.invoke("employee-career-paths-bulk",{body:{employees:e.map(e=>({id:e.id,first_name:e.first_name,last_name:e.last_name,current_position:e.current_position,current_department:e.current_department,current_level:e.current_level,years_of_experience:e.years_of_experience,skills:e.skills,performance_rating:e.performance_rating,source_company:e.source_company})),standard_roles:t}});if(a)throw a;(null==s?void 0:s.success)&&(u({title:"Career Path Analysis Complete",description:`Generated career paths for ${s.total_processed} employees`}),await x())}catch(s){u({title:"Analysis Failed",description:s.message||"Failed to run career path analysis",variant:"destructive"})}finally{d(!1),h(null)}}else u({title:"No employees",description:"No employees found for career path analysis",variant:"destructive"})},disabled:o||0===e.length,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:o?i.jsxs(i.Fragment,{children:[i.jsx(kt,{className:"mr-2 h-4 w-4 animate-spin"}),"Analyzing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rs,{className:"mr-2 h-4 w-4"}),"Run AI Career Path Analysis"]})})]}),o&&m&&i.jsx(fn,{children:i.jsx(yn,{className:"pt-6",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Analyzing employee career paths..."}),i.jsxs("span",{children:[m.processed," / ",m.total]})]}),i.jsx(Bi,{value:m?m.processed/m.total*100:0,className:"w-full"})]})})}),i.jsxs(hn,{defaultValue:"overview",className:"space-y-4",children:[i.jsxs(un,{children:[i.jsx(xn,{value:"overview",children:"Overview"}),i.jsx(xn,{value:"employees",children:"Employee Analysis"}),i.jsx(xn,{value:"insights",children:"Career Insights"})]}),i.jsx(pn,{value:"overview",className:"space-y-4",children:i.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"Total Employees"}),i.jsx(Wt,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:e.length}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Active employees in system"})]})]}),i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"Career Tracks"}),i.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:"4"}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Growth, Specialist, Leadership, Expert"})]})]}),i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"High Potential"}),i.jsx(Ot,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:e.filter(e=>e.performance_rating>=4).length}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Employees rated 4+ performance"})]})]}),i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"Departments"}),i.jsx(Ps,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:new Set(e.map(e=>e.current_department).filter(Boolean)).size}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Unique departments"})]})]})]})}),i.jsx(pn,{value:"employees",className:"space-y-4",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ft,{className:"h-5 w-5"}),"Employee Career Path Analysis"]})}),i.jsx(yn,{children:i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Employee"}),i.jsx(rl,{children:"Current Position"}),i.jsx(rl,{children:"Experience"}),i.jsx(rl,{children:"Performance"}),i.jsx(rl,{className:"text-green-600",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(mt,{className:"h-4 w-4"}),"Lateral Opportunities"]})}),i.jsx(rl,{className:"text-blue-600",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Es,{className:"h-4 w-4"}),"Career Progression"]})}),i.jsx(rl,{children:"Development Actions"})]})}),i.jsx(tl,{children:e.map(e=>{const s=(e=>{const s=p(e);return(null==s?void 0:s.lateralRoles)||[]})(e),t=(e=>{const s=p(e);return(null==s?void 0:s.nextRoles)||[]})(e),a=(e=>{const s=p(e);return(null==s?void 0:s.actionsPlan)||{lateral:[],vertical:[]}})(e);return i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium",children:[e.first_name," ",e.last_name]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:e.employee_number}),i.jsx("div",{className:"text-sm text-muted-foreground",children:e.current_department||"N/A"})]})}),i.jsx(nl,{children:i.jsx(zn,{variant:"outline",children:e.current_position})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Ys,{className:"h-3 w-3"}),e.years_of_experience||0," years"]})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Ot,{className:"h-3 w-3 text-yellow-500"}),e.performance_rating||0,"/5"]})}),i.jsx(nl,{children:i.jsx("div",{className:"space-y-1 max-w-[240px]",children:s.length>0?i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"text-xs font-medium text-green-600 mb-1 flex items-center gap-1",children:[i.jsx(mt,{className:"h-3 w-3"}),"Lateral Moves"]}),s.slice(0,3).map((e,s)=>i.jsx(zn,{variant:"outline",className:"text-xs block w-fit mb-1 bg-green-50 border-green-200",children:e},s)),s.length>3&&i.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",s.length-3," more"]})]}):i.jsx("div",{className:"text-xs text-muted-foreground italic",children:"Run AI analysis for recommendations"})})}),i.jsx(nl,{children:i.jsx("div",{className:"space-y-1 max-w-[240px]",children:t.length>0?i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"text-xs font-medium text-blue-600 mb-1 flex items-center gap-1",children:[i.jsx(Es,{className:"h-3 w-3"}),"Career Progression"]}),t.slice(0,3).map((e,s)=>i.jsx(zn,{variant:"outline",className:"text-xs block w-fit mb-1 bg-blue-50 border-blue-200",children:e},s)),t.length>3&&i.jsxs("span",{className:"text-xs text-muted-foreground",children:["+",t.length-3," more"]})]}):i.jsx("div",{className:"text-xs text-muted-foreground italic",children:"Run AI analysis for recommendations"})})}),i.jsx(nl,{children:i.jsxs("div",{className:"max-w-[280px] space-y-3",children:[a.lateral.length>0&&i.jsxs("div",{className:"bg-green-50 p-2 rounded-md border border-green-200",children:[i.jsxs("div",{className:"text-xs font-medium text-green-700 mb-1 flex items-center gap-1",children:[i.jsx(mt,{className:"h-3 w-3"}),"Lateral Development"]}),i.jsx("div",{className:"space-y-1",children:a.lateral.slice(0,2).map((e,s)=>i.jsxs("div",{className:"text-xs text-green-600 flex items-start gap-1",children:[i.jsx("span",{className:"text-green-400 mt-0.5",children:"•"}),i.jsx("span",{children:e})]},s))}),a.lateral.length>2&&i.jsxs("div",{className:"text-xs text-green-500 mt-1",children:["+",a.lateral.length-2," more actions"]})]}),a.vertical.length>0&&i.jsxs("div",{className:"bg-blue-50 p-2 rounded-md border border-blue-200",children:[i.jsxs("div",{className:"text-xs font-medium text-blue-700 mb-1 flex items-center gap-1",children:[i.jsx(Es,{className:"h-3 w-3"}),"Career Advancement"]}),i.jsx("div",{className:"space-y-1",children:a.vertical.slice(0,2).map((e,s)=>i.jsxs("div",{className:"text-xs text-blue-600 flex items-start gap-1",children:[i.jsx("span",{className:"text-blue-400 mt-0.5",children:"•"}),i.jsx("span",{children:e})]},s))}),a.vertical.length>2&&i.jsxs("div",{className:"text-xs text-blue-500 mt-1",children:["+",a.vertical.length-2," more actions"]})]}),0===a.lateral.length&&0===a.vertical.length&&i.jsx("div",{className:"text-xs text-muted-foreground italic bg-gray-50 p-2 rounded-md border border-gray-200",children:"Run AI analysis for personalized recommendations"})]})})]},e.id)})})]})})]})}),i.jsx(pn,{value:"insights",className:"space-y-4",children:i.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Career Track Distribution"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:["Growth Track","Specialist Track","Leadership Track","Expert Track"].map(s=>{const t=e.filter(e=>(e=>{const s=e.years_of_experience||0,t=e.current_level||"";return s<3?"Growth Track":s<7?"Specialist Track":t.includes("M")||s>10?"Leadership Track":"Expert Track"})(e)===s).length,a=e.length>0?t/e.length*100:0;return i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:s}),i.jsxs("span",{children:[t," employees (",a.toFixed(1),"%)"]})]}),i.jsx(Bi,{value:a,className:"h-2"})]},s)})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"High Potential Employees"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:e.filter(e=>e.performance_rating>=4).slice(0,5).map(e=>i.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium",children:[e.first_name," ",e.last_name]}),i.jsx("div",{className:"text-sm text-gray-500",children:e.current_position})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Ot,{className:"h-4 w-4 text-yellow-500"}),i.jsxs("span",{className:"font-medium",children:[e.performance_rating,"/5"]})]})]},e.id))})})]})]})})]})]})},Lj=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState([]),[r,n]=ce.useState([]),[l,c]=ce.useState(!0),[o,d]=ce.useState(!1),[m,h]=ce.useState(null),[u,x]=ce.useState("overview"),[p,f]=ce.useState(new Set),[g,v]=ce.useState(new Map),[j,y]=ce.useState(new Set),[b,N]=ce.useState(new Set),{toast:w}=De(),{user:_}=tn();ce.useEffect(()=>{S(),k()},[]);const k=async()=>{try{const{data:e,error:s}=await en.from("employee_moves").select("employee_id").eq("move_status","executed");if(s)throw s;const t=new Set((null==e?void 0:e.map(e=>e.employee_id))||[]);f(t)}catch(e){}},S=async()=>{try{c(!0);const[e,t]=await Promise.all([en.from("xlsmart_employees").select("*").eq("is_active",!0).order("first_name"),en.from("xlsmart_standard_roles").select("*").eq("is_active",!0)]);if(e.error)throw e.error;if(t.error)throw t.error;s(e.data||[]),a(t.data||[]),c(!1),setTimeout(async()=>{try{const{data:e,error:s}=await en.from("ai_analysis_results").select("*").eq("analysis_type","mobility_plan").order("created_at",{ascending:!1});if(s);else{const s=(null==e?void 0:e.map(e=>{var s,t,a,r,n;return{id:e.id,employee_id:(null==(s=e.input_parameters)?void 0:s.employee_id)||"",current_role:(null==(t=e.input_parameters)?void 0:t.current_position)||"",target_roles:(null==(a=e.analysis_result)?void 0:a.mobilityPlan)||"",mobility_score:75,barriers:[],recommendations:(null==(r=e.analysis_result)?void 0:r.mobilityPlan)||"",ai_analysis:(null==(n=e.analysis_result)?void 0:n.mobilityPlan)||"",created_at:e.created_at}}))||[];n(s)}}catch(e){}},100)}catch(e){w({title:"Error",description:"Failed to load mobility planning data",variant:"destructive"}),c(!1)}},E=async()=>{if(0!==e.length){d(!0),h({processed:0,total:e.length});try{const{data:s,error:a}=await en.functions.invoke("employee-mobility-planning-bulk",{body:{employees:e.map(e=>({id:e.id,first_name:e.first_name,last_name:e.last_name,current_position:e.current_position,current_department:e.current_department,current_level:e.current_level,years_of_experience:e.years_of_experience,skills:e.skills,performance_rating:e.performance_rating,source_company:e.source_company})),standard_roles:t}});if(a)throw a;if(!(null==s?void 0:s.success)||!s.sessionId)throw new Error("Failed to start mobility analysis session");{w({title:"Mobility Analysis Started",description:`Processing mobility plans for ${e.length} employees`});const t=setInterval(async()=>{try{const{data:a}=await en.functions.invoke("employee-mobility-planning-progress",{body:{sessionId:s.sessionId}});(null==a?void 0:a.progress)&&(h({processed:a.progress.processed||0,total:a.progress.total||e.length}),"completed"===a.status?(clearInterval(t),d(!1),h(null),w({title:"Mobility Analysis Complete!",description:`Generated mobility plans for ${a.progress.completed||e.length} employees`}),await S()):"error"===a.status&&(clearInterval(t),d(!1),h(null),w({title:"Analysis Failed",description:a.error||"An error occurred during analysis",variant:"destructive"})))}catch(a){}},2e3);setTimeout(()=>{clearInterval(t),o&&(d(!1),h(null),w({title:"Analysis Timeout",description:"Analysis is taking longer than expected. Please check back later.",variant:"destructive"}))},3e5)}}catch(s){w({title:"Analysis Failed",description:s.message||"Failed to run mobility analysis",variant:"destructive"}),d(!1),h(null)}}else w({title:"No employees",description:"No employees found for mobility analysis",variant:"destructive"})},T=e=>{let s=50;const t=e.years_of_experience||0;t>5?s+=20:t>2&&(s+=10);s+=10*((e.performance_rating||0)-3);const a=Array.isArray(e.skills)?e.skills.length:1;return s+=Math.min(5*a,20),Math.max(0,Math.min(100,s))},C=e=>{const s=T(e);return s>=80?{level:"High",color:"destructive"}:s>=60?{level:"Medium",color:"default"}:{level:"Low",color:"secondary"}},A=e=>{const s=e.current_department;return t.filter(t=>t.department!==s&&(t.job_family.toLowerCase().includes(e.current_position.toLowerCase().split(" ")[0])||e.current_position.toLowerCase().includes(t.job_family.toLowerCase()))).slice(0,3)},R=ce.useCallback(e=>e?e.replace(/###\s+(.*?)(?=\n|$)/g,'<h4 class="font-semibold text-blue-600 mt-3 mb-2">$1</h4>').replace(/##\s+(.*?)(?=\n|$)/g,'<h3 class="font-bold text-gray-800 mt-4 mb-2">$1</h3>').replace(/\*\*(.*?)\*\*/g,'<strong class="font-semibold">$1</strong>').replace(/^[-•]\s+(.*)$/gm,'<div class="mb-1">• $1</div>').replace(/\n\n/g,"<br/><br/>").replace(/\n/g,"<br/>"):"",[]),[I,P]=ce.useState([]),[D,M]=ce.useState(!1);ce.useEffect(()=>{if("ai-results"===u&&r.length>0){P([...r]);const e=r.filter(e=>!e.formattedAnalysis);if(e.length>0){M(!0);(async()=>{let s=[...r];await new Promise(e=>setTimeout(e,50)),e.forEach(e=>{const t=s.findIndex(s=>s.id===e.id);-1!==t&&(s[t]={...e,formattedAnalysis:R(e.ai_analysis)})}),P([...s]),M(!1)})()}}else"ai-results"!==u&&P([])},[u,r,R]);const O=ce.useCallback(()=>i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Rs,{className:"h-5 w-5"}),"AI-Generated Mobility Plans"]})}),i.jsx(yn,{children:r.length>0?i.jsxs("div",{className:"space-y-4",children:[D&&i.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(kt,{className:"h-4 w-4 animate-spin text-blue-600"}),i.jsxs("span",{className:"text-sm text-blue-700",children:["Formatting content... (",I.filter(e=>e.formattedAnalysis).length,"/",r.length,")"]})]})}),0===I.filter(e=>!p.has(e.employee_id)).length&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Gs,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"All Moves Executed!"}),i.jsx("p",{className:"text-muted-foreground",children:"All available mobility plans have been executed. Check the Employee Moves History to see completed moves."})]}),I.filter(e=>!p.has(e.employee_id)).slice(0,20).map(s=>{const t=e.find(e=>e.id===s.employee_id);return t?i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 space-y-4 shadow-sm",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold",children:t?`${t.first_name} ${t.last_name}`:"Unknown Employee"}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.current_role," • ",null==t?void 0:t.current_department]})]}),i.jsx(zn,{variant:"outline",children:new Date(s.created_at).toLocaleDateString()})]}),i.jsxs("div",{className:"bg-white border border-gray-200 p-6 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h5",{className:"font-semibold text-base text-gray-800",children:"AI Mobility Recommendations"}),i.jsxs(nn,{size:"sm",onClick:()=>(async(e,s)=>{if(s)if(null==_?void 0:_.id)try{const t=e.ai_analysis||"",a={employee_id:s.id,move_type:"lateral_move",previous_position:s.current_position,previous_department:s.current_department,previous_level:s.current_level,new_position:`${s.current_position} (Advanced)`,new_department:s.current_department,new_level:s.current_level,reason:"AI-recommended mobility plan",notes:t.substring(0,500),mobility_plan_id:e.id,requested_by:_.id,approved_by:_.id,approval_date:(new Date).toISOString(),move_status:"executed",effective_date:(new Date).toISOString()},{data:r,error:n}=await en.from("employee_moves").insert(a).select().single();if(n)throw n;const{error:i}=await en.from("xlsmart_employees").update({current_position:a.new_position,current_department:a.new_department,current_level:a.new_level,updated_at:(new Date).toISOString()}).eq("id",s.id);if(i)throw i;w({title:"Move Executed Successfully!",description:`${s.first_name} ${s.last_name}'s position has been updated to ${a.new_position}.`}),f(e=>new Set([...e,s.id])),await S(),window.dispatchEvent(new CustomEvent("moveExecuted",{detail:{moveRecord:r,employee:s}}))}catch(t){w({title:"Error",description:t.message||"Failed to execute move",variant:"destructive"})}else w({title:"Error",description:"You must be logged in to execute moves",variant:"destructive"});else w({title:"Error",description:"Employee information not found",variant:"destructive"})})(s,t),className:"bg-green-600 hover:bg-green-700 text-white",children:[i.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Execute Move Now"]})]}),i.jsx("div",{className:"max-w-none border-t border-gray-200 pt-4",children:i.jsx("div",{className:"text-sm leading-relaxed text-gray-700",children:s.formattedAnalysis?i.jsx("div",{dangerouslySetInnerHTML:{__html:s.formattedAnalysis}}):i.jsx("div",{className:"whitespace-pre-wrap",children:s.ai_analysis||"No analysis available"})})})]})]},s.id):null}),I.length>20&&i.jsx("div",{className:"text-center py-4",children:i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing first 20 of ",I.length," mobility plans"]})})]}):i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Rs,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold",children:"No AI Results Yet"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:"Run the AI mobility analysis to generate personalized mobility plans."}),i.jsxs(nn,{onClick:E,disabled:o||0===e.length,className:"bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700",children:[i.jsx(Rs,{className:"mr-2 h-4 w-4"}),"Run AI Analysis"]})]})})]}),[I,e,o,E,D,r]);return l?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsxs("div",{className:"text-center",children:[i.jsx(kt,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),i.jsx("p",{children:"Loading employee mobility data..."})]})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"AI Employee Mobility Planning"}),i.jsx("p",{className:"text-muted-foreground",children:"AI-powered internal mobility analysis and planning for workforce optimization"})]}),i.jsx(nn,{onClick:E,disabled:o||0===e.length,className:"bg-gradient-to-r from-green-600 to-blue-600 hover:from-green-700 hover:to-blue-700",children:o?i.jsxs(i.Fragment,{children:[i.jsx(kt,{className:"mr-2 h-4 w-4 animate-spin"}),"Analyzing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rs,{className:"mr-2 h-4 w-4"}),"Run AI Mobility Analysis"]})})]}),o&&m&&i.jsx(fn,{children:i.jsx(yn,{className:"pt-6",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Analyzing employee mobility potential..."}),i.jsxs("span",{children:[m.processed," / ",m.total]})]}),i.jsx(Bi,{value:m?m.processed/m.total*100:0,className:"w-full"})]})})}),i.jsxs(hn,{value:u,onValueChange:x,className:"space-y-4",children:[i.jsxs(un,{children:[i.jsx(xn,{value:"overview",children:"Overview"}),i.jsx(xn,{value:"employees",children:"Mobility Analysis"}),i.jsx(xn,{value:"ai-results",children:"AI Results"}),i.jsx(xn,{value:"risks",children:"Flight Risk"})]}),i.jsx(pn,{value:"overview",className:"space-y-4",children:i.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"Total Employees"}),i.jsx(Wt,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:e.length}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Active employees analyzed"})]})]}),i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"High Mobility Risk"}),i.jsx(Ut,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:e.filter(e=>T(e)>=80).length}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Employees with high mobility potential"})]})]}),i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"Internal Moves"}),i.jsx(mt,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:e.filter(e=>A(e).length>0).length}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Potential internal opportunities"})]})]}),i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"Departments"}),i.jsx(Ps,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:new Set(e.map(e=>e.current_department).filter(Boolean)).size}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Cross-functional opportunities"})]})]})]})}),i.jsx(pn,{value:"employees",className:"space-y-4",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ft,{className:"h-5 w-5"}),"Employee Mobility Analysis"]})}),i.jsx(yn,{children:i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Employee"}),i.jsx(rl,{children:"Current Role"}),i.jsx(rl,{children:"Department"}),i.jsx(rl,{children:"Experience"}),i.jsx(rl,{children:"Performance"}),i.jsx(rl,{children:"Mobility Score"}),i.jsx(rl,{children:"Potential Moves"})]})}),i.jsx(tl,{children:e.map(e=>{const s=C(e),t=A(e);return i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium",children:[e.first_name," ",e.last_name]}),i.jsx("div",{className:"text-sm text-gray-500",children:e.employee_number})]})}),i.jsx(nl,{children:e.current_position}),i.jsx(nl,{children:i.jsx(zn,{variant:"outline",children:e.current_department||"N/A"})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Ys,{className:"h-3 w-3"}),e.years_of_experience||0," years"]})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Ot,{className:"h-3 w-3 text-yellow-500"}),e.performance_rating||0,"/5"]})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(zn,{variant:s.color,children:s.level}),i.jsxs("span",{className:"text-sm",children:[T(e),"%"]})]})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex flex-col gap-1",children:[t.map((e,s)=>i.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[i.jsx(Es,{className:"h-3 w-3 text-green-500"}),i.jsx("span",{children:e.role_title}),i.jsx(zn,{variant:"outline",className:"text-xs",children:e.department})]},s)),0===t.length&&i.jsx("span",{className:"text-sm text-gray-500",children:"No immediate moves"})]})})]},e.id)})})]})})]})}),i.jsx(pn,{value:"ai-results",className:"space-y-4",children:"ai-results"===u&&i.jsx(O,{})}),i.jsxs(pn,{value:"risks",className:"space-y-4",children:[i.jsxs("div",{className:"grid gap-4 md:grid-cols-2",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Flight Risk Distribution"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:["High","Medium","Low"].map(s=>{const t=e.filter(e=>C(e).level===s).length,a=e.length>0?t/e.length*100:0;return i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsxs("span",{children:[s," Flight Risk"]}),i.jsxs("span",{children:[t," employees (",a.toFixed(1),"%)"]})]}),i.jsx(Bi,{value:a,className:"h-2"})]},s)})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Retention Action Summary"})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Plans Generated:"}),i.jsx("span",{className:"font-medium",children:g.size})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"High Risk Employees:"}),i.jsx("span",{className:"font-medium text-red-600",children:e.filter(e=>T(e)>=80).length})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Actions in Progress:"}),i.jsx("span",{className:"font-medium text-blue-600",children:b.size})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Avg Success Rate:"}),i.jsx("span",{className:"font-medium text-green-600",children:"73%"})]})]})})]})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-red-500"}),"High Flight Risk Employees + Retention Actions"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-6",children:[e.filter(e=>T(e)>=80).map(e=>{var s;const t=T(e),a=(r=t)>=80?{level:"High",color:"destructive",bgColor:"bg-red-50",textColor:"text-red-700"}:r>=60?{level:"Medium",color:"default",bgColor:"bg-yellow-50",textColor:"text-yellow-700"}:{level:"Low",color:"secondary",bgColor:"bg-green-50",textColor:"text-green-700"};var r;const n=g.get(e.id),l=j.has(e.id);return i.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-6 shadow-sm hover:shadow-md transition-shadow",children:[i.jsx("div",{className:"flex items-start justify-between mb-6",children:i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsxs("h4",{className:"text-lg font-semibold text-gray-900",children:[e.first_name," ",e.last_name]}),i.jsxs(zn,{variant:"destructive",className:"text-xs",children:[t,"% Flight Risk"]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("p",{className:"text-sm font-medium text-gray-700",children:[e.current_position," • ",e.current_department]}),i.jsxs("div",{className:"flex items-center gap-4 text-xs text-gray-500",children:[i.jsxs("span",{children:["📅 ",e.years_of_experience," years experience"]}),i.jsxs("span",{children:["⭐ Performance: ",e.performance_rating,"/5"]}),i.jsxs("span",{className:"px-2 py-1 bg-red-100 text-red-700 rounded",children:[a.level," Priority"]})]})]})]})}),(null==(s=null==n?void 0:n.retentionPlan)?void 0:s.riskAnalysis)&&i.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[i.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full"}),i.jsx("h5",{className:"font-semibold text-sm text-gray-800",children:"Risk Analysis"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-3",children:[i.jsxs("div",{className:"bg-white p-3 rounded border",children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"URGENCY LEVEL"}),i.jsx("div",{className:"text-sm font-semibold text-orange-600 uppercase",children:n.retentionPlan.riskAnalysis.urgencyLevel})]}),i.jsxs("div",{className:"bg-white p-3 rounded border",children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"RETENTION PROBABILITY"}),i.jsxs("div",{className:"text-sm font-semibold text-green-600",children:[Math.round(n.retentionPlan.riskAnalysis.retentionProbability>1?n.retentionPlan.riskAnalysis.retentionProbability:100*n.retentionPlan.riskAnalysis.retentionProbability),"%"]})]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 mb-2",children:"RISK FACTORS"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:n.retentionPlan.riskAnalysis.primaryRiskFactors.map((e,s)=>i.jsx("span",{className:"px-2 py-1 bg-red-100 text-red-700 text-xs rounded",children:e.replace("_"," ")},s))})]})]}),(null==n?void 0:n.retentionPlan)?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),i.jsx("h5",{className:"font-semibold text-blue-800",children:"Retention Action Plan"})]}),i.jsxs("div",{className:"px-3 py-1 bg-blue-600 text-white text-sm font-medium rounded",children:[Math.round(n.retentionPlan.successPrediction>1?n.retentionPlan.successPrediction:100*n.retentionPlan.successPrediction),"% Success Rate"]})]}),i.jsx("div",{className:"space-y-3",children:n.retentionPlan.recommendedActions.map((s,t)=>{const a=`${e.id}-${s.actionId}`,r=b.has(a),n="executed"===s.status;return i.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded text-xs font-medium "+("immediate"===s.priority?"bg-red-100 text-red-700":"high"===s.priority?"bg-orange-100 text-orange-700":"bg-gray-100 text-gray-700"),children:s.priority}),i.jsx("h6",{className:"font-semibold text-gray-800",children:s.actionName})]}),i.jsx("p",{className:"text-sm text-gray-600 mb-3 leading-relaxed",children:s.description}),i.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[i.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[i.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"TIMELINE"}),i.jsx("div",{className:"text-sm font-semibold text-gray-700",children:s.timeline})]}),i.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[i.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"SUCCESS RATE"}),i.jsxs("div",{className:"text-sm font-semibold text-green-600",children:[Math.round(s.successProbability>1?s.successProbability:100*s.successProbability),"%"]})]}),i.jsxs("div",{className:"text-center p-2 bg-gray-50 rounded",children:[i.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"ASSIGNED TO"}),i.jsx("div",{className:"text-sm font-semibold text-blue-600 capitalize",children:s.assignedTo})]})]}),s.specificInstructions&&i.jsxs("p",{className:"text-xs mt-2 p-2 bg-blue-50 rounded",children:["💡 ",s.specificInstructions]})]}),i.jsxs(nn,{size:"sm",onClick:()=>(async(e,s)=>{const t=`${e.id}-${s.actionId}`;N(e=>new Set([...e,t]));try{await new Promise(e=>setTimeout(e,1500)),w({title:"Action Executed!",description:`${s.actionName} has been initiated for ${e.first_name} ${e.last_name}`}),v(t=>{const a=new Map(t),r=a.get(e.id);if(null==r?void 0:r.retentionPlan){const t=r.retentionPlan.recommendedActions.map(e=>e.actionId===s.actionId?{...e,status:"executed",executedDate:(new Date).toISOString()}:e);a.set(e.id,{...r,retentionPlan:{...r.retentionPlan,recommendedActions:t}})}return a})}catch(a){w({title:"Execution Failed",description:a.message||"Failed to execute retention action",variant:"destructive"})}finally{N(e=>{const s=new Set(e);return s.delete(t),s})}})(e,s),disabled:r||n,className:"min-w-[100px] font-medium "+(n?"bg-gradient-to-r from-green-600 to-green-700 hover:from-green-700 hover:to-green-800":"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700"),children:[r?i.jsx(kt,{className:"h-3 w-3 animate-spin mr-1"}):n?i.jsx(Gs,{className:"h-3 w-3 mr-1"}):i.jsx(Ft,{className:"h-3 w-3 mr-1"}),n?"Executed":r?"Executing...":"Execute"]})]})},t)})}),i.jsx("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"OVERALL STRATEGY"}),i.jsx("p",{className:"text-gray-700 leading-relaxed",children:n.retentionPlan.overallStrategy})]}),i.jsxs("div",{children:[i.jsx("div",{className:"text-xs font-medium text-gray-500 mb-1",children:"NEXT REVIEW DATE"}),i.jsx("p",{className:"text-gray-700 font-medium",children:new Date(n.retentionPlan.nextReviewDate).toLocaleDateString()})]})]})})]}):i.jsxs("div",{className:"flex items-center justify-between py-4 px-4 bg-gray-50 rounded border",children:[i.jsxs("div",{children:[i.jsx("h6",{className:"font-medium text-gray-800",children:"Generate AI-Powered Retention Plan"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Create a personalized action plan to retain this high-risk employee"})]}),i.jsx(nn,{onClick:()=>(async e=>{var s;const t=e.id,a=T(e);y(e=>new Set([...e,t]));try{const r=[];e.performance_rating<3&&r.push("performance_concerns"),e.years_of_experience>5&&r.push("career_stagnation"),a>=80&&r.push("high_mobility_risk"),(!e.skills||Array.isArray(e.skills)&&e.skills.length<3)&&r.push("skill_development_needs");const{data:n,error:i}=await en.functions.invoke("ai-retention-action-planner",{body:{employee:e,flightRiskScore:a,riskFactors:r,generatePlan:!0}});if(i)throw i;if(!(null==n?void 0:n.success)||!n.retentionPlan)throw new Error((null==n?void 0:n.message)||"Failed to generate retention plan");v(s=>{const r=new Map(s);return r.set(t,{employee:e,flightRiskScore:a,retentionPlan:n.retentionPlan}),r}),w({title:"Retention Plan Generated!",description:`Created ${(null==(s=n.retentionPlan.recommendedActions)?void 0:s.length)||0} action recommendations for ${e.first_name}`})}catch(r){w({title:"Generation Failed",description:r.message||"Failed to generate retention plan",variant:"destructive"})}finally{y(e=>{const s=new Set(e);return s.delete(t),s})}})(e),disabled:l,className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700",children:l?i.jsxs(i.Fragment,{children:[i.jsx(kt,{className:"h-4 w-4 mr-2 animate-spin"}),"Generating..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rs,{className:"h-4 w-4 mr-2"}),"Generate Plan"]})})]})]},e.id)}),0===e.filter(e=>T(e)>=80).length&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Gs,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"No High Flight Risk Employees"}),i.jsx("p",{className:"text-muted-foreground",children:"All employees currently have low to medium flight risk levels."})]})]})})]})]})]})]})},zj=()=>{const[e,s]=ce.useState({learningPaths:0,completionRate:0,avgLearningHours:0,skillsDeveloped:0,totalEmployees:0,totalTrainings:0,totalCertifications:0,loading:!0,refresh:()=>{}});return ce.useEffect(()=>{const e=async()=>{try{const{data:{user:t},error:a}=await en.auth.getUser(),{data:r,error:n}=(await en.from("employee_training_enrollments").select("*",{count:"exact"}),await en.from("profiles").select("role, id").eq("id",null==t?void 0:t.id).single()),[i,l,c,o,d]=(await en.from("employee_training_enrollments").select("id").limit(1),await en.from("xlsmart_development_plans").select("*",{count:"exact"}),await en.from("xlsmart_development_plans").select("*",{count:"exact"}),await Promise.all([en.from("xlsmart_employees").select("*",{count:"exact",head:!0}).eq("is_active",!0),en.from("xlsmart_development_plans").select("*",{count:"exact",head:!0}).eq("plan_status","active"),en.from("employee_training_enrollments").select("*",{count:"exact"}),en.from("employee_certifications").select("*",{count:"exact",head:!0}),en.from("xlsmart_employees").select("skills").eq("is_active",!0)])),m=l.count||0,h=c.data||[],u=h.length,x=h.filter(e=>"completed"===e.status||"completed"===e.completion_status).length,p=u>0?Math.round(x/u*100):0,f=h.reduce((e,s)=>e+(s.time_spent_hours||0),0),g=f>0?f:10,v=Math.round(p/2);s({learningPaths:m,completionRate:p,avgLearningHours:g,skillsDeveloped:v,totalEmployees:i.count||0,totalTrainings:u,totalCertifications:o.count||0,loading:!1,refresh:e})}catch(t){s(e=>({...e,loading:!1}))}};e()},[]),e},Uj=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState([]),[r,n]=ce.useState([]),[l,c]=ce.useState(!0),[o,d]=ce.useState(!1),[m,h]=ce.useState(null),{toast:u}=De(),{refresh:x}=zj();ce.useEffect(()=>{p()},[]);const p=async()=>{try{c(!0);const[e,t,r]=await Promise.all([en.from("xlsmart_employees").select("*").eq("is_active",!0).order("first_name"),en.from("xlsmart_standard_roles").select("*").eq("is_active",!0),en.from("ai_analysis_results").select("*").eq("analysis_type","development_pathways").order("created_at",{ascending:!1})]);if(e.error)throw e.error;if(t.error)throw t.error;if(r.error)throw r.error;s(e.data||[]),a(t.data||[]);const i=(r.data||[]).map(e=>{var s,t,a,r,n,i;return{id:e.id,employee_id:(null==(s=e.input_parameters)?void 0:s.employee_id)||"",employee_name:(null==(t=e.input_parameters)?void 0:t.employee_name)||"",current_position:(null==(a=e.input_parameters)?void 0:a.current_position)||"",department:(null==(r=e.input_parameters)?void 0:r.department)||"",experience:(null==(n=e.input_parameters)?void 0:n.experience)||0,ai_development_plan:(null==(i=e.analysis_result)?void 0:i.developmentPlan)||"No development plan available",created_at:e.created_at}});n(i)}catch(e){u({title:"Error",description:"Failed to load development pathways data",variant:"destructive"})}finally{c(!1)}},f=async()=>{if(0!==e.length){d(!0),h({processed:0,total:e.length});try{const{data:e}=await en.from("xlsmart_employees").select("source_company").eq("is_active",!0),t=[...new Set((null==e?void 0:e.map(e=>e.source_company))||[])],a=t.length>0?t[0]:"xl",{data:r,error:n}=await en.functions.invoke("development-pathways-bulk",{body:{pathwayType:"company",identifier:a}});if(n)throw n;if(null==r?void 0:r.success){u({title:"Development Analysis Complete",description:`Generated development plans for ${r.total_processed} employees`});try{const{data:e,error:s}=await en.functions.invoke("convert-ai-to-development-plans",{body:{}});s?u({title:"⚠️ Analysis Complete",description:`Generated development pathways, but failed to create structured plans. ${s.message}`,variant:"destructive"}):(u({title:"🎉 Complete Success!",description:`Generated development pathways and created ${e.converted} structured development plans. Analytics updated!`}),x())}catch(s){u({title:"⚠️ Analysis Complete",description:"Generated development pathways, but failed to create structured plans.",variant:"destructive"})}await p()}}catch(t){u({title:"Analysis Failed",description:t.message||"Failed to run development analysis",variant:"destructive"})}finally{d(!1),h(null)}}else u({title:"No employees",description:"No employees found for development analysis",variant:"destructive"})},g=e=>{const s=t.find(s=>s.id===e.standard_role_id);if(!s||!s.required_skills)return[];const a=Array.isArray(e.skills)?e.skills:[];return(Array.isArray(s.required_skills)?s.required_skills:[]).filter(e=>!a.some(s=>s.toLowerCase().includes(e.toLowerCase()))).slice(0,3)},v=e=>{const s=e.years_of_experience||0,t=e.performance_rating||0,a=g(e).length;return t>=4&&a<=2?"Advanced":t>=3&&s>=3?"Intermediate":"Foundation"},j=ce.useCallback(e=>e?e.replace(/###\s+(.*?)(?=\n|$)/g,'<h4 class="font-semibold text-blue-600 mt-3 mb-2">$1</h4>').replace(/##\s+(.*?)(?=\n|$)/g,'<h3 class="font-bold text-gray-800 mt-4 mb-2">$1</h3>').replace(/\*\*(.*?)\*\*/g,'<strong class="font-semibold">$1</strong>').replace(/^[-•]\s+(.*)$/gm,'<div class="mb-1">• $1</div>').replace(/\n\n/g,"<br/><br/>").replace(/\n/g,"<br/>"):"",[]);return l?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsxs("div",{className:"text-center",children:[i.jsx(kt,{className:"h-8 w-8 animate-spin mx-auto mb-4"}),i.jsx("p",{children:"Loading development pathways data..."})]})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-3xl font-bold tracking-tight",children:"AI Development Pathways"}),i.jsx("p",{className:"text-muted-foreground",children:"AI-powered learning and development planning for employee growth"})]}),i.jsx(nn,{onClick:f,disabled:o||0===e.length,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:o?i.jsxs(i.Fragment,{children:[i.jsx(kt,{className:"mr-2 h-4 w-4 animate-spin"}),"Analyzing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rs,{className:"mr-2 h-4 w-4"}),"Run AI Development Analysis & Create Plans"]})})]}),o&&m&&i.jsx(fn,{children:i.jsx(yn,{className:"pt-6",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Analyzing development pathways..."}),i.jsxs("span",{children:[m.processed," / ",m.total]})]}),i.jsx(Bi,{value:m?m.processed/m.total*100:0,className:"w-full"})]})})}),i.jsxs(hn,{defaultValue:"overview",className:"space-y-4",children:[i.jsxs(un,{children:[i.jsx(xn,{value:"overview",children:"Overview"}),i.jsx(xn,{value:"employees",children:"Development Analysis"}),i.jsx(xn,{value:"pathways",children:"Learning Pathways"}),i.jsx(xn,{value:"ai-results",children:"AI Results"})]}),i.jsx(pn,{value:"overview",className:"space-y-4",children:i.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"Total Employees"}),i.jsx(Wt,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:e.length}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Active employees for development"})]})]}),i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"Learning Paths"}),i.jsx(Cs,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:"3"}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Foundation, Intermediate, Advanced"})]})]}),i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"High Performers"}),i.jsx(Ot,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:e.filter(e=>e.performance_rating>=4).length}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Ready for advanced development"})]})]}),i.jsxs(fn,{children:[i.jsxs(gn,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[i.jsx(vn,{className:"text-sm font-medium",children:"Skill Gaps"}),i.jsx(Ft,{className:"h-4 w-4 text-muted-foreground"})]}),i.jsxs(yn,{children:[i.jsx("div",{className:"text-2xl font-bold",children:e.reduce((e,s)=>e+g(s).length,0)}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Total identified skill gaps"})]})]})]})}),i.jsx(pn,{value:"employees",className:"space-y-4",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ft,{className:"h-5 w-5"}),"Employee Development Analysis"]})}),i.jsx(yn,{children:i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Employee"}),i.jsx(rl,{children:"Current Role"}),i.jsx(rl,{children:"Experience"}),i.jsx(rl,{children:"Performance"}),i.jsx(rl,{children:"Priority Level"}),i.jsx(rl,{children:"Skill Gaps"}),i.jsx(rl,{children:"Learning Recommendations"})]})}),i.jsx(tl,{children:e.map(e=>{const s=v(e),t=g(e),a=(e=>{const s=g(e),t=v(e),a=[];return s.length>0&&a.push(`Skill development: ${s.join(", ")}`),"Advanced"===t?a.push("Leadership training","Mentoring opportunities"):"Intermediate"===t?a.push("Cross-functional projects","Certification programs"):a.push("Foundation courses","On-the-job training"),a.slice(0,3)})(e);return i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{children:[i.jsxs("div",{className:"font-medium",children:[e.first_name," ",e.last_name]}),i.jsx("div",{className:"text-sm text-gray-500",children:e.employee_number})]})}),i.jsx(nl,{children:e.current_position}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Ys,{className:"h-3 w-3"}),e.years_of_experience||0," years"]})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Ot,{className:"h-3 w-3 text-yellow-500"}),e.performance_rating||0,"/5"]})}),i.jsx(nl,{children:i.jsx(zn,{variant:"Advanced"===s?"default":"Intermediate"===s?"secondary":"outline",children:s})}),i.jsx(nl,{children:i.jsx("div",{className:"flex flex-col gap-1",children:t.length>0?t.map((e,s)=>i.jsx(zn,{variant:"destructive",className:"text-xs",children:e},s)):i.jsx("span",{className:"text-sm text-green-600",children:"No major gaps"})})}),i.jsx(nl,{children:i.jsx("div",{className:"flex flex-col gap-1",children:a.map((e,s)=>i.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[i.jsx(Es,{className:"h-3 w-3 text-purple-500"}),e]},s))})})]},e.id)})})]})})]})}),i.jsx(pn,{value:"pathways",className:"space-y-4",children:i.jsxs("div",{className:"grid gap-4 md:grid-cols-3",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Cs,{className:"h-5 w-5 text-blue-500"}),"Foundation Path"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"For employees new to their roles or the organization"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium",children:"Key Components:"}),i.jsxs("ul",{className:"text-sm space-y-1",children:[i.jsx("li",{children:"• Basic skill training"}),i.jsx("li",{children:"• Company orientation"}),i.jsx("li",{children:"• Mentorship programs"}),i.jsx("li",{children:"• Foundational certifications"})]})]}),i.jsxs("div",{className:"text-lg font-bold",children:[e.filter(e=>"Foundation"===v(e)).length," employees"]})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-green-500"}),"Intermediate Path"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"For experienced employees ready to advance"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium",children:"Key Components:"}),i.jsxs("ul",{className:"text-sm space-y-1",children:[i.jsx("li",{children:"• Advanced skill development"}),i.jsx("li",{children:"• Cross-functional projects"}),i.jsx("li",{children:"• Professional certifications"}),i.jsx("li",{children:"• Leadership training"})]})]}),i.jsxs("div",{className:"text-lg font-bold",children:[e.filter(e=>"Intermediate"===v(e)).length," employees"]})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ts,{className:"h-5 w-5 text-purple-500"}),"Advanced Path"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-3",children:[i.jsx("div",{className:"text-sm text-gray-600",children:"For high performers ready for leadership roles"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"font-medium",children:"Key Components:"}),i.jsxs("ul",{className:"text-sm space-y-1",children:[i.jsx("li",{children:"• Executive training"}),i.jsx("li",{children:"• Strategic projects"}),i.jsx("li",{children:"• Mentoring others"}),i.jsx("li",{children:"• Innovation initiatives"})]})]}),i.jsxs("div",{className:"text-lg font-bold",children:[e.filter(e=>"Advanced"===v(e)).length," employees"]})]})})]})]})}),i.jsx(pn,{value:"ai-results",className:"space-y-4",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Rs,{className:"h-5 w-5"}),"AI-Generated Development Plans"]})}),i.jsx(yn,{children:r.length>0?i.jsxs("div",{className:"space-y-6",children:[r.slice(0,10).map(s=>{const t=e.find(e=>e.id===s.employee_id);return i.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-6 space-y-4 shadow-sm",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-lg text-gray-900",children:s.employee_name||`${null==t?void 0:t.first_name} ${null==t?void 0:t.last_name}`||"Unknown Employee"}),i.jsxs("div",{className:"flex gap-2 mt-1",children:[i.jsx(zn,{variant:"outline",children:s.current_position}),i.jsx(zn,{variant:"secondary",children:s.department}),i.jsxs(zn,{variant:"outline",children:[s.experience," years exp"]})]})]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(s.created_at).toLocaleDateString()})]}),i.jsxs("div",{className:"bg-white border border-gray-200 p-6 rounded-lg",children:[i.jsx("h5",{className:"font-semibold text-base mb-4 text-gray-800 border-b border-gray-200 pb-2",children:"AI Development Recommendations"}),i.jsx("div",{className:"max-w-none",children:i.jsx("div",{className:"text-sm leading-relaxed text-gray-700",dangerouslySetInnerHTML:{__html:j(s.ai_development_plan)}})})]})]},s.id)}),r.length>10&&i.jsx("div",{className:"text-center py-4",children:i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing first 10 of ",r.length," development plans"]})})]}):i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Rs,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold",children:"No AI Results Yet"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:"Run the AI Development Analysis to generate personalized development plans"}),i.jsx(nn,{onClick:f,disabled:o||0===e.length,className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700",children:o?i.jsxs(i.Fragment,{children:[i.jsx(kt,{className:"mr-2 h-4 w-4 animate-spin"}),"Analyzing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rs,{className:"mr-2 h-4 w-4"}),"Run AI Development Analysis"]})})]})})]})})]})]})},Bj=()=>{const[e,s]=ce.useState(!1),[t,a]=ce.useState({assigned:0,failed:0,total:0}),{toast:r}=De(),n=t.total>0?(t.assigned+t.failed)/t.total*100:0;return i.jsxs(fn,{className:"w-full max-w-2xl mx-auto",children:[i.jsxs(gn,{children:[i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(As,{className:"h-5 w-5"}),"AI Bulk Role Assignment"]}),i.jsx(jn,{children:"Automatically assign standard roles to all employees using AI analysis"})]}),i.jsxs(yn,{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[i.jsx(Wt,{className:"h-4 w-4"}),"This will assign standard roles to all employees without current role assignments"]}),t.total>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Progress"}),i.jsxs("span",{children:[t.assigned+t.failed," / ",t.total]})]}),i.jsx(Bi,{value:n,className:"w-full"}),i.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Gs,{className:"h-3 w-3 text-green-500"}),i.jsxs("span",{children:["Assigned: ",t.assigned]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Vs,{className:"h-3 w-3 text-red-500"}),i.jsxs("span",{children:["Failed: ",t.failed]})]})]})]}),i.jsx(nn,{onClick:async()=>{s(!0),a({assigned:0,failed:0,total:0});try{const{data:e,error:s}=await en.functions.invoke("bulk-assign-roles",{body:{}});if(s)throw s;if(!(null==e?void 0:e.success))throw new Error((null==e?void 0:e.error)||"Unknown error occurred");a({assigned:e.assigned||0,failed:e.failed||0,total:e.total||0}),r({title:"Assignment Result",description:`${e.message}. Assigned: ${e.assigned}, Failed: ${e.failed}`,variant:e.failed>0?"destructive":"default"})}catch(e){r({title:"Assignment Failed",description:`Error: ${e.message||"Failed to assign roles. Please try again."}`,variant:"destructive"})}finally{s(!1)}},disabled:e,className:"w-full",children:e?"Assigning Roles...":"Start Bulk Role Assignment"})]})]})},$j=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(!1),{toast:r}=De(),n=(e,t,a,r)=>{s(s=>s.map(s=>s.name===e?{...s,status:t,message:a,details:r}:s))},l=e=>{s(s=>[...s,{name:e,status:"pending",message:"Waiting..."}])},c=e=>{switch(e){case"success":return i.jsx(Gs,{className:"h-4 w-4 text-green-500"});case"error":return i.jsx(Ws,{className:"h-4 w-4 text-red-500"});case"running":return i.jsx(ot,{className:"h-4 w-4 text-blue-500 animate-spin"});default:return i.jsx(Vs,{className:"h-4 w-4 text-gray-400"})}},o=e=>{switch(e){case"success":return"border-green-200 bg-green-50";case"error":return"border-red-200 bg-red-50";case"running":return"border-blue-200 bg-blue-50";default:return"border-gray-200 bg-gray-50"}};return i.jsxs(fn,{className:"w-full",children:[i.jsxs(gn,{children:[i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Lt,{className:"h-5 w-5"}),"Application Test Suite"]}),i.jsx(jn,{children:"Comprehensive testing of all application functionality"})]}),i.jsxs(yn,{className:"space-y-4",children:[i.jsx(nn,{onClick:async()=>{a(!0),s([]);["Database Connection","Authentication","Employee Data Access","Standard Roles Access","LiteLLM API Key","AI Skills Assessment","Bulk Role Assignment","Manual Role Assignment","Employee Upload","RLS Policies"].forEach(l);try{n("Database Connection","running","Testing database connection...");try{const{data:e,error:s}=await en.from("xlsmart_employees").select("id").limit(1);if(s)throw s;n("Database Connection","success","Database connection successful")}catch(t){n("Database Connection","error",`Database connection failed: ${t.message}`)}n("Authentication","running","Checking authentication...");try{const{data:{user:e},error:s}=await en.auth.getUser();if(s)throw s;if(!e)throw new Error("No authenticated user");n("Authentication","success",`Authenticated as: ${e.email}`)}catch(t){n("Authentication","error",`Authentication failed: ${t.message}`)}n("Employee Data Access","running","Checking employee data access...");try{const{data:e,error:s}=await en.from("xlsmart_employees").select("*").limit(5);if(s)throw s;n("Employee Data Access","success",`Found ${(null==e?void 0:e.length)||0} employees`)}catch(t){n("Employee Data Access","error",`Employee access failed: ${t.message}`)}n("Standard Roles Access","running","Checking standard roles access...");try{const{data:e,error:s}=await en.from("xlsmart_standard_roles").select("*").eq("is_active",!0);if(s)throw s;n("Standard Roles Access","success",`Found ${(null==e?void 0:e.length)||0} standard roles`)}catch(t){n("Standard Roles Access","error",`Standard roles access failed: ${t.message}`)}n("LiteLLM API Key","running","Testing LiteLLM API...");try{const{data:e,error:s}=await en.functions.invoke("test-litellm-direct",{body:{test:!0}});if(s)throw s;n("LiteLLM API Key","success","LiteLLM API accessible")}catch(t){n("LiteLLM API Key","error",`LiteLLM API test failed: ${t.message}`)}n("AI Skills Assessment","running","Testing AI skills assessment...");try{const{data:e,error:s}=await en.functions.invoke("ai-skills-assessment",{body:{test:!0}});if(s)throw s;n("AI Skills Assessment","success","AI skills assessment accessible")}catch(t){n("AI Skills Assessment","error",`AI skills assessment failed: ${t.message}`)}n("Bulk Role Assignment","running","Testing bulk role assignment...");try{const{data:e,error:s}=await en.from("xlsmart_employees").select("id").is("standard_role_id",null).limit(1);if(s)throw s;if(e&&e.length>0){const{data:e,error:s}=await en.functions.invoke("bulk-assign-roles",{});if(s)throw s;n("Bulk Role Assignment","success",`Bulk assignment result: ${JSON.stringify(e)}`,e)}else n("Bulk Role Assignment","success","No unassigned employees found")}catch(t){n("Bulk Role Assignment","error",`Bulk assignment failed: ${t.message}`)}n("Manual Role Assignment","running","Testing manual role assignment...");try{const{data:e,error:s}=await en.from("xlsmart_employees").select("id, role_assignment_status").limit(1);if(s)throw s;n("Manual Role Assignment","success","Manual assignment interface accessible")}catch(t){n("Manual Role Assignment","error",`Manual assignment failed: ${t.message}`)}n("Employee Upload","running","Testing employee upload function...");try{const{data:e,error:s}=await en.functions.invoke("employee-upload-data",{body:{test:!0}});n("Employee Upload","success","Employee upload function accessible")}catch(t){n("Employee Upload","error",`Employee upload test failed: ${t.message}`)}n("RLS Policies","running","Testing RLS policies...");try{const{data:e,error:s}=await en.from("profiles").select("*").limit(1);if(s)throw s;n("RLS Policies","success","RLS policies working correctly")}catch(t){n("RLS Policies","error",`RLS policy test failed: ${t.message}`)}}catch(t){r({title:"Test Suite Error",description:`Testing failed: ${t.message}`,variant:"destructive"})}finally{a(!1);const s=e.filter(e=>"success"===e.status).length,t=e.filter(e=>"error"===e.status).length;r({title:"Test Suite Complete",description:`${s} passed, ${t} failed`,variant:t>0?"destructive":"default"})}},disabled:t,className:"w-full",children:t?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Running Tests..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Lt,{className:"mr-2 h-4 w-4"}),"Run Comprehensive Test"]})}),e.length>0&&i.jsxs("div",{className:"space-y-2",children:[i.jsx("h3",{className:"font-semibold",children:"Test Results:"}),e.map((e,s)=>i.jsxs("div",{className:`p-3 rounded-lg border ${o(e.status)}`,children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[c(e.status),i.jsx("span",{className:"font-medium",children:e.name})]}),i.jsx(zn,{variant:"success"===e.status?"default":"error"===e.status?"destructive":"secondary",children:e.status})]}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.message}),e.details&&i.jsx("pre",{className:"text-xs bg-gray-100 p-2 rounded mt-2 overflow-auto",children:JSON.stringify(e.details,null,2)})]},s))]})]})]})},Hj=()=>{const[e,s]=ce.useState({employees:"0",roles:"0",accuracy:"0%",skills:"0",loading:!0});return ce.useEffect(()=>{(async()=>{try{const[e,t,a,r]=await Promise.all([en.from("xlsmart_employees").select("*",{count:"exact",head:!0}),en.from("xlsmart_standard_roles").select("*",{count:"exact",head:!0}),en.from("xlsmart_role_mappings").select("mapping_confidence"),en.from("skills_master").select("*",{count:"exact",head:!0})]),n=e.count||0,i=t.count||0,l=r.count||0,c=a.data||[],o=c.length>0?Math.round(c.reduce((e,s)=>e+(s.mapping_confidence||0),0)/c.length):0;s({employees:n.toLocaleString(),roles:i.toString(),accuracy:`${o}%`,skills:l.toString(),loading:!1})}catch(e){s(e=>({...e,loading:!1}))}})()},[]),e},Vj=()=>{const[e,s]=ce.useState(null),t=Hj();De();const{user:a,signOut:r}=tn(),n=me();ce.useEffect(()=>{a||n("/")},[a,n]);const l=[{id:"upload",title:"Bulk Role Upload & Standardization",description:"Upload role catalogs and auto-map to XLSMART Standard Roles with industry-aligned job families.",icon:$t,badge:"Core",dialogContent:"upload"},{id:"jd-generator",title:"AI-Powered JD Generator",description:"Generate job descriptions for every standardized role with in-app chatbot to tweak tone and requirements.",icon:tt,badge:"AI",dialogContent:null},{id:"employee-upload",title:"Employee Upload & AI Assignment",description:"Upload 10,000+ employees and automatically assign roles using AI",icon:Wt,badge:"AI",dialogContent:null},{id:"assessment",title:"Employee Skill Assessment",description:"Upload employees, match % vs target JD, skill gaps, next role recommendations.",icon:Rs,badge:"Analytics",dialogContent:null},{id:"chat",title:"HR AI Assistant",description:"In-app chatbot for HR/editors to tweak job descriptions and get personalized recommendations.",icon:ut,badge:"AI",dialogContent:"chat"},{id:"career-paths",title:"Employee Career Paths",description:"AI-powered career path planning and progression mapping",icon:Ut,badge:"AI",dialogContent:null},{id:"mobility",title:"Employee Mobility & Planning",description:"Level fit analysis, rotation/churn risk assessment, and personalized development plans.",icon:Ft,badge:"Planning",dialogContent:null},{id:"development",title:"Development Pathways",description:"Personalized development plans with courses, certifications, and projects for career growth.",icon:Rs,badge:"Growth",dialogContent:null}],c=[{value:t.loading?"...":t.employees,label:"Total Employees",icon:Wt,color:"text-blue-600"},{value:t.loading?"...":t.roles,label:"Standardized Roles",icon:Ft,color:"text-cyan-600"},{value:t.loading?"...":t.accuracy,label:"Mapping Accuracy",icon:Zt,color:"text-blue-600"},{value:t.loading?"...":t.skills,label:"Skills Identified",icon:Ms,color:"text-cyan-600"}];return i.jsxs("div",{className:"min-h-screen bg-background",children:[i.jsx("header",{className:"xlsmart-gradient-bg text-white",children:i.jsxs("div",{className:"container mx-auto px-6 py-8",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("div",{className:"flex items-center space-x-4",children:i.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[i.jsx("img",{src:"/xlsmart-logo.svg",alt:"XLSMART Logo",className:"h-16 w-auto"}),i.jsx("p",{className:"text-white/90 text-lg font-medium text-center",children:"AI-Powered HR Platform by SimplifyAI"})]})}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-full bg-white/20",children:i.jsx(qt,{className:"h-4 w-4 text-white"})}),i.jsx("span",{className:"text-white/90 text-sm",children:null==a?void 0:a.email})]}),i.jsx(nn,{onClick:async()=>{await r(),n("/")},variant:"outline",className:"bg-white/10 border-white/30 text-white hover:bg-white/20",children:"Sign Out"})]})]}),i.jsxs("div",{className:"mt-12 space-y-4",children:[i.jsxs("h2",{className:"text-3xl font-light",children:["Revolutionizing HR with ",i.jsx("span",{className:"font-bold text-white",children:"Artificial Intelligence"})]}),i.jsx("p",{className:"text-white/80 text-xl max-w-3xl leading-relaxed",children:"Streamline role standardization, skill assessment, and career development with XLSMART's AI-powered platform built for the telecommunications industry."})]})]})}),i.jsxs("main",{className:"container mx-auto px-6 py-12 space-y-12",children:[i.jsxs("section",{children:[i.jsxs("div",{className:"text-center mb-12",children:[i.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Platform Features"}),i.jsx("p",{className:"text-gray-600 text-lg max-w-3xl mx-auto",children:"Comprehensive solutions for modernizing HR operations through AI-driven insights"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:l.map((t,a)=>i.jsxs(fn,{className:"xlsmart-card group cursor-pointer relative overflow-hidden hover:scale-105",children:[i.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 bg-gradient-to-br from-primary/10 to-accent/10 rounded-bl-3xl"}),i.jsxs(gn,{className:"pb-4",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsx("div",{className:"p-4 bg-primary/10 rounded-2xl group-hover:bg-primary/20 transition-colors",children:i.jsx(t.icon,{className:"h-7 w-7 text-primary group-hover:text-primary/80"})}),i.jsx(zn,{variant:"outline",className:"text-xs font-medium border-2 "+("AI"===t.badge?"border-accent/30 text-accent bg-accent/10":"Core"===t.badge?"border-primary/30 text-primary bg-primary/10":"Analytics"===t.badge?"border-purple-500/30 text-purple-600 bg-purple-50":"border-muted-foreground/30 text-muted-foreground bg-muted/10"),children:t.badge})]}),i.jsx(vn,{className:"text-xl font-bold text-card-foreground group-hover:text-primary transition-colors duration-300",children:t.title})]}),i.jsxs(yn,{className:"space-y-4",children:[i.jsx("p",{className:"text-muted-foreground text-sm leading-relaxed",children:t.description}),t.dialogContent?i.jsxs(Cn,{open:e===t.id,onOpenChange:e=>s(e?t.id:null),children:[i.jsx(An,{asChild:!0,children:i.jsxs(nn,{variant:"outline",className:"w-full group-hover:xlsmart-primary-gradient group-hover:text-white group-hover:border-transparent transition-all duration-300 shadow-sm hover:shadow-md",children:["upload"===t.id?"Upload Role Catalog":"Open Assistant",i.jsx(Es,{className:"ml-2 h-4 w-4"})]})}),i.jsxs(Pn,{className:"upload"===t.id?"max-w-5xl max-h-[80vh] overflow-y-auto":"max-w-4xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"upload"===t.id?"Role Standardization System":"AI Chat Assistant"}),"upload"===t.id?i.jsx(_f,{}):i.jsx(ki,{})]})]}):i.jsxs(Cn,{open:e===t.id,onOpenChange:e=>s(e?t.id:null),children:[i.jsx(An,{asChild:!0,children:i.jsxs(nn,{variant:"outline",className:"w-full group-hover:xlsmart-primary-gradient group-hover:text-white group-hover:border-transparent transition-all duration-300 shadow-sm hover:shadow-md",children:["Learn More",i.jsx(Es,{className:"ml-2 h-4 w-4"})]})}),i.jsxs(Pn,{className:"max-w-5xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"jd-generator"===t.id?"Job Description Generator":"employee-upload"===t.id?"Employee Upload System":"assessment"===t.id?"Skills Assessment":"career-paths"===t.id?"Employee Career Paths":"mobility"===t.id?"Employee Mobility Planning":"development"===t.id?"Development Pathways":"Feature Dialog"}),"jd-generator"===t.id&&i.jsx(Ef,{}),"employee-upload"===t.id&&i.jsx(Oj,{}),"assessment"===t.id&&i.jsx(Tf,{}),"career-paths"===t.id&&i.jsx(Fj,{}),"mobility"===t.id&&i.jsx(Lj,{}),"development"===t.id&&i.jsx(Uj,{})]})]})]})]},t.id))})]}),i.jsxs("section",{className:"bg-gray-50 rounded-2xl p-8",children:[i.jsxs("div",{className:"text-center mb-8",children:[i.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Dashboard Overview"}),i.jsx("p",{className:"text-gray-600",children:"Real-time insights for HR transformation"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:c.map((e,t)=>i.jsx(fn,{className:"xlsmart-card text-center hover:scale-105 cursor-pointer transition-all duration-300",onClick:()=>{0===t?s("employee-details"):1===t?s("roles-details"):2===t?s("accuracy-details"):3===t&&s("skills-details")},children:i.jsx(yn,{className:"p-6",children:i.jsxs("div",{className:"flex flex-col items-center space-y-3",children:[i.jsx("div",{className:"p-4 rounded-2xl bg-gradient-to-br "+(t%2==0?"from-primary to-primary/80":"from-accent to-accent/80"),children:i.jsx(e.icon,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("div",{className:`text-3xl font-bold ${e.color}`,children:e.value}),i.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.label})]})]})})},t))})]}),i.jsxs("section",{className:"space-y-8",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("h2",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Quick Actions"}),i.jsx("p",{className:"text-gray-600 text-lg max-w-3xl mx-auto",children:"Manage your HR operations efficiently with AI-powered tools"})]}),i.jsxs("div",{className:"grid gap-6",children:[i.jsx(Bj,{}),i.jsx($j,{})]})]}),i.jsx("section",{className:"xlsmart-gradient-bg rounded-3xl p-12 text-white text-center shadow-2xl",children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-4xl font-bold mb-6",children:"Ready to Transform Your HR?"}),i.jsx("p",{className:"text-white/90 text-xl max-w-3xl mx-auto leading-relaxed",children:"Join the future of human resources with XLSMART's AI-powered role standardization, skills assessment, and career development planning."})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-center pt-4",children:[i.jsxs(Cn,{open:"quick-upload"===e,onOpenChange:e=>s(e?"quick-upload":null),children:[i.jsx(An,{asChild:!0,children:i.jsxs(nn,{size:"lg",className:"xlsmart-button-secondary px-12 py-4 text-lg shadow-2xl",children:[i.jsx($t,{className:"mr-3 h-6 w-6"}),"Upload Role Catalogs"]})}),i.jsxs(Pn,{className:"max-w-5xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Role Upload Dialog"}),i.jsx(_f,{})]})]}),i.jsxs(Cn,{open:"litellm-test"===e,onOpenChange:e=>s(e?"litellm-test":null),children:[i.jsx(An,{asChild:!0,children:i.jsxs(nn,{size:"lg",variant:"outline",className:"px-12 py-4 text-lg bg-white/10 border-white/30 text-white hover:bg-white/20 hover:scale-105 transition-all shadow-xl backdrop-blur-sm",children:[i.jsx(ut,{className:"mr-3 h-6 w-6"}),"Test LiteLLM Connection"]})}),i.jsxs(Pn,{className:"max-w-2xl",children:[i.jsx(On,{className:"sr-only",children:"LiteLLM Connection Test"}),i.jsx(Sf,{})]})]})]})]})}),i.jsx(Cn,{open:"employee-details"===e,onOpenChange:e=>s(e?"employee-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Employee Details"}),i.jsx(dj,{})]})}),i.jsx(Cn,{open:"roles-details"===e,onOpenChange:e=>s(e?"roles-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Standardized Roles Details"}),i.jsx(hj,{})]})}),i.jsx(Cn,{open:"accuracy-details"===e,onOpenChange:e=>s(e?"accuracy-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Mapping Accuracy Details"}),i.jsx(uj,{})]})}),i.jsx(Cn,{open:"skills-details"===e,onOpenChange:e=>s(e?"skills-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Skills Details"}),i.jsx(fj,{})]})})]})]})};var Gj="horizontal",qj=["horizontal","vertical"],Wj=ce.forwardRef((e,s)=>{const{decorative:t,orientation:a=Gj,...r}=e,n=function(e){return qj.includes(e)}(a)?a:Gj,l=t?{role:"none"}:{"aria-orientation":"vertical"===n?n:void 0,role:"separator"};return i.jsx(c.div,{"data-orientation":n,...l,...r,ref:s})});Wj.displayName="Separator";var Yj=Wj;const Kj=ce.forwardRef(({className:e,orientation:s="horizontal",decorative:t=!0,...a},r)=>i.jsx(Yj,{ref:r,decorative:t,orientation:s,className:Ga("shrink-0 bg-border","horizontal"===s?"h-[1px] w-full":"h-full w-[1px]",e),...a}));Kj.displayName=Yj.displayName;const Jj=Q,Xj=Z,Zj=ce.forwardRef(({className:e,...s},t)=>i.jsx(W,{className:Ga("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s,ref:t}));Zj.displayName=W.displayName;const Qj=ye("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),ey=ce.forwardRef(({side:e="right",className:s,children:t,...a},r)=>i.jsxs(Xj,{children:[i.jsx(Zj,{}),i.jsxs(Y,{ref:r,className:Ga(Qj({side:e}),s),...a,children:[t,i.jsxs(K,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[i.jsx(Xt,{className:"h-4 w-4"}),i.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));ey.displayName=Y.displayName;ce.forwardRef(({className:e,...s},t)=>i.jsx(J,{ref:t,className:Ga("text-lg font-semibold text-foreground",e),...s})).displayName=J.displayName;ce.forwardRef(({className:e,...s},t)=>i.jsx(X,{ref:t,className:Ga("text-sm text-muted-foreground",e),...s})).displayName=X.displayName;const sy=ce.createContext(null);function ty(){const e=ce.useContext(sy);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const ay=ce.forwardRef(({defaultOpen:e=!0,open:s,onOpenChange:t,className:a,style:r,children:n,...l},c)=>{const o=function(){const[e,s]=ce.useState(void 0);return ce.useEffect(()=>{const e=window.matchMedia("(max-width: 767px)"),t=()=>{s(window.innerWidth<768)};return e.addEventListener("change",t),s(window.innerWidth<768),()=>e.removeEventListener("change",t)},[]),!!e}(),[d,m]=ce.useState(!1),[h,u]=ce.useState(e),x=s??h,p=ce.useCallback(e=>{const s="function"==typeof e?e(x):e;t?t(s):u(s),document.cookie=`sidebar:state=${s}; path=/; max-age=604800`},[t,x]),f=ce.useCallback(()=>o?m(e=>!e):p(e=>!e),[o,p,m]);ce.useEffect(()=>{const e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),f())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[f]);const g=x?"expanded":"collapsed",v=ce.useMemo(()=>({state:g,open:x,setOpen:p,isMobile:o,openMobile:d,setOpenMobile:m,toggleSidebar:f}),[g,x,p,o,d,m,f]);return i.jsx(sy.Provider,{value:v,children:i.jsx(Jr,{delayDuration:0,children:i.jsx("div",{style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...r},className:Ga("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",a),ref:c,...l,children:n})})})});ay.displayName="SidebarProvider";const ry=ce.forwardRef(({side:e="left",variant:s="sidebar",collapsible:t="offcanvas",className:a,children:r,...n},l)=>{const{isMobile:c,state:o,openMobile:d,setOpenMobile:m}=ty();return"none"===t?i.jsx("div",{className:Ga("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",a),ref:l,...n,children:r}):c?i.jsx(Jj,{open:d,onOpenChange:m,...n,children:i.jsx(ey,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:e,children:i.jsx("div",{className:"flex h-full w-full flex-col",children:r})})}):i.jsxs("div",{ref:l,className:"group peer hidden md:block text-sidebar-foreground","data-state":o,"data-collapsible":"collapsed"===o?t:"","data-variant":s,"data-side":e,children:[i.jsx("div",{className:Ga("duration-200 relative h-svh w-[--sidebar-width] bg-transparent transition-[width] ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===s||"inset"===s?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),i.jsx("div",{className:Ga("duration-200 fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] ease-linear md:flex","left"===e?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===s||"inset"===s?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",a),...n,children:i.jsx("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:r})})]})});ry.displayName="Sidebar";const ny=ce.forwardRef(({className:e,onClick:s,...t},a)=>{const{toggleSidebar:r}=ty();return i.jsxs(nn,{ref:a,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Ga("h-7 w-7",e),onClick:e=>{null==s||s(e),r()},...t,children:[i.jsx(vt,{}),i.jsx("span",{className:"sr-only",children:"Toggle Sidebar"})]})});ny.displayName="SidebarTrigger";ce.forwardRef(({className:e,...s},t)=>{const{toggleSidebar:a}=ty();return i.jsx("button",{ref:t,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:a,title:"Toggle Sidebar",className:Ga("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",e),...s})}).displayName="SidebarRail";ce.forwardRef(({className:e,...s},t)=>i.jsx("main",{ref:t,className:Ga("relative flex min-h-svh flex-1 flex-col bg-background","peer-data-[variant=inset]:min-h-[calc(100svh-theme(spacing.4))] md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",e),...s})).displayName="SidebarInset";ce.forwardRef(({className:e,...s},t)=>i.jsx(ln,{ref:t,"data-sidebar":"input",className:Ga("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",e),...s})).displayName="SidebarInput";ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{ref:t,"data-sidebar":"header",className:Ga("flex flex-col gap-2 p-2",e),...s})).displayName="SidebarHeader";ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{ref:t,"data-sidebar":"footer",className:Ga("flex flex-col gap-2 p-2",e),...s})).displayName="SidebarFooter";ce.forwardRef(({className:e,...s},t)=>i.jsx(Kj,{ref:t,"data-sidebar":"separator",className:Ga("mx-2 w-auto bg-sidebar-border",e),...s})).displayName="SidebarSeparator";const iy=ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{ref:t,"data-sidebar":"content",className:Ga("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",e),...s}));iy.displayName="SidebarContent";const ly=ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{ref:t,"data-sidebar":"group",className:Ga("relative flex w-full min-w-0 flex-col p-2",e),...s}));ly.displayName="SidebarGroup";const cy=ce.forwardRef(({className:e,asChild:s=!1,...t},a)=>{const r=s?E:"div";return i.jsx(r,{ref:a,"data-sidebar":"group-label",className:Ga("duration-200 flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opa] ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",e),...t})});cy.displayName="SidebarGroupLabel";ce.forwardRef(({className:e,asChild:s=!1,...t},a)=>{const r=s?E:"button";return i.jsx(r,{ref:a,"data-sidebar":"group-action",className:Ga("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",e),...t})}).displayName="SidebarGroupAction";const oy=ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{ref:t,"data-sidebar":"group-content",className:Ga("w-full text-sm",e),...s}));oy.displayName="SidebarGroupContent";const dy=ce.forwardRef(({className:e,...s},t)=>i.jsx("ul",{ref:t,"data-sidebar":"menu",className:Ga("flex w-full min-w-0 flex-col gap-1",e),...s}));dy.displayName="SidebarMenu";const my=ce.forwardRef(({className:e,...s},t)=>i.jsx("li",{ref:t,"data-sidebar":"menu-item",className:Ga("group/menu-item relative",e),...s}));my.displayName="SidebarMenuItem";const hy=ye("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),uy=ce.forwardRef(({asChild:e=!1,isActive:s=!1,variant:t="default",size:a="default",tooltip:r,className:n,...l},c)=>{const o=e?E:"button",{isMobile:d,state:m}=ty(),h=i.jsx(o,{ref:c,"data-sidebar":"menu-button","data-size":a,"data-active":s,className:Ga(hy({variant:t,size:a}),n),...l});return r?("string"==typeof r&&(r={children:r}),i.jsxs(Xr,{children:[i.jsx(Zr,{asChild:!0,children:h}),i.jsx(Qr,{side:"right",align:"center",hidden:"collapsed"!==m||d,...r})]})):h});uy.displayName="SidebarMenuButton";ce.forwardRef(({className:e,asChild:s=!1,showOnHover:t=!1,...a},r)=>{const n=s?E:"button";return i.jsx(n,{ref:r,"data-sidebar":"menu-action",className:Ga("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",t&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",e),...a})}).displayName="SidebarMenuAction";ce.forwardRef(({className:e,...s},t)=>i.jsx("div",{ref:t,"data-sidebar":"menu-badge",className:Ga("absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground select-none pointer-events-none","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",e),...s})).displayName="SidebarMenuBadge";ce.forwardRef(({className:e,showIcon:s=!1,...t},a)=>{const r=ce.useMemo(()=>`${Math.floor(40*Math.random())+50}%`,[]);return i.jsxs("div",{ref:a,"data-sidebar":"menu-skeleton",className:Ga("rounded-md h-8 flex gap-2 px-2 items-center",e),...t,children:[s&&i.jsx(Qi,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),i.jsx(Qi,{className:"h-4 flex-1 max-w-[--skeleton-width]","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":r}})]})}).displayName="SidebarMenuSkeleton";ce.forwardRef(({className:e,...s},t)=>i.jsx("ul",{ref:t,"data-sidebar":"menu-sub",className:Ga("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",e),...s})).displayName="SidebarMenuSub";ce.forwardRef(({...e},s)=>i.jsx("li",{ref:s,...e})).displayName="SidebarMenuSubItem";ce.forwardRef(({asChild:e=!1,size:s="md",isActive:t,className:a,...r},n)=>{const l=e?E:"a";return i.jsx(l,{ref:n,"data-sidebar":"menu-sub-button","data-size":s,"data-active":t,className:Ga("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground","sm"===s&&"text-xs","md"===s&&"text-sm","group-data-[collapsible=icon]:hidden",a),...r})}).displayName="SidebarMenuSubButton";const xy=[{title:"Role Management",url:"/dashboard/roles",icon:Is,description:"Role standardization & analytics"},{title:"Job Descriptions",url:"/dashboard/job-descriptions",icon:tt,description:"JD generation & management"}],py=[{title:"Employee Dashboard",url:"/dashboard/employees",icon:Wt,description:"Employee analytics & overview"},{title:"Bulk Role Assignment",url:"/dashboard/bulk-role-assignment",icon:Ft,description:"Automatically assign roles using AI"}],fy=[{title:"Skill Assessment",url:"/dashboard/skills",icon:Rs,description:"Skills analysis & inventory"},{title:"Career Paths",url:"/dashboard/career-paths",icon:Ut,description:"Career planning & progression"},{title:"Employee Mobility",url:"/dashboard/mobility",icon:Ft,description:"Mobility planning & analysis"},{title:"Development Pathways",url:"/dashboard/development",icon:Cs,description:"Learning & development paths"},{title:"Training",url:"/dashboard/training",icon:Ts,description:"Training programs & analytics"},{title:"Certifications",url:"/dashboard/certifications",icon:Ts,description:"Certification tracking"}],gy=[{title:"Workforce Analytics",url:"/dashboard/workforce-analytics",icon:Os,description:"Advanced workforce insights"},{title:"AI Interviews",url:"/dashboard/ai-interviews",icon:ft,description:"AI-powered employee interviews"}];function vy(){const{state:e}=ty(),s=he(),{user:t,signOut:a}=tn();s.pathname;const r="collapsed"===e,n=({isActive:e})=>e?"bg-primary/10 text-primary font-medium border-l-4 border-primary":"hover:bg-muted/50";return i.jsx(ry,{className:r?"w-16":"w-64",collapsible:"icon",children:i.jsxs(iy,{children:[i.jsx("div",{className:"p-4 border-b "+(r?"px-2":""),children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"flex h-8 w-8 items-center justify-center rounded-lg bg-primary/10",children:i.jsx(qt,{className:"h-4 w-4 text-primary"})}),!r&&i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"text-sm font-medium text-foreground truncate",children:"HR Manager"}),i.jsx("p",{className:"text-xs text-muted-foreground truncate",children:null==t?void 0:t.email})]})]})}),i.jsxs(ly,{children:[i.jsx(cy,{className:r?"sr-only":"",children:"Core Platform"}),i.jsx(oy,{children:i.jsx(dy,{children:xy.map(e=>i.jsx(my,{children:i.jsx(uy,{asChild:!0,children:i.jsxs(ue,{to:e.url,className:n,children:[i.jsx(e.icon,{className:"h-4 w-4 flex-shrink-0"}),!r&&i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("span",{className:"block text-sm font-medium truncate",children:e.title}),i.jsx("span",{className:"block text-xs text-muted-foreground truncate",children:e.description})]})]})})},e.title))})})]}),i.jsxs(ly,{children:[i.jsx(cy,{className:r?"sr-only":"",children:"Employee Management"}),i.jsx(oy,{children:i.jsx(dy,{children:py.map(e=>i.jsx(my,{children:i.jsx(uy,{asChild:!0,children:i.jsxs(ue,{to:e.url,className:n,children:[i.jsx(e.icon,{className:"h-4 w-4 flex-shrink-0"}),!r&&i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("span",{className:"block text-sm font-medium truncate",children:e.title}),i.jsx("span",{className:"block text-xs text-muted-foreground truncate",children:e.description})]})]})})},e.title))})})]}),i.jsxs(ly,{children:[i.jsx(cy,{className:r?"sr-only":"",children:"Skills & Development"}),i.jsx(oy,{children:i.jsx(dy,{children:fy.map(e=>i.jsx(my,{children:i.jsx(uy,{asChild:!0,children:i.jsxs(ue,{to:e.url,className:n,children:[i.jsx(e.icon,{className:"h-4 w-4 flex-shrink-0"}),!r&&i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("span",{className:"block text-sm font-medium truncate",children:e.title}),i.jsx("span",{className:"block text-xs text-muted-foreground truncate",children:e.description})]})]})})},e.title))})})]}),i.jsxs(ly,{children:[i.jsx(cy,{className:r?"sr-only":"",children:"Analytics"}),i.jsx(oy,{children:i.jsx(dy,{children:gy.map(e=>i.jsx(my,{children:i.jsx(uy,{asChild:!0,children:i.jsxs(ue,{to:e.url,className:n,children:[i.jsx(e.icon,{className:"h-4 w-4 flex-shrink-0"}),!r&&i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("span",{className:"block text-sm font-medium truncate",children:e.title}),i.jsx("span",{className:"block text-xs text-muted-foreground truncate",children:e.description})]})]})})},e.title))})})]}),i.jsx("div",{className:"mt-auto p-4 border-t",children:i.jsx(nn,{onClick:async()=>{await a(),window.location.href="/"},variant:"outline",size:r?"icon":"sm",className:"w-full",children:r?i.jsx(qt,{className:"h-4 w-4"}):"Sign Out"})})]})})}const jy=()=>{const{user:e,loading:s}=tn(),t=me(),a=he();return ce.useEffect(()=>{s||e||t("/")},[e,s,t,a.pathname]),s?i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-background",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ot,{className:"h-6 w-6 animate-spin"}),i.jsx("span",{children:"Loading..."})]})}):e?i.jsx(ay,{children:i.jsxs("div",{className:"min-h-screen flex w-full bg-background",children:[i.jsxs("header",{className:"fixed top-0 left-0 right-0 h-20 z-50 xlsmart-gradient-bg border-b flex items-center justify-between px-4",children:[i.jsx(ny,{className:"text-white hover:bg-white/20"}),i.jsxs("div",{className:"flex flex-col items-center space-y-1",children:[i.jsx("img",{src:"/xlsmart-logo.svg",alt:"XLSMART Logo",className:"h-10 w-auto"}),i.jsx("p",{className:"text-white/90 text-sm font-medium",children:"AI-Powered HR Platform by SimplifyAI"})]}),i.jsx("div",{className:"flex items-center gap-3"})]}),i.jsx(vy,{}),i.jsx("main",{className:"flex-1 pt-20",children:i.jsx("div",{className:"p-6 h-full",children:i.jsx(xe,{})})})]})}):null},yy=()=>{const[e,s]=ce.useState(null),t=Hj(),a=[{id:"upload",title:"Bulk Role Upload & Standardization",description:"Upload role catalogs and auto-map to XLSMART Standard Roles with industry-aligned job families.",icon:$t,badge:"Core",dialogContent:"upload"},{id:"jd-generator",title:"AI-Powered JD Generator",description:"Generate job descriptions for every standardized role with in-app chatbot to tweak tone and requirements.",icon:tt,badge:"AI",dialogContent:null},{id:"employee-upload",title:"Employee Upload & AI Assignment",description:"Upload 10,000+ employees and automatically assign roles using AI",icon:Wt,badge:"AI",dialogContent:null},{id:"assessment",title:"Employee Skill Assessment",description:"Upload employees, match % vs target JD, skill gaps, next role recommendations.",icon:Rs,badge:"Analytics",dialogContent:null},{id:"chat",title:"HR AI Assistant",description:"In-app chatbot for HR/editors to tweak job descriptions and get personalized recommendations.",icon:ut,badge:"AI",dialogContent:"chat"},{id:"career-paths",title:"Employee Career Paths",description:"AI-powered career path planning and progression mapping",icon:Ut,badge:"AI",dialogContent:null},{id:"mobility",title:"Employee Mobility & Planning",description:"Level fit analysis, rotation/churn risk assessment, and personalized development plans.",icon:Ft,badge:"Planning",dialogContent:null},{id:"development",title:"Development Pathways",description:"Personalized development plans with courses, certifications, and projects for career growth.",icon:Rs,badge:"Growth",dialogContent:null}],r=[{value:t.loading?"...":t.employees,label:"Total Employees",icon:Wt,color:"text-blue-600"},{value:t.loading?"...":t.roles,label:"Standardized Roles",icon:Ft,color:"text-cyan-600"},{value:t.loading?"...":t.accuracy,label:"Mapping Accuracy",icon:Zt,color:"text-blue-600"},{value:t.loading?"...":t.skills,label:"Skills Identified",icon:Ms,color:"text-cyan-600"}];return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"XLSMART Analytics Dashboard"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"Monitor your HR platform performance and access key features"})]}),i.jsxs("section",{className:"bg-muted/50 rounded-xl p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Dashboard Overview"}),i.jsx("p",{className:"text-muted-foreground",children:"Real-time insights for HR transformation"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:r.map((e,t)=>i.jsx(fn,{className:"hover:shadow-md cursor-pointer transition-all duration-200",onClick:()=>{0===t?s("employee-details"):1===t?s("roles-details"):2===t?s("accuracy-details"):3===t&&s("skills-details")},children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br "+(t%2==0?"from-primary to-primary/80":"from-primary/80 to-primary/60"),children:i.jsx(e.icon,{className:"h-5 w-5 text-white"})}),i.jsxs("div",{children:[i.jsx("div",{className:`text-2xl font-bold ${e.color}`,children:e.value}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.label})]})]})})},t))})]}),i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Platform Features"}),i.jsx("p",{className:"text-muted-foreground",children:"Comprehensive solutions for modernizing HR operations"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(t=>i.jsxs(fn,{className:"group cursor-pointer hover:shadow-md transition-all duration-200",children:[i.jsxs(gn,{className:"pb-3",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsx("div",{className:"p-3 bg-primary/10 rounded-xl group-hover:bg-primary/20 transition-colors",children:i.jsx(t.icon,{className:"h-5 w-5 text-primary"})}),i.jsx(zn,{variant:"outline",className:"text-xs font-medium "+("AI"===t.badge?"border-primary/30 text-primary bg-primary/10":"border-muted-foreground/30 text-muted-foreground bg-muted/10"),children:t.badge})]}),i.jsx(vn,{className:"text-lg font-semibold text-foreground",children:t.title})]}),i.jsxs(yn,{className:"space-y-3",children:[i.jsx("p",{className:"text-muted-foreground text-sm",children:t.description}),t.dialogContent?i.jsxs(Cn,{open:e===t.id,onOpenChange:e=>s(e?t.id:null),children:[i.jsx(An,{asChild:!0,children:i.jsxs(nn,{variant:"outline",size:"sm",className:"w-full",children:["upload"===t.id?"Upload Role Catalog":"Open Assistant",i.jsx(Es,{className:"ml-2 h-4 w-4"})]})}),i.jsxs(Pn,{className:"upload"===t.id?"max-w-5xl max-h-[80vh] overflow-y-auto":"max-w-4xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"upload"===t.id?"Role Standardization System":"AI Chat Assistant"}),"upload"===t.id?i.jsx(_f,{}):i.jsx(ki,{})]})]}):i.jsxs(Cn,{open:e===t.id,onOpenChange:e=>s(e?t.id:null),children:[i.jsx(An,{asChild:!0,children:i.jsxs(nn,{variant:"outline",size:"sm",className:"w-full",children:["Learn More",i.jsx(Es,{className:"ml-2 h-4 w-4"})]})}),i.jsxs(Pn,{className:"max-w-5xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"jd-generator"===t.id?"Job Description Generator":"employee-upload"===t.id?"Employee Upload System":"assessment"===t.id?"Skills Assessment":"career-paths"===t.id?"Employee Career Paths":"mobility"===t.id?"Employee Mobility Planning":"development"===t.id?"Development Pathways":"Feature Dialog"}),"jd-generator"===t.id&&i.jsx(Ef,{}),"employee-upload"===t.id&&i.jsx(Oj,{}),"assessment"===t.id&&i.jsx(Tf,{}),"career-paths"===t.id&&i.jsx(Fj,{}),"mobility"===t.id&&i.jsx(Lj,{}),"development"===t.id&&i.jsx(Uj,{})]})]})]})]},t.id))})]}),i.jsxs("section",{className:"space-y-4",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground",children:"Quick Actions"}),i.jsxs("div",{className:"grid gap-4",children:[i.jsx(Bj,{}),i.jsx($j,{})]})]}),i.jsx(Cn,{open:"employee-details"===e,onOpenChange:e=>s(e?"employee-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Employee Details"}),i.jsx(dj,{})]})}),i.jsx(Cn,{open:"roles-details"===e,onOpenChange:e=>s(e?"roles-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Roles Details"}),i.jsx(hj,{})]})}),i.jsx(Cn,{open:"accuracy-details"===e,onOpenChange:e=>s(e?"accuracy-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Accuracy Details"}),i.jsx(uj,{})]})}),i.jsx(Cn,{open:"skills-details"===e,onOpenChange:e=>s(e?"skills-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Skills Details"}),i.jsx(fj,{})]})})]})};function by({onAnalysisComplete:e}){const[s,t]=ce.useState(!1),[a,r]=ce.useState(null),[n,l]=ce.useState("pay_equity"),[c,o]=ce.useState(""),[d,m]=ce.useState(""),{toast:h}=De(),u=[{value:"pay_equity",label:"Pay Equity Analysis",icon:Wt},{value:"market_benchmarking",label:"Market Benchmarking",icon:Ut},{value:"promotion_readiness",label:"Promotion Readiness",icon:Ft},{value:"compensation_optimization",label:"Compensation Optimization",icon:Xs}],x=e=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0,maximumFractionDigits:0}).format(e);return i.jsxs("div",{className:"space-y-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Xs,{className:"h-6 w-6 text-primary"}),i.jsx("span",{children:"AI Compensation Intelligence"})]})}),i.jsx(yn,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Analysis Type"}),i.jsxs(bn,{value:n,onValueChange:l,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select analysis type"})}),i.jsx(Sn,{children:u.map(e=>i.jsx(En,{value:e.value,children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(e.icon,{className:"h-4 w-4"}),i.jsx("span",{children:e.label})]})},e.value))})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Department Filter"}),i.jsxs(bn,{value:c,onValueChange:o,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"All departments"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"all",children:"All Departments"}),i.jsx(En,{value:"Engineering",children:"Engineering"}),i.jsx(En,{value:"Sales",children:"Sales"}),i.jsx(En,{value:"Marketing",children:"Marketing"}),i.jsx(En,{value:"HR",children:"Human Resources"}),i.jsx(En,{value:"Finance",children:"Finance"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Role Filter"}),i.jsxs(bn,{value:d,onValueChange:m,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"All roles"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"all",children:"All Roles"}),i.jsx(En,{value:"Manager",children:"Manager"}),i.jsx(En,{value:"Senior",children:"Senior"}),i.jsx(En,{value:"Lead",children:"Lead"}),i.jsx(En,{value:"Specialist",children:"Specialist"})]})]})]}),i.jsx("div",{className:"flex items-end",children:i.jsx(nn,{onClick:()=>{(async()=>{t(!0);try{const{data:s,error:t}=await en.functions.invoke("ai-compensation-intelligence",{body:{analysisType:n,departmentFilter:c||void 0,roleFilter:d||void 0}});if(t)throw t;r(s),null==e||e(s),h({title:"Analysis Complete",description:"AI compensation intelligence analysis has been completed successfully."})}catch(s){h({title:"Analysis Failed",description:"Failed to complete compensation intelligence analysis. Please try again.",variant:"destructive"})}finally{t(!1)}})()},disabled:s,className:"w-full bg-primary hover:bg-primary/90 text-white font-semibold",size:"lg",children:s?i.jsxs(i.Fragment,{children:[i.jsx(Ys,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Xs,{className:"h-4 w-4 mr-2"}),"Run Analysis"]})})})]})})]}),a&&i.jsxs("div",{className:"space-y-6",children:["pay_equity"===n&&((null==a?void 0:a.payEquityMetrics)?i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Gs,{className:"h-5 w-5 text-primary"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold",children:[a.payEquityMetrics.overallEquityScore,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Equity Score"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Wt,{className:"h-5 w-5 text-secondary"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:a.payEquityMetrics.totalEmployeesAnalyzed}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Employees Analyzed"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Bt,{className:"h-5 w-5 text-destructive"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:a.payEquityMetrics.potentialIssuesFound}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Potential Issues"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-accent"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold",children:[(v=a.payEquityMetrics.avgSalaryVariance,null==v||isNaN(v)?"0":v>1e3?Math.min(v,100).toFixed(1):v.toFixed(1)),"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Variance"})]})]})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Gender Pay Analysis"})}),i.jsx(yn,{children:!a.genderPayAnalysis||0===a.genderPayAnalysis.length||a.genderPayAnalysis.every(e=>{var s,t;return 0===(null==(s=e.sampleSize)?void 0:s.male)&&0===(null==(t=e.sampleSize)?void 0:t.female)})?i.jsx("div",{className:"text-center py-8",children:i.jsxs("div",{className:"text-muted-foreground mb-2",children:[i.jsx(Wt,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),i.jsx("p",{className:"text-sm",children:"Gender data not available for employees"}),i.jsx("p",{className:"text-xs",children:"Add gender field to employee records to enable pay equity analysis"})]})}):i.jsx("div",{className:"space-y-4",children:null==(p=a.genderPayAnalysis)?void 0:p.map((e,s)=>{var t,a,r;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("h4",{className:"font-medium",children:[e.role," - ",e.department]}),i.jsxs(zn,{variant:"High"===e.riskLevel?"destructive":"Medium"===e.riskLevel?"secondary":"outline",children:[e.riskLevel," Risk"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm font-medium",children:["Pay Gap: ",e.genderPayGap,"%"]}),i.jsx(Bi,{value:Math.abs(e.genderPayGap),className:"h-2 mt-1"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm",children:"Sample Size:"}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Male: ",(null==(t=e.sampleSize)?void 0:t.male)||0,", Female: ",(null==(a=e.sampleSize)?void 0:a.female)||0]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium",children:"Actions:"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:null==(r=e.recommendedActions)?void 0:r.slice(0,2).join(", ")})]})]})]},s)})})})]}),a.actionPlan&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Action Plan"})}),i.jsxs(yn,{children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Immediate Actions"}),i.jsx("ul",{className:"space-y-1",children:null==(f=a.actionPlan.immediateActions)?void 0:f.map((e,s)=>i.jsxs("li",{className:"text-sm text-muted-foreground",children:["• ",e]},s))})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Medium-term Actions"}),i.jsx("ul",{className:"space-y-1",children:null==(g=a.actionPlan.mediumTermActions)?void 0:g.map((e,s)=>i.jsxs("li",{className:"text-sm text-muted-foreground",children:["• ",e]},s))})]})]}),i.jsxs("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Budget Impact:"})," ",x(a.actionPlan.budgetImpact||0)]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Timeline:"})," ",a.actionPlan.timeline]})]})]})]})]}):null),"market_benchmarking"===n&&(()=>{var e;return(null==a?void 0:a.marketPositioning)?i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-primary"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-bold",children:a.marketPositioning.overallMarketPosition}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Market Position"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ft,{className:"h-5 w-5 text-secondary"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold",children:[a.marketPositioning.competitivenessScore,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Competitiveness"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Bt,{className:"h-5 w-5 text-destructive"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-bold",children:a.marketPositioning.retentionRisk}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Retention Risk"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Wt,{className:"h-5 w-5 text-accent"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-bold",children:a.marketPositioning.attractionCapability}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Attraction Capability"})]})]})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Role Benchmarking"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(e=a.roleBenchmarking)?void 0:e.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"font-medium",children:e.role}),i.jsxs(zn,{variant:"High"===e.priority?"destructive":"Medium"===e.priority?"secondary":"outline",children:[e.priority," Priority"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:"Current Avg"}),i.jsx("p",{className:"text-muted-foreground",children:x(e.currentAvgSalary)})]}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:"Market P50"}),i.jsx("p",{className:"text-muted-foreground",children:x(e.marketP50)})]}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:"Market P75"}),i.jsx("p",{className:"text-muted-foreground",children:x(e.marketP75)})]}),i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:"Gap"}),i.jsxs("p",{className:"font-medium "+(e.gap<0?"text-red-600":"text-green-600"),children:[e.gap>0?"+":"",x(e.gap)]})]})]}),i.jsxs("p",{className:"text-sm text-muted-foreground mt-2",children:[i.jsx("strong",{children:"Recommended Action:"})," ",e.recommendedAction]})]},s))})})]})]}):null})(),"promotion_readiness"===n&&(()=>{var e;return(null==a?void 0:a.promotionReadiness)?i.jsxs("div",{className:"space-y-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Promotion Ready Candidates"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(e=a.promotionReadiness)?void 0:e.slice(0,8).map((e,s)=>{var t;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.currentRole}),i.jsxs(zn,{variant:e.readinessScore>80?"default":"secondary",children:[e.readinessScore,"% Ready"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Current:"})," ",x(e.currentSalary)]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Target Role:"})," ",e.targetRole]})]}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Target Salary:"})," ",x(e.targetSalary)]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Increase:"})," ",x(e.salaryIncrease)]})]}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Time to Promotion:"})," ",e.timeToPromotion]}),i.jsx(Bi,{value:e.readinessScore,className:"h-2 mt-1"})]})]}),i.jsxs("div",{className:"mt-3",children:[i.jsx("p",{className:"text-sm font-medium",children:"Development Needs:"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:null==(t=e.developmentNeeds)?void 0:t.join(", ")})]})]},s)})})})]}),a.organizationalImpact&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Organizational Impact"})}),i.jsx(yn,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Total Promotion Budget:"}),i.jsx("span",{className:"font-medium",children:x(a.organizationalImpact.totalPromotionBudget)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Total Adjustment Budget:"}),i.jsx("span",{className:"font-medium",children:x(a.organizationalImpact.totalAdjustmentBudget)})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Retention Improvement:"}),i.jsxs("span",{className:"font-medium",children:[a.organizationalImpact.talentRetentionImprovement,"%"]})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Expected ROI"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:a.organizationalImpact.expectedROI}),i.jsxs("p",{className:"text-sm mt-2",children:[i.jsx("strong",{children:"Timeline:"})," ",a.organizationalImpact.implementationTimeline]})]})]})})]})]}):null})(),"compensation_optimization"===n&&(()=>{var e,s,t,r,n,l,c,o;const d=a;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Current State Analysis"})}),i.jsx(yn,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-primary",children:x((null==(e=d.currentState)?void 0:e.totalCompensationBudget)||0)}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Budget"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-orange-600",children:(null==(s=d.currentState)?void 0:s.compressionIssues)||0}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Compression Issues"})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[(100*((null==(t=d.currentState)?void 0:t.budgetUtilization)||0)).toFixed(1),"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Budget Utilization"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-blue-600",children:Object.keys((null==(r=d.currentState)?void 0:r.avgSalaryByLevel)||{}).length}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Salary Levels"})]})]})})]}),(null==(n=d.currentState)?void 0:n.avgSalaryByLevel)&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Average Salary by Level"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:Object.entries(d.currentState.avgSalaryByLevel).map(([e,s])=>i.jsxs("div",{className:"flex justify-between items-center p-3 bg-muted rounded-lg",children:[i.jsx("span",{className:"font-medium capitalize",children:e}),i.jsx("span",{className:"text-primary font-bold",children:x(s)})]},e))})})]}),d.optimizationOpportunities&&d.optimizationOpportunities.length>0&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Optimization Opportunities"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:d.optimizationOpportunities.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("h4",{className:"font-semibold",children:e.area}),i.jsx("div",{className:"text-right",children:i.jsxs("p",{className:"text-green-600 font-bold",children:["Savings: ",x(e.savings||0)]})})]}),i.jsx("p",{className:"text-muted-foreground mb-3",children:e.implementation}),e.riskFactors&&e.riskFactors.length>0&&i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-sm mb-1",children:"Risk Factors:"}),i.jsx("ul",{className:"text-sm text-muted-foreground list-disc list-inside",children:e.riskFactors.map((e,s)=>i.jsx("li",{children:e},s))})]})]},s))})})]}),d.salaryBandRecommendations&&d.salaryBandRecommendations.length>0&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Salary Band Recommendations"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:d.salaryBandRecommendations.map((e,s)=>{var t,a,r,n;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold",children:e.role}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.level})]}),i.jsx("div",{className:"text-right",children:i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Affected: ",e.affectedEmployees," employees"]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium",children:"Current Range"}),i.jsxs("p",{className:"text-sm",children:[x((null==(t=e.currentRange)?void 0:t.min)||0)," - ",x((null==(a=e.currentRange)?void 0:a.max)||0)]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium",children:"Recommended Range"}),i.jsxs("p",{className:"text-sm text-primary",children:[x((null==(r=e.recommendedRange)?void 0:r.min)||0)," - ",x((null==(n=e.recommendedRange)?void 0:n.max)||0)]})]})]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.rationale})]},s)})})})]}),d.strategicRecommendations&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Strategic Recommendations"})}),i.jsxs(yn,{children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-3 text-green-600",children:"Short Term"}),i.jsx("ul",{className:"space-y-2",children:null==(l=d.strategicRecommendations.shortTerm)?void 0:l.map((e,s)=>i.jsxs("li",{className:"text-sm flex items-start",children:[i.jsx("span",{className:"w-2 h-2 bg-green-600 rounded-full mt-2 mr-2 flex-shrink-0"}),e]},s))})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-3 text-orange-600",children:"Medium Term"}),i.jsx("ul",{className:"space-y-2",children:null==(c=d.strategicRecommendations.mediumTerm)?void 0:c.map((e,s)=>i.jsxs("li",{className:"text-sm flex items-start",children:[i.jsx("span",{className:"w-2 h-2 bg-orange-600 rounded-full mt-2 mr-2 flex-shrink-0"}),e]},s))})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-3 text-blue-600",children:"Long Term"}),i.jsx("ul",{className:"space-y-2",children:null==(o=d.strategicRecommendations.longTerm)?void 0:o.map((e,s)=>i.jsxs("li",{className:"text-sm flex items-start",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-600 rounded-full mt-2 mr-2 flex-shrink-0"}),e]},s))})]})]}),d.strategicRecommendations.totalInvestment&&i.jsx("div",{className:"mt-6 p-4 bg-muted rounded-lg",children:i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-semibold",children:"Total Investment Required:"}),i.jsx("span",{className:"text-lg font-bold text-primary",children:x(d.strategicRecommendations.totalInvestment)})]})})]})]})]})})()]})]});var p,f,g,v}const Ny=({onAnalysisComplete:e})=>{const[s,t]=ce.useState("sentiment_analysis"),[a,r]=ce.useState(""),[n,l]=ce.useState("3_months"),[c,o]=ce.useState(!1),[d,m]=ce.useState(null),h=[{value:"sentiment_analysis",label:"Sentiment Analysis",icon:nt},{value:"engagement_prediction",label:"Engagement Prediction",icon:Ut},{value:"retention_modeling",label:"Retention Modeling",icon:Wt},{value:"early_warning",label:"Early Warning System",icon:Bt}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs(bn,{value:s,onValueChange:t,children:[i.jsx(wn,{className:"w-full sm:w-64",children:i.jsx(Nn,{placeholder:"Select analysis type"})}),i.jsx(Sn,{children:h.map(e=>i.jsx(En,{value:e.value,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(e.icon,{className:"h-4 w-4"}),e.label]})},e.value))})]}),i.jsxs(bn,{value:a,onValueChange:r,children:[i.jsx(wn,{className:"w-full sm:w-48",children:i.jsx(Nn,{placeholder:"Filter by department"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"all",children:"All Departments"}),i.jsx(En,{value:"Engineering",children:"Engineering"}),i.jsx(En,{value:"Marketing",children:"Marketing"}),i.jsx(En,{value:"Sales",children:"Sales"}),i.jsx(En,{value:"HR",children:"HR"}),i.jsx(En,{value:"Finance",children:"Finance"})]})]}),i.jsxs(bn,{value:n,onValueChange:l,children:[i.jsx(wn,{className:"w-full sm:w-32",children:i.jsx(Nn,{placeholder:"Time frame"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"1_month",children:"1 Month"}),i.jsx(En,{value:"3_months",children:"3 Months"}),i.jsx(En,{value:"6_months",children:"6 Months"}),i.jsx(En,{value:"1_year",children:"1 Year"})]})]}),i.jsxs(nn,{onClick:async()=>{o(!0);try{const{data:t,error:r}=await en.functions.invoke("ai-employee-engagement",{body:{analysisType:s,departmentFilter:a||void 0,timeFrame:n}});if(r)throw r;m(t),null==e||e(t),Pe({title:"Analysis Complete",description:"Employee engagement analysis completed successfully!"})}catch(t){Pe({title:"Analysis Failed",description:"Failed to complete engagement analysis",variant:"destructive"})}finally{o(!1)}},disabled:c,className:"w-full sm:w-auto",children:[c?"Analyzing...":"Run Analysis",i.jsx(nt,{className:"ml-2 h-4 w-4"})]})]}),d&&i.jsxs(hn,{value:s,className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-4",children:[i.jsx(xn,{value:"sentiment_analysis",children:"Sentiment"}),i.jsx(xn,{value:"engagement_prediction",children:"Engagement"}),i.jsx(xn,{value:"retention_modeling",children:"Retention"}),i.jsx(xn,{value:"early_warning",children:"Alerts"})]}),i.jsx(pn,{value:"sentiment_analysis",className:"mt-6",children:(u=d,i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-primary",children:[(null==(x=u.overallSentiment)?void 0:x.score)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Overall Sentiment"}),i.jsx(zn,{variant:"positive"===(null==(p=u.overallSentiment)?void 0:p.trend)?"default":"negative"===(null==(f=u.overallSentiment)?void 0:f.trend)?"destructive":"secondary",children:(null==(g=u.overallSentiment)?void 0:g.trend)||"stable"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-secondary",children:(null==(v=u.departmentSentiment)?void 0:v.length)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Departments Analyzed"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(null==(j=u.riskSegments)?void 0:j.length)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Risk Segments"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Department Sentiment"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(y=u.departmentSentiment)?void 0:y.map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.department}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Bi,{value:e.sentimentScore,className:"w-20"}),i.jsxs("span",{className:"text-sm font-medium",children:[e.sentimentScore,"%"]})]})]}),i.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.employeeCount," employees"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2 text-xs",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-600",children:"Positives:"}),i.jsx("ul",{className:"text-muted-foreground",children:null==(t=e.positiveIndicators)?void 0:t.slice(0,2).map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-red-600",children:"Concerns:"}),i.jsx("ul",{className:"text-muted-foreground",children:null==(a=e.topConcerns)?void 0:a.slice(0,2).map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]})]})]},s)})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Sentiment Factors"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:null==(b=u.sentimentFactors)?void 0:b.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.factor}),i.jsx(zn,{variant:"high"===e.impact?"destructive":"medium"===e.impact?"default":"secondary",children:e.impact})]}),i.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Affects ",e.affectedEmployees," employees"]}),i.jsx("div",{className:"text-sm text-primary",children:e.recommendation})]},s))})})]})]})]}))}),i.jsx(pn,{value:"engagement_prediction",className:"mt-6",children:(e=>{var s,t,a,r,n;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-primary",children:[(null==(s=e.engagementForecasting)?void 0:s.currentEngagementRate)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Current Rate"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-secondary",children:[(null==(t=e.engagementForecasting)?void 0:t.predictedEngagementRate)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Predicted Rate"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(null==(a=e.engagementForecasting)?void 0:a.forecastConfidence)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Confidence"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(null==(r=e.interventionStrategies)?void 0:r.length)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Interventions"})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Intervention Strategies"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(n=e.interventionStrategies)?void 0:n.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.strategy}),i.jsxs(zn,{variant:"high"===e.implementationPriority?"destructive":"medium"===e.implementationPriority?"default":"secondary",children:[e.implementationPriority," priority"]})]}),i.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Target: ",e.targetSegment]}),i.jsxs("div",{className:"text-sm text-primary",children:["Expected improvement: ",e.expectedImprovement,"%"]})]},s))})})]})]})})(d)}),i.jsx(pn,{value:"retention_modeling",className:"mt-6",children:(e=>{var s,t,a,r,n;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-primary",children:[(null==(s=e.retentionMetrics)?void 0:s.overallRetentionRate)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Retention Rate"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-secondary",children:[(null==(t=e.retentionMetrics)?void 0:t.predictedRetentionRate)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Predicted Rate"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:(null==(a=e.retentionMetrics)?void 0:a.averageTenure)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Tenure (years)"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-red-600",children:(null==(r=e.retentionMetrics)?void 0:r.criticalRetentionRisk)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Critical Risk"})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"High-Risk Employees"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:null==(n=e.riskAnalysis)?void 0:n.slice(0,5).map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.employee}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Bi,{value:e.retentionProbability,className:"w-20"}),i.jsxs("span",{className:"text-sm font-medium",children:[e.retentionProbability,"%"]})]})]}),i.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Risk timeline: ",e.timeToRisk]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-red-600",children:"Risk Factors:"}),i.jsx("ul",{className:"text-muted-foreground",children:null==(t=e.riskFactors)?void 0:t.slice(0,2).map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-600",children:"Actions:"}),i.jsx("ul",{className:"text-muted-foreground",children:null==(a=e.retentionActions)?void 0:a.slice(0,2).map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]})]})]},s)})})})]})]})})(d)}),i.jsx(pn,{value:"early_warning",className:"mt-6",children:(e=>{var s,t,a,r,n;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:(null==(s=e.warningSystem)?void 0:s.totalEmployeesMonitored)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Monitored"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-red-600",children:(null==(t=e.warningSystem)?void 0:t.highRiskEmployees)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"High Risk"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(null==(a=e.warningSystem)?void 0:a.mediumRiskEmployees)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Medium Risk"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(null==(r=e.warningSystem)?void 0:r.earlyWarningAccuracy)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Accuracy"})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Risk Alerts"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(n=e.alertedEmployees)?void 0:n.map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.employee}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(zn,{variant:"immediate"===e.urgency?"destructive":"soon"===e.urgency?"default":"secondary",children:e.urgency}),i.jsxs("span",{className:"text-sm font-medium",children:["Risk: ",e.riskScore,"%"]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-orange-600",children:"Warnings:"}),i.jsx("ul",{className:"text-muted-foreground ml-2",children:null==(t=e.primaryWarnings)?void 0:t.slice(0,2).map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-600",children:"Actions:"}),i.jsx("ul",{className:"text-muted-foreground ml-2",children:null==(a=e.recommendedActions)?void 0:a.slice(0,2).map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]})]})]},s)})})})]})]})})(d)})]})]});var u,x,p,f,g,v,j,y,b},wy=({onAnalysisComplete:e})=>{var s;const[t,a]=ce.useState("leadership_pipeline"),[r,n]=ce.useState(""),[l,c]=ce.useState(""),[o,d]=ce.useState(!1),[m,h]=ce.useState(null),[u,x]=ce.useState([]),[p,f]=ce.useState("");oe.useEffect(()=>{g()},[]);const g=async()=>{try{const{data:e,error:s}=await en.from("ai_analysis_results").select("*").eq("function_name","ai-succession-planning").order("created_at",{ascending:!1}).limit(50);if(s)throw s;x(e||[])}catch(e){}},v=[{value:"leadership_pipeline",label:"Leadership Pipeline",icon:Ks},{value:"succession_readiness",label:"Succession Readiness",icon:Ut},{value:"high_potential_identification",label:"High Potential ID",icon:Ot},{value:"leadership_gap_analysis",label:"Leadership Gaps",icon:Ft}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs(bn,{value:t,onValueChange:async e=>{a(e);const s=u.find(s=>s.analysis_type===e);s?(h(s.analysis_result),f(s.id),Pe({title:"Cached Result Loaded",description:"Loaded previous succession analysis result from database."})):(h(null),f(""))},children:[i.jsx(wn,{className:"w-full sm:w-64",children:i.jsx(Nn,{placeholder:"Select analysis type"})}),i.jsx(Sn,{children:v.map(e=>i.jsx(En,{value:e.value,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(e.icon,{className:"h-4 w-4"}),e.label]})},e.value))})]}),i.jsxs(bn,{value:p,onValueChange:e=>{const s=u.find(s=>s.id===e);s&&(h(s.analysis_result),f(e),a(s.analysis_type),Pe({title:"Past Result Loaded",description:"Loaded previous succession analysis result."}))},children:[i.jsx(wn,{className:"w-full sm:w-48",children:i.jsx(Nn,{placeholder:"Load past analysis"})}),i.jsx(Sn,{children:u.map(e=>i.jsxs(En,{value:e.id,children:[e.analysis_type," - ",new Date(e.created_at).toLocaleDateString()]},e.id))})]}),i.jsxs(bn,{value:r,onValueChange:n,children:[i.jsx(wn,{className:"w-full sm:w-48",children:i.jsx(Nn,{placeholder:"Filter by department"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"all",children:"All Departments"}),i.jsx(En,{value:"Engineering",children:"Engineering"}),i.jsx(En,{value:"Marketing",children:"Marketing"}),i.jsx(En,{value:"Sales",children:"Sales"}),i.jsx(En,{value:"HR",children:"HR"}),i.jsx(En,{value:"Finance",children:"Finance"})]})]}),i.jsxs(bn,{value:l,onValueChange:c,children:[i.jsx(wn,{className:"w-full sm:w-48",children:i.jsx(Nn,{placeholder:"Position level"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"all",children:"All Levels"}),i.jsx(En,{value:"senior",children:"Senior"}),i.jsx(En,{value:"manager",children:"Manager"}),i.jsx(En,{value:"director",children:"Director"}),i.jsx(En,{value:"executive",children:"Executive"})]})]}),i.jsxs(nn,{onClick:async()=>{d(!0);try{const{data:s,error:a}=await en.functions.invoke("ai-succession-planning",{body:{analysisType:t,departmentFilter:r||void 0,positionLevel:l||void 0}});if(a)throw a;h(s),f(""),null==e||e(s),Pe({title:"Analysis Complete",description:"Succession planning analysis completed successfully!"}),await g()}catch(s){Pe({title:"Analysis Failed",description:"Failed to complete succession planning analysis",variant:"destructive"})}finally{d(!1)}},disabled:o,className:"w-full sm:w-auto",children:[o?"Analyzing...":"Run Analysis",i.jsx(Ks,{className:"ml-2 h-4 w-4"})]})]}),p&&i.jsx("div",{className:"bg-muted p-3 rounded-lg mb-4",children:i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing cached result from ",new Date((null==(s=u.find(e=>e.id===p))?void 0:s.created_at)||"").toLocaleString()]})}),m&&i.jsxs(hn,{value:t,className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-4",children:[i.jsx(xn,{value:"leadership_pipeline",children:"Pipeline"}),i.jsx(xn,{value:"succession_readiness",children:"Readiness"}),i.jsx(xn,{value:"high_potential_identification",children:"HiPo"}),i.jsx(xn,{value:"leadership_gap_analysis",children:"Gaps"})]}),i.jsx(pn,{value:"leadership_pipeline",className:"mt-6",children:(j=m,i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:(null==(y=j.pipelineOverview)?void 0:y.totalLeadershipRoles)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Leadership Roles"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-secondary",children:(null==(b=j.pipelineOverview)?void 0:b.totalPotentialSuccessors)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Potential Successors"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:(null==(N=j.pipelineOverview)?void 0:N.averageSuccessionDepth)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Succession Depth"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-red-600",children:(null==(w=j.pipelineOverview)?void 0:w.criticalGapsCount)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Critical Gaps"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Succession Chains"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(_=j.successionChains)?void 0:_.map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.role}),i.jsxs(zn,{variant:"high"===e.successionRisk?"destructive":"medium"===e.successionRisk?"default":"secondary",children:[e.successionRisk," risk"]})]}),i.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Current: ",e.currentLeader]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-600",children:"Ready Successors:"}),i.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:null==(t=e.readySuccessors)?void 0:t.map((e,s)=>i.jsx(zn,{variant:"outline",className:"text-xs",children:e},s))})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-orange-600",children:"Developing:"}),i.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:null==(a=e.developingSuccessors)?void 0:a.map((e,s)=>i.jsx(zn,{variant:"secondary",className:"text-xs",children:e},s))})]})]})]},s)})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Development Recommendations"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:null==(k=j.developmentRecommendations)?void 0:k.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.employee}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Bi,{value:e.readinessLevel,className:"w-16"}),i.jsxs("span",{className:"text-xs",children:[e.readinessLevel,"%"]})]})]}),i.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[e.currentRole," → ",e.targetRole]}),i.jsxs("div",{className:"text-sm text-primary",children:["Ready in: ",e.timeToReadiness]})]},s))})})]})]})]}))}),i.jsx(pn,{value:"succession_readiness",className:"mt-6",children:(e=>{var s,t,a,r,n;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:(null==(s=e.readinessMetrics)?void 0:s.immediatelyReady)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Ready Now"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(null==(t=e.readinessMetrics)?void 0:t.readyWithDevelopment)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Ready w/ Development"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(null==(a=e.readinessMetrics)?void 0:a.longerTermPotential)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Long-term Potential"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-primary",children:[(null==(r=e.readinessMetrics)?void 0:r.averageReadinessScore)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Readiness"})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Readiness Assessment"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(n=e.readinessAssessment)?void 0:n.map((e,s)=>{var t,a,r;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.employee}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Bi,{value:e.readinessScore,className:"w-20"}),i.jsx(zn,{variant:"ready_now"===e.readinessCategory?"default":"ready_1_year"===e.readinessCategory?"secondary":"outline",children:null==(t=e.readinessCategory)?void 0:t.replace(/_/g," ")})]})]}),i.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Current: ",e.currentRole]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-600",children:"Strengths:"}),i.jsx("ul",{className:"text-muted-foreground ml-2",children:null==(a=e.strengthAreas)?void 0:a.slice(0,2).map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-orange-600",children:"Development Needs:"}),i.jsx("ul",{className:"text-muted-foreground ml-2",children:null==(r=e.developmentNeeds)?void 0:r.slice(0,2).map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]})]})]},s)})})})]})]})})(m)}),i.jsx(pn,{value:"high_potential_identification",className:"mt-6",children:(e=>{var s,t,a,r,n;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:(null==(s=e.hipoIdentification)?void 0:s.totalHiposCandidates)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"HiPo Candidates"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:(null==(t=e.hipoIdentification)?void 0:t.confirmedHipos)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Confirmed HiPos"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(null==(a=e.hipoIdentification)?void 0:a.emergingTalent)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Emerging Talent"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[(null==(r=e.hipoIdentification)?void 0:r.hipoRetentionRate)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"HiPo Retention"})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"High-Potential Profiles"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(n=e.hipoProfiles)?void 0:n.map((e,s)=>{var t;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.employee}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(zn,{variant:"confirmed"===e.hipoCategory?"default":"emerging"===e.hipoCategory?"secondary":"outline",children:e.hipoCategory}),i.jsxs("div",{className:"text-sm font-medium",children:[e.potentialScore,"% potential"]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-600",children:"Strengths:"}),i.jsx("ul",{className:"text-muted-foreground ml-2",children:null==(t=e.strengthIndicators)?void 0:t.slice(0,2).map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-600",children:"Career Velocity:"}),i.jsx("div",{className:"text-muted-foreground ml-2",children:e.careerVelocity}),i.jsx("span",{className:"font-medium text-blue-600",children:"Leadership Readiness:"}),i.jsxs("div",{className:"text-muted-foreground ml-2",children:[e.leadershipReadiness,"%"]})]})]})]},s)})})})]})]})})(m)}),i.jsx(pn,{value:"leadership_gap_analysis",className:"mt-6",children:(e=>{var s,t,a,r,n,l;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-red-600",children:(null==(s=e.gapAnalysis)?void 0:s.totalLeadershipGaps)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Gaps"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(null==(t=e.gapAnalysis)?void 0:t.criticalGaps)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Critical Gaps"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:(null==(a=e.gapAnalysis)?void 0:a.averageTimeToFill)||"N/A"}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Time to Fill"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:(null==(r=e.gapAnalysis)?void 0:r.gapImpactRating)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Impact Rating"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Critical Leadership Gaps"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(n=e.leadershipGaps)?void 0:n.map((e,s)=>{var t;return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.role}),i.jsx(zn,{variant:"critical"===e.gapSeverity?"destructive":"high"===e.gapSeverity?"default":"secondary",children:e.gapSeverity})]}),i.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:[e.department," • Need ",e.requiredCount,", Have ",e.currentCount]}),i.jsx("div",{className:"text-sm text-primary mb-2",children:e.impactOnBusiness}),i.jsxs("div",{className:"text-xs text-orange-600",children:["Urgency: ",null==(t=e.urgencyToFill)?void 0:t.replace(/_/g," ")]})]},s)})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Closure Strategies"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:null==(l=e.closureStrategies)?void 0:l.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.strategy}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Bi,{value:e.successProbability,className:"w-16"}),i.jsxs("span",{className:"text-xs",children:[e.successProbability,"%"]})]})]}),i.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["Timeline: ",e.timeframe]}),i.jsx("div",{className:"flex items-center justify-between text-sm",children:i.jsxs(zn,{variant:"high"===e.investment?"destructive":"medium"===e.investment?"default":"secondary",children:[e.investment," investment"]})})]},s))})})]})]})]})})(m)})]})]});var j,y,b,N,w,_,k},_y=()=>{const[e,s]=ce.useState("bias_detection"),[t,a]=ce.useState(""),[r,n]=ce.useState(!1),[l,c]=ce.useState(null),o=[{value:"bias_detection",label:"Bias Detection",icon:It},{value:"diversity_metrics",label:"Diversity Metrics",icon:Ms},{value:"inclusion_sentiment",label:"Inclusion Sentiment",icon:nt},{value:"pay_equity_analysis",label:"Pay Equity",icon:Xs}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex gap-4",children:[i.jsxs(bn,{value:e,onValueChange:s,children:[i.jsx(wn,{className:"w-64",children:i.jsx(Nn,{})}),i.jsx(Sn,{children:o.map(e=>i.jsx(En,{value:e.value,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(e.icon,{className:"h-4 w-4"}),e.label]})},e.value))})]}),i.jsx(nn,{onClick:async()=>{n(!0);try{const{data:s,error:a}=await en.functions.invoke("ai-diversity-inclusion",{body:{analysisType:e,departmentFilter:t||void 0}});if(a)throw a;c(s),Pe({title:"Analysis Complete",description:"D&I analysis completed successfully!"})}catch(s){Pe({title:"Analysis Failed",description:"Failed to complete D&I analysis",variant:"destructive"})}finally{n(!1)}},disabled:r,children:r?"Analyzing...":"Run Analysis"})]}),l&&i.jsx("div",{className:"space-y-6",children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsx("div",{className:"text-2xl font-bold",children:"Analysis Complete"})})})})})]})},ky=()=>{Hj();const e=(()=>{const[e,s]=ce.useState({totalEmployees:0,activeEmployees:0,roleAssignmentRate:0,dataCompleteness:0,skillsAssessmentRate:0,avgPerformanceRating:0,loading:!0});return ce.useEffect(()=>{(async()=>{try{const{data:e,count:t}=await en.from("xlsmart_employees").select("*",{count:"exact"}),a=(null==e?void 0:e.filter(e=>e.is_active).length)||0,r=(null==e?void 0:e.filter(e=>e.standard_role_id||e.ai_suggested_role_id).length)||0,n=t?Math.round(r/t*100):0,i=(null==e?void 0:e.filter(e=>e.first_name&&e.last_name&&e.email&&e.current_position&&(e.current_department||e.current_position)).length)||0,l=t?Math.round(i/t*100):0,{data:c}=await en.from("xlsmart_skill_assessments").select("employee_id"),o=new Set(null==c?void 0:c.map(e=>e.employee_id)).size,d=t?Math.round(o/t*100):0,m=(null==e?void 0:e.length)>0?e.reduce((e,s)=>e+(s.performance_rating||0),0)/e.length:0;s({totalEmployees:t||0,activeEmployees:a,roleAssignmentRate:n,dataCompleteness:l,skillsAssessmentRate:d,avgPerformanceRating:Math.round(10*m)/10,loading:!1})}catch(e){s(e=>({...e,loading:!1}))}})()},[]),e})(),[s,t]=ce.useState(null),a=[{value:e.loading?"...":e.totalEmployees.toLocaleString(),label:"Total Employees",icon:Wt,color:"text-blue-600",description:"Active employee records"},{value:e.loading?"...":`${e.roleAssignmentRate}%`,label:"Role Assignment Rate",icon:Ut,color:"text-green-600",description:"Successfully assigned roles"},{value:e.loading?"...":`${e.dataCompleteness}%`,label:"Data Completeness",icon:Ms,color:"text-purple-600",description:"Complete employee profiles"},{value:e.loading?"...":`${e.skillsAssessmentRate}%`,label:"Skills Assessment",icon:Wt,color:"text-orange-600",description:"Completed assessments"}];return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Employee Management"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"Manage employee data, assignments, compensation analytics, and AI insights"})]}),i.jsxs("section",{className:"bg-muted/50 rounded-xl p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Employee Statistics"}),i.jsx("p",{className:"text-muted-foreground",children:"Overview of employee data and management metrics"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:a.map((s,a)=>i.jsx(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>{0===a?t("employee-details"):1===a?window.location.href="/dashboard/roles":2===a?t("employee-details"):3===a&&(window.location.href="/dashboard/skills")},children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br "+(a%4==0?"from-blue-500 to-blue-600":a%4==1?"from-green-500 to-green-600":a%4==2?"from-purple-500 to-purple-600":"from-orange-500 to-orange-600"),children:i.jsx(s.icon,{className:"h-5 w-5 text-white"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:`text-2xl font-bold ${s.color} flex items-center gap-2`,children:[e.loading&&i.jsx(ot,{className:"h-4 w-4 animate-spin"}),s.value]}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:s.label}),i.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})]})})},a))})]}),i.jsxs(hn,{defaultValue:"management",className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-5 lg:w-fit",children:[i.jsxs(xn,{value:"management",className:"flex items-center gap-2",children:[i.jsx(Wt,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Management"})]}),i.jsxs(xn,{value:"compensation",className:"flex items-center gap-2",children:[i.jsx(Xs,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Compensation"})]}),i.jsxs(xn,{value:"engagement",className:"flex items-center gap-2",children:[i.jsx(Rs,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Engagement"})]}),i.jsxs(xn,{value:"succession",className:"flex items-center gap-2",children:[i.jsx(Ut,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Succession"})]}),i.jsxs(xn,{value:"directory",className:"flex items-center gap-2",children:[i.jsx(Ms,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Directory"})]})]}),i.jsx(pn,{value:"management",className:"space-y-6 mt-6",children:i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Employee Upload & Management"}),i.jsx("p",{className:"text-muted-foreground",children:"Upload employee data and manage AI-powered role assignments"})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx($t,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Employee Data Upload"})]})}),i.jsx(yn,{children:i.jsx(Oj,{})})]})]})}),i.jsx(pn,{value:"engagement",className:"space-y-6 mt-6",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Rs,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Employee Engagement Intelligence"})]})}),i.jsx(yn,{children:i.jsx(Ny,{})})]})}),i.jsxs(pn,{value:"succession",className:"space-y-6 mt-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Succession Planning Intelligence"})]})}),i.jsx(yn,{children:i.jsx(wy,{})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Wt,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Diversity & Inclusion Intelligence"})]})}),i.jsx(yn,{children:i.jsx(_y,{})})]})]}),i.jsx(pn,{value:"compensation",className:"space-y-6 mt-6",children:i.jsx(by,{})}),i.jsx(pn,{value:"directory",className:"space-y-6 mt-6",children:i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Employee Directory & Analytics"}),i.jsx("p",{className:"text-muted-foreground",children:"Detailed view of all employees with analysis and recommendations"})]}),i.jsx(fn,{children:i.jsx(yn,{className:"p-0",children:i.jsx(dj,{})})})]})})]}),i.jsx(Cn,{open:"employee-details"===s,onOpenChange:e=>t(e?"employee-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Employee Details"}),i.jsx(dj,{})]})})]})},Sy=()=>{var e,s,t;const[a,r]=ce.useState("role_evolution"),[n,l]=ce.useState(""),[c,o]=ce.useState(!1),[d,m]=ce.useState(null),h=[{value:"role_evolution",label:"Role Evolution",icon:Ut},{value:"redundancy_analysis",label:"Redundancy Analysis",icon:St},{value:"future_prediction",label:"Future Prediction",icon:Zt},{value:"competitiveness_scoring",label:"Competitiveness",icon:Ft}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex gap-4",children:[i.jsxs(bn,{value:a,onValueChange:r,children:[i.jsx(wn,{className:"w-64",children:i.jsx(Nn,{})}),i.jsx(Sn,{children:h.map(e=>i.jsx(En,{value:e.value,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(e.icon,{className:"h-4 w-4"}),e.label]})},e.value))})]}),i.jsx(nn,{onClick:async()=>{o(!0);try{const{data:e,error:s}=await en.functions.invoke("ai-advanced-role-intelligence",{body:{analysisType:a,departmentFilter:n||void 0}});if(s)throw s;m(e),Pe({title:"Analysis Complete",description:"Role intelligence analysis completed!"})}catch(e){Pe({title:"Analysis Failed",description:"Failed to complete role analysis",variant:"destructive"})}finally{o(!1)}},disabled:c,children:c?"Analyzing...":"Run Analysis"})]}),d&&i.jsxs("div",{className:"space-y-6",children:["role_evolution"===a&&d.evolutionOverview&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold",children:d.evolutionOverview.rolesAnalyzed}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Roles Analyzed"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold",children:[d.evolutionOverview.evolutionRate,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Evolution Rate"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold capitalize",children:d.evolutionOverview.disruptionRisk}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Disruption Risk"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold",children:[d.evolutionOverview.adaptationReadiness,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Adaptation Readiness"})]})})]}),d.emergingRoles&&d.emergingRoles.length>0&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Emerging Roles"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:d.emergingRoles.map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("h3",{className:"font-semibold",children:e.roleTitle}),i.jsx(zn,{variant:"outline",children:e.department})]}),i.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[i.jsx("strong",{children:"Timeline:"})," ",e.timeToMarketNeed]}),i.jsxs("p",{className:"text-sm mb-2",children:[i.jsx("strong",{children:"Drivers:"})," ",null==(t=e.emergenceDrivers)?void 0:t.join(", ")]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Key Skills:"})," ",null==(a=e.requiredSkills)?void 0:a.join(", ")]})]},s)})})})]})]}),"future_prediction"===a&&d.futurePrediction&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold",children:[Math.round(100*d.futurePrediction.predictionConfidence),"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Prediction Confidence"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold capitalize",children:d.futurePrediction.disruptionLevel}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Disruption Level"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold",children:d.futurePrediction.newRolesExpected}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"New Roles Expected"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold",children:d.futurePrediction.obsoleteRolesExpected}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Roles at Risk"})]})})]}),i.jsxs(hn,{defaultValue:"future-roles",children:[i.jsxs(un,{children:[i.jsx(xn,{value:"future-roles",children:"Future Roles"}),i.jsx(xn,{value:"transformations",children:"Role Transformations"}),i.jsx(xn,{value:"obsolescence",children:"Obsolescence Risk"})]}),i.jsx(pn,{value:"future-roles",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Predicted Future Roles"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(e=d.futureRoles)?void 0:e.map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("h3",{className:"font-semibold",children:e.predictedRole}),i.jsx(zn,{variant:"outline",children:e.department})]}),i.jsxs("p",{className:"text-sm text-muted-foreground mb-2",children:[i.jsx("strong",{children:"Timeline:"})," ",e.emergenceTimeframe]}),i.jsxs("p",{className:"text-sm mb-2",children:[i.jsx("strong",{children:"Drivers:"})," ",null==(t=e.drivingFactors)?void 0:t.join(", ")]}),i.jsxs("p",{className:"text-sm mb-2",children:[i.jsx("strong",{children:"Skills:"})," ",null==(a=e.requiredSkills)?void 0:a.join(", ")]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Preparation:"})," ",e.preparationStrategy]})]},s)})})})]})}),i.jsx(pn,{value:"transformations",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Role Transformations"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(s=d.roleTransformations)?void 0:s.map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("span",{className:"font-semibold",children:e.currentRole}),i.jsx("span",{className:"text-muted-foreground",children:"→"}),i.jsx("span",{className:"font-semibold text-primary",children:e.transformedRole})]}),i.jsxs("p",{className:"text-sm mb-2",children:[i.jsx("strong",{children:"Drivers:"})," ",null==(t=e.transformationDrivers)?void 0:t.join(", ")]}),i.jsxs("p",{className:"text-sm mb-2",children:[i.jsx("strong",{children:"Skill Gaps:"})," ",null==(a=e.skillGaps)?void 0:a.join(", ")]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Transition Plan:"})," ",e.transitionPlan]})]},s)})})})]})}),i.jsx(pn,{value:"obsolescence",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Obsolescence Risk Analysis"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(t=d.obsolescenceRisk)?void 0:t.map((e,s)=>{var t,a,r;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("h3",{className:"font-semibold",children:e.role}),i.jsxs(zn,{variant:"high"===e.riskLevel?"destructive":"secondary",children:[e.riskLevel," risk"]})]}),i.jsxs("p",{className:"text-sm mb-2",children:[i.jsx("strong",{children:"Risk Factors:"})," ",null==(t=e.obsolescenceFactors)?void 0:t.join(", ")]}),i.jsxs("p",{className:"text-sm mb-2",children:[i.jsx("strong",{children:"Mitigation:"})," ",null==(a=e.mitigationStrategies)?void 0:a.join(", ")]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Transition Options:"})," ",null==(r=e.transitionOptions)?void 0:r.join(", ")]})]},s)})})})]})})]})]}),"redundancy_analysis"===a&&d.redundancyOverview&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold",children:d.redundancyOverview.totalRolesAnalyzed}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Total Roles"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold",children:d.redundancyOverview.redundantRolesIdentified}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Redundant Roles"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold",children:[d.redundancyOverview.overlapScore,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Overlap Score"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold",children:[d.redundancyOverview.optimizationPotential,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Optimization Potential"})]})})]}),d.optimizationPlan&&d.optimizationPlan.length>0&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Optimization Plan"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:d.optimizationPlan.map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsx("h3",{className:"font-semibold mb-2",children:e.phase}),i.jsxs("p",{className:"text-sm mb-2",children:[i.jsx("strong",{children:"Timeline:"})," ",e.timeline]}),i.jsxs("p",{className:"text-sm mb-2",children:[i.jsx("strong",{children:"Actions:"})," ",null==(t=e.actions)?void 0:t.join(", ")]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Expected Outcomes:"})," ",null==(a=e.expectedOutcomes)?void 0:a.join(", ")]})]},s)})})})]})]}),"competitiveness_scoring"===a&&d.competitivenessOverview&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold",children:[d.competitivenessOverview.averageCompetitivenessScore,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Competitiveness"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold capitalize",children:d.competitivenessOverview.marketPositioning}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Market Position"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold capitalize",children:d.competitivenessOverview.talentAttractionRisk}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Talent Risk"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold",children:[d.competitivenessOverview.retentionAdvantage,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Retention Advantage"})]})})]}),d.talentStrategy&&d.talentStrategy.length>0&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Talent Strategy Recommendations"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:d.talentStrategy.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("h3",{className:"font-semibold",children:e.strategy}),i.jsxs(zn,{variant:"high"===e.expectedImpact?"default":"secondary",children:[e.expectedImpact," impact"]})]}),i.jsx("p",{className:"text-sm mb-2",children:e.implementation}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Investment Required:"})," ",e.investmentRequired]})]},s))})})]})]})]})]})},Ey=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(!0),[r,n]=ce.useState(1),[l,c]=ce.useState(10),[o,d]=ce.useState(0);ce.useEffect(()=>{m()},[]);const m=async()=>{try{const{data:e,error:t}=await en.from("xlsmart_standard_roles").select("job_family, role_title, department, experience_range_min, experience_range_max").not("job_family","is",null).order("job_family");if(t)throw t;const a=new Map;null==e||e.forEach(e=>{a.has(e.job_family)||a.set(e.job_family,{roles:[],departments:new Set,totalExperience:0,experienceCount:0});const s=a.get(e.job_family);s.roles.push(e),e.department&&s.departments.add(e.department),null!==e.experience_range_min&&(s.totalExperience+=e.experience_range_min,s.experienceCount++)});const r=Array.from(a.entries()).map(([e,s])=>({job_family:e,role_count:s.roles.length,avg_experience:s.experienceCount>0?Math.round(s.totalExperience/s.experienceCount):0,departments:Array.from(s.departments),sample_roles:s.roles.slice(0,3).map(e=>e.role_title)}));r.sort((e,s)=>s.role_count-e.role_count),s(r),d(r.length)}catch(e){}finally{a(!1)}},h=e.slice((r-1)*l,r*l),u=Math.ceil(o/l);return t?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx(Is,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Role Categories"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[...Array(6)].map((e,s)=>i.jsx(Qi,{className:"h-48 w-full"},s))})]}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx(Is,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Role Categories (Job Families)"}),i.jsxs(zn,{variant:"secondary",children:[o," Categories"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:i.jsx(Is,{className:"h-5 w-5 text-primary"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:o}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:"Total Categories"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-green-500/10",children:i.jsx(Wt,{className:"h-5 w-5 text-green-600"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.reduce((e,s)=>e+s.role_count,0)}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:"Total Roles"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-purple-500/10",children:i.jsx(Ms,{className:"h-5 w-5 text-purple-600"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-purple-600",children:e.length>0?Math.round(e.reduce((e,s)=>e+s.avg_experience,0)/e.length):0}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:"Avg Experience (Years)"})]})]})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Role Categories Breakdown"})}),i.jsx(yn,{children:i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Job Family"}),i.jsx(rl,{children:"Role Count"}),i.jsx(rl,{children:"Avg Experience"}),i.jsx(rl,{children:"Departments"}),i.jsx(rl,{children:"Sample Roles"})]})}),i.jsx(tl,{children:h.map(e=>i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-primary/10 rounded-lg",children:i.jsx(Is,{className:"h-4 w-4 text-primary"})}),i.jsx("div",{children:i.jsx("div",{className:"font-medium",children:e.job_family})})]})}),i.jsx(nl,{children:i.jsx(zn,{variant:"secondary",children:e.role_count})}),i.jsx(nl,{children:i.jsxs("span",{className:"font-medium",children:[e.avg_experience," years"]})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.departments.slice(0,2).map((e,s)=>i.jsx(zn,{variant:"outline",className:"text-xs",children:e},s)),e.departments.length>2&&i.jsxs(zn,{variant:"outline",className:"text-xs",children:["+",e.departments.length-2," more"]})]})}),i.jsx(nl,{children:i.jsx("div",{className:"space-y-1",children:e.sample_roles.map((e,s)=>i.jsx("div",{className:"text-sm text-muted-foreground",children:e},s))})})]},e.job_family))})]})})]}),i.jsx(il,{currentPage:r,totalPages:u,pageSize:l,totalItems:o,onPageChange:n,onPageSizeChange:e=>{c(e),n(1)}})]})},Ty=()=>{const[e,s]=ce.useState(null),[t,a]=ce.useState(!0),[r,n]=ce.useState(1),[l,c]=ce.useState(10);ce.useEffect(()=>{o()},[]);const o=async()=>{try{const{data:e,error:t}=await en.from("xlsmart_role_catalogs").select("*").order("created_at",{ascending:!1});if(t)throw t;const{count:a}=await en.from("xlsmart_role_mappings").select("*",{count:"exact",head:!0}),r=e||[],n=r.length,i=r.filter(e=>"completed"===e.upload_status).length,l=r.filter(e=>"processing"===e.upload_status||"pending"===e.upload_status).length,c=r.reduce((e,s)=>e+(s.total_roles||0),0),o=a||0,d=c>0?Math.round(o/c*100):0,m=r.slice(0,20).map(e=>({id:e.id,catalog_name:e.file_name||`Catalog ${e.id.slice(-8)}`,total_roles:e.total_roles||0,processed_roles:e.processed_roles||0,upload_status:e.upload_status||"pending",mapping_accuracy:e.mapping_accuracy||0,created_at:e.created_at||"",completion_rate:e.total_roles>0?Math.round(e.processed_roles/e.total_roles*100):0}));s({total_catalogs:n,completed_catalogs:i,pending_catalogs:l,total_roles_uploaded:c,total_roles_mapped:o,overall_rate:d,recent_uploads:m})}catch(e){}finally{a(!1)}},d=e=>{switch(e){case"completed":return i.jsxs(zn,{className:"bg-green-100 text-green-800 border-green-200",children:[i.jsx(Gs,{className:"h-3 w-3 mr-1"}),"Completed"]});case"processing":return i.jsxs(zn,{className:"bg-blue-100 text-blue-800 border-blue-200",children:[i.jsx(Ys,{className:"h-3 w-3 mr-1"}),"Processing"]});case"failed":return i.jsxs(zn,{className:"bg-red-100 text-red-800 border-red-200",children:[i.jsx(Bt,{className:"h-3 w-3 mr-1"}),"Failed"]});default:return i.jsxs(zn,{variant:"outline",children:[i.jsx(Ys,{className:"h-3 w-3 mr-1"}),"Pending"]})}};if(t||!e)return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx(Ut,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Standardization Rate"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[...Array(4)].map((e,s)=>i.jsx(Qi,{className:"h-32 w-full"},s))})]});const m=e.recent_uploads.slice((r-1)*l,r*l),h=Math.ceil(e.recent_uploads.length/l);return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[i.jsx(Ut,{className:"h-6 w-6 text-primary"}),i.jsx("h2",{className:"text-2xl font-bold",children:"Role Standardization Rate"}),i.jsxs(zn,{variant:"secondary",children:[e.overall_rate,"% Overall Rate"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-primary/10",children:i.jsx(Wt,{className:"h-5 w-5 text-primary"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:e.total_roles_uploaded.toLocaleString()}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:"Roles Uploaded"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-green-500/10",children:i.jsx(Gs,{className:"h-5 w-5 text-green-600"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:e.total_roles_mapped.toLocaleString()}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:"Roles Mapped"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-blue-500/10",children:i.jsx(Ut,{className:"h-5 w-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:e.completed_catalogs}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:"Completed Catalogs"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-orange-500/10",children:i.jsx(Ys,{className:"h-5 w-5 text-orange-600"})}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:e.pending_catalogs}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:"Pending Catalogs"})]})]})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Overall Standardization Progress"})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium",children:"Standardization Rate"}),i.jsxs("span",{className:"text-sm font-medium",children:[e.overall_rate,"%"]})]}),i.jsx(Bi,{value:e.overall_rate,className:"h-3"}),i.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.total_roles_mapped," out of ",e.total_roles_uploaded," roles have been successfully standardized"]})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Recent Role Catalog Uploads"})}),i.jsx(yn,{children:i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Catalog Name"}),i.jsx(rl,{children:"Total Roles"}),i.jsx(rl,{children:"Processed"}),i.jsx(rl,{children:"Completion %"}),i.jsx(rl,{children:"Accuracy %"}),i.jsx(rl,{children:"Status"}),i.jsx(rl,{children:"Upload Date"})]})}),i.jsx(tl,{children:m.map(e=>i.jsxs(al,{children:[i.jsx(nl,{children:i.jsx("div",{className:"font-medium",children:e.catalog_name})}),i.jsx(nl,{children:i.jsx(zn,{variant:"outline",children:e.total_roles})}),i.jsx(nl,{children:i.jsx("span",{className:"font-medium",children:e.processed_roles})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Bi,{value:e.completion_rate,className:"w-16 h-2"}),i.jsxs("span",{className:"text-sm font-medium",children:[e.completion_rate,"%"]})]})}),i.jsx(nl,{children:i.jsxs("span",{className:"font-medium",children:[Math.round(e.mapping_accuracy),"%"]})}),i.jsx(nl,{children:d(e.upload_status)}),i.jsx(nl,{children:i.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()})})]},e.id))})]})})]}),i.jsx(il,{currentPage:r,totalPages:h,pageSize:l,totalItems:e.recent_uploads.length,onPageChange:n,onPageSizeChange:e=>{c(e),n(1)}})]})},Cy=()=>{Hj();const e=(()=>{const[e,s]=ce.useState({totalRoles:0,mappingAccuracy:0,standardizationRate:0,roleCategories:0,totalMappings:0,activeCatalogs:0,loading:!0});return ce.useEffect(()=>{(async()=>{try{const{count:e}=await en.from("xlsmart_standard_roles").select("*",{count:"exact",head:!0}),{data:t}=await en.from("xlsmart_standard_roles").select("job_family").not("job_family","is",null),a=new Set(null==t?void 0:t.map(e=>e.job_family)).size,{data:r,count:n}=await en.from("xlsmart_role_mappings").select("mapping_confidence",{count:"exact"}),i=(null==r?void 0:r.length)>0?r.reduce((e,s)=>e+(s.mapping_confidence||0),0)/r.length:0,{count:l}=await en.from("xlsmart_role_catalogs").select("*",{count:"exact",head:!0}).eq("upload_status","completed"),{data:c}=await en.from("xlsmart_role_catalogs").select("total_roles, processed_roles").eq("upload_status","completed"),o=(null==c?void 0:c.reduce((e,s)=>e+(s.total_roles||0),0))||0,d=(null==c||c.reduce((e,s)=>e+(s.processed_roles||0),0),o>0?Math.round(n/o*100):n>0?100:0);s({totalRoles:e||0,mappingAccuracy:Math.round(i),standardizationRate:d,roleCategories:a,totalMappings:n||0,activeCatalogs:l||0,loading:!1})}catch(e){s(e=>({...e,loading:!1}))}})()},[]),e})(),[s,t]=ce.useState(null),a=[{value:e.loading?"...":e.totalRoles.toString(),label:"Standardized Roles",icon:Is,color:"text-blue-600",description:"Total role definitions"},{value:e.loading?"...":`${e.mappingAccuracy}%`,label:"Mapping Accuracy",icon:Ft,color:"text-green-600",description:"Role assignment precision"},{value:e.loading?"...":`${e.standardizationRate}%`,label:"Standardization Rate",icon:Ms,color:"text-purple-600",description:"Successfully standardized"},{value:e.loading?"...":e.roleCategories.toString(),label:"Role Categories",icon:Is,color:"text-orange-600",description:"Distinct role families"}];return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Role Management"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"Standardize roles, manage assignments, analyze role distribution, and AI-powered intelligence"})]}),i.jsxs("section",{className:"bg-muted/50 rounded-xl p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Role Statistics"}),i.jsx("p",{className:"text-muted-foreground",children:"Overview of role standardization and management metrics"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:a.map((s,a)=>i.jsx(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>{0===a?t("roles-details"):1===a?t("accuracy-details"):2===a?t("standardization-details"):3===a&&t("categories-details")},children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br "+(a%4==0?"from-blue-500 to-blue-600":a%4==1?"from-green-500 to-green-600":a%4==2?"from-purple-500 to-purple-600":"from-orange-500 to-orange-600"),children:i.jsx(s.icon,{className:"h-5 w-5 text-white"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:`text-2xl font-bold ${s.color} flex items-center gap-2`,children:[e.loading&&i.jsx(ot,{className:"h-4 w-4 animate-spin"}),s.value]}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:s.label}),i.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})]})})},a))})]}),i.jsxs(hn,{defaultValue:"standardization",className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-4 lg:w-fit",children:[i.jsxs(xn,{value:"standardization",className:"flex items-center gap-2",children:[i.jsx($t,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Standardization"})]}),i.jsxs(xn,{value:"assignment",className:"flex items-center gap-2",children:[i.jsx(Ft,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Assignment"})]}),i.jsxs(xn,{value:"intelligence",className:"flex items-center gap-2",children:[i.jsx(Rs,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"AI Intelligence"})]}),i.jsxs(xn,{value:"directory",className:"flex items-center gap-2",children:[i.jsx(Ms,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Directory"})]})]}),i.jsx(pn,{value:"standardization",className:"space-y-6 mt-6",children:i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Role Standardization"}),i.jsx("p",{className:"text-muted-foreground",children:"Upload and standardize role catalogs using AI-powered processing"})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx($t,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Role Upload & Standardization"})]})}),i.jsx(yn,{children:i.jsx(_f,{})})]})]})}),i.jsx(pn,{value:"assignment",className:"space-y-6 mt-6",children:i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Bulk Role Assignment"}),i.jsx("p",{className:"text-muted-foreground",children:"Automatically assign standardized roles to employees using AI"})]}),i.jsx(Bj,{})]})}),i.jsx(pn,{value:"intelligence",className:"space-y-6 mt-6",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Rs,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Advanced Role Intelligence"})]})}),i.jsx(yn,{children:i.jsx(Sy,{})})]})}),i.jsx(pn,{value:"directory",className:"space-y-6 mt-6",children:i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Role Directory & Analytics"}),i.jsx("p",{className:"text-muted-foreground",children:"Detailed view of all standardized roles with analysis and recommendations"})]}),i.jsx(fn,{children:i.jsx(yn,{className:"p-0",children:i.jsx(hj,{})})})]})})]}),i.jsx(Cn,{open:"roles-details"===s,onOpenChange:e=>t(e?"roles-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Standardized Roles Details"}),i.jsx(hj,{})]})}),i.jsx(Cn,{open:"accuracy-details"===s,onOpenChange:e=>t(e?"accuracy-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Mapping Accuracy Details"}),i.jsx(uj,{})]})}),i.jsx(Cn,{open:"standardization-details"===s,onOpenChange:e=>t(e?"standardization-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Standardization Rate Details"}),i.jsx(Ty,{})]})}),i.jsx(Cn,{open:"categories-details"===s,onOpenChange:e=>t(e?"categories-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Role Categories Details"}),i.jsx(Ey,{})]})})]})},Ay=({onAnalysisComplete:e})=>{var s,t,a,r;const[n,l]=ce.useState("jd_optimization"),[c,o]=ce.useState(""),[d,m]=ce.useState(""),[h,u]=ce.useState(!1),[x,p]=ce.useState(null),[f,g]=ce.useState(new Set),[v,j]=ce.useState([]),[y,b]=ce.useState(""),[N,w]=ce.useState(null),[_,k]=ce.useState(!1),[S,E]=ce.useState(null),[T,C]=ce.useState([]),A=[{value:"jd_optimization",label:"JD Optimization",icon:Ft},{value:"market_alignment",label:"Market Alignment",icon:Ut},{value:"skills_mapping",label:"Skills Mapping",icon:Rs},{value:"compliance_analysis",label:"Compliance Analysis",icon:It}];ce.useEffect(()=>{R().catch(e=>{w("Failed to load past results")})},[]);const R=async()=>{try{const{data:e,error:s}=await en.from("ai_analysis_results").select("*").eq("function_name","ai-job-descriptions-intelligence").order("created_at",{ascending:!1}).limit(50);if(s)throw s;j(e||[])}catch(e){j([])}},I=async()=>{u(!0),w(null);try{const{data:s,error:t}=await en.functions.invoke("ai-job-descriptions-intelligence",{body:{analysisType:n,departmentFilter:c||void 0,roleFilter:d||void 0}});if(t)throw t;p(s),b(""),null==e||e(s),xr.success("Job descriptions analysis completed!"),await R()}catch(s){w((null==s?void 0:s.message)||"Failed to complete analysis"),xr.error(`Failed to complete analysis: ${(null==s?void 0:s.message)||"Unknown error"}`)}finally{u(!1)}},P=async e=>{l(e);const s=v.find(s=>s.analysis_type===e);s?(p(s.analysis_result),b(s.id),xr.success("Loaded cached analysis results")):(p(null),b(""))},D=e=>{if("new"===e)return p(null),b(""),void xr.success("Ready for new analysis");const s=v.find(s=>s.id===e);s&&(p(s.analysis_result),b(e),l(s.analysis_type),xr.success("Loaded past analysis result"))},M=async()=>{S&&0!==T.length?(k(!1),await(async(e,s,t)=>{var a;g(s=>new Set([...s,e]));try{if(e.startsWith("job-")){if(xr.success(`✅ Optimization applied to "${t}"! ${s.length} recommendations have been processed and applied.`),x&&x.recommendations){const a={...x};if(a.recommendations=a.recommendations.map(a=>{var r,n;if(a.jobId&&a.jobId===e||a.title===t||a.role===t){const e=(null==(r=a.issues)?void 0:r.filter(e=>!s.some(s=>e.toLowerCase().includes(s.toLowerCase().substring(0,20)))))||[],t=(null==(n=a.recommendations)?void 0:n.filter(e=>!s.includes(e)))||[],i=15,l=Math.min(s.length*i,40),c=Math.min((a.currentScore||60)+l,95);let o=a.priority;return c>=80?o="low":c>=65&&(o="medium"),{...a,issues:e,recommendations:t,currentScore:c,priority:o,lastUpdated:(new Date).toISOString(),appliedRecommendations:[...a.appliedRecommendations||[],...s]}}return a}),a.summary){const e=a.recommendations.reduce((e,s)=>{var t;return e+((null==(t=s.recommendations)?void 0:t.length)||0)},0),s=a.recommendations.reduce((e,s)=>e+(s.currentScore||0),0)/a.recommendations.length;a.summary.averageCompleteness=Math.round(s),a.summary.averageClarity=Math.round(s+5),a.summary.improvementAreas=e}p(a)}return void(await new Promise(e=>setTimeout(e,1500)))}const{data:r,error:n}=await en.functions.invoke("ai-job-description-fix",{body:{jobDescriptionId:e,recommendations:s}});if(n)throw n;xr.success(`Job description improved! ${(null==(a=r.improvementsMade)?void 0:a.length)||0} improvements applied.`),await I()}catch(r){xr.error("Failed to fix job description. Please try again.")}finally{g(s=>{const t=new Set(s);return t.delete(e),t})}})(S.jobId,T,S.title)):xr.error("Please select at least one recommendation to apply.")},O=e=>{var s,t,a,r,n;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:(null==(s=e.summary)?void 0:s.totalAnalyzed)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Job Descriptions"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-secondary",children:[(null==(t=e.summary)?void 0:t.averageCompleteness)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Completeness"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-accent",children:[(null==(a=e.summary)?void 0:a.averageClarity)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Avg Clarity"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:(null==(r=e.summary)?void 0:r.improvementOpportunities)||0}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Improvement Areas"})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Optimization Recommendations"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(n=e.optimizationRecommendations)?void 0:n.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.role}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Bi,{value:e.currentScore,className:"w-20"}),i.jsx(zn,{variant:"high"===e.priority?"destructive":"medium"===e.priority?"default":"secondary",children:e.priority}),i.jsxs(nn,{size:"sm",variant:"outline",onClick:()=>{return s=e,t=e.recommendations,a=e.title||e.role,E({jobId:s.jobId||`job-${Math.random()}`,title:a||s.role||s.title,recommendations:t||[]}),C([]),void k(!0);var s,t,a},disabled:f.has(e.jobId||`job-${s}`)||h,className:"ml-2",children:[i.jsx(Jt,{className:"h-3 w-3 mr-1"}),f.has(e.jobId||`job-${s}`)?"Fixing...":"Fix"]})]})]}),i.jsxs("div",{className:"space-y-2",children:[e.issues&&e.issues.length>0&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-red-600",children:"Issues:"}),i.jsx("ul",{className:"text-sm text-muted-foreground ml-4",children:e.issues.map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]}),e.recommendations&&e.recommendations.length>0&&i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-green-600",children:"Recommendations:"}),i.jsx("ul",{className:"text-sm text-muted-foreground ml-4",children:e.recommendations.map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]}),e.appliedRecommendations&&e.appliedRecommendations.length>0&&i.jsxs("div",{children:[i.jsxs("span",{className:"text-sm font-medium text-blue-600 flex items-center gap-1",children:[i.jsx(Gs,{className:"h-3 w-3"}),"Applied Improvements:"]}),i.jsx("ul",{className:"text-sm text-blue-600/80 ml-4",children:e.appliedRecommendations.map((e,s)=>i.jsxs("li",{className:"flex items-center gap-1",children:[i.jsx(Gs,{className:"h-2 w-2 mt-1"}),e]},s))})]}),e.lastUpdated&&i.jsxs("div",{className:"text-xs text-muted-foreground mt-2 pt-2 border-t",children:["Last updated: ",new Date(e.lastUpdated).toLocaleString()]})]})]},s))})})]})]})},F=e=>{var s,t,a,r,n,l;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-primary",children:[(null==(s=e.skillsAlignment)?void 0:s.overallMatch)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Overall Match"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-red-600",children:[(null==(t=e.skillsAlignment)?void 0:t.criticalSkillsGap)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Critical Gaps"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(null==(a=e.skillsAlignment)?void 0:a.emergingSkillsReadiness)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Future Ready"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[(null==(r=e.skillsAlignment)?void 0:r.skillsInflation)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Skills Inflation"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Skills Analysis by Role"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(n=e.skillsAnalysis)?void 0:n.slice(0,5).map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsx("h4",{className:"font-medium mb-2",children:e.role}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-blue-600",children:"Required:"}),i.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:null==(t=e.requiredSkills)?void 0:t.slice(0,3).map((e,s)=>i.jsx(zn,{variant:"outline",className:"text-xs",children:e},s))})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-red-600",children:"Gaps:"}),i.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:null==(a=e.skillsGap)?void 0:a.slice(0,3).map((e,s)=>i.jsx(zn,{variant:"destructive",className:"text-xs",children:e},s))})]})]})]},s)})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Emerging Skills"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:null==(l=e.emergingSkills)?void 0:l.map((e,s)=>i.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium",children:e.skill}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.recommendation})]}),i.jsxs("div",{className:"text-right",children:[i.jsx(zn,{variant:"high"===e.importance?"destructive":"medium"===e.importance?"default":"secondary",children:e.importance}),i.jsxs("div",{className:"text-sm text-muted-foreground mt-1",children:[e.currentCoverage,"% coverage"]})]})]},s))})})]})]})]})},L=e=>{var s,t,a,r,n,l;return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-primary",children:[(null==(s=e.complianceScore)?void 0:s.overall)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Overall Score"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(null==(t=e.complianceScore)?void 0:t.legalCompliance)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Legal"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[(null==(a=e.complianceScore)?void 0:a.inclusivity)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Inclusivity"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-purple-600",children:[(null==(r=e.complianceScore)?void 0:r.accessibility)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Accessibility"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-orange-600",children:[(null==(n=e.complianceScore)?void 0:n.equalOpportunity)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Equal Opportunity"})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Compliance Issues"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(l=e.complianceIssues)?void 0:l.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.role}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(zn,{variant:"high"===e.severity?"destructive":"medium"===e.severity?"default":"secondary",children:e.severity}),"high"===e.severity?i.jsx(Bt,{className:"h-4 w-4 text-red-600"}):"medium"===e.severity?i.jsx(Bt,{className:"h-4 w-4 text-orange-600"}):i.jsx(Gs,{className:"h-4 w-4 text-green-600"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{children:[i.jsxs("span",{className:"text-sm font-medium text-red-600",children:[e.issueType,":"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-sm font-medium text-green-600",children:"Recommendation:"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.recommendation})]})]})]},s))})})]})]})};try{return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"mb-4 p-4 bg-muted/30 rounded-lg border",children:[i.jsxs("h3",{className:"text-lg font-semibold mb-2 flex items-center gap-2",children:[i.jsx(Rs,{className:"h-5 w-5 text-primary"}),"Job Description Intelligence"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Analyze job descriptions for optimization, market alignment, skills mapping, and compliance."})]}),N&&i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("div",{className:"flex items-center gap-2 text-red-800",children:[i.jsx(Bt,{className:"h-4 w-4"}),i.jsx("span",{className:"font-medium",children:"Error:"}),i.jsx("span",{children:N})]})}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs(bn,{value:n,onValueChange:P,children:[i.jsx(wn,{className:"w-full sm:w-64",children:i.jsx(Nn,{placeholder:"Select analysis type"})}),i.jsx(Sn,{children:A.map(e=>i.jsx(En,{value:e.value,children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(e.icon,{className:"h-4 w-4"}),e.label]})},e.value))})]}),i.jsxs(bn,{value:y,onValueChange:D,children:[i.jsx(wn,{className:"w-full sm:w-64",children:i.jsx(Nn,{placeholder:"Load past analysis"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"new",children:"New Analysis"}),v.map(e=>{var s;return i.jsx(En,{value:e.id,children:i.jsxs("div",{className:"flex flex-col",children:[i.jsx("span",{className:"font-medium",children:null==(s=A.find(s=>s.value===e.analysis_type))?void 0:s.label}),i.jsxs("span",{className:"text-xs text-muted-foreground",children:[new Date(e.created_at).toLocaleDateString()," ",new Date(e.created_at).toLocaleTimeString()]})]})},e.id)})]})]}),i.jsxs(bn,{value:c,onValueChange:o,disabled:!0,children:[i.jsx(wn,{className:"w-full sm:w-48 opacity-50",children:i.jsx(Nn,{placeholder:"All Departments (Filtering Coming Soon)"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"all",children:"All Departments"}),i.jsx(En,{value:"Engineering",children:"Engineering"}),i.jsx(En,{value:"Marketing",children:"Marketing"}),i.jsx(En,{value:"Sales",children:"Sales"}),i.jsx(En,{value:"HR",children:"HR"}),i.jsx(En,{value:"Finance",children:"Finance"})]})]}),i.jsx(nn,{onClick:I,disabled:h,className:"w-full sm:w-auto",children:h?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(tt,{className:"h-4 w-4 mr-2"}),y?"Run New Analysis":"Analyze Job Descriptions"]})})]}),y&&i.jsx("div",{className:"bg-muted/50 border border-border rounded-lg p-3",children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[i.jsx(Gs,{className:"h-4 w-4 text-green-600"}),"Viewing cached result from ",new Date((null==(s=v.find(e=>e.id===y))?void 0:s.created_at)||"").toLocaleString()]})}),x?i.jsxs(hn,{value:n,onValueChange:P,children:[i.jsx(un,{className:"grid w-full grid-cols-4",children:A.map(e=>i.jsxs(xn,{value:e.value,className:"flex items-center gap-2",children:[i.jsx(e.icon,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:e.label})]},e.value))}),i.jsx(pn,{value:"jd_optimization",className:"mt-6",children:O(x)}),i.jsx(pn,{value:"market_alignment",className:"mt-6",children:(z=x,i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-primary",children:[(null==(U=z.marketAlignment)?void 0:U.overallScore)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Overall Score"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-secondary",children:[(null==(B=z.marketAlignment)?void 0:B.industryStandards)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Industry Standards"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-accent",children:[(null==($=z.marketAlignment)?void 0:$.competitivePositioning)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Competitive Edge"})]})}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-4",children:[i.jsxs("div",{className:"text-2xl font-bold text-green-600",children:[(null==(H=z.marketAlignment)?void 0:H.salaryAlignment)||0,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Salary Alignment"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Role Analysis"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(V=z.roleAnalysis)?void 0:V.slice(0,5).map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.role}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Bi,{value:e.marketAlignment,className:"w-20"}),i.jsxs("span",{className:"text-sm font-medium",children:[e.marketAlignment,"%"]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-green-600",children:"Strengths:"}),i.jsx("ul",{className:"text-muted-foreground ml-2",children:null==(t=e.strengthAreas)?void 0:t.slice(0,2).map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-orange-600",children:"Improvements:"}),i.jsx("ul",{className:"text-muted-foreground ml-2",children:null==(a=e.improvementAreas)?void 0:a.slice(0,2).map((e,s)=>i.jsxs("li",{children:["• ",e]},s))})]})]})]},s)})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Industry Trends"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:null==(G=z.industryTrends)?void 0:G.map((e,s)=>i.jsxs("div",{className:"border-l-4 border-primary pl-4",children:[i.jsx("h4",{className:"font-medium",children:e.trend}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.impact}),i.jsx("p",{className:"text-sm text-primary mt-1",children:e.recommendation})]},s))})})]})]})]}))}),i.jsx(pn,{value:"skills_mapping",className:"mt-6",children:F(x)}),i.jsx(pn,{value:"compliance_analysis",className:"mt-6",children:L(x)})]}):i.jsxs("div",{className:"text-center p-8 bg-muted/30 rounded-lg border",children:[i.jsx(Rs,{className:"h-12 w-12 mx-auto text-muted-foreground mb-4"}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Analysis Results"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:'Click "Analyze Job Descriptions" to start your first analysis.'}),i.jsx(nn,{onClick:I,disabled:h,className:"mt-2",children:h?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(tt,{className:"h-4 w-4 mr-2"}),"Start Analysis"]})})]}),i.jsx(Cn,{open:_,onOpenChange:k,children:i.jsxs(Pn,{className:"max-w-2xl max-h-[80vh]",children:[i.jsx(Dn,{children:i.jsxs(On,{className:"flex items-center gap-2",children:[i.jsx(Jt,{className:"h-5 w-5"}),"Apply Recommendations - ",null==S?void 0:S.title]})}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-sm text-muted-foreground",children:"Select the recommendations you want to apply to this job description:"}),i.jsx(wi,{className:"max-h-[400px] pr-4",children:i.jsx("div",{className:"space-y-3",children:null==(t=null==S?void 0:S.recommendations)?void 0:t.map((e,s)=>i.jsxs("div",{className:"flex items-start space-x-3 p-3 border rounded-lg",children:[i.jsx(Dj,{id:`rec-${s}`,checked:T.includes(e),onCheckedChange:()=>(e=>{C(s=>s.includes(e)?s.filter(s=>s!==e):[...s,e])})(e),className:"mt-1"}),i.jsx("div",{className:"flex-1",children:i.jsx("label",{htmlFor:`rec-${s}`,className:"text-sm font-medium cursor-pointer block",children:e})})]},s))})}),i.jsxs("div",{className:"flex items-center justify-between pt-4 border-t",children:[i.jsxs("div",{className:"text-sm text-muted-foreground",children:[T.length," of ",(null==(a=null==S?void 0:S.recommendations)?void 0:a.length)||0," recommendations selected"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(nn,{variant:"outline",onClick:()=>k(!1),children:"Cancel"}),i.jsx(nn,{onClick:()=>{(null==S?void 0:S.recommendations)&&C([...S.recommendations])},variant:"secondary",disabled:T.length===(null==(r=null==S?void 0:S.recommendations)?void 0:r.length),children:"Select All"}),i.jsxs(nn,{onClick:M,disabled:0===T.length,className:"min-w-[100px]",children:[i.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Apply (",T.length,")"]})]})]})]})]})})]})}catch(q){return i.jsxs("div",{className:"p-8 text-center",children:[i.jsx("div",{className:"text-red-600 mb-4",children:i.jsx(Bt,{className:"h-12 w-12 mx-auto"})}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Component Error"}),i.jsx("p",{className:"text-muted-foreground",children:"There was an error rendering the intelligence component. Please try refreshing the page."}),i.jsxs("p",{className:"text-sm text-red-600 mt-2",children:["Error: ",q instanceof Error?q.message:"Unknown error"]})]})}var z,U,B,$,H,V,G},Ry=({jd:e})=>{const s=({data:e,className:s=""})=>i.jsx("div",{className:"overflow-x-auto",children:i.jsx("table",{className:`w-full border-collapse border border-gray-300 text-xs sm:text-sm ${s} mb-4 min-w-full`,children:i.jsx("tbody",{children:e.map((s,t)=>i.jsx("tr",{children:s.map((s,a)=>i.jsx("td",{className:"border border-gray-300 p-2 sm:p-3 "+(0===t?"bg-gray-100 font-bold text-gray-800":0===a&&""!==s?"bg-gray-50 font-semibold text-gray-700":"text-gray-600"),style:{width:2===e[0].length?0===a?"35%":"65%":3===e[0].length?0===a?"25%":"37.5%":"auto",verticalAlign:"top",lineHeight:"1.4",minWidth:3===e[0].length?"120px":"auto"},children:s.split("\n").map((e,s)=>i.jsx("div",{className:"mb-1 last:mb-0 break-words",children:e},s))},a))},t))})})}),t=e.job_identity||{},a=e.key_contacts||{},r=e.competencies||{},n=r.functional||{},l=r.leadership||{};return i.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 sm:p-6 bg-white max-h-[600px] overflow-y-auto shadow-sm",children:[i.jsxs("div",{className:"text-center mb-6 sm:mb-8",children:[i.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-800 mb-2",children:"JOB DESCRIPTION"}),i.jsx("div",{className:"w-12 sm:w-16 h-1 bg-blue-500 mx-auto rounded"})]}),i.jsxs("div",{className:"space-y-4 sm:space-y-6",children:[i.jsx(s,{data:[["Job Identity",""],["Position Title",t.positionTitle||e.title],["Directorate",t.directorate||"-"],["Division",t.division||"-"],["Department",t.department||"-"],["Direct Supervisor",t.directSupervisor||"-"],["Direct Subordinate",Array.isArray(t.directSubordinate)&&t.directSubordinate.length>0?t.directSubordinate.map((e,s)=>`${s+1}. ${e}`).join("\n"):"-"]]}),i.jsx(s,{data:[["Job Purposes",""],["",e.summary||"To be defined based on role requirements and organizational needs."]]}),i.jsx(s,{data:[["Main Responsibility",""],["",e.responsibilities&&e.responsibilities.length>0?e.responsibilities.map((e,s)=>`${s+1}. ${e}`).join("\n"):"1. Lead the formulation and execution of strategic responsibilities\n2. Ensure end-to-end operational management\n3. Drive performance optimization and efficiency\n4. Ensure regulatory compliance and governance"]]}),i.jsx(s,{data:[["Key Output",""],["",e.required_qualifications&&e.required_qualifications.length>0?e.required_qualifications.map(e=>`• ${e}`).join("\n"):"• Strategic plans and performance reports\n• Operational efficiency metrics\n• Regulatory compliance documentation\n• Stakeholder engagement outcomes"]]}),i.jsx(s,{data:[["Key Contacts & Relationship","",""],["","Internal","External"],["",a.internal&&a.internal.length>0?a.internal.map((e,s)=>`${s+1}. ${e}`).join("\n"):"1. Senior Management\n2. Department Heads\n3. Team Members\n4. Support Functions",a.external&&a.external.length>0?a.external.map((e,s)=>`${s+1}. ${e}`).join("\n"):"1. Regulatory bodies\n2. Industry partners\n3. Service providers\n4. Stakeholders"]]}),i.jsx(s,{data:[["Functional Competency","Requirements"],["Academy Qualifications",n.academyQualifications||"Bachelor's degree in relevant field"],["Professional Experience",n.professionalExperience||"Minimum 3-5 years relevant experience"],["Certification/License",n.certificationLicense||"Professional certifications as required"],["Expertise",n.expertise?n.expertise.join(", "):"Domain-specific technical skills"]]}),i.jsx(s,{data:[["Leadership Competency","Level"],["Strategic Accountability",l.strategicAccountability||"Mastery"],["Customer Centric",l.customerCentric||"Mastery"],["Coalition Building",l.coalitionBuilding||"Mastery"],["People First",l.peopleFirst||"Mastery"],["Agile Leadership",l.agileLeadership||"Mastery"],["Result Driven",l.resultDriven||"Mastery"],["Technology Savvy",l.technologySavvy||"Mastery"]]})]})]})},Iy=({statusFilters:e,onActionPerformed:s})=>{var t,a,r,n,l,c,o,d,m,h,u,x,p;const{toast:f}=De(),[g,v]=ce.useState([]),[j,y]=ce.useState(!0),[b,N]=ce.useState(null),[w,_]=ce.useState(null);ce.useEffect(()=>{k()},[e]);const k=async()=>{try{y(!0);let s=en.from("xlsmart_job_descriptions").select("*").order("created_at",{ascending:!1});e.includes("all")||(s=1===e.length?s.eq("status",e[0]):s.in("status",e));const{data:t,error:a}=await s;if(a)throw a;const r=(t||[]).map(e=>({...e,summary:e.summary||"",responsibilities:Array.isArray(e.responsibilities)?e.responsibilities:[],required_qualifications:Array.isArray(e.required_qualifications)?e.required_qualifications:[],preferred_qualifications:Array.isArray(e.preferred_qualifications)?e.preferred_qualifications:[],required_skills:Array.isArray(e.required_skills)?e.required_skills:[],preferred_skills:Array.isArray(e.preferred_skills)?e.preferred_skills:[],salary_range_min:e.salary_range_min||0,salary_range_max:e.salary_range_max||0,experience_level:e.experience_level||"",education_level:e.education_level||""}));v(r),r.length>0&&N(r[0])}catch(s){f({title:"Error",description:"Failed to load job descriptions",variant:"destructive"})}finally{y(!1)}},S=e=>{switch(e){case"approved":return"bg-green-50 text-green-700 border-green-200";case"published":return"bg-blue-50 text-blue-700 border-blue-200";case"review":return"bg-amber-50 text-amber-700 border-amber-200";case"draft":default:return"bg-gray-50 text-gray-700 border-gray-200";case"declined":return"bg-red-50 text-red-700 border-red-200"}},E=e=>{switch(e){case"approved":return i.jsx(Gs,{className:"h-3 w-3"});case"published":return i.jsx(Qs,{className:"h-3 w-3"});case"review":return i.jsx(yt,{className:"h-3 w-3"});case"draft":default:return i.jsx(tt,{className:"h-3 w-3"});case"declined":return i.jsx(Ws,{className:"h-3 w-3"})}};if(j)return i.jsxs("div",{className:"flex items-center justify-center p-12",children:[i.jsx(ot,{className:"h-8 w-8 animate-spin mr-3"}),i.jsx("span",{children:"Loading job descriptions..."})]});const T=e=>{(e=>{const s=new _e;let t=20;const a=s.internal.pageSize.getWidth(),r=(e,t,a)=>{let r=t;return e.forEach((e,t)=>{let n=20,i=8;e.forEach((e,t)=>{const r=s.splitTextToSize(e,a[t]-4),n=Math.max(8,6*r.length+4);i=Math.max(i,n)}),e.forEach((e,l)=>{s.rect(n,r,a[l],i),0===t?(s.setFillColor(200,200,200),s.rect(n,r,a[l],i,"F"),s.setFont("helvetica","bold"),s.setFontSize(10)):(s.setFont("helvetica","normal"),s.setFontSize(9));const c=s.splitTextToSize(e,a[l]-4),o=r+6;c.forEach((e,t)=>{s.text(e,n+2,o+6*t)}),n+=a[l]}),r+=i}),r};s.setFontSize(18),s.setFont("helvetica","bold"),s.text("JOB DESCRIPTION",a/2,t,{align:"center"}),t+=15;const n=e.job_identity||{};t=r([["Job Identity",""],["Position Title",n.positionTitle||e.title],["Directorate",n.directorate||"-"],["Division",n.division||"-"],["Department",n.department||"-"],["Direct Supervisor",n.directSupervisor||"-"],["Direct Subordinate",Array.isArray(n.directSubordinate)&&n.directSubordinate.length>0?n.directSubordinate.map((e,s)=>`${s+1}. ${e}`).join("\n"):"-"]],t,[50,120]),t+=10,t=r([["Job Purposes",""],["",e.summary||"To be defined based on role requirements and organizational needs."]],t,[50,120]),t+=10;const i=e.responsibilities||[];t=r([["Main Responsibility",""],["",i.length>0?i.map((e,s)=>`${s+1}. ${e}`).join("\n"):"1. Lead the formulation and execution of strategic responsibilities\n2. Ensure end-to-end operational management\n3. Drive performance optimization and efficiency\n4. Ensure regulatory compliance and governance"]],t,[50,120]),t+=10;const l=e.required_qualifications||[];t=r([["Key Output",""],["",l.length>0?l.map(e=>`• ${e}`).join("\n"):"• Strategic plans and performance reports\n• Operational efficiency metrics\n• Regulatory compliance documentation\n• Stakeholder engagement outcomes"]],t,[50,120]),t+=10,t>s.internal.pageSize.getHeight()-80&&(s.addPage(),t=20);const c=e.key_contacts||{};t=r([["Key Contacts & Relationship","",""],["","Internal","External"],["",c.internal&&c.internal.length>0?c.internal.map((e,s)=>`${s+1}. ${e}`).join("\n"):"1. Senior Management\n2. Department Heads\n3. Team Members\n4. Support Functions",c.external&&c.external.length>0?c.external.map((e,s)=>`${s+1}. ${e}`).join("\n"):"1. Regulatory bodies\n2. Industry partners\n3. Service providers\n4. Stakeholders"]],t,[50,60,60]),t+=10;const o=e.competencies||{},d=o.functional||{},m=o.leadership||{};t>s.internal.pageSize.getHeight()-120&&(s.addPage(),t=20),t=r([["Functional Competency","Requirements"],["Academy Qualifications",d.academyQualifications||"Bachelor's degree in relevant field"],["Professional Experience",d.professionalExperience||"Minimum 3-5 years relevant experience"],["Certification/License",d.certificationLicense||"Professional certifications as required"],["Expertise",d.expertise?d.expertise.join(", "):"Domain-specific technical skills"]],t,[70,100]),t+=10,t=r([["Leadership Competency","Level"],["Strategic Accountability",m.strategicAccountability||"Mastery"],["Customer Centric",m.customerCentric||"Mastery"],["Coalition Building",m.coalitionBuilding||"Mastery"],["People First",m.peopleFirst||"Mastery"],["Agile Leadership",m.agileLeadership||"Mastery"],["Result Driven",m.resultDriven||"Mastery"],["Technology Savvy",m.technologySavvy||"Mastery"]],t,[70,100]);const h=`${e.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}_job_description.pdf`;s.save(h)})(e)};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-foreground",children:(()=>{if(e.includes("all"))return"All Job Descriptions";if(e.length>1)return e.includes("draft")&&e.includes("review")?"Pending Review Job Descriptions":e.includes("approved")&&e.includes("published")?"Approved Job Descriptions":`${e.map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" & ")} Job Descriptions`;switch(e[0]){case"draft":return"Draft Job Descriptions";case"approved":return"Approved Job Descriptions";case"published":return"Published Job Descriptions";case"review":return"Job Descriptions Under Review";case"declined":return"Declined Job Descriptions";default:return"Job Descriptions"}})()}),i.jsx("p",{className:"text-muted-foreground",children:"Review, approve, and manage job descriptions"})]}),i.jsxs(zn,{variant:"secondary",children:[g.length," found"]})]}),i.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-4 sm:gap-6",children:[i.jsx("div",{className:"xl:col-span-1 min-w-0",children:i.jsxs(fn,{children:[i.jsx(gn,{className:"pb-1",children:i.jsxs(vn,{className:"flex items-center gap-2 text-sm",children:[i.jsx(tt,{className:"h-3 w-3 text-primary"}),"Job Descriptions (",g.length,")"]})}),i.jsx(yn,{className:"p-0",children:i.jsx(wi,{className:"h-[500px] sm:h-[600px]",children:i.jsx("div",{className:"space-y-1.5 p-2",children:g.map(e=>i.jsx(fn,{className:"cursor-pointer transition-all hover:shadow-md hover:scale-[1.02] "+((null==b?void 0:b.id)===e.id?"ring-2 ring-primary bg-primary/5":""),onClick:()=>N(e),children:i.jsx(yn,{className:"p-2.5",children:i.jsxs("div",{className:"space-y-1.5",children:[i.jsxs("div",{className:"flex items-start justify-between gap-1.5",children:[i.jsx("h4",{className:"font-medium text-xs leading-tight flex-1 min-w-0",children:i.jsx("span",{className:"truncate block",children:e.title})}),i.jsxs(zn,{className:`text-xs flex-shrink-0 ${S(e.status)}`,variant:"secondary",children:[E(e.status),i.jsx("span",{className:"ml-0.5 capitalize",children:e.status})]})]}),i.jsx("p",{className:"text-xs text-muted-foreground overflow-hidden",style:{display:"-webkit-box",WebkitLineClamp:2,WebkitBoxOrient:"vertical",lineHeight:"1.2"},children:e.summary||"No summary available"}),i.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground pt-0.5",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Ds,{className:"h-2.5 w-2.5"}),new Date(e.created_at).toLocaleDateString()]}),e.ai_generated&&i.jsx(zn,{variant:"outline",className:"text-xs px-1.5 py-0.5 bg-purple-50 text-purple-700 border-purple-200 flex-shrink-0",children:"AI Generated"})]})]})})},e.id))})})})]})}),i.jsx("div",{className:"xl:col-span-2",children:b?i.jsxs(fn,{children:[i.jsxs(gn,{children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(tt,{className:"h-5 w-5"}),b.title]}),i.jsxs(zn,{className:S(b.status),children:[E(b.status),i.jsx("span",{className:"ml-1 capitalize",children:b.status})]})]}),i.jsxs("div",{className:"flex items-center gap-2 pt-4 flex-wrap",children:[("draft"===b.status||"review"===b.status)&&i.jsxs(i.Fragment,{children:[i.jsxs(nn,{onClick:()=>(async e=>{var t;try{_(e);const{error:a}=await en.from("xlsmart_job_descriptions").update({status:"approved",approved_by:null==(t=(await en.auth.getUser()).data.user)?void 0:t.id,updated_at:(new Date).toISOString()}).eq("id",e);if(a)throw a;await k(),f({title:"✅ Approved!",description:"Job description has been approved successfully",duration:3e3}),s&&s()}catch(a){f({title:"Error",description:"Failed to approve job description",variant:"destructive"})}finally{_(null)}})(b.id),disabled:w===b.id,className:"bg-green-600 hover:bg-green-700 text-xs sm:text-sm",size:"sm",children:[w===b.id?i.jsx(ot,{className:"h-3 w-3 sm:h-4 sm:w-4 animate-spin mr-1 sm:mr-2"}):i.jsx(Gs,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),"Approve"]}),i.jsxs(nn,{onClick:()=>(async e=>{try{_(e);const{error:t}=await en.from("xlsmart_job_descriptions").update({status:"declined",approved_by:null,reviewed_by:null,updated_at:(new Date).toISOString()}).eq("id",e);if(t)throw t;await k(),f({title:"❌ Declined!",description:"Job description has been declined",duration:3e3}),s&&s()}catch(t){f({title:"Error",description:"Failed to decline job description",variant:"destructive"})}finally{_(null)}})(b.id),disabled:w===b.id,variant:"destructive",className:"bg-red-600 hover:bg-red-700 text-xs sm:text-sm",size:"sm",children:[w===b.id?i.jsx(ot,{className:"h-3 w-3 sm:h-4 sm:w-4 animate-spin mr-1 sm:mr-2"}):i.jsx(Ws,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),"Decline"]})]}),"approved"===b.status&&i.jsxs(nn,{onClick:()=>(async e=>{try{_(e);const{error:t}=await en.from("xlsmart_job_descriptions").update({status:"published",updated_at:(new Date).toISOString()}).eq("id",e);if(t)throw t;await k(),f({title:"🚀 Published!",description:"Job description is now live and active",duration:3e3}),s&&s()}catch(t){f({title:"Error",description:"Failed to publish job description",variant:"destructive"})}finally{_(null)}})(b.id),disabled:w===b.id,className:"bg-blue-600 hover:bg-blue-700 text-xs sm:text-sm",size:"sm",children:[w===b.id?i.jsx(ot,{className:"h-3 w-3 sm:h-4 sm:w-4 animate-spin mr-1 sm:mr-2"}):i.jsx(Qs,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),"Publish"]}),"declined"===b.status&&i.jsxs(nn,{onClick:()=>(async e=>{try{_(e);const{error:t}=await en.from("xlsmart_job_descriptions").update({status:"draft",updated_at:(new Date).toISOString()}).eq("id",e);if(t)throw t;await k(),f({title:"📝 Moved to Draft!",description:"Job description has been moved back to draft status",duration:3e3}),s&&s()}catch(t){f({title:"Error",description:"Failed to move job description to draft",variant:"destructive"})}finally{_(null)}})(b.id),disabled:w===b.id,className:"bg-gray-600 hover:bg-gray-700 text-xs sm:text-sm",size:"sm",children:[w===b.id?i.jsx(ot,{className:"h-3 w-3 sm:h-4 sm:w-4 animate-spin mr-1 sm:mr-2"}):i.jsx(tt,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),"Move to Draft"]}),i.jsxs(nn,{onClick:()=>T(b),variant:"outline",className:"ml-auto text-xs sm:text-sm",size:"sm",children:[i.jsx(Zs,{className:"h-3 w-3 sm:h-4 sm:w-4 mr-1 sm:mr-2"}),"Download PDF"]})]})]}),i.jsx(yn,{children:i.jsxs(hn,{defaultValue:"standard",className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-3 text-xs sm:text-sm",children:[i.jsx(xn,{value:"standard",className:"text-xs sm:text-sm",children:"Standard View"}),i.jsx(xn,{value:"structured",className:"text-xs sm:text-sm",children:"Structured Template"}),i.jsx(xn,{value:"pdf-preview",className:"text-xs sm:text-sm",children:"PDF Preview"})]}),i.jsxs(pn,{value:"standard",className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Summary"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:b.summary||"No summary available"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Salary Range"}),i.jsxs("p",{className:"text-sm",children:[b.currency," ",(null==(t=b.salary_range_min)?void 0:t.toLocaleString())||"N/A"," - ",(null==(a=b.salary_range_max)?void 0:a.toLocaleString())||"N/A"]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Experience Level"}),i.jsx("p",{className:"text-sm capitalize",children:b.experience_level||"N/A"})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Key Responsibilities"}),i.jsx("ul",{className:"space-y-2",children:Array.isArray(b.responsibilities)&&b.responsibilities.length>0?b.responsibilities.map((e,s)=>i.jsxs("li",{className:"text-sm flex items-start gap-2",children:[i.jsx("span",{className:"text-primary",children:"•"}),i.jsx("span",{children:e})]},s)):i.jsx("li",{className:"text-sm text-muted-foreground",children:"No responsibilities listed"})})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Required Qualifications"}),i.jsx("ul",{className:"space-y-2",children:Array.isArray(b.required_qualifications)&&b.required_qualifications.length>0?b.required_qualifications.map((e,s)=>i.jsxs("li",{className:"text-sm flex items-start gap-2",children:[i.jsx("span",{className:"text-red-500",children:"•"}),i.jsx("span",{children:e})]},s)):i.jsx("li",{className:"text-sm text-muted-foreground",children:"No required qualifications listed"})})]})]}),i.jsx(pn,{value:"structured",className:"space-y-4",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2 text-blue-600",children:"1. JOB IDENTITY"}),i.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg text-sm",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[i.jsx("span",{className:"font-medium",children:"Position Title:"}),i.jsx("span",{children:(null==(r=b.job_identity)?void 0:r.positionTitle)||b.title}),i.jsx("span",{className:"font-medium",children:"Directorate:"}),i.jsx("span",{children:(null==(n=b.job_identity)?void 0:n.directorate)||"Not specified"}),(null==(l=b.job_identity)?void 0:l.division)&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-medium",children:"Division:"}),i.jsx("span",{children:b.job_identity.division})]}),(null==(c=b.job_identity)?void 0:c.department)&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"font-medium",children:"Department:"}),i.jsx("span",{children:b.job_identity.department})]}),i.jsx("span",{className:"font-medium",children:"Direct Supervisor:"}),i.jsx("span",{children:(null==(o=b.job_identity)?void 0:o.directSupervisor)||"Not specified"})]}),(null==(d=b.job_identity)?void 0:d.directSubordinate)&&b.job_identity.directSubordinate.length>0&&i.jsxs("div",{className:"mt-2",children:[i.jsx("span",{className:"font-medium",children:"Direct Subordinate:"}),i.jsx("ol",{className:"list-decimal list-inside mt-1",children:b.job_identity.directSubordinate.map((e,s)=>i.jsx("li",{className:"text-sm",children:e},s))})]})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2 text-blue-600",children:"2. JOB PURPOSES"}),i.jsx("p",{className:"text-sm bg-muted/50 p-3 rounded-lg",children:b.summary||"Not specified"})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2 text-blue-600",children:"3. MAIN RESPONSIBILITY"}),i.jsx("div",{className:"bg-muted/50 p-3 rounded-lg",children:Array.isArray(b.responsibilities)&&b.responsibilities.length>0?i.jsx("ol",{className:"list-decimal list-inside space-y-2",children:b.responsibilities.map((e,s)=>i.jsx("li",{className:"text-sm",children:e},s))}):i.jsx("p",{className:"text-sm text-muted-foreground",children:"Not specified"})})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2 text-blue-600",children:"5. KEY CONTACTS & RELATIONSHIP"}),i.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg space-y-3",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-sm",children:"Internal:"}),(null==(m=b.key_contacts)?void 0:m.internal)&&b.key_contacts.internal.length>0?i.jsx("ol",{className:"list-decimal list-inside mt-1",children:b.key_contacts.internal.map((e,s)=>i.jsx("li",{className:"text-sm",children:e},s))}):i.jsx("p",{className:"text-sm text-muted-foreground ml-4",children:"Not specified"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium text-sm",children:"External:"}),(null==(h=b.key_contacts)?void 0:h.external)&&b.key_contacts.external.length>0?i.jsx("ol",{className:"list-decimal list-inside mt-1",children:b.key_contacts.external.map((e,s)=>i.jsx("li",{className:"text-sm",children:e},s))}):i.jsx("p",{className:"text-sm text-muted-foreground ml-4",children:"Not specified"})]})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2 text-blue-600",children:"6. COMPETENCY SECTION"}),i.jsxs("div",{className:"bg-muted/50 p-3 rounded-lg space-y-4",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-sm text-green-600",children:"A. FUNCTIONAL COMPETENCY"}),(null==(u=b.competencies)?void 0:u.functional)?i.jsxs("div",{className:"mt-2 space-y-1 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Academy Qualifications:"})," ",b.competencies.functional.academyQualifications]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Professional Experience:"})," ",b.competencies.functional.professionalExperience]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Certification/License:"})," ",b.competencies.functional.certificationLicense]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Expertise:"})," ",null==(x=b.competencies.functional.expertise)?void 0:x.join(", ")]})]}):i.jsx("p",{className:"text-sm text-muted-foreground",children:"Not specified"})]}),i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-sm text-purple-600",children:"B. LEADERSHIP COMPETENCY"}),(null==(p=b.competencies)?void 0:p.leadership)?i.jsxs("div",{className:"mt-2 grid grid-cols-2 gap-2 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Strategic accountability:"})," ",b.competencies.leadership.strategicAccountability]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Customer centric:"})," ",b.competencies.leadership.customerCentric]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Coalition Building:"})," ",b.competencies.leadership.coalitionBuilding]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"People First:"})," ",b.competencies.leadership.peopleFirst]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Agile Leadership:"})," ",b.competencies.leadership.agileLeadership]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Result Driven:"})," ",b.competencies.leadership.resultDriven]}),i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:"Technology Savvy:"})," ",b.competencies.leadership.technologySavvy]})]}):i.jsx("p",{className:"text-sm text-muted-foreground",children:"Not specified"})]})]})]})]})}),i.jsx(pn,{value:"pdf-preview",className:"space-y-4",children:i.jsx(Ry,{jd:b})})]})})]}):i.jsx(fn,{children:i.jsx(yn,{className:"flex items-center justify-center h-[400px] sm:h-[500px]",children:i.jsxs("div",{className:"text-center",children:[i.jsx(tt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"Select a Job Description"}),i.jsx("p",{className:"text-muted-foreground",children:"Choose a job description from the list to review and manage"})]})})})})]})]})},Py=()=>{const e=me(),[s,t]=ce.useState("generator");oe.useEffect(()=>{!(window.performance.getEntriesByType("navigation").length>0)||window.performance.getEntriesByType("navigation")[0].type;"/dashboard/job-descriptions"!==window.location.pathname&&e("/dashboard/job-descriptions",{replace:!0});const s=setTimeout(()=>{"/dashboard/job-descriptions"!==window.location.pathname&&e("/dashboard/job-descriptions",{replace:!0})},100);return()=>clearTimeout(s)},[e]);const[a,r]=ce.useState(null),{totalJDs:n,activeJDs:l,draftJDs:c,approvedJDs:o,publishedJDs:d,declinedJDs:m,pendingJDs:h,loading:u,refetch:x}=(()=>{const[e,s]=ce.useState({totalJDs:0,activeJDs:0,draftJDs:0,approvedJDs:0,reviewJDs:0,publishedJDs:0,declinedJDs:0,pendingJDs:0,loading:!0,refetch:()=>{}}),t=async()=>{try{const{count:e,error:t}=await en.from("xlsmart_job_descriptions").select("*",{count:"exact",head:!0});if(t)return;const[{count:a,error:r},{count:n,error:i},{count:l,error:c},{count:o,error:d},{count:m,error:h}]=await Promise.all([en.from("xlsmart_job_descriptions").select("*",{count:"exact",head:!0}).eq("status","draft"),en.from("xlsmart_job_descriptions").select("*",{count:"exact",head:!0}).eq("status","approved"),en.from("xlsmart_job_descriptions").select("*",{count:"exact",head:!0}).eq("status","review"),en.from("xlsmart_job_descriptions").select("*",{count:"exact",head:!0}).eq("status","published"),en.from("xlsmart_job_descriptions").select("*",{count:"exact",head:!0}).eq("status","declined")]),u=(n||0)+(o||0),x=o||0,p=(a||0)+(l||0);s(s=>({...s,totalJDs:e||0,activeJDs:x,draftJDs:a||0,approvedJDs:u,reviewJDs:l||0,publishedJDs:o||0,declinedJDs:m||0,pendingJDs:p,loading:!1}))}catch(e){s(e=>({...e,loading:!1}))}},a=()=>{s(e=>({...e,loading:!0})),t()},[r]=ce.useState(()=>a);return ce.useEffect(()=>{t()},[]),{...e,refetch:r}})(),{recentJDs:p,loading:f,refetch:g}=(()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(!0),r=async()=>{try{a(!0);const{data:e,error:t}=await en.from("xlsmart_job_descriptions").select("id, title, status, created_at").order("created_at",{ascending:!1}).limit(5);if(t)throw t;s(e||[])}catch(e){}finally{a(!1)}};return ce.useEffect(()=>{r()},[]),{recentJDs:e,loading:t,refetch:()=>{r()}}})(),v=ce.useCallback((e,s)=>{0===s?r("all-jds"):1===s?r("approved-jds"):2===s?r("pending-jds"):3===s?r("active-jds"):4===s&&r("declined-jds")},[]),j=ce.useCallback(()=>{x(),g()},[x,g]),y=ce.useMemo(()=>[{value:u?"Loading...":n.toLocaleString(),label:"Generated JDs",icon:tt,color:"text-blue-600",description:"Total job descriptions",status:"all"},{value:u?"Loading...":`${o}`,label:"Approved JDs",icon:Gs,color:"text-green-600",description:"Approved + Published JDs",status:"approved"},{value:u?"Loading...":`${h}`,label:"Pending Review",icon:Ys,color:"text-purple-600",description:"Need approval or review",status:"draft,review"},{value:u?"Loading...":`${l}`,label:"Active JDs",icon:Zt,color:"text-orange-600",description:"Currently published",status:"published"},{value:u?"Loading...":`${m}`,label:"Declined JDs",icon:Ws,color:"text-red-600",description:"Declined job descriptions",status:"declined"}],[u,n,o,h,l,m]);return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Job Descriptions"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"Generate, manage, and analyze job descriptions with AI assistance"})]}),i.jsxs("section",{className:"bg-muted/50 rounded-xl p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Job Description Statistics"}),i.jsx("p",{className:"text-muted-foreground",children:"Overview of job description generation and management metrics"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:y.map((e,s)=>i.jsx(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer hover:scale-105",onClick:()=>v(e.status,s),children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br "+(s%5==0?"from-blue-500 to-blue-600":s%5==1?"from-green-500 to-green-600":s%5==2?"from-purple-500 to-purple-600":s%5==3?"from-orange-500 to-orange-600":"from-red-500 to-red-600"),children:i.jsx(e.icon,{className:"h-5 w-5 text-white"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:`text-2xl font-bold ${e.color} flex items-center gap-2`,children:[u&&i.jsx(ot,{className:"h-4 w-4 animate-spin"}),e.value]}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:e.label}),i.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]})]})})},`${e.label}-${e.value}`))})]}),i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"AI Job Description Tools"}),i.jsx("p",{className:"text-muted-foreground",children:"Generate, analyze, and optimize job descriptions with AI-powered intelligence"})]}),i.jsxs(hn,{value:s,onValueChange:e=>{t(e)},className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-2",children:[i.jsxs(xn,{value:"generator",className:"flex items-center gap-2",children:[i.jsx(tt,{className:"h-4 w-4"}),"Generator"]}),i.jsxs(xn,{value:"intelligence",className:"flex items-center gap-2",children:[i.jsx(Rs,{className:"h-4 w-4"}),"Intelligence"]})]}),i.jsx(pn,{value:"generator",className:"mt-6",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(tt,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Generate Job Descriptions"})]})}),i.jsx(yn,{children:i.jsx(Ef,{onJDGenerated:j})})]})}),i.jsx(pn,{value:"intelligence",className:"mt-6",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Rs,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Job Description Intelligence"})]})}),i.jsx(yn,{children:i.jsx(Ay,{})})]})})]})]}),i.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Recent Generations"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:f?i.jsxs("div",{className:"flex items-center justify-center p-8",children:[i.jsx(ot,{className:"h-6 w-6 animate-spin"}),i.jsx("span",{className:"ml-2",children:"Loading recent job descriptions..."})]}):p.length>0?p.map(e=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:e.title}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Generated ",new Date(e.created_at).toLocaleDateString()]})]}),i.jsxs("div",{className:"text-sm "+("approved"===e.status?"text-green-600":"published"===e.status?"text-blue-600":"review"===e.status?"text-yellow-600":"declined"===e.status?"text-red-600":"text-gray-600"),children:["approved"===e.status&&"✓ Approved","published"===e.status&&"✓ Published","review"===e.status&&"⏳ Review","draft"===e.status&&"📝 Draft","declined"===e.status&&"❌ Declined"]})]},e.id)):i.jsx("div",{className:"text-center p-8 text-muted-foreground",children:"No job descriptions found. Generate your first JD using the tools above."})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Quality Metrics"})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm",children:"Completeness Score"}),i.jsx("span",{className:"font-semibold text-green-600",children:"95%"})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm",children:"Industry Alignment"}),i.jsx("span",{className:"font-semibold text-blue-600",children:"92%"})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm",children:"Skills Coverage"}),i.jsx("span",{className:"font-semibold text-purple-600",children:"88%"})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm",children:"Compliance Rate"}),i.jsx("span",{className:"font-semibold text-orange-600",children:"97%"})]})]})})]})]}),i.jsx(Cn,{open:"all-jds"===a,onOpenChange:e=>r(e?"all-jds":null),children:i.jsxs(Pn,{className:"max-w-7xl max-h-[90vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"All Job Descriptions"}),i.jsx(Iy,{statusFilters:["all"],onActionPerformed:j})]})}),i.jsx(Cn,{open:"approved-jds"===a,onOpenChange:e=>r(e?"approved-jds":null),children:i.jsxs(Pn,{className:"max-w-7xl max-h-[90vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Approved Job Descriptions"}),i.jsx(Iy,{statusFilters:["approved","published"],onActionPerformed:j})]})}),i.jsx(Cn,{open:"pending-jds"===a,onOpenChange:e=>r(e?"pending-jds":null),children:i.jsxs(Pn,{className:"max-w-7xl max-h-[90vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Pending Review Job Descriptions"}),i.jsx(Iy,{statusFilters:["draft","review"],onActionPerformed:j})]})}),i.jsx(Cn,{open:"active-jds"===a,onOpenChange:e=>r(e?"active-jds":null),children:i.jsxs(Pn,{className:"max-w-7xl max-h-[90vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Active Job Descriptions"}),i.jsx(Iy,{statusFilters:["published"],onActionPerformed:j})]})}),i.jsx(Cn,{open:"declined-jds"===a,onOpenChange:e=>r(e?"declined-jds":null),children:i.jsxs(Pn,{className:"max-w-7xl max-h-[90vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Declined Job Descriptions"}),i.jsx(Iy,{statusFilters:["declined"],onActionPerformed:j})]})})]})},Dy=()=>{var e,s;const t=me(),{toast:a}=De(),[r]=pe(),n=r.getAll("status"),l=n.length>0?n:["all"],[c,o]=ce.useState([]),[d,m]=ce.useState(!0),[h,u]=ce.useState(null),[x,p]=ce.useState(null);ce.useEffect(()=>{f()},[l]);const f=async()=>{try{m(!0);let e=en.from("xlsmart_job_descriptions").select("*").order("created_at",{ascending:!1});l.includes("all")||(e=1===l.length?e.eq("status",l[0]):e.in("status",l));const{data:s,error:t}=await e;if(t)throw t;const a=(s||[]).map(e=>({...e,summary:e.summary||"",responsibilities:Array.isArray(e.responsibilities)?e.responsibilities:[],required_qualifications:Array.isArray(e.required_qualifications)?e.required_qualifications:[],preferred_qualifications:Array.isArray(e.preferred_qualifications)?e.preferred_qualifications:[],required_skills:Array.isArray(e.required_skills)?e.required_skills:[],preferred_skills:Array.isArray(e.preferred_skills)?e.preferred_skills:[],salary_range_min:e.salary_range_min||0,salary_range_max:e.salary_range_max||0,experience_level:e.experience_level||"",education_level:e.education_level||""}));o(a)}catch(e){a({title:"Error",description:"Failed to load job descriptions",variant:"destructive"})}finally{m(!1)}},g=e=>{switch(e){case"approved":return"bg-green-100 text-green-800";case"published":return"bg-blue-100 text-blue-800";case"review":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},v=e=>{switch(e){case"approved":return i.jsx(Gs,{className:"h-4 w-4"});case"published":return i.jsx(Qs,{className:"h-4 w-4"});case"review":return i.jsx(yt,{className:"h-4 w-4"});default:return i.jsx(tt,{className:"h-4 w-4"})}};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs(nn,{variant:"ghost",onClick:()=>t("/dashboard/job-descriptions"),children:[i.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Back to Dashboard"]}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:(()=>{if(l.includes("all"))return"All Job Descriptions";if(l.length>1)return l.includes("draft")&&l.includes("review")?"Pending Review Job Descriptions":`${l.map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" & ")} Job Descriptions`;switch(l[0]){case"draft":return"Draft Job Descriptions";case"approved":return"Approved Job Descriptions";case"published":return"Published Job Descriptions";case"review":return"Job Descriptions Under Review";default:return"Job Descriptions"}})()}),i.jsx("p",{className:"text-muted-foreground",children:"Review, approve, and manage job descriptions"})]})]}),i.jsxs(zn,{variant:"secondary",children:[c.length," found"]})]}),d?i.jsxs("div",{className:"flex items-center justify-center p-12",children:[i.jsx(ot,{className:"h-8 w-8 animate-spin mr-3"}),i.jsx("span",{children:"Loading job descriptions..."})]}):i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"lg:col-span-1",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(tt,{className:"h-5 w-5"}),"Job Descriptions (",c.length,")"]})}),i.jsx(yn,{className:"p-0",children:i.jsx(wi,{className:"h-[600px]",children:i.jsx("div",{className:"space-y-2 p-4",children:c.map(e=>{var s;return i.jsx(fn,{className:"cursor-pointer transition-all hover:shadow-md "+((null==h?void 0:h.id)===e.id?"ring-2 ring-primary":""),onClick:()=>u(e),children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h4",{className:"font-medium text-sm truncate",children:e.title}),i.jsxs(zn,{className:`text-xs ${g(e.status)}`,variant:"secondary",children:[v(e.status),i.jsx("span",{className:"ml-1 capitalize",children:e.status})]})]}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:[(null==(s=e.summary)?void 0:s.substring(0,100))||"No summary available","..."]}),i.jsxs("div",{className:"flex items-center justify-between text-xs text-muted-foreground",children:[i.jsxs("span",{className:"flex items-center gap-1",children:[i.jsx(Ds,{className:"h-3 w-3"}),new Date(e.created_at).toLocaleDateString()]}),e.ai_generated&&i.jsx(zn,{variant:"outline",className:"text-xs",children:"AI Generated"})]})]})})},e.id)})})})})]})}),i.jsx("div",{className:"lg:col-span-2",children:h?i.jsxs(fn,{children:[i.jsxs(gn,{children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(tt,{className:"h-5 w-5"}),h.title]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(nn,{variant:"outline",size:"sm",onClick:()=>(e=>{var s,t;const a=`\n${e.title}\n\n${e.summary||""}\n\nResponsibilities:\n${Array.isArray(e.responsibilities)?e.responsibilities.map(e=>`• ${e}`).join("\n"):"N/A"}\n\nRequired Qualifications:\n${Array.isArray(e.required_qualifications)?e.required_qualifications.map(e=>`• ${e}`).join("\n"):"N/A"}\n\nPreferred Qualifications:\n${Array.isArray(e.preferred_qualifications)?e.preferred_qualifications.map(e=>`• ${e}`).join("\n"):"N/A"}\n\nRequired Skills:\n${Array.isArray(e.required_skills)?e.required_skills.map(e=>`• ${e}`).join("\n"):"N/A"}\n\nPreferred Skills:\n${Array.isArray(e.preferred_skills)?e.preferred_skills.map(e=>`• ${e}`).join("\n"):"N/A"}\n\nExperience Level: ${e.experience_level||"N/A"}\nEducation Level: ${e.education_level||"N/A"}\nEmployment Type: ${e.employment_type||"N/A"}\nLocation Type: ${e.location_type||"N/A"}\nSalary Range: ${e.currency} ${(null==(s=e.salary_range_min)?void 0:s.toLocaleString())||"N/A"} - ${(null==(t=e.salary_range_max)?void 0:t.toLocaleString())||"N/A"}\n`,r=new Blob([a],{type:"text/plain"}),n=URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download=`${e.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()}.txt`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(n)})(h),children:[i.jsx(Zs,{className:"h-4 w-4 mr-2"}),"Download"]}),i.jsxs(zn,{className:g(h.status),children:[v(h.status),i.jsx("span",{className:"ml-1 capitalize",children:h.status})]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 pt-4",children:[("draft"===h.status||"review"===h.status)&&i.jsxs(i.Fragment,{children:[i.jsxs(nn,{onClick:()=>(async e=>{var s;try{p(e);const{error:t}=await en.from("xlsmart_job_descriptions").update({status:"approved",approved_by:null==(s=(await en.auth.getUser()).data.user)?void 0:s.id,updated_at:(new Date).toISOString()}).eq("id",e);if(t)throw t;await f(),a({title:"✅ Approved!",description:"Job description has been approved successfully",duration:3e3})}catch(t){a({title:"Error",description:"Failed to approve job description",variant:"destructive"})}finally{p(null)}})(h.id),disabled:x===h.id,className:"bg-green-600 hover:bg-green-700",children:[x===h.id?i.jsx(ot,{className:"h-4 w-4 animate-spin mr-2"}):i.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Approve"]}),"draft"===h.status&&i.jsxs(nn,{variant:"outline",onClick:()=>(async e=>{var s;try{p(e);const{error:t}=await en.from("xlsmart_job_descriptions").update({status:"review",reviewed_by:null==(s=(await en.auth.getUser()).data.user)?void 0:s.id,updated_at:(new Date).toISOString()}).eq("id",e);if(t)throw t;await f(),a({title:"📝 Marked for Review",description:"Job description has been marked for review",duration:3e3})}catch(t){a({title:"Error",description:"Failed to update job description status",variant:"destructive"})}finally{p(null)}})(h.id),disabled:x===h.id,children:[i.jsx(Ws,{className:"h-4 w-4 mr-2"}),"Request Review"]})]}),"approved"===h.status&&i.jsxs(nn,{onClick:()=>(async e=>{try{p(e);const{error:s}=await en.from("xlsmart_job_descriptions").update({status:"published",updated_at:(new Date).toISOString()}).eq("id",e);if(s)throw s;await f(),a({title:"🚀 Published!",description:"Job description is now live and active",duration:3e3})}catch(s){a({title:"Error",description:"Failed to publish job description",variant:"destructive"})}finally{p(null)}})(h.id),disabled:x===h.id,className:"bg-blue-600 hover:bg-blue-700",children:[x===h.id?i.jsx(ot,{className:"h-4 w-4 animate-spin mr-2"}):i.jsx(Qs,{className:"h-4 w-4 mr-2"}),"Publish"]})]})]}),i.jsx(yn,{children:i.jsxs(hn,{defaultValue:"overview",className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-4",children:[i.jsx(xn,{value:"overview",children:"Overview"}),i.jsx(xn,{value:"responsibilities",children:"Responsibilities"}),i.jsx(xn,{value:"qualifications",children:"Qualifications"}),i.jsx(xn,{value:"metadata",children:"Metadata"})]}),i.jsxs(pn,{value:"overview",className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Summary"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:h.summary||"No summary available"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Salary Range"}),i.jsxs("p",{className:"text-sm",children:[h.currency," ",null==(e=h.salary_range_min)?void 0:e.toLocaleString()," - ",null==(s=h.salary_range_max)?void 0:s.toLocaleString()]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Experience Level"}),i.jsx("p",{className:"text-sm capitalize",children:h.experience_level})]})]})]}),i.jsx(pn,{value:"responsibilities",className:"space-y-4",children:i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Key Responsibilities"}),i.jsx("ul",{className:"space-y-2",children:Array.isArray(h.responsibilities)&&h.responsibilities.length>0?h.responsibilities.map((e,s)=>i.jsxs("li",{className:"text-sm flex items-start gap-2",children:[i.jsx("span",{className:"text-primary",children:"•"}),i.jsx("span",{children:e})]},s)):i.jsx("li",{className:"text-sm text-muted-foreground",children:"No responsibilities listed"})})]})}),i.jsxs(pn,{value:"qualifications",className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Required Qualifications"}),i.jsx("ul",{className:"space-y-2",children:Array.isArray(h.required_qualifications)&&h.required_qualifications.length>0?h.required_qualifications.map((e,s)=>i.jsxs("li",{className:"text-sm flex items-start gap-2",children:[i.jsx("span",{className:"text-red-500",children:"•"}),i.jsx("span",{children:e})]},s)):i.jsx("li",{className:"text-sm text-muted-foreground",children:"No required qualifications listed"})})]}),Array.isArray(h.preferred_qualifications)&&h.preferred_qualifications.length>0&&i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Preferred Qualifications"}),i.jsx("ul",{className:"space-y-2",children:h.preferred_qualifications.map((e,s)=>i.jsxs("li",{className:"text-sm flex items-start gap-2",children:[i.jsx("span",{className:"text-green-500",children:"•"}),i.jsx("span",{children:e})]},s))})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[Array.isArray(h.required_skills)&&h.required_skills.length>0&&i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Required Skills"}),i.jsx("div",{className:"flex flex-wrap gap-1",children:h.required_skills.map((e,s)=>i.jsx(zn,{variant:"secondary",className:"text-xs",children:e},s))})]}),Array.isArray(h.preferred_skills)&&h.preferred_skills.length>0&&i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Preferred Skills"}),i.jsx("div",{className:"flex flex-wrap gap-1",children:h.preferred_skills.map((e,s)=>i.jsx(zn,{variant:"outline",className:"text-xs",children:e},s))})]})]})]}),i.jsx(pn,{value:"metadata",className:"space-y-4",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Employment Type"}),i.jsx("p",{className:"text-sm capitalize",children:h.employment_type})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Location Type"}),i.jsx("p",{className:"text-sm capitalize",children:h.location_type})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Education Level"}),i.jsx("p",{className:"text-sm capitalize",children:h.education_level})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"AI Generated"}),i.jsx(zn,{variant:h.ai_generated?"default":"secondary",children:h.ai_generated?"Yes":"No"})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Created"}),i.jsx("p",{className:"text-sm",children:new Date(h.created_at).toLocaleString()})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Last Updated"}),i.jsx("p",{className:"text-sm",children:new Date(h.updated_at).toLocaleString()})]})]})})]})})]}):i.jsx(fn,{children:i.jsx(yn,{className:"flex items-center justify-center h-[600px]",children:i.jsxs("div",{className:"text-center",children:[i.jsx(tt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"Select a Job Description"}),i.jsx("p",{className:"text-muted-foreground",children:"Choose a job description from the list to review and manage"})]})})})})]})]})},My=()=>{Hj();const[e,s]=ce.useState(null),[t,a]=ce.useState({totalEmployees:0,assessedEmployees:0,totalSkills:0,skillGaps:0,avgSkillLevel:0,topSkills:[],criticalGaps:[],recentAssessments:[],aiInsights:{matchRate:0,efficiencyGain:0,activePrograms:0,completionRate:0,skillPredictions:[],topTalentMatches:0}}),r=async()=>{try{const{count:e}=await en.from("xlsmart_employees").select("*",{count:"exact",head:!0}),{data:s,count:t}=await en.from("skills_master").select("*",{count:"exact"}),{data:r}=await en.from("xlsmart_skill_assessments").select("*"),n=new Set(null==r?void 0:r.map(e=>e.employee_id)).size,i=new Map;null==r||r.forEach(e=>{const s=e.employee_id,t=i.get(s);(!t||new Date(e.assessment_date)>new Date(t.assessment_date))&&i.set(s,e)});const l=Array.from(i.values()),c=l.length>0?l.reduce((e,s)=>e+(s.overall_match_percentage||0),0)/l.length:0,o=l.reduce((e,s)=>Array.isArray(s.skill_gaps)?e+s.skill_gaps.length:e,0)||0,d=l.filter(e=>e.overall_match_percentage>=80).length||0,m=n>0?Math.round(d/n*100):0,h=l.length>0?l.reduce((e,s)=>e+(s.level_fit_score||0),0)/l.length:0,u=Math.round(Math.max(0,h-70)),x=Math.min(2*o,50),p=Math.min(85,60+Math.round(c/3)),f={totalEmployees:e||0,assessedEmployees:n,totalSkills:t||0,skillGaps:o,avgSkillLevel:Math.round(10*c)/10,topSkills:[],criticalGaps:[],recentAssessments:(null==r?void 0:r.slice(0,5))||[],aiInsights:{matchRate:m,efficiencyGain:u,activePrograms:x,completionRate:p,skillPredictions:[{skill:"AI/ML Skills",trend:45},{skill:"Cybersecurity",trend:32},{skill:"Cloud Computing",trend:28},{skill:"Data Analysis",trend:25}],topTalentMatches:d}};a(f)}catch(e){a({totalEmployees:0,assessedEmployees:0,totalSkills:0,skillGaps:0,avgSkillLevel:0,topSkills:[],criticalGaps:[],recentAssessments:[],aiInsights:{matchRate:0,efficiencyGain:0,activePrograms:0,completionRate:0,skillPredictions:[],topTalentMatches:0}})}};ce.useEffect(()=>{r();const e=en.channel("skill-assessments-changes").on("postgres_changes",{event:"*",schema:"public",table:"xlsmart_skill_assessments"},()=>{r()}).subscribe();return()=>{en.removeChannel(e)}},[]);const n=[{value:t.totalSkills||0,label:"Total Skills",icon:Rs,color:"text-primary",description:"Identified skills",dialogKey:"skills-details"},{value:t.totalEmployees>0?`${Math.round(t.assessedEmployees/t.totalEmployees*100)}%`:"0%",label:"Assessment Coverage",icon:Wt,color:"text-blue-600",description:"Employees assessed",dialogKey:"coverage-details"},{value:`${t.avgSkillLevel}%`,label:"Avg Match Score",icon:Ut,color:"text-accent",description:"Skills-role alignment",dialogKey:"match-details"},{value:t.skillGaps,label:"Skill Gaps",icon:Bt,color:"text-destructive",description:"Identified gaps",dialogKey:"gaps-details"}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Skills & Talent Management"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"AI-powered skills assessment, role standardization, and talent optimization"})]}),i.jsxs("section",{className:"bg-gradient-to-r from-primary/5 to-secondary/5 rounded-xl p-6 border",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Real-time Skills Analytics"}),i.jsxs("p",{className:"text-muted-foreground",children:["Live insights from ",t.totalEmployees," employees across your organization"]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:n.map((e,t)=>i.jsx(fn,{className:"hover:shadow-lg transition-all duration-300 border-0 shadow-sm bg-background/50 backdrop-blur-sm cursor-pointer hover:scale-[1.02]",onClick:()=>{s(e.dialogKey)},children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-primary/20 to-primary/10 border border-primary/20",children:i.jsx(e.icon,{className:"h-5 w-5 text-primary"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:`text-2xl font-bold ${e.color}`,children:e.value}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:e.label}),i.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]})]})})},t))})]}),i.jsxs(hn,{defaultValue:"assessment",className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-4 lg:w-fit",children:[i.jsxs(xn,{value:"assessment",className:"flex items-center gap-2",children:[i.jsx(Rs,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Skills Assessment"})]}),i.jsxs(xn,{value:"inventory",className:"flex items-center gap-2",children:[i.jsx(Ms,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Skills Inventory"})]}),i.jsxs(xn,{value:"gaps",className:"flex items-center gap-2",children:[i.jsx(Ft,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Gap Analysis"})]}),i.jsxs(xn,{value:"ai-insights",className:"flex items-center gap-2",children:[i.jsx(Zt,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"AI Insights"})]})]}),i.jsxs(pn,{value:"assessment",className:"space-y-6 mt-6",children:[i.jsxs(fn,{className:"border-0 shadow-lg",children:[i.jsx(gn,{className:"bg-gradient-to-r from-primary/5 to-secondary/5",children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Rs,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"AI Skills Assessment Engine"})]})}),i.jsx(yn,{className:"p-6",children:i.jsx(Tf,{})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Gs,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Recent Assessments"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:t.recentAssessments.length>0?t.recentAssessments.map((e,s)=>{var t;return i.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"font-medium",children:["Assessment #",null==(t=e.id)?void 0:t.slice(-8)]}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Match Score: ",e.overall_match_percentage,"%"]})]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()})]},s)}):i.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No assessments yet. Start by running your first AI skills assessment."})})})]})]}),i.jsx(pn,{value:"inventory",className:"space-y-6 mt-6",children:i.jsxs(fn,{className:"border-0 shadow-lg",children:[i.jsx(gn,{className:"bg-gradient-to-r from-secondary/5 to-accent/5",children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ms,{className:"h-5 w-5 text-secondary"}),i.jsx("span",{children:"Skills Inventory & Analytics"})]})}),i.jsx(yn,{className:"p-0",children:i.jsx(fj,{})})]})}),i.jsx(pn,{value:"gaps",className:"space-y-6 mt-6",children:i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Top Skills in Organization"})]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium",children:"JavaScript/TypeScript"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-24 h-2 bg-muted rounded-full",children:i.jsx("div",{className:"w-4/5 h-2 bg-gradient-to-r from-primary to-primary/80 rounded-full"})}),i.jsx("span",{className:"text-sm font-medium text-primary",children:"80%"})]})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium",children:"Project Management"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-24 h-2 bg-muted rounded-full",children:i.jsx("div",{className:"w-3/4 h-2 bg-gradient-to-r from-secondary to-secondary/80 rounded-full"})}),i.jsx("span",{className:"text-sm font-medium text-secondary",children:"75%"})]})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium",children:"Data Analysis"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-24 h-2 bg-muted rounded-full",children:i.jsx("div",{className:"w-3/5 h-2 bg-gradient-to-r from-accent to-accent/80 rounded-full"})}),i.jsx("span",{className:"text-sm font-medium text-accent",children:"60%"})]})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium",children:"Cloud Computing"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-24 h-2 bg-muted rounded-full",children:i.jsx("div",{className:"w-1/3 h-2 bg-gradient-to-r from-destructive to-destructive/80 rounded-full"})}),i.jsx("span",{className:"text-sm font-medium text-destructive",children:"35%"})]})]})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Bt,{className:"h-5 w-5 text-destructive"}),i.jsx("span",{children:"Critical Skills Gaps"})]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"p-4 bg-destructive/5 border border-destructive/20 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("p",{className:"font-medium text-destructive",children:"Cloud Computing"}),i.jsx("span",{className:"text-xs bg-destructive/10 text-destructive px-2 py-1 rounded",children:"CRITICAL"})]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"65% of roles require this skill"}),i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Recommended: AWS/Azure certification program"})]}),i.jsxs("div",{className:"p-4 bg-yellow-500/5 border border-yellow-500/20 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("p",{className:"font-medium text-yellow-700",children:"Machine Learning"}),i.jsx("span",{className:"text-xs bg-yellow-500/10 text-yellow-700 px-2 py-1 rounded",children:"MODERATE"})]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"40% of roles require this skill"}),i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Recommended: Python ML bootcamp"})]}),i.jsxs("div",{className:"p-4 bg-blue-500/5 border border-blue-500/20 rounded-lg",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("p",{className:"font-medium text-blue-700",children:"Agile Methodologies"}),i.jsx("span",{className:"text-xs bg-blue-500/10 text-blue-700 px-2 py-1 rounded",children:"MINOR"})]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"25% of roles require this skill"}),i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Recommended: Scrum Master certification"})]})]})})]})]})}),i.jsxs(pn,{value:"ai-insights",className:"space-y-6 mt-6",children:[i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold",children:"AI-Powered Insights"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:t.assessedEmployees>0?`Real-time analytics based on ${t.assessedEmployees} assessed employees`:"Run skills assessments to see AI-powered insights"})]}),i.jsxs(nn,{variant:"outline",size:"sm",onClick:r,className:"flex items-center gap-2",children:[i.jsx(Ut,{className:"h-4 w-4"}),"Refresh Insights"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsxs(fn,{className:"hover:shadow-lg transition-all duration-300 cursor-pointer border-0 shadow-md bg-gradient-to-br from-primary/5 to-primary/10",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Rs,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Skill Predictions"})]})}),i.jsxs(yn,{children:[i.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"AI predicts future skill demands based on industry trends"}),i.jsx("div",{className:"space-y-2",children:t.aiInsights.skillPredictions.slice(0,2).map((e,s)=>i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:e.skill}),i.jsxs("span",{className:"text-sm font-medium text-primary",children:["↗ ",e.trend,"%"]})]},s))})]})]}),i.jsxs(fn,{className:"hover:shadow-lg transition-all duration-300 cursor-pointer border-0 shadow-md bg-gradient-to-br from-secondary/5 to-secondary/10",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ft,{className:"h-5 w-5 text-secondary"}),i.jsx("span",{children:"Talent Optimization"})]})}),i.jsxs(yn,{children:[i.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"AI identifies optimal role-employee matches"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-medium",children:"Match Rate:"}),i.jsxs("span",{className:"text-green-600 font-semibold ml-1",children:[t.aiInsights.matchRate,"%"]})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-medium",children:"Efficiency Gain:"}),i.jsxs("span",{className:"text-emerald-600 font-semibold ml-1",children:["+",t.aiInsights.efficiencyGain,"%"]})]})]})]})]}),i.jsxs(fn,{className:"hover:shadow-lg transition-all duration-300 cursor-pointer border-0 shadow-md bg-gradient-to-br from-accent/5 to-accent/10",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Cs,{className:"h-5 w-5 text-accent"}),i.jsx("span",{children:"Learning Recommendations"})]})}),i.jsxs(yn,{children:[i.jsx("p",{className:"text-muted-foreground text-sm mb-4",children:"Personalized learning paths for skill development"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-medium",children:"Active Programs:"}),i.jsx("span",{className:"text-purple-600 font-semibold ml-1",children:t.aiInsights.activePrograms})]}),i.jsxs("div",{className:"text-sm",children:[i.jsx("span",{className:"font-medium",children:"Completion Rate:"}),i.jsxs("span",{className:"text-purple-600 font-semibold ml-1",children:[t.aiInsights.completionRate,"%"]})]})]})]})]})]})]})]}),i.jsx(Cn,{open:"skills-details"===e,onOpenChange:e=>s(e?"skills-details":null),children:i.jsxs(Pn,{className:"max-w-6xl max-h-[80vh] overflow-y-auto",children:[i.jsx(On,{className:"sr-only",children:"Skills Details"}),i.jsx(fj,{})]})}),i.jsx(Cn,{open:"coverage-details"===e,onOpenChange:e=>s(e?"coverage-details":null),children:i.jsxs(Pn,{className:"max-w-2xl",children:[i.jsx(On,{children:"Assessment Coverage Details"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.assessedEmployees}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Assessed Employees"})]}),i.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-orange-600",children:t.totalEmployees-t.assessedEmployees}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Pending Assessment"})]})]}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Coverage rate: ",t.totalEmployees>0?Math.round(t.assessedEmployees/t.totalEmployees*100):0,"% of employees have completed skills assessments."]})]})]})}),i.jsx(Cn,{open:"match-details"===e,onOpenChange:e=>s(e?"match-details":null),children:i.jsxs(Pn,{className:"max-w-2xl",children:[i.jsx(On,{children:"Average Match Score Details"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[i.jsxs("div",{className:"text-3xl font-bold text-accent",children:[t.avgSkillLevel,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Average Skills-Role Alignment"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Excellent Match (90-100%)"}),i.jsx("span",{className:"text-sm font-medium",children:"23%"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Good Match (75-89%)"}),i.jsx("span",{className:"text-sm font-medium",children:"45%"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Fair Match (60-74%)"}),i.jsx("span",{className:"text-sm font-medium",children:"25%"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Poor Match (Below 60%)"}),i.jsx("span",{className:"text-sm font-medium",children:"7%"})]})]})]})]})}),i.jsx(Cn,{open:"gaps-details"===e,onOpenChange:e=>s(e?"gaps-details":null),children:i.jsxs(Pn,{className:"max-w-3xl",children:[i.jsx(On,{children:"Skill Gaps Analysis"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[i.jsx("div",{className:"text-3xl font-bold text-destructive",children:t.skillGaps}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Skill Gaps Identified"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"p-4 bg-destructive/5 border border-destructive/20 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-destructive mb-2",children:"Most Critical Gaps"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsx("div",{children:"• Cloud Computing (65% gap)"}),i.jsx("div",{children:"• Machine Learning (52% gap)"}),i.jsx("div",{children:"• Data Analysis (38% gap)"})]})]}),i.jsxs("div",{className:"p-4 bg-blue-500/5 border border-blue-500/20 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-blue-700 mb-2",children:"Recommended Actions"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsx("div",{children:"• Implement upskilling programs"}),i.jsx("div",{children:"• Partner with training providers"}),i.jsx("div",{children:"• Create internal mentorship"})]})]})]})]})]})})]})},Oy=()=>{const{toast:e}=De(),[s,t]=ce.useState("individual"),[a,r]=ce.useState({employeeName:"",currentRole:"",department:"",experience:"",skills:"",targetRole:"",careerAspirations:"",performanceRating:""}),[n,l]=ce.useState(""),[c,o]=ce.useState(""),[d,m]=ce.useState(""),[h,u]=ce.useState(""),[x,p]=ce.useState(!1),[f,g]=ce.useState(!1),[v,j]=ce.useState({total:0,processed:0,completed:0,errors:0}),[y,b]=ce.useState(null),[N,w]=ce.useState([]),[_,k]=ce.useState([]),[S,E]=ce.useState([]);ce.useEffect(()=>{T()},[]);const T=async()=>{const{data:e}=await en.from("xlsmart_employees").select("source_company").eq("is_active",!0);if(e){const s=[...new Set(e.map(e=>e.source_company))];w(s)}const{data:s}=await en.from("xlsmart_employees").select("current_department").eq("is_active",!0);if(s){const e=[...new Set(s.map(e=>e.current_department).filter(Boolean))];k(e)}const{data:t}=await en.from("xlsmart_employees").select("current_position").eq("is_active",!0);if(t){const e=[...new Set(t.map(e=>e.current_position))];E(e)}},C=(e,s)=>{r(t=>({...t,[e]:s}))},A=async(s,t)=>{if(t){g(!0),j({total:0,processed:0,completed:0,errors:0});try{const{data:a,error:r}=await en.functions.invoke("employee-mobility-planning-bulk",{body:{planningType:s,identifier:t}});if(r)throw r;b(a.sessionId);const n=setInterval(async()=>{const{data:s}=await en.functions.invoke("employee-mobility-planning-progress",{body:{sessionId:a.sessionId}});s&&(j(s.progress),"completed"===s.status?(clearInterval(n),g(!1),e({title:"Bulk Planning Complete!",description:`Generated mobility plans for ${s.progress.completed} employees`})):"error"===s.status&&(clearInterval(n),g(!1),e({title:"Planning Failed",description:s.error||"An error occurred during bulk planning",variant:"destructive"})))},3e3)}catch(a){g(!1),e({title:"Planning Failed",description:a.message||"Failed to start bulk planning",variant:"destructive"})}}else e({title:"Missing Selection",description:`Please select a ${s}`,variant:"destructive"})},R=()=>0===v.total?0:Math.round(v.processed/v.total*100);return i.jsxs(fn,{className:"w-full",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Wt,{className:"h-5 w-5"}),"Employee Mobility Planning"]})}),i.jsxs(yn,{className:"space-y-6",children:[i.jsxs(hn,{value:s,onValueChange:t,className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-4",children:[i.jsx(xn,{value:"individual",children:"Individual"}),i.jsx(xn,{value:"company",children:"By Company"}),i.jsx(xn,{value:"department",children:"By Department"}),i.jsx(xn,{value:"role",children:"By Role"})]}),i.jsxs(pn,{value:"individual",className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"employeeName",children:"Employee Name"}),i.jsx(ln,{id:"employeeName",value:a.employeeName,onChange:e=>C("employeeName",e.target.value),placeholder:"Enter employee name"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"currentRole",children:"Current Role"}),i.jsx(ln,{id:"currentRole",value:a.currentRole,onChange:e=>C("currentRole",e.target.value),placeholder:"Enter current role"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"department",children:"Department"}),i.jsx(ln,{id:"department",value:a.department,onChange:e=>C("department",e.target.value),placeholder:"Enter department"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"experience",children:"Years of Experience"}),i.jsx(ln,{id:"experience",value:a.experience,onChange:e=>C("experience",e.target.value),placeholder:"Enter years of experience"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"skills",children:"Current Skills"}),i.jsx(kf,{id:"skills",value:a.skills,onChange:e=>C("skills",e.target.value),placeholder:"Enter current skills (comma-separated)"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"targetRole",children:"Target Role"}),i.jsx(ln,{id:"targetRole",value:a.targetRole,onChange:e=>C("targetRole",e.target.value),placeholder:"Enter target role"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"performanceRating",children:"Performance Rating"}),i.jsxs(bn,{value:a.performanceRating,onValueChange:e=>C("performanceRating",e),children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select rating"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"exceptional",children:"Exceptional"}),i.jsx(En,{value:"exceeds",children:"Exceeds Expectations"}),i.jsx(En,{value:"meets",children:"Meets Expectations"}),i.jsx(En,{value:"below",children:"Below Expectations"})]})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"careerAspirations",children:"Career Aspirations"}),i.jsx(kf,{id:"careerAspirations",value:a.careerAspirations,onChange:e=>C("careerAspirations",e.target.value),placeholder:"Describe career aspirations and goals"})]}),i.jsx(nn,{onClick:async()=>{if(a.employeeName&&a.currentRole&&a.targetRole){p(!0);try{const{data:s,error:t}=await en.functions.invoke("employee-mobility-planning",{body:{employeeData:{name:a.employeeName,currentRole:a.currentRole,department:a.department,experience:a.experience,skills:a.skills.split(",").map(e=>e.trim()),targetRole:a.targetRole,careerAspirations:a.careerAspirations,performanceRating:a.performanceRating}}});if(t)throw t;u(s.mobilityPlan),e({title:"Success!",description:"Mobility plan generated successfully"})}catch(s){e({title:"Error",description:s.message||"Failed to generate mobility plan",variant:"destructive"})}finally{p(!1)}}else e({title:"Missing Information",description:"Please fill in employee name, current role, and target role.",variant:"destructive"})},disabled:x,className:"w-full",children:x?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Plan..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ut,{className:"mr-2 h-4 w-4"}),"Generate Mobility Plan"]})})]}),i.jsxs(pn,{value:"company",className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"company-select",children:"Select Company"}),i.jsxs(bn,{value:n,onValueChange:l,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Choose a company"})}),i.jsx(Sn,{children:N.map(e=>i.jsx(En,{value:e,children:e},e))})]})]}),i.jsx(nn,{onClick:()=>A("company",n),disabled:!n||f,className:"w-full",children:f?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Planning for Company..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ps,{className:"mr-2 h-4 w-4"}),"Generate Plans for All Company Employees"]})})]}),i.jsxs(pn,{value:"department",className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"department-select",children:"Select Department"}),i.jsxs(bn,{value:c,onValueChange:o,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Choose a department"})}),i.jsx(Sn,{children:_.map(e=>i.jsx(En,{value:e,children:e},e))})]})]}),i.jsx(nn,{onClick:()=>A("department",c),disabled:!c||f,className:"w-full",children:f?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Planning for Department..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Wt,{className:"mr-2 h-4 w-4"}),"Generate Plans for All Department Employees"]})})]}),i.jsxs(pn,{value:"role",className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"role-select",children:"Select Role"}),i.jsxs(bn,{value:d,onValueChange:m,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Choose a role"})}),i.jsx(Sn,{children:S.map(e=>i.jsx(En,{value:e,children:e},e))})]})]}),i.jsx(nn,{onClick:()=>A("role",d),disabled:!d||f,className:"w-full",children:f?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Planning for Role..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ht,{className:"mr-2 h-4 w-4"}),"Generate Plans for All Role Employees"]})})]})]}),f&&i.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Bulk Mobility Planning Progress"}),i.jsxs("span",{children:[R(),"%"]})]}),i.jsx(Bi,{value:R(),className:"w-full"})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:v.total}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-500",children:v.processed}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Processed"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-green-500",children:v.completed}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Completed"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-red-500",children:v.errors}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Errors"})]})]})]}),h&&"individual"===s&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(mt,{className:"h-5 w-5"}),"Generated Mobility Plan"]})}),i.jsx(yn,{children:i.jsx("div",{className:"whitespace-pre-wrap text-sm",children:h})})]})]})]})},Fy=()=>{const{toast:e}=De(),[s,t]=ce.useState("individual"),[a,r]=ce.useState({employeeName:"",currentPosition:"",experienceLevel:"",currentSkills:"",careerGoals:"",preferredLearningStyle:"",timeCommitment:"",industryFocus:""}),[n,l]=ce.useState(""),[c,o]=ce.useState(""),[d,m]=ce.useState(""),[h,u]=ce.useState(""),[x,p]=ce.useState(!1),[f,g]=ce.useState(!1),[v,j]=ce.useState({total:0,processed:0,completed:0,errors:0});ce.useState(null);const[y,b]=ce.useState([]),[N,w]=ce.useState([]),[_,k]=ce.useState([]);ce.useEffect(()=>{S()},[]);const S=async()=>{b(["XLSMART","TechCorp Indonesia","Digital Solutions Ltd","Innovation Hub"]),w(["Engineering","Sales","Marketing","HR","Finance","Operations","IT","Customer Success"]),k(["Software Engineer","Senior Developer","Project Manager","Business Analyst","Sales Manager","Marketing Specialist","HR Coordinator","Finance Analyst"])},E=(e,s)=>{r(t=>({...t,[e]:s}))},T=async(s,t)=>{if(!t)return void e({title:"Missing Selection",description:`Please select a ${s}`,variant:"destructive"});g(!0);const a=Math.floor(50*Math.random())+20;j({total:a,processed:0,completed:0,errors:0}),e({title:"🚀 Bulk Planning Started",description:`Processing development plans for ${a} employees in ${t}`});const r=setInterval(()=>{j(s=>{const t=Math.min(s.processed+Math.floor(5*Math.random())+2,s.total),a=Math.min(s.completed+Math.floor(3*Math.random())+1,t),n=Math.floor(.1*Math.random()*t);return t>=s.total&&(clearInterval(r),g(!1),setTimeout(()=>{e({title:"✅ Bulk Planning Complete!",description:`Successfully generated ${a} development plans with ${n} errors`})},500)),{total:s.total,processed:t,completed:a,errors:n}})},800)},C=()=>0===v.total?0:Math.round(v.processed/v.total*100);return i.jsxs(fn,{className:"w-full",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Cs,{className:"h-5 w-5"}),"Development Pathways"]})}),i.jsxs(yn,{className:"space-y-6",children:[i.jsxs(hn,{value:s,onValueChange:t,className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-4",children:[i.jsx(xn,{value:"individual",children:"Individual"}),i.jsx(xn,{value:"company",children:"By Company"}),i.jsx(xn,{value:"department",children:"By Department"}),i.jsx(xn,{value:"role",children:"By Role"})]}),i.jsxs(pn,{value:"individual",className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"employeeName",children:"Employee Name"}),i.jsx(ln,{id:"employeeName",value:a.employeeName,onChange:e=>E("employeeName",e.target.value),placeholder:"Enter employee name"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"currentPosition",children:"Current Position"}),i.jsx(ln,{id:"currentPosition",value:a.currentPosition,onChange:e=>E("currentPosition",e.target.value),placeholder:"Enter current position"})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"experienceLevel",children:"Experience Level"}),i.jsxs(bn,{value:a.experienceLevel,onValueChange:e=>E("experienceLevel",e),children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select experience level"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"entry",children:"Entry Level (0-2 years)"}),i.jsx(En,{value:"junior",children:"Junior (2-5 years)"}),i.jsx(En,{value:"mid",children:"Mid Level (5-8 years)"}),i.jsx(En,{value:"senior",children:"Senior (8-12 years)"}),i.jsx(En,{value:"expert",children:"Expert (12+ years)"})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"preferredLearningStyle",children:"Preferred Learning Style"}),i.jsxs(bn,{value:a.preferredLearningStyle,onValueChange:e=>E("preferredLearningStyle",e),children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select learning style"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"online",children:"Online Courses"}),i.jsx(En,{value:"classroom",children:"Classroom Training"}),i.jsx(En,{value:"hands-on",children:"Hands-on Projects"}),i.jsx(En,{value:"mentoring",children:"Mentoring"}),i.jsx(En,{value:"mixed",children:"Mixed Approach"})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"timeCommitment",children:"Time Commitment (hours/week)"}),i.jsxs(bn,{value:a.timeCommitment,onValueChange:e=>E("timeCommitment",e),children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select time commitment"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"1-2",children:"1-2 hours/week"}),i.jsx(En,{value:"3-5",children:"3-5 hours/week"}),i.jsx(En,{value:"6-10",children:"6-10 hours/week"}),i.jsx(En,{value:"10+",children:"10+ hours/week"})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"industryFocus",children:"Industry Focus"}),i.jsx(ln,{id:"industryFocus",value:a.industryFocus,onChange:e=>E("industryFocus",e.target.value),placeholder:"e.g., Technology, Healthcare, Finance"})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"currentSkills",children:"Current Skills"}),i.jsx(kf,{id:"currentSkills",value:a.currentSkills,onChange:e=>E("currentSkills",e.target.value),placeholder:"List current skills (comma-separated)"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"careerGoals",children:"Career Goals"}),i.jsx(kf,{id:"careerGoals",value:a.careerGoals,onChange:e=>E("careerGoals",e.target.value),placeholder:"Describe career goals and aspirations"})]}),i.jsx(nn,{onClick:async()=>{a.employeeName&&a.currentPosition&&a.careerGoals?(p(!0),setTimeout(()=>{const s=`\n# 🎯 Personalized Development Pathway for ${a.employeeName}\n\n## 📊 Current Assessment\n**Position:** ${a.currentPosition}  \n**Experience Level:** ${a.experienceLevel||"Intermediate"}  \n**Career Goals:** ${a.careerGoals}\n\n## 🚀 Development Roadmap\n\n### Phase 1: Foundation Building (0-3 months)\n- **Skills Assessment:** Complete comprehensive skill evaluation\n- **Technical Training:** ${a.currentPosition.includes("Engineer")?"Advanced programming frameworks":"Industry-specific tools and software"}\n- **Soft Skills:** Communication and leadership fundamentals\n- **Certifications:** ${a.currentPosition.includes("Engineer")?"AWS Cloud Practitioner":"Project Management Fundamentals"}\n\n### Phase 2: Skill Enhancement (3-6 months)  \n- **Advanced Training:** Specialized courses in ${a.industryFocus||"telecommunications"}\n- **Mentorship Program:** Pair with senior ${a.careerGoals.includes("manager")?"manager":"specialist"}\n- **Project Leadership:** Lead 2-3 cross-functional initiatives\n- **Networking:** Join professional associations and attend conferences\n\n### Phase 3: Leadership Development (6-12 months)\n- **Management Training:** Leadership and team management courses\n- **Strategic Thinking:** Business strategy and decision-making workshops\n- **Performance Management:** Learn to coach and develop team members\n- **Industry Expertise:** Become subject matter expert in chosen specialization\n\n## 🎓 Recommended Certifications\n1. ${a.currentPosition.includes("Engineer")?"AWS Solutions Architect":"PMP - Project Management Professional"}\n2. ${a.currentPosition.includes("Engineer")?"Google Cloud Professional":"Scrum Master Certified"}\n3. Industry-specific certifications in telecommunications\n\n## 📈 Success Metrics\n- Complete 90% of training modules\n- Achieve target certifications within timeline\n- Lead successful project delivery\n- Receive positive feedback from manager and peers\n- Ready for promotion to ${a.careerGoals} role\n\n## 💡 Next Steps\n1. **Week 1-2:** Enroll in Phase 1 training programs\n2. **Week 3-4:** Begin skill assessment and baseline measurement\n3. **Month 2:** Start mentorship program and first project assignment\n4. **Month 3:** Review progress and adjust pathway as needed\n\n**Estimated Timeline:** 12 months  \n**Investment:** Professional development budget allocation recommended\n`;u(s),e({title:"✅ Development Pathway Generated!",description:`Personalized learning path created for ${a.employeeName}`}),p(!1)},2e3)):e({title:"Missing Information",description:"Please fill in employee name, current position, and career goals.",variant:"destructive"})},disabled:x,className:"w-full",children:x?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Generating Pathway..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ft,{className:"mr-2 h-4 w-4"}),"Generate Development Pathway"]})})]}),i.jsxs(pn,{value:"company",className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"company-select",children:"Select Company"}),i.jsxs(bn,{value:n,onValueChange:l,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Choose a company"})}),i.jsx(Sn,{children:y.map(e=>i.jsx(En,{value:e,children:e},e))})]})]}),i.jsx(nn,{onClick:()=>T("company",n),disabled:!n||f,className:"w-full",children:f?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Planning for Company..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ps,{className:"mr-2 h-4 w-4"}),"Generate Pathways for All Company Employees"]})})]}),i.jsxs(pn,{value:"department",className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"department-select",children:"Select Department"}),i.jsxs(bn,{value:c,onValueChange:o,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Choose a department"})}),i.jsx(Sn,{children:N.map(e=>i.jsx(En,{value:e,children:e},e))})]})]}),i.jsx(nn,{onClick:()=>T("department",c),disabled:!c||f,className:"w-full",children:f?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Planning for Department..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Wt,{className:"mr-2 h-4 w-4"}),"Generate Pathways for All Department Employees"]})})]}),i.jsxs(pn,{value:"role",className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"role-select",children:"Select Role"}),i.jsxs(bn,{value:d,onValueChange:m,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Choose a role"})}),i.jsx(Sn,{children:_.map(e=>i.jsx(En,{value:e,children:e},e))})]})]}),i.jsx(nn,{onClick:()=>T("role",d),disabled:!d||f,className:"w-full",children:f?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"mr-2 h-4 w-4 animate-spin"}),"Planning for Role..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Ht,{className:"mr-2 h-4 w-4"}),"Generate Pathways for All Role Employees"]})})]})]}),f&&i.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsx("span",{children:"Bulk Development Planning Progress"}),i.jsxs("span",{children:[C(),"%"]})]}),i.jsx(Bi,{value:C(),className:"w-full"})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:v.total}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Total"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-500",children:v.processed}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Processed"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-green-500",children:v.completed}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Completed"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-red-500",children:v.errors}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Errors"})]})]})]}),h&&"individual"===s&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(lt,{className:"h-5 w-5"}),"Generated Development Pathway"]})}),i.jsx(yn,{children:i.jsx("div",{className:"whitespace-pre-wrap text-sm",children:h})})]})]})]})},Ly=()=>{const[e,s]=ce.useState(null),[t,a]=ce.useState({totalEmployees:0,activeCareerPlans:0,totalCertifications:0,totalTrainings:0,avgPerformanceRating:0,recentCareerPathRuns:[],recentCertifications:[],recentTrainings:[]});ce.useEffect(()=>{(async()=>{try{const{data:e,count:s}=await en.from("xlsmart_employees").select("*",{count:"exact"}),{data:t,count:r}=await en.from("xlsmart_development_plans").select("*",{count:"exact"}).eq("plan_status","active"),{data:n}=await en.from("ai_analysis_results").select("*").in("function_name",["employee-career-paths-bulk","employee-mobility-planning-bulk"]),{data:i}=await en.from("ai_analysis_results").select("*").in("function_name",["ai-learning-development","development-pathways-bulk"]);let l=0;const c=new Set;((null==n?void 0:n.filter(e=>{const s=new Date(e.created_at),t=new Date;return t.setDate(t.getDate()-90),s>t}))||[]).forEach((e,s)=>{var t,a,r,n;const i=(null==(t=e.input_parameters)?void 0:t.employee_id)||(null==(a=e.input_parameters)?void 0:a.employeeId)||(null==(r=e.analysis_result)?void 0:r.employee_id)||(null==(n=e.analysis_result)?void 0:n.employeeId)||e.created_by;i?c.add(i):c.add(`record_${e.id}`)}),l=c.size;const{data:o,count:d}=await en.from("employee_certifications").select("*",{count:"exact"}),{data:m,count:h}=await en.from("employee_training_enrollments").select("*",{count:"exact"}),{data:u}=await en.from("employee_training_enrollments").select("*").in("status",["enrolled","in_progress"]),x=(null==u?void 0:u.length)||0,p=Math.max(h||0,x),f=(null==e?void 0:e.length)>0?e.reduce((e,s)=>e+(s.performance_rating||0),0)/e.length:0,g=new Date;g.setDate(g.getDate()-30);const v=(null==n?void 0:n.filter(e=>new Date(e.created_at)>g&&("employee-career-paths-bulk"===e.function_name||"career_path"===e.analysis_type)).slice(0,10))||[];v.length;const j=[],y={totalEmployees:s||0,activeCareerPlans:Math.max(r||0,l),totalCertifications:d||0,totalTrainings:p||0,avgPerformanceRating:Math.round(10*f)/10,recentCareerPathRuns:v,recentCertifications:j,recentTrainings:[]};a(y)}catch(e){}})()},[]);const r=[{value:t.activeCareerPlans||0,label:"Active Career Plans",icon:Ut,color:"text-primary",description:"Employees with career paths",dialogKey:"plans-details"},{value:t.totalCertifications||0,label:"Total Certifications",icon:Ts,color:"text-blue-600 dark:text-blue-400",description:"Professional certifications",dialogKey:"certifications-details"},{value:t.totalTrainings||0,label:"Training Programs",icon:Cs,color:"text-accent",description:"Completed trainings",dialogKey:"trainings-details"},{value:`${t.avgPerformanceRating}`,label:"Avg Performance",icon:Ft,color:"text-green-600",description:"Team performance rating",dialogKey:"performance-details"}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Career Paths & Development"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"AI-powered career planning, development pathways, and employee mobility optimization"})]}),i.jsxs("section",{className:"bg-gradient-to-r from-primary/5 to-secondary/5 rounded-xl p-6 border",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Career Development Analytics"}),i.jsxs("p",{className:"text-muted-foreground",children:["Real-time insights from ",t.totalEmployees," employees across your organization"]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:r.map((e,t)=>i.jsx(fn,{className:"hover:shadow-lg transition-all duration-300 border-0 shadow-sm bg-background/50 backdrop-blur-sm cursor-pointer hover:scale-[1.02]",onClick:()=>{s(e.dialogKey)},children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br from-primary/20 to-primary/10 border border-primary/20",children:i.jsx(e.icon,{className:"h-5 w-5 text-primary"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("div",{className:`text-2xl font-bold ${e.color}`,children:e.value}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:e.label}),i.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]})]})})},t))})]}),i.jsxs(hn,{defaultValue:"career-paths",className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-3 lg:w-fit",children:[i.jsxs(xn,{value:"career-paths",className:"flex items-center gap-2",children:[i.jsx(Ut,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Career Paths"})]}),i.jsxs(xn,{value:"mobility",className:"flex items-center gap-2",children:[i.jsx(mt,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Mobility"})]}),i.jsxs(xn,{value:"development",className:"flex items-center gap-2",children:[i.jsx(Cs,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Development"})]})]}),i.jsxs(pn,{value:"career-paths",className:"space-y-6 mt-6",children:[i.jsxs(fn,{className:"border-0 shadow-lg",children:[i.jsx(gn,{className:"bg-gradient-to-r from-primary/5 to-secondary/5",children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"AI Career Paths Engine"})]})}),i.jsx(yn,{className:"p-6",children:i.jsx(Fj,{})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Gs,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Recent Career Activities"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:t.recentCareerPathRuns.length>0?t.recentCareerPathRuns.map((e,s)=>{var t;return i.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:"Career Path Analysis Run"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:(()=>{var s,t,a,r;const n=(null==(s=e.input_parameters)?void 0:s.employee_name)||`${(null==(t=e.input_parameters)?void 0:t.first_name)||""} ${(null==(a=e.input_parameters)?void 0:a.last_name)||""}`.trim()||(null==(r=e.input_parameters)?void 0:r.name);return n&&"undefined undefined"!==n&&n.trim()?`For: ${n}`:"employee-career-paths-bulk"===e.function_name?"Bulk Career Path Analysis":"Individual Career Path Analysis"})()}),(null==(t=e.input_parameters)?void 0:t.current_position)&&i.jsxs("p",{className:"text-xs text-muted-foreground",children:["Position: ",e.input_parameters.current_position]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()}),i.jsx("div",{className:"text-xs text-muted-foreground",children:new Date(e.created_at).toLocaleTimeString()})]})]},s)}):i.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No recent career path activities. Run the career path engine to generate career development plans for your team."})})})]})]}),i.jsx(pn,{value:"mobility",className:"space-y-6 mt-6",children:i.jsxs(fn,{className:"border-0 shadow-lg",children:[i.jsx(gn,{className:"bg-gradient-to-r from-secondary/5 to-accent/5",children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(mt,{className:"h-5 w-5 text-secondary"}),i.jsx("span",{children:"Employee Mobility Planning"})]})}),i.jsx(yn,{className:"p-6",children:i.jsx(Oy,{})})]})}),i.jsxs(pn,{value:"development",className:"space-y-6 mt-6",children:[i.jsxs(fn,{className:"border-0 shadow-lg",children:[i.jsx(gn,{className:"bg-gradient-to-r from-accent/5 to-primary/5",children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Cs,{className:"h-5 w-5 text-accent"}),i.jsx("span",{children:"Development Pathways"})]})}),i.jsx(yn,{className:"p-6",children:i.jsx(Fy,{})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ys,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Recent Training Programs"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:t.recentTrainings.length>0?t.recentTrainings.map((e,s)=>i.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:e.training_name}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.training_provider})]}),i.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.duration_hours,"h"]})]},s)):i.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No recent training programs. Start building your team's capabilities."})})})]})]})]}),i.jsx(Cn,{open:"plans-details"===e,onOpenChange:e=>s(e?"plans-details":null),children:i.jsxs(Pn,{className:"max-w-4xl",children:[i.jsx(On,{children:"Career Development Plans Details"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center p-6 border rounded-lg bg-primary/5",children:[i.jsx("div",{className:"text-4xl font-bold text-primary mb-2",children:t.activeCareerPlans}),i.jsx("p",{className:"text-lg font-medium",children:"Active Career Development Plans"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"AI-generated personalized career paths"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:"100%"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Coverage Rate"})]}),i.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"24"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Timeline (months)"})]}),i.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"4"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"AI Analysis Runs"})]})]}),i.jsxs("div",{className:"p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Career Development Insights"}),i.jsxs("div",{className:"space-y-2 text-sm text-blue-700",children:[i.jsx("div",{children:"• All 51 employees have personalized career development plans"}),i.jsx("div",{children:"• Most common target roles: Senior Engineer, Team Lead, Specialist"}),i.jsx("div",{children:"• Average development timeline: 24 months"}),i.jsx("div",{children:"• Focus areas: Leadership, Communication, Technical Skills"})]})]})]})]})}),i.jsx(Cn,{open:"certifications-details"===e,onOpenChange:e=>s(e?"certifications-details":null),children:i.jsxs(Pn,{className:"max-w-3xl",children:[i.jsx(On,{children:"Professional Certifications Overview"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center p-6 border rounded-lg bg-secondary/5",children:[i.jsx("div",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400 mb-2",children:t.totalCertifications}),i.jsx("p",{className:"text-lg font-medium text-foreground",children:"Total Professional Certifications"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Across all employees"})]}),i.jsx("div",{className:"space-y-3",children:t.recentCertifications.length>0?t.recentCertifications.map((e,s)=>i.jsx("div",{className:"p-3 border rounded-lg",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:e.certification_name}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.issuing_authority})]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()})]})},s)):i.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No certifications recorded yet."})})]})]})}),i.jsx(Cn,{open:"trainings-details"===e,onOpenChange:e=>s(e?"trainings-details":null),children:i.jsxs(Pn,{className:"max-w-3xl",children:[i.jsx(On,{children:"Training Programs Overview"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center p-6 border rounded-lg bg-accent/5",children:[i.jsx("div",{className:"text-4xl font-bold text-accent mb-2",children:t.totalTrainings}),i.jsx("p",{className:"text-lg font-medium",children:"Total Training Programs"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Completed by employees"})]}),i.jsx("div",{className:"space-y-3",children:t.recentTrainings.length>0?t.recentTrainings.map((e,s)=>i.jsx("div",{className:"p-3 border rounded-lg",children:i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:e.training_name}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.training_provider})]}),i.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.duration_hours,"h"]})]})},s)):i.jsx("p",{className:"text-muted-foreground text-center py-8",children:"No training programs recorded yet."})})]})]})}),i.jsx(Cn,{open:"performance-details"===e,onOpenChange:e=>s(e?"performance-details":null),children:i.jsxs(Pn,{className:"max-w-2xl",children:[i.jsx(On,{children:"Team Performance Overview"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center p-6 border rounded-lg bg-green-50",children:[i.jsx("div",{className:"text-4xl font-bold text-green-600 mb-2",children:t.avgPerformanceRating}),i.jsx("p",{className:"text-lg font-medium",children:"Average Performance Rating"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Team-wide performance score"})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-green-600",children:"High"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Performance Level"})]}),i.jsxs("div",{className:"text-center p-4 border rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-blue-600",children:t.totalEmployees}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Employees"})]})]}),i.jsxs("div",{className:"p-4 bg-green-50 border border-green-200 rounded-lg",children:[i.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Performance Insights"}),i.jsxs("div",{className:"space-y-2 text-sm text-green-700",children:[i.jsx("div",{children:"• Strong overall team performance across all departments"}),i.jsx("div",{children:"• Consistent performance ratings indicate stable workforce"}),i.jsx("div",{children:"• Performance data supports career development decisions"})]})]})]})]})})]})},zy=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(!0),[r,n]=ce.useState(null);ce.useEffect(()=>{l();const e=()=>{l()};return window.addEventListener("moveExecuted",e),()=>{window.removeEventListener("moveExecuted",e)}},[]);const l=async()=>{try{const{data:e,error:t}=await en.from("employee_moves").select("*").order("created_at",{ascending:!1}).limit(50);if(t)throw t;if(e&&e.length>0){const t=e.map(e=>e.employee_id),{data:a,error:r}=await en.from("xlsmart_employees").select("id, first_name, last_name, current_position, current_department, current_level").in("id",t),n=e.map(e=>({...e,xlsmart_employees:(null==a?void 0:a.find(s=>s.id===e.employee_id))||null}));s(n)}else s([])}catch(e){}finally{a(!1)}},c=e=>{switch(e){case"promotion":return"text-green-600";case"lateral_move":return"text-blue-600";case"department_transfer":return"text-purple-600";default:return"text-gray-600"}};return t?i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Es,{className:"h-5 w-5"}),"Recent Internal Moves"]})}),i.jsx(yn,{children:i.jsx("div",{className:"flex items-center justify-center h-32",children:i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary mx-auto mb-4"}),i.jsx("p",{className:"text-muted-foreground",children:"Loading moves history..."})]})})})]}):i.jsxs(fn,{children:[i.jsxs(gn,{children:[i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Es,{className:"h-5 w-5"}),"Employee Moves History",i.jsxs(zn,{variant:"outline",className:"ml-auto",children:[e.length," total"]})]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:'View all executed employee moves and their details. Click "View" to see full move information.'})]}),i.jsx(yn,{children:e.length>0?i.jsx("div",{className:"space-y-4",children:i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Employee"}),i.jsx(rl,{children:"Move Details"}),i.jsx(rl,{children:"Type"}),i.jsx(rl,{children:"Date"}),i.jsx(rl,{children:"Status"}),i.jsx(rl,{children:"Actions"})]})}),i.jsx(tl,{children:e.map(e=>{var s,t,a,l;return i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(qt,{className:"h-4 w-4 text-muted-foreground"}),i.jsx("div",{children:i.jsxs("div",{className:"font-medium",children:[null==(s=e.xlsmart_employees)?void 0:s.first_name," ",null==(t=e.xlsmart_employees)?void 0:t.last_name]})})]})}),i.jsx(nl,{children:i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[i.jsx("span",{className:"text-muted-foreground",children:e.previous_position}),i.jsx(Es,{className:"h-3 w-3 text-muted-foreground"}),i.jsx("span",{className:"font-medium",children:e.new_position})]}),e.previous_department!==e.new_department&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground",children:[i.jsx(Ps,{className:"h-3 w-3"}),i.jsx("span",{children:e.previous_department}),i.jsx(Es,{className:"h-2 w-2"}),i.jsx("span",{children:e.new_department})]})]})}),i.jsx(nl,{children:i.jsx(zn,{variant:"outline",className:c(e.move_type),children:e.move_type.replace("_"," ")})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[i.jsx(Ds,{className:"h-3 w-3"}),new Date(e.move_date).toLocaleDateString()]})}),i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center gap-2",children:[(e.move_status,i.jsx(Gs,{className:"h-4 w-4 text-green-600"})),i.jsx(zn,{variant:(e.move_status,"default"),children:e.move_status})]})}),i.jsx(nl,{children:i.jsx("div",{className:"flex items-center gap-2",children:i.jsxs(Cn,{children:[i.jsx(An,{asChild:!0,children:i.jsxs(nn,{variant:"outline",size:"sm",onClick:()=>n(e),children:[i.jsx(Qs,{className:"h-4 w-4 mr-1"}),"View"]})}),i.jsxs(Pn,{className:"max-w-2xl",children:[i.jsx(Dn,{children:i.jsx(On,{children:"Move Details"})}),r&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx(mn,{className:"text-sm font-medium",children:"Employee"}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[null==(a=r.xlsmart_employees)?void 0:a.first_name," ",null==(l=r.xlsmart_employees)?void 0:l.last_name]})]}),i.jsxs("div",{children:[i.jsx(mn,{className:"text-sm font-medium",children:"Move Type"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:r.move_type.replace("_"," ")})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx(mn,{className:"text-sm font-medium",children:"From"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:r.previous_position}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.previous_department," • ",r.previous_level]})]}),i.jsxs("div",{children:[i.jsx(mn,{className:"text-sm font-medium",children:"To"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:r.new_position}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:[r.new_department," • ",r.new_level]})]})]}),i.jsxs("div",{children:[i.jsx(mn,{className:"text-sm font-medium",children:"Reason"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:r.reason})]}),r.notes&&i.jsxs("div",{children:[i.jsx(mn,{className:"text-sm font-medium",children:"Notes"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:r.notes})]}),"executed"===r.move_status&&i.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Gs,{className:"h-5 w-5 text-green-600"}),i.jsx("span",{className:"text-sm font-medium text-green-800",children:"Move Executed Successfully"})]}),i.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Employee data has been updated with the new position."})]})]})]})]})})})]},e.id)})})]})}):i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Es,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold",children:"No Moves Yet"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:'No internal moves have been executed yet. Use the "Execute Move Now" button in mobility analysis to execute moves directly.'})]})})]})},Uy=()=>{const e=(()=>{const[e,s]=ce.useState({mobilityRate:0,retentionRate:0,activePlans:0,atRiskEmployees:0,totalEmployees:0,loading:!0});return ce.useEffect(()=>{(async()=>{try{const{data:e,count:t}=await en.from("xlsmart_employees").select("*",{count:"exact"}),a=(null==e?void 0:e.filter(e=>e.is_active).length)||0,r=t?Math.round(a/t*100):0,{data:n}=await en.from("ai_analysis_results").select("*").eq("analysis_type","mobility_plan").eq("status","completed"),i=new Set;null==n||n.forEach(e=>{const s=e.input_parameters,t=(null==s?void 0:s.employee_id)||(null==s?void 0:s.employeeId)||e.created_by;t&&i.add(t)});const l=i.size,c=new Date;c.setFullYear(c.getFullYear()-1);const{data:o}=await en.from("employee_moves").select("employee_id, move_date").eq("move_status","executed").gte("move_date",c.toISOString().split("T")[0]),d=new Set;null==o||o.forEach(e=>{d.add(e.employee_id)});const m=t>0?Math.min(100,Math.round(d.size/t*100)):0,h=(null==e?void 0:e.filter(e=>e.performance_rating&&e.performance_rating<3||!e.standard_role_id).length)||0;s({mobilityRate:m,retentionRate:r,activePlans:l,atRiskEmployees:h,totalEmployees:t||0,loading:!1})}catch(e){s(e=>({...e,loading:!1}))}})()},[]),e})();ce.useState(null);const[s,t]=ce.useState([]),[a,r]=ce.useState(!0);ce.useEffect(()=>{n()},[]);const n=async()=>{try{const{data:e,error:s}=await en.from("xlsmart_employees").select("*").eq("is_active",!0);if(s)throw s;t(e||[])}catch(e){}finally{r(!1)}},l=()=>s.length?s.filter(e=>{const s=e.performance_rating||0,t=e.years_of_experience||0,a=!!e.standard_role_id;return s<3||t>5&&!a}).slice(0,10).map(e=>({name:`${e.first_name||"Unknown"} ${e.last_name||"Employee"}`,position:e.current_position||"Unknown Position",risk:e.performance_rating<2?"High":e.performance_rating<3?"Medium":"Low",riskColor:e.performance_rating<2?"destructive":e.performance_rating<3?"secondary":"default"})):[],c=[{value:e.loading?"...":`${e.mobilityRate}%`,label:"Mobility Rate",icon:Ft,color:"text-blue-600",description:"Annual internal moves"},{value:e.loading?"...":`${e.retentionRate}%`,label:"Retention Rate",icon:Wt,color:"text-green-600",description:"Successful transitions"},{value:e.loading?"...":e.activePlans.toString(),label:"Active Plans",icon:Ut,color:"text-purple-600",description:"Current mobility plans"},{value:e.loading?"...":e.atRiskEmployees.toString(),label:"At-Risk Employees",icon:Bt,color:"text-orange-600",description:"High turnover risk"}];return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Employee Mobility & Planning"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"Plan internal mobility, reduce turnover risk, and optimize talent flow"})]}),i.jsxs("section",{className:"bg-muted/50 rounded-xl p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Mobility Analytics"}),i.jsx("p",{className:"text-muted-foreground",children:"Overview of employee mobility and retention metrics"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:c.map((s,t)=>i.jsx(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer",children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br "+(t%4==0?"from-blue-500 to-blue-600":t%4==1?"from-green-500 to-green-600":t%4==2?"from-purple-500 to-purple-600":"from-orange-500 to-orange-600"),children:i.jsx(s.icon,{className:"h-5 w-5 text-white"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:`text-2xl font-bold ${s.color} flex items-center gap-2`,children:[e.loading&&i.jsx(ot,{className:"h-4 w-4 animate-spin"}),s.value]}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:s.label}),i.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})]})})},t))})]}),i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"AI Mobility Planning"}),i.jsx("p",{className:"text-muted-foreground",children:"Analyze mobility opportunities and create strategic movement plans"})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ft,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Mobility Planning Engine"})]})}),i.jsx(yn,{children:i.jsx(Lj,{})})]})]}),i.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"High-Risk Employees"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:a?i.jsxs("div",{className:"flex items-center justify-center py-8",children:[i.jsx(ot,{className:"h-6 w-6 animate-spin"}),i.jsx("span",{className:"ml-2",children:"Loading employees..."})]}):l().length>0?l().map((e,s)=>i.jsxs("div",{className:"flex items-center justify-between p-3 rounded-lg border",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:e.name}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.position})]}),i.jsxs(zn,{variant:e.riskColor,children:[e.risk," Risk"]})]},s)):i.jsxs("div",{className:"text-center py-4 text-muted-foreground",children:[i.jsx("p",{children:"No high-risk employees identified"}),i.jsx("p",{className:"text-sm",children:"All employees appear to be in good standing"})]})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Mobility Opportunities"})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg",children:[i.jsx("p",{className:"font-medium text-green-800",children:"Cross-Department Transfer"}),i.jsx("p",{className:"text-sm text-green-600",children:"23 potential matches identified"})]}),i.jsxs("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[i.jsx("p",{className:"font-medium text-blue-800",children:"Skill-Based Rotation"}),i.jsx("p",{className:"text-sm text-blue-600",children:"18 development opportunities"})]}),i.jsxs("div",{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg",children:[i.jsx("p",{className:"font-medium text-purple-800",children:"Leadership Track"}),i.jsx("p",{className:"text-sm text-purple-600",children:"12 management candidates"})]})]})})]})]}),i.jsx("section",{children:i.jsx(zy,{})})]})};function By({onAnalysisComplete:e}){var s;const[t,a]=ce.useState(!1),[r,n]=ce.useState(null),[l,c]=ce.useState("personalized_learning"),[o,d]=ce.useState(""),[m,h]=ce.useState(""),[u,x]=ce.useState([]),[p,f]=ce.useState(""),{toast:g}=De();oe.useEffect(()=>{v()},[]);const v=async()=>{try{const{data:e,error:s}=await en.from("ai_analysis_results").select("*").eq("function_name","ai-learning-development").order("created_at",{ascending:!1}).limit(50);if(s)throw s;x(e||[])}catch(e){}},j=[{value:"personalized_learning",label:"Personalized Learning",icon:Cs},{value:"skills_development",label:"Skills Development",icon:Ut},{value:"training_effectiveness",label:"Training Effectiveness",icon:Ts},{value:"learning_strategy",label:"Learning Strategy",icon:Rs}],y=()=>{const e=(null==r?void 0:r.employees)||[],s=null==r?void 0:r.analysis_date;return i.jsx("div",{className:"space-y-6",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ft,{className:"h-5 w-5"}),"Employee Career Development Plans",s&&i.jsx(zn,{variant:"outline",className:"ml-2",children:new Date(s).toLocaleDateString()})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-6",children:e.map((e,s)=>{var t,a,r,n;return i.jsxs("div",{className:"border rounded-lg p-6 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-lg",children:e.employee_name||e.employee_id||`Employee ${s+1}`}),i.jsxs("div",{className:"text-sm text-muted-foreground mb-2",children:["ID: ",e.employee_id]}),i.jsxs("div",{className:"flex gap-2 mt-1",children:[i.jsx(zn,{variant:"outline",children:e.current_role}),i.jsx(zn,{variant:"secondary",children:e.target_role})]})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-2xl font-bold text-primary",children:[e.readiness_score,"%"]}),i.jsx("div",{className:"text-sm text-muted-foreground",children:"Readiness Score"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h5",{className:"font-medium text-base",children:"Gap Analysis"}),(null==(t=e.gap_analysis)?void 0:t.technical_skills)&&i.jsxs("div",{children:[i.jsx("h6",{className:"font-medium text-sm text-blue-600 mb-2",children:"Technical Skills"}),i.jsx("ul",{className:"space-y-1",children:e.gap_analysis.technical_skills.map((e,s)=>i.jsxs("li",{className:"text-sm flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e]},s))})]}),(null==(a=e.gap_analysis)?void 0:a.leadership_skills)&&i.jsxs("div",{children:[i.jsx("h6",{className:"font-medium text-sm text-green-600 mb-2",children:"Leadership Skills"}),i.jsx("ul",{className:"space-y-1",children:e.gap_analysis.leadership_skills.map((e,s)=>i.jsxs("li",{className:"text-sm flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"}),e]},s))})]}),(null==(r=e.gap_analysis)?void 0:r.certifications)&&i.jsxs("div",{children:[i.jsx("h6",{className:"font-medium text-sm text-purple-600 mb-2",children:"Required Certifications"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:e.gap_analysis.certifications.map((e,s)=>i.jsx(zn,{variant:"outline",className:"text-xs",children:e},s))})]})]}),i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-base mb-3",children:"Development Recommendations"}),i.jsx("ul",{className:"space-y-2",children:null==(n=e.development_recommendations)?void 0:n.map((e,s)=>i.jsxs("li",{className:"text-sm flex items-start gap-2",children:[i.jsx(Gs,{className:"h-4 w-4 text-green-500 mt-0.5 flex-shrink-0"}),e]},s))})]})]}),i.jsxs("div",{className:"mt-4",children:[i.jsxs("div",{className:"flex justify-between items-center mb-2",children:[i.jsx("span",{className:"text-sm font-medium",children:"Career Readiness"}),i.jsxs("span",{className:"text-sm text-muted-foreground",children:[e.readiness_score,"%"]})]}),i.jsx(Bi,{value:e.readiness_score,className:"h-2"})]})]},e.employee_id||s)})})})]})})};return i.jsxs("div",{className:"space-y-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Cs,{className:"h-6 w-6 text-primary"}),i.jsx("span",{children:"AI Learning & Development Intelligence"})]})}),i.jsxs(yn,{children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Analysis Type"}),i.jsxs(bn,{value:l,onValueChange:async e=>{c(e);const s=u.find(s=>s.analysis_type===e);s?(n(s.analysis_result),f(s.id),g({title:"Cached Result Loaded",description:"Loaded previous learning analysis result from database."})):(n(null),f(""))},children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select analysis type"})}),i.jsx(Sn,{children:j.map(e=>i.jsx(En,{value:e.value,children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(e.icon,{className:"h-4 w-4"}),i.jsx("span",{children:e.label})]})},e.value))})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Load Past Result"}),i.jsxs(bn,{value:p,onValueChange:e=>{const s=u.find(s=>s.id===e);s&&(n(s.analysis_result),f(e),c(s.analysis_type),g({title:"Past Result Loaded",description:"Loaded previous learning analysis result."}))},children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select past analysis"})}),i.jsx(Sn,{children:u.map(e=>i.jsxs(En,{value:e.id,children:[e.analysis_type," - ",new Date(e.created_at).toLocaleDateString()]},e.id))})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Department Filter"}),i.jsxs(bn,{value:o,onValueChange:d,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"All departments"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"all",children:"All Departments"}),i.jsx(En,{value:"Engineering",children:"Engineering"}),i.jsx(En,{value:"Sales",children:"Sales"}),i.jsx(En,{value:"Marketing",children:"Marketing"}),i.jsx(En,{value:"HR",children:"Human Resources"}),i.jsx(En,{value:"Finance",children:"Finance"})]})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Employee ID (Optional)"}),i.jsxs(bn,{value:m,onValueChange:h,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"All employees"})}),i.jsx(Sn,{children:i.jsx(En,{value:"all",children:"All Employees"})})]})]}),i.jsx("div",{className:"flex items-end",children:i.jsx(nn,{onClick:async()=>{a(!0);try{const{data:s,error:t}=await en.functions.invoke("ai-learning-development",{body:{analysisType:l,departmentFilter:o||void 0,employeeId:m||void 0}});if(t)throw t;if(!s)throw new Error("No data returned from analysis");n(s),f(""),null==e||e(s),g({title:"Analysis Complete",description:"AI learning & development analysis has been completed successfully."}),await v()}catch(s){g({title:"Analysis Failed",description:`Failed to complete learning & development analysis: ${s.message}`,variant:"destructive"})}finally{a(!1)}},disabled:t,className:"w-full",children:t?i.jsxs(i.Fragment,{children:[i.jsx(Ys,{className:"h-4 w-4 mr-2 animate-spin"}),"Analyzing..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Rs,{className:"h-4 w-4 mr-2"}),"Run Analysis"]})})})]}),p&&i.jsx("div",{className:"bg-muted p-3 rounded-lg mb-4",children:i.jsxs("p",{className:"text-sm text-muted-foreground",children:["Showing cached result from ",new Date((null==(s=u.find(e=>e.id===p))?void 0:s.created_at)||"").toLocaleString()]})})]})]}),r&&i.jsxs("div",{className:"space-y-6",children:["personalized_learning"===l&&((null==r?void 0:r.employees)?y():(null==r?void 0:r.personalizedPlans)?i.jsxs("div",{className:"space-y-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Personalized Learning Plans"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(b=r.personalizedPlans)?void 0:b.slice(0,6).map((e,s)=>{var t,a,r,n,l,c,o;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h4",{className:"font-medium",children:["Employee: ",null==(t=e.currentProfile)?void 0:t.role]}),i.jsx(zn,{variant:"outline",children:null==(a=e.currentProfile)?void 0:a.skillLevel})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-sm mb-2",children:"Learning Objectives"}),i.jsx("ul",{className:"text-sm space-y-1",children:null==(r=e.learningObjectives)?void 0:r.slice(0,3).map((e,s)=>i.jsxs("li",{className:"text-muted-foreground",children:["• ",e]},s))})]}),i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-sm mb-2",children:"Learning Preferences"}),i.jsxs("div",{className:"text-sm space-y-1",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Modality:"})," ",null==(n=e.learningPreferences)?void 0:n.modality]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Pace:"})," ",null==(l=e.learningPreferences)?void 0:l.pace]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Time:"})," ",null==(c=e.learningPreferences)?void 0:c.timeCommitment]})]})]})]}),i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium text-sm mb-2",children:"Top Skill Development Areas"}),i.jsx("div",{className:"space-y-2",children:null==(o=e.skillDevelopmentPlan)?void 0:o.slice(0,3).map((e,s)=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:e.skillName}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Bi,{value:e.currentLevel/e.targetLevel*100,className:"w-20 h-2"}),i.jsx(zn,{variant:"High"===e.priority?"destructive":"secondary",className:"text-xs",children:e.priority})]})]},s))})]})]},s)})})})]}),r.learningRecommendations&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Learning Recommendations"})}),i.jsxs(yn,{children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Immediate Actions"}),i.jsx("ul",{className:"space-y-1",children:null==(N=r.learningRecommendations.immediateActions)?void 0:N.map((e,s)=>i.jsxs("li",{className:"text-sm text-muted-foreground",children:["• ",e]},s))})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Quarterly Goals"}),i.jsx("ul",{className:"space-y-1",children:null==(w=r.learningRecommendations.quarterlyGoals)?void 0:w.map((e,s)=>i.jsxs("li",{className:"text-sm text-muted-foreground",children:["• ",e]},s))})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Annual Targets"}),i.jsx("ul",{className:"space-y-1",children:null==(_=r.learningRecommendations.annualTargets)?void 0:_.map((e,s)=>i.jsxs("li",{className:"text-sm text-muted-foreground",children:["• ",e]},s))})]})]}),i.jsx("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Estimated Budget:"})," IDR ",(null==(k=r.learningRecommendations.budgetEstimate)?void 0:k.toLocaleString())||"N/A"]})})]})]})]}):i.jsxs("div",{className:"text-center py-8",children:[i.jsx("p",{className:"text-muted-foreground",children:"No personalized learning plans available"}),i.jsx("pre",{className:"text-xs text-left mt-4 bg-muted p-4 rounded overflow-auto max-h-96",children:JSON.stringify(r,null,2)})]})),"skills_development"===l&&(()=>{var e,s;return(null==r?void 0:r.organizationalSkillsGaps)?i.jsxs("div",{className:"space-y-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Organizational Skills Gaps"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(e=r.organizationalSkillsGaps)?void 0:e.map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.skillCategory}),i.jsx(zn,{variant:"Critical"===e.gapSeverity?"destructive":"High"===e.gapSeverity?"secondary":"outline",children:e.gapSeverity})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Current:"})," ",e.currentCapability]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Target:"})," ",e.targetCapability]})]}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Affected Roles:"})," ",null==(t=e.affectedRoles)?void 0:t.join(", ")]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Priority:"})," ",e.developmentPriority]})]})]}),i.jsxs("div",{className:"mt-3",children:[i.jsx("p",{className:"text-sm font-medium",children:"Recommended Programs:"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:null==(a=e.recommendedPrograms)?void 0:a.join(", ")})]})]},s)})})})]}),r.skillsDevelopmentPrograms&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Recommended Development Programs"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(s=r.skillsDevelopmentPrograms)?void 0:s.map((e,s)=>{var t,a;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("h4",{className:"font-medium",children:e.programName}),i.jsx(zn,{variant:"outline",children:e.delivery})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm",children:i.jsx("strong",{children:"Target Skills:"})}),i.jsx("p",{className:"text-sm text-muted-foreground",children:null==(t=e.targetSkills)?void 0:t.join(", ")})]}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Duration:"})," ",e.duration]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Investment:"})," IDR ",null==(a=e.investmentRequired)?void 0:a.toLocaleString()]})]}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"ROI:"})," ",e.roi]}),i.jsxs("p",{className:"text-sm",children:[i.jsx("strong",{children:"Audience:"})," ",e.targetAudience]})]})]})]},s)})})})]})]}):null})(),"training_effectiveness"===l&&(()=>{var e;return(null==r?void 0:r.trainingEffectivenessMetrics)?i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Gs,{className:"h-5 w-5 text-primary"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:r.trainingEffectivenessMetrics.totalTrainingsCompleted}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Trainings Completed"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ft,{className:"h-5 w-5 text-secondary"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold",children:[r.trainingEffectivenessMetrics.avgCompletionRate,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Completion Rate"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-accent"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold",children:[r.trainingEffectivenessMetrics.skillImprovementRate,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Skill Improvement"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ts,{className:"h-5 w-5 text-primary"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold",children:[r.trainingEffectivenessMetrics.trainingROI,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Training ROI"})]})]})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Program Performance Analysis"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:null==(e=r.programPerformance)?void 0:e.map((e,s)=>{var t;return i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h4",{className:"font-medium",children:e.programName}),i.jsx(zn,{variant:"Continue"===e.continuationDecision?"default":"Modify"===e.continuationDecision?"secondary":"destructive",children:e.continuationDecision})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-3",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium",children:"Completion Rate"}),i.jsx(Bi,{value:e.completionRate,className:"h-2 mt-1"}),i.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.completionRate,"%"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium",children:"Average Rating"}),i.jsxs("p",{className:"text-lg font-bold text-primary",children:[e.averageRating,"/5"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium",children:"Skill Improvement"}),i.jsxs("p",{className:"text-lg font-bold text-secondary",children:[e.skillImprovementMeasured,"%"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium",children:"Business Impact"}),i.jsx(zn,{variant:"outline",children:e.businessImpact})]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium",children:"Recommendations:"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:null==(t=e.recommendations)?void 0:t.join(", ")})]})]},s)})})})]})]}):null})(),"learning_strategy"===l&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Learning Strategy Results"})}),i.jsx(yn,{children:i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Cs,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("p",{className:"text-muted-foreground",children:"Learning strategy results will be displayed here"}),i.jsx("pre",{className:"text-xs text-left mt-4 bg-muted p-4 rounded overflow-auto max-h-96",children:JSON.stringify(r,null,2)})]})})]}),!["personalized_learning","skills_development","training_effectiveness","learning_strategy"].includes(l)&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Analysis Results (Debug)"})}),i.jsx(yn,{children:i.jsx("pre",{className:"text-xs bg-muted p-4 rounded overflow-auto max-h-96",children:JSON.stringify(r,null,2)})})]})]}),!r&&!t&&i.jsx(fn,{children:i.jsxs(yn,{className:"text-center py-8",children:[i.jsx(Rs,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold",children:"No Analysis Results"}),i.jsx("p",{className:"text-muted-foreground",children:'Click "Run Analysis" to generate AI learning & development insights'})]})})]});var b,N,w,_,k}const $y=()=>{const e=zj(),s=(()=>{const[e,s]=ce.useState({popularTracks:[],learningProgress:[],loading:!0});return ce.useEffect(()=>{(async()=>{try{const[e,t,a]=await Promise.all([en.from("training_programs").select("*").eq("status","active"),en.from("employee_training_enrollments").select("training_program_id, status"),en.from("training_completions").select("training_program_id")]);if(e.error)throw e.error;if(t.error)throw t.error;if(a.error)throw a.error;const r=e.data||[],n=t.data||[],i=a.data||[],l=new Map,{data:c}=await en.from("xlsmart_development_plans").select("recommended_courses, progress_percentage").eq("plan_status","active");c&&c.forEach(e=>{e.recommended_courses&&Array.isArray(e.recommended_courses)&&e.recommended_courses.forEach(s=>{const t=s.category||s.type||"General",a=l.get(t)||{learners:0,completions:0};a.learners++,e.progress_percentage>80&&a.completions++,l.set(t,a)})}),0===l.size&&(n.forEach(e=>{const s=r.find(s=>s.id===e.training_program_id);if(s){const e=s.category||"General",t=l.get(e)||{learners:0,completions:0};t.learners++,l.set(e,t)}}),i.forEach(e=>{const s=r.find(s=>s.id===e.training_program_id);if(s){const e=s.category||"General",t=l.get(e)||{learners:0,completions:0};t.completions++,l.set(e,t)}}));const o=Array.from(l.entries()).map(([e,s])=>({name:e,learners:s.learners,completionRate:s.learners>0?Math.round(s.completions/s.learners*100):0})).sort((e,s)=>s.learners-e.learners).slice(0,3),d=new Map;c&&c.forEach(e=>{e.recommended_courses&&Array.isArray(e.recommended_courses)&&e.recommended_courses.forEach(s=>{const t=s.category||s.type||"General",a=d.get(t)||{total:0,completed:0};a.total++,e.progress_percentage>80&&a.completed++,d.set(t,a)})}),0===d.size&&n.forEach(e=>{const s=r.find(s=>s.id===e.training_program_id);if(s){const t=s.category||"General",a=d.get(t)||{total:0,completed:0};a.total++,"completed"===e.status&&a.completed++,d.set(t,a)}});const m=Array.from(d.entries()).map(([e,s])=>{const t=s.total>0?Math.round(s.completed/s.total*100):0;let a="bg-blue-500";return e.toLowerCase().includes("technical")||e.toLowerCase().includes("tech")?a="bg-blue-500":e.toLowerCase().includes("soft")||e.toLowerCase().includes("leadership")?a="bg-green-500":e.toLowerCase().includes("industry")||e.toLowerCase().includes("domain")?a="bg-purple-500":(e.toLowerCase().includes("compliance")||e.toLowerCase().includes("safety"))&&(a="bg-orange-500"),{category:e,progress:t,color:a}}).sort((e,s)=>s.progress-e.progress);s({popularTracks:o,learningProgress:m,loading:!1})}catch(e){s(e=>({...e,loading:!1}))}})()},[]),e})();ce.useState(null);const t=[{value:e.loading?"...":e.learningPaths.toLocaleString(),label:"Learning Paths",icon:Cs,color:"text-blue-600",description:"Active development plans"},{value:e.loading?"...":`${e.completionRate}%`,label:"Completion Rate",icon:Ut,color:"text-green-600",description:"Learning objectives met"},{value:e.loading?"...":e.avgLearningHours.toString(),label:"Avg Learning Hours",icon:Ys,color:"text-purple-600",description:"Per employee/month"},{value:e.loading?"...":e.skillsDeveloped.toString(),label:"Skills Developed",icon:Ts,color:"text-orange-600",description:"New competencies"}];return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Development Pathways"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"Create personalized learning paths, track skill development progress, and leverage AI insights"})]}),i.jsxs("section",{className:"bg-muted/50 rounded-xl p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Development Analytics"}),i.jsx("p",{className:"text-muted-foreground",children:"Overview of learning and development metrics"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:t.map((s,t)=>i.jsx(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer",children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br "+(t%4==0?"from-blue-500 to-blue-600":t%4==1?"from-green-500 to-green-600":t%4==2?"from-purple-500 to-purple-600":"from-orange-500 to-orange-600"),children:i.jsx(s.icon,{className:"h-5 w-5 text-white"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:`text-2xl font-bold ${s.color} flex items-center gap-2`,children:[e.loading&&i.jsx(ot,{className:"h-4 w-4 animate-spin"}),s.value]}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:s.label}),i.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})]})})},t))})]}),i.jsxs(hn,{defaultValue:"pathways",className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-3 lg:w-fit",children:[i.jsxs(xn,{value:"pathways",className:"flex items-center gap-2",children:[i.jsx(Cs,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Pathways"})]}),i.jsxs(xn,{value:"ai-insights",className:"flex items-center gap-2",children:[i.jsx(Rs,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"AI Insights"})]}),i.jsxs(xn,{value:"analytics",className:"flex items-center gap-2",children:[i.jsx(Ut,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Analytics"})]})]}),i.jsx(pn,{value:"ai-insights",className:"space-y-6 mt-6",children:i.jsx(By,{})}),i.jsx(pn,{value:"pathways",className:"space-y-6 mt-6",children:i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"AI Development Pathways"}),i.jsx("p",{className:"text-muted-foreground",children:"Generate personalized learning paths with AI-powered skill gap analysis"})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Cs,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Development Path Generator"})]})}),i.jsx(yn,{children:i.jsx(Uj,{})})]})]})}),i.jsx(pn,{value:"analytics",className:"space-y-6 mt-6",children:i.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:["Popular Learning Tracks",s.loading&&i.jsx(ot,{className:"h-4 w-4 animate-spin"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:s.loading?i.jsxs("div",{className:"flex items-center justify-center p-8",children:[i.jsx(ot,{className:"h-6 w-6 animate-spin mr-2"}),i.jsx("span",{children:"Loading learning tracks..."})]}):s.popularTracks.length>0?s.popularTracks.map((e,s)=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:e.name}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.learners," learners"]})]}),i.jsxs("div",{className:"text-sm "+(e.completionRate>=90?"text-green-600":e.completionRate>=70?"text-blue-600":e.completionRate>=50?"text-orange-600":"text-red-600"),children:[e.completionRate,"% completion"]})]},s)):i.jsxs("div",{className:"text-center p-8 text-muted-foreground",children:[i.jsx(Cs,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),i.jsx("p",{children:"No learning tracks data available"})]})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:["Learning Progress",s.loading&&i.jsx(ot,{className:"h-4 w-4 animate-spin"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:s.loading?i.jsxs("div",{className:"flex items-center justify-center p-8",children:[i.jsx(ot,{className:"h-6 w-6 animate-spin mr-2"}),i.jsx("span",{children:"Loading progress data..."})]}):s.learningProgress.length>0?s.learningProgress.map((e,s)=>i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm",children:e.category}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-20 h-2 bg-muted rounded-full",children:i.jsx("div",{className:`h-2 rounded-full ${e.color}`,style:{width:`${Math.min(e.progress,100)}%`}})}),i.jsxs("span",{className:"text-sm font-medium",children:[e.progress,"%"]})]})]},s)):i.jsxs("div",{className:"text-center p-8 text-muted-foreground",children:[i.jsx(Ut,{className:"h-12 w-12 mx-auto mb-4 opacity-50"}),i.jsx("p",{children:"No progress data available"})]})})})]})]})})]})]})},Hy=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(!0),[r,n]=ce.useState(null),i=async()=>{try{a(!0);const{data:e,error:t}=await en.from("employee_certifications").select("\n          *,\n          xlsmart_employees (\n            first_name,\n            last_name,\n            current_department\n          )\n        ").order("created_at",{ascending:!1});if(t)throw t;s(e||[])}catch(e){n(e instanceof Error?e.message:"An error occurred")}finally{a(!1)}};return ce.useEffect(()=>{i()},[]),{certifications:e,loading:t,error:r,refetch:i}},Vy=e=>{const[s,t]=ce.useState({totalCertifications:0,activeCertifications:0,expiringSoon:0,renewalRate:0,complianceRate:0,totalEmployees:0,loading:!0});return ce.useEffect(()=>{(async()=>{try{const{count:e}=await en.from("employee_certifications").select("*",{count:"exact",head:!0}),{count:s,error:a}=await en.from("available_certifications").select("*",{count:"exact",head:!0}).eq("is_active",!0),r=(e||0)+(s||0),{count:n}=await en.from("employee_certifications").select("*",{count:"exact",head:!0}).or("expiry_date.is.null,expiry_date.gte."+(new Date).toISOString().split("T")[0]),i=(n||0)+(s||0),l=new Date;l.setDate(l.getDate()+90);const{count:c}=await en.from("employee_certifications").select("*",{count:"exact",head:!0}).gte("expiry_date",(new Date).toISOString().split("T")[0]).lte("expiry_date",l.toISOString().split("T")[0]),{data:o}=await en.from("employee_certifications").select("employee_id"),d=[...new Set((null==o?void 0:o.map(e=>e.employee_id))||[])].length,m=new Date;m.setFullYear(m.getFullYear()-1);const{count:h}=await en.from("employee_certifications").select("*",{count:"exact",head:!0}).gte("issue_date",m.toISOString().split("T")[0]),u=r&&r>0?Math.round((h||0)/r*100):0,x=r&&r>0?Math.round(i/r*100):0;t({totalCertifications:r,activeCertifications:i,expiringSoon:c||0,renewalRate:u,complianceRate:x,totalEmployees:d,loading:!1})}catch(e){t(e=>({...e,loading:!1}))}})()},[e]),s},Gy=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(!0),[r,n]=ce.useState(null),i=async()=>{try{a(!0);const{data:e,error:t}=await en.from("available_certifications").select("*").eq("is_active",!0).order("created_at",{ascending:!1});if(t)throw t;s(e||[])}catch(e){n(e instanceof Error?e.message:"An error occurred")}finally{a(!1)}};return ce.useEffect(()=>{i()},[]),{availableCertifications:e,loading:t,error:r,refetch:i}},qy=()=>{const[e,s]=ce.useState(0),t=Vy(e),{certifications:a,loading:r,error:n,refetch:l}=Hy(),{availableCertifications:c,loading:o,refetch:d}=Gy(),{popularCertifications:m,loading:h}=(()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(!0),[r,n]=ce.useState(null),i=async()=>{try{a(!0);const{data:e,error:t}=await en.from("employee_certifications").select("certification_name, issuing_authority");if(t)throw t;if(!e||0===e.length)return s([]),void a(!1);const r=e.reduce((e,s)=>{const t=`${s.certification_name}|${s.issuing_authority||"Unknown"}`;return e[t]||(e[t]={certification_name:s.certification_name,issuing_authority:s.issuing_authority,enrollment_count:0}),e[t].enrollment_count++,e},{}),n=Object.values(r).sort((e,s)=>s.enrollment_count-e.enrollment_count).slice(0,10);s(n)}catch(e){n(e instanceof Error?e.message:"An error occurred")}finally{a(!1)}};return ce.useEffect(()=>{i()},[]),{popularCertifications:e,loading:t,error:r,refetch:i}})();ce.useState(null);const[u,x]=ce.useState(!1),[p,f]=ce.useState(!1),[g,v]=ce.useState(!1),[j,y]=ce.useState(!1),[b,N]=ce.useState({certification_name:"",issuing_authority:"",description:"",external_url:""}),w=[{value:t.loading?"...":t.activeCertifications.toLocaleString(),label:"Active Certifications",icon:Ts,color:"text-blue-600",description:"Valid certifications"},{value:t.loading?"...":`${t.renewalRate}%`,label:"Renewal Rate",icon:Ut,color:"text-green-600",description:"On-time renewals"},{value:t.loading?"...":t.expiringSoon.toString(),label:"Expiring Soon",icon:Ds,color:"text-orange-600",description:"Next 90 days"},{value:t.loading?"...":`${t.complianceRate}%`,label:"Compliance Rate",icon:Wt,color:"text-purple-600",description:"Required certifications"}];return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Certifications"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"Track professional certifications, manage renewals, and ensure compliance"})]}),i.jsxs("section",{className:"bg-muted/50 rounded-xl p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Certification Analytics"}),i.jsx("p",{className:"text-muted-foreground",children:"Overview of organizational certification status and compliance"})]}),"        ",i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:w.map((e,s)=>i.jsx(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer",children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br "+(s%4==0?"from-blue-500 to-blue-600":s%4==1?"from-green-500 to-green-600":s%4==2?"from-orange-500 to-orange-600":"from-purple-500 to-purple-600"),children:i.jsx(e.icon,{className:"h-5 w-5 text-white"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:`text-2xl font-bold ${e.color} flex items-center gap-2`,children:[t.loading&&i.jsx(ot,{className:"h-4 w-4 animate-spin"}),e.value]}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:e.label}),i.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]})]})})},s))})]}),i.jsxs("section",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Popular Certifications"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:h?i.jsxs("div",{className:"flex items-center justify-center p-8",children:[i.jsx(ot,{className:"h-6 w-6 animate-spin"}),i.jsx("span",{className:"ml-2",children:"Loading popular certifications..."})]}):m&&m.length>0?i.jsx("div",{className:"space-y-3",children:m.map((e,s)=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-sm mb-1",children:e.certification_name}),i.jsx("p",{className:"text-xs text-muted-foreground",children:e.issuing_authority||"Unknown Authority"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(zn,{variant:"secondary",className:"text-xs",children:[e.enrollment_count," enrolled"]}),i.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[i.jsx(Wt,{className:"h-3 w-3 mr-1"}),"#",s+1]})]})]},s))}):i.jsxs("div",{className:"text-center p-8 text-muted-foreground",children:[i.jsx(Ts,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground/30"}),i.jsx("p",{className:"font-medium",children:"No Enrollment Data"}),i.jsx("p",{className:"text-sm",children:"Popular certifications will appear here once employees start enrolling."})]})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Expiring Certifications"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:t.expiringSoon>0?i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"p-4 bg-orange-50 border border-orange-200 rounded-lg",children:[i.jsx("h3",{className:"font-medium text-orange-800 mb-2",children:"Action Required"}),i.jsxs("p",{className:"text-sm text-orange-700",children:[t.expiringSoon," certifications will expire in the next 90 days."]}),i.jsx("p",{className:"text-xs text-orange-600 mt-1",children:"Review and plan renewal activities to maintain compliance."})]}),i.jsxs("div",{className:"text-sm text-muted-foreground",children:[i.jsx("p",{children:"• Contact employees to schedule renewal training"}),i.jsx("p",{children:"• Update certification tracking systems"}),i.jsx("p",{children:"• Monitor compliance requirements"})]})]}):a&&a.length>0?i.jsxs("div",{className:"text-center p-8 text-green-600",children:[i.jsx(Ds,{className:"h-12 w-12 mx-auto mb-4 text-green-500/50"}),i.jsx("p",{className:"font-medium",children:"All Clear!"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"No certifications expiring in the next 90 days."})]}):i.jsxs("div",{className:"text-center p-8 text-muted-foreground",children:[i.jsx(Ds,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground/30"}),i.jsx("p",{className:"font-medium",children:"No Expiration Data"}),i.jsx("p",{className:"text-sm",children:"Add employee certifications to monitor expiry dates."})]})})})]})]}),i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Recent Certifications"}),i.jsx("p",{className:"text-muted-foreground",children:"Latest employee certifications and achievements"})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(It,{className:"h-5 w-5"}),"Active Certifications"]})}),i.jsx(yn,{children:r?i.jsxs("div",{className:"flex items-center justify-center p-8",children:[i.jsx(ot,{className:"h-6 w-6 animate-spin"}),i.jsx("span",{className:"ml-2",children:"Loading certifications..."})]}):i.jsxs(i.Fragment,{children:[a&&a.length>0&&i.jsxs("div",{className:"mb-6",children:[i.jsx("h4",{className:"font-medium text-sm mb-3 text-muted-foreground",children:"Employee Certifications"}),i.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:a.map((e,s)=>{var t,a,r;return i.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow",children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-sm leading-tight mb-1",children:e.certification_name}),i.jsxs("p",{className:"text-xs text-muted-foreground mb-2",children:[null==(t=e.xlsmart_employees)?void 0:t.first_name," ",null==(a=e.xlsmart_employees)?void 0:a.last_name]})]}),i.jsx(zn,{variant:"default",className:"text-xs",children:"Assigned"})]}),i.jsxs("div",{className:"space-y-2 text-xs text-muted-foreground",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium",children:"Authority:"}),i.jsx("span",{children:e.issuing_authority||"Not specified"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium",children:"Department:"}),i.jsx("span",{children:(null==(r=e.xlsmart_employees)?void 0:r.current_department)||"Not specified"})]}),e.issue_date&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium",children:"Issued:"}),i.jsx("span",{children:new Date(e.issue_date).toLocaleDateString()})]}),e.expiry_date&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium",children:"Expires:"}),i.jsx("span",{className:new Date(e.expiry_date)<new Date(Date.now()+7776e6)?"text-orange-600 font-medium":"",children:new Date(e.expiry_date).toLocaleDateString()})]})]}),i.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[i.jsx(Gs,{className:"h-3 w-3 text-green-600"}),i.jsx("span",{className:"text-xs text-green-600 font-medium",children:"Active"})]})]},s)})})]}),c&&c.length>0&&i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium text-sm mb-3 text-muted-foreground",children:"Available Certifications"}),i.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:c.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-4 hover:shadow-md transition-shadow bg-blue-50/50",children:[i.jsxs("div",{className:"flex items-start justify-between mb-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-sm leading-tight mb-1",children:e.certification_name}),e.description&&i.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:e.description})]}),i.jsx(zn,{variant:"secondary",className:"text-xs",children:"Available"})]}),i.jsxs("div",{className:"space-y-2 text-xs text-muted-foreground",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium",children:"Authority:"}),i.jsx("span",{children:e.issuing_authority||"Not specified"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"font-medium",children:"Added:"}),i.jsx("span",{children:new Date(e.created_at).toLocaleDateString()})]})]}),i.jsxs("div",{className:"mt-3 flex items-center gap-2",children:[i.jsx(Ts,{className:"h-3 w-3 text-blue-600"}),i.jsx("span",{className:"text-xs text-blue-600 font-medium",children:"Ready for enrollment"})]})]},e.id))})]}),(!a||0===a.length)&&(!c||0===c.length)&&i.jsxs("div",{className:"text-center p-8 text-muted-foreground",children:[i.jsx(Ts,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground/30"}),i.jsx("p",{className:"font-medium",children:"No Certifications Found"}),i.jsx("p",{className:"text-sm",children:"Start by adding certifications that employees can opt into."})]})]})})]})]}),i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Certification Management"}),i.jsx("p",{className:"text-muted-foreground",children:"Tools and features for managing organizational certifications"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsxs(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer hover:scale-105",onClick:()=>{x(!0)},children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ts,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Add Certification"})]})}),i.jsx(yn,{children:i.jsx("p",{className:"text-muted-foreground text-sm",children:"Register new employee certifications and set renewal reminders"})})]}),i.jsxs(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer hover:scale-105",onClick:()=>{f(!0)},children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ds,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Renewal Tracking"})]})}),i.jsx(yn,{children:i.jsx("p",{className:"text-muted-foreground text-sm",children:"Monitor certification expiry dates and automate renewal notifications"})})]}),i.jsxs(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer hover:scale-105",onClick:()=>{v(!0)},children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Compliance Reports"})]})}),i.jsx(yn,{children:i.jsx("p",{className:"text-muted-foreground text-sm",children:"Generate compliance reports and track certification requirements"})})]})]})]}),i.jsx(Cn,{open:u,onOpenChange:x,children:i.jsxs(Pn,{className:"max-w-2xl",children:[i.jsx(Dn,{children:i.jsxs(On,{className:"flex items-center gap-2",children:[i.jsx(Ts,{className:"h-5 w-5 text-primary"}),"Add New Certification"]})}),i.jsxs("form",{onSubmit:async e=>{e.preventDefault(),y(!0);try{const{error:e}=await en.from("available_certifications").insert([{certification_name:b.certification_name,issuing_authority:b.issuing_authority||null,description:b.description||null,external_url:b.external_url||null,is_active:!0}]);if(e)throw e;N({certification_name:"",issuing_authority:"",description:"",external_url:""}),x(!1),d(),s(e=>e+1),alert("Certification added successfully! It will be available for employees to opt into.")}catch(t){alert("Error adding certification. Please try again.")}finally{y(!1)}},className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"certification_name",children:"Certification Name *"}),i.jsx(ln,{id:"certification_name",value:b.certification_name,onChange:e=>N(s=>({...s,certification_name:e.target.value})),placeholder:"e.g., AWS Certified Solutions Architect",required:!0})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"issuing_authority",children:"Issuing Authority"}),i.jsx(ln,{id:"issuing_authority",value:b.issuing_authority,onChange:e=>N(s=>({...s,issuing_authority:e.target.value})),placeholder:"e.g., Amazon Web Services"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"description",children:"Description"}),i.jsx(kf,{id:"description",value:b.description,onChange:e=>N(s=>({...s,description:e.target.value})),placeholder:"Brief description of the certification...",rows:3})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"external_url",children:"Certification URL"}),i.jsx(ln,{id:"external_url",type:"url",value:b.external_url,onChange:e=>N(s=>({...s,external_url:e.target.value})),placeholder:"e.g., https://aws.amazon.com/certification/certified-solutions-architect-associate/"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Optional: Link to certification information or registration page"})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[i.jsx(nn,{type:"button",variant:"outline",onClick:()=>x(!1),disabled:j,children:"Cancel"}),i.jsx(nn,{type:"submit",disabled:j,children:j?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding..."]}):i.jsxs(i.Fragment,{children:[i.jsx(_t,{className:"h-4 w-4 mr-2"}),"Add Certification"]})})]})]})]})}),i.jsx(Cn,{open:p,onOpenChange:f,children:i.jsxs(Pn,{className:"max-w-4xl",children:[i.jsx(Dn,{children:i.jsxs(On,{className:"flex items-center gap-2",children:[i.jsx(Ds,{className:"h-5 w-5 text-primary"}),"Renewal Tracking"]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-orange-100",children:i.jsx(Ds,{className:"h-4 w-4 text-orange-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold text-orange-600",children:t.expiringSoon}),i.jsx("p",{className:"text-sm font-medium",children:"Expiring Soon"}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Next 90 days"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-green-100",children:i.jsx(Gs,{className:"h-4 w-4 text-green-600"})}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold text-green-600",children:[t.renewalRate,"%"]}),i.jsx("p",{className:"text-sm font-medium",children:"Renewal Rate"}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Last 12 months"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:i.jsx(Wt,{className:"h-4 w-4 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.activeCertifications}),i.jsx("p",{className:"text-sm font-medium",children:"Active Certs"}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Currently valid"})]})]})})})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Certifications Expiring Soon"}),a&&a.filter(e=>{if(!e.expiry_date)return!1;const s=new Date(e.expiry_date),t=new Date,a=Math.ceil((s.getTime()-t.getTime())/864e5);return a<=90&&a>=0}).length>0?i.jsx("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:a.filter(e=>{if(!e.expiry_date)return!1;const s=new Date(e.expiry_date),t=new Date,a=Math.ceil((s.getTime()-t.getTime())/864e5);return a<=90&&a>=0}).map((e,s)=>{var t,a;const r=new Date(e.expiry_date),n=new Date,l=Math.ceil((r.getTime()-n.getTime())/864e5);return i.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium",children:e.certification_name}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[null==(t=e.xlsmart_employees)?void 0:t.first_name," ",null==(a=e.xlsmart_employees)?void 0:a.last_name]})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs(zn,{variant:l<=30?"destructive":"secondary",children:[l," days left"]}),i.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Expires: ",r.toLocaleDateString()]})]})]},s)})}):i.jsxs("div",{className:"text-center p-6 bg-green-50 rounded-lg",children:[i.jsx(Gs,{className:"h-8 w-8 mx-auto mb-2 text-green-600"}),i.jsx("p",{className:"font-medium text-green-800",children:"All Clear!"}),i.jsx("p",{className:"text-sm text-green-600",children:"No certifications expiring in the next 90 days."})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[i.jsx(nn,{variant:"outline",onClick:()=>f(!1),children:"Close"}),i.jsxs(nn,{children:[i.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Set Reminders"]})]})]})]})}),i.jsx(Cn,{open:g,onOpenChange:v,children:i.jsxs(Pn,{className:"max-w-4xl",children:[i.jsx(Dn,{children:i.jsxs(On,{className:"flex items-center gap-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-primary"}),"Compliance Reports"]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-blue-100",children:i.jsx(Ts,{className:"h-4 w-4 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold text-blue-600",children:t.totalCertifications}),i.jsx("p",{className:"text-sm font-medium",children:"Total Certs"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-green-100",children:i.jsx(Gs,{className:"h-4 w-4 text-green-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold text-green-600",children:t.activeCertifications}),i.jsx("p",{className:"text-sm font-medium",children:"Active"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-purple-100",children:i.jsx(Wt,{className:"h-4 w-4 text-purple-600"})}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:[t.complianceRate,"%"]}),i.jsx("p",{className:"text-sm font-medium",children:"Compliance"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-orange-100",children:i.jsx(Ds,{className:"h-4 w-4 text-orange-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold text-orange-600",children:t.expiringSoon}),i.jsx("p",{className:"text-sm font-medium",children:"At Risk"})]})]})})})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Department Compliance Summary"}),a&&a.length>0?i.jsx("div",{className:"space-y-3",children:(()=>{const e=a.reduce((e,s)=>{var t;const a=(null==(t=s.xlsmart_employees)?void 0:t.current_department)||"Unknown";if(e[a]||(e[a]={total:0,active:0,expiring:0}),e[a].total++,(!s.expiry_date||new Date(s.expiry_date)>new Date)&&e[a].active++,s.expiry_date){const t=new Date(s.expiry_date),r=new Date,n=Math.ceil((t.getTime()-r.getTime())/864e5);n<=90&&n>=0&&e[a].expiring++}return e},{});return Object.entries(e).map(([e,s])=>{const t=s.total>0?Math.round(s.active/s.total*100):0;return i.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-medium",children:e}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[s.total," total certifications"]})]}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-lg font-bold text-green-600",children:s.active}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Active"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-lg font-bold text-orange-600",children:s.expiring}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Expiring"})]}),i.jsxs(zn,{variant:t>=80?"default":t>=60?"secondary":"destructive",children:[t,"% compliant"]})]})]},e)})})()}):i.jsxs("div",{className:"text-center p-6 bg-muted/50 rounded-lg",children:[i.jsx(Ut,{className:"h-8 w-8 mx-auto mb-2 text-muted-foreground"}),i.jsx("p",{className:"font-medium",children:"No Compliance Data"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Employee certifications needed to generate compliance reports."})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[i.jsx(nn,{variant:"outline",onClick:()=>v(!1),children:"Close"}),i.jsxs(nn,{variant:"outline",children:[i.jsx(Ut,{className:"h-4 w-4 mr-2"}),"Export PDF"]}),i.jsxs(nn,{children:[i.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Schedule Report"]})]})]})]})})]})},Wy=()=>{const[e,s]=ce.useState([]),[t,a]=ce.useState(!0),[r,n]=ce.useState(null),i=async()=>{try{a(!0),n(null);const{data:e,error:t}=await en.from("xlsmart_employees").select("*").eq("is_active",!0).order("first_name",{ascending:!0});if(t)throw new Error(t.message||"Failed to fetch employees");s(e||[])}catch(e){const s=e instanceof Error?e.message:"Unknown error occurred";n(s)}finally{a(!1)}};return ce.useEffect(()=>{i()},[]),{employees:e,loading:t,error:r,refresh:i}},Yy=({title:e,value:s,subtitle:t,icon:a,color:r,trend:n,details:l,onClick:c})=>{const[o,d]=ce.useState(!1);return i.jsxs(Cn,{open:o,onOpenChange:d,children:[i.jsx(An,{asChild:!0,children:i.jsx(fn,{className:"hover:shadow-xl transition-all duration-300 cursor-pointer border-0 shadow-lg bg-gradient-to-br from-background to-muted/20 group",children:i.jsx(yn,{className:"p-6",children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[i.jsx("div",{className:`p-3 rounded-xl bg-gradient-to-br ${r} shadow-lg group-hover:scale-110 transition-transform duration-300`,children:i.jsx(a,{className:"h-6 w-6 text-white"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:e}),n&&i.jsx(zn,{variant:"outline",className:"text-xs",children:n})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("div",{className:"text-3xl font-bold text-foreground",children:s}),i.jsx("p",{className:"text-sm text-muted-foreground",children:t})]})]}),i.jsx(nn,{variant:"ghost",size:"sm",className:"opacity-0 group-hover:opacity-100 transition-opacity",children:"View Details"})]})})})}),i.jsxs(Pn,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[i.jsx(Dn,{children:i.jsxs(On,{className:"flex items-center space-x-2",children:[i.jsx(a,{className:"h-5 w-5"}),i.jsxs("span",{children:[e," - Detailed Analytics"]})]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"text-center p-4 bg-muted/30 rounded-lg",children:[i.jsx("div",{className:"text-2xl font-bold text-primary",children:s}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Current Value"})]}),i.jsxs("div",{className:"text-center p-4 bg-muted/30 rounded-lg",children:[i.jsx("div",{className:"text-lg font-bold text-secondary",children:n||"Stable"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Trend"})]}),i.jsxs("div",{className:"text-center p-4 bg-muted/30 rounded-lg",children:[i.jsxs("div",{className:"text-lg font-bold text-accent",children:[Math.floor(20*Math.random()+80),"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Health Score"})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold",children:"Detailed Breakdown"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:l.map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-4 space-y-2",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"font-medium",children:e.label}),i.jsx(zn,{variant:"outline",children:e.value})]}),e.progress&&i.jsx(Bi,{value:e.progress,className:"h-2"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]},s))})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold",children:"Recommended Actions"}),i.jsx("div",{className:"space-y-2",children:["Review underperforming areas","Implement improvement strategies","Schedule follow-up assessments","Update training programs"].map((e,s)=>i.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-muted/20 rounded",children:[i.jsx(Ft,{className:"h-4 w-4 text-primary"}),i.jsx("span",{className:"text-sm",children:e})]},s))})]})]})]})]})},Ky=({metrics:e})=>{if(!e)return null;const s=Object.entries(e.skillDistribution||{}).sort(([,e],[,s])=>s-e).slice(0,8);return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Rs,{className:"h-5 w-5 text-primary"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:Object.keys(e.skillDistribution||{}).length}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Skills"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ft,{className:"h-5 w-5 text-secondary"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold",children:[e.skillGaps.averageMatchPercentage,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Match Score"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Bt,{className:"h-5 w-5 text-destructive"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:e.skillGaps.criticalGaps}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Critical Gaps"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Gs,{className:"h-5 w-5 text-accent"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:e.skillGaps.totalAssessments}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Assessments"})]})]})})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Top Skills Distribution"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:s.map(([s,t])=>{const a=Math.round(t/e.totalEmployees*100);return i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium",children:s}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("span",{className:"text-sm text-muted-foreground",children:[t," employees"]}),i.jsxs(zn,{variant:"outline",children:[a,"%"]})]})]}),i.jsx(Bi,{value:a,className:"h-2"})]},s)})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Bt,{className:"h-5 w-5 text-destructive"}),i.jsx("span",{children:"Skill Gap Analysis"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:[{skill:"AI/Machine Learning",currentSupply:12,requiredDemand:25,gap:52},{skill:"Cybersecurity",currentSupply:8,requiredDemand:18,gap:56},{skill:"Cloud Architecture",currentSupply:15,requiredDemand:28,gap:46},{skill:"Data Science",currentSupply:20,requiredDemand:35,gap:43},{skill:"DevOps",currentSupply:18,requiredDemand:30,gap:40}].map((e,s)=>{const t=(e=>e>=70?{color:"text-destructive",label:"Critical"}:e>=40?{color:"text-orange-500",label:"High"}:{color:"text-yellow-500",label:"Medium"})(e.gap);return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsx("span",{className:"font-medium",children:e.skill}),i.jsx(zn,{variant:e.gap>=50?"destructive":"secondary",className:t.color,children:t.label})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsxs("span",{children:["Supply: ",e.currentSupply]}),i.jsxs("span",{children:["Demand: ",e.requiredDemand]})]}),i.jsx(Bi,{value:100-e.gap,className:"h-2"}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.gap,"% gap (",e.requiredDemand-e.currentSupply," employees needed)"]})]})]},s)})})})]})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"AI-Powered Skill Development Recommendations"})}),i.jsx(yn,{children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{category:"Technical Skills",priority:"High",recommendations:["Cloud Computing","Machine Learning","API Development"],impact:"Immediate productivity boost"},{category:"Leadership Skills",priority:"Medium",recommendations:["Team Management","Strategic Planning","Change Management"],impact:"Enhanced team performance"},{category:"Digital Skills",priority:"High",recommendations:["Data Analytics","Automation","Digital Transformation"],impact:"Future-ready workforce"}].map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h4",{className:"font-medium",children:e.category}),i.jsxs(zn,{variant:"High"===e.priority?"destructive":"secondary",children:[e.priority," Priority"]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("p",{className:"text-sm text-muted-foreground",children:"Focus Areas:"}),i.jsx("div",{className:"flex flex-wrap gap-1",children:e.recommendations.map((e,s)=>i.jsx(zn,{variant:"outline",className:"text-xs",children:e},s))})]}),i.jsx("p",{className:"text-xs text-primary font-medium",children:e.impact})]},s))})})]})]})},Jy=({metrics:e})=>{var s,t,a,r;const[n,l]=ce.useState(!1),[c,o]=ce.useState([]),[d,m]=ce.useState(!1),[h,u]=ce.useState(null),{toast:x}=De(),[p,f]=ce.useState({employeeId:"",employeeName:"",currentPosition:"",targetRole:"",careerGoals:"",currentSkills:"",timeframe:"12"});if(ce.useEffect(()=>{(async()=>{const{data:e,error:s}=await en.from("xlsmart_employees").select("id, first_name, last_name, current_position, current_department").eq("is_active",!0).order("first_name");!s&&e&&o(e)})()},[]),!e)return null;const g=[{currentRole:"Software Engineer",employees:Math.floor(.25*(e.totalEmployees||0)),nextRoles:["Senior Software Engineer","Tech Lead","Engineering Manager"],readinessScore:78,timeframe:"6-12 months",requiredSkills:["Leadership","System Design","Mentoring"]},{currentRole:"Business Analyst",employees:Math.floor(.15*(e.totalEmployees||0)),nextRoles:["Senior Business Analyst","Product Manager","Solutions Architect"],readinessScore:65,timeframe:"8-15 months",requiredSkills:["Product Management","Stakeholder Management","Strategic Thinking"]},{currentRole:"Marketing Specialist",employees:Math.floor(.12*(e.totalEmployees||0)),nextRoles:["Marketing Manager","Brand Manager","Digital Marketing Lead"],readinessScore:72,timeframe:"6-10 months",requiredSkills:["Team Leadership","Budget Management","Campaign Strategy"]},{currentRole:"Data Analyst",employees:Math.floor(.18*(e.totalEmployees||0)),nextRoles:["Senior Data Analyst","Data Scientist","Analytics Manager"],readinessScore:84,timeframe:"4-8 months",requiredSkills:["Machine Learning","Data Engineering","Statistical Modeling"]}],v=e=>e>=80?"text-green-600":e>=60?"text-yellow-600":"text-red-600";return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ft,{className:"h-5 w-5 text-primary"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:(null==(s=e.careerPathways)?void 0:s.totalPathways)||0}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Pathways"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-secondary"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:(null==(t=e.mobilityPlanning)?void 0:t.readyForPromotion)||0}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Ready for Promotion"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Wt,{className:"h-5 w-5 text-accent"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:(null==(a=e.mobilityPlanning)?void 0:a.internalMoves)||0}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Internal Moves"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ot,{className:"h-5 w-5 text-primary"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold",children:[(null==(r=e.careerPathways)?void 0:r.avgReadinessScore)||0,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Readiness"})]})]})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Career Progression Analytics"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-6",children:g.map((e,s)=>{return i.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-lg",children:e.currentRole}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.employees," employees in this role"]})]}),i.jsxs(zn,{variant:(t=e.readinessScore,t>=80?"default":t>=60?"secondary":"destructive"),children:[e.readinessScore,"% Ready"]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"space-y-3",children:[i.jsx("h5",{className:"font-medium text-sm",children:"Next Career Steps"}),i.jsx("div",{className:"space-y-2",children:e.nextRoles.map((e,s)=>i.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-muted/30 rounded",children:[i.jsx(Es,{className:"h-4 w-4 text-primary"}),i.jsx("span",{className:"text-sm font-medium",children:e})]},s))})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h5",{className:"font-medium text-sm",children:"Readiness Score"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(Bi,{value:e.readinessScore,className:"h-3"}),i.jsxs("div",{className:"flex justify-between text-sm",children:[i.jsxs("span",{className:v(e.readinessScore),children:[e.readinessScore,"% Ready"]}),i.jsxs("span",{className:"text-muted-foreground",children:[i.jsx(Ys,{className:"h-3 w-3 inline mr-1"}),e.timeframe]})]})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("h5",{className:"font-medium text-sm",children:"Development Focus"}),i.jsx("div",{className:"flex flex-wrap gap-1",children:e.requiredSkills.map((e,s)=>i.jsx(zn,{variant:"outline",className:"text-xs",children:e},s))}),i.jsxs(nn,{size:"sm",className:"w-full mt-2",onClick:()=>(e=>{u(e),f({...p,targetRole:e.nextRoles[0]||"",currentSkills:e.requiredSkills.join(", ")}),l(!0)})(e),children:[i.jsx(Cs,{className:"h-4 w-4 mr-2"}),"Create Development Plan"]})]})]})]},s);var t})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Succession Planning Insights"})}),i.jsx(yn,{children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[{role:"Engineering Manager",criticality:"High",successors:3,readiness:"2 ready now, 1 in 6 months",risk:"Low"},{role:"Product Manager",criticality:"High",successors:2,readiness:"1 ready now, 1 in 12 months",risk:"Medium"},{role:"Sales Director",criticality:"Critical",successors:1,readiness:"1 ready in 8 months",risk:"High"}].map((e,s)=>i.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h4",{className:"font-medium",children:e.role}),i.jsx(zn,{variant:"Critical"===e.criticality?"destructive":"High"===e.criticality?"secondary":"outline",children:e.criticality})]}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted-foreground",children:"Successors:"}),i.jsx("span",{className:"font-medium",children:e.successors})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-muted-foreground",children:"Readiness:"}),i.jsx("p",{className:"text-xs mt-1",children:e.readiness})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted-foreground",children:"Risk:"}),i.jsx(zn,{variant:"High"===e.risk?"destructive":"Medium"===e.risk?"secondary":"outline",children:e.risk})]})]})]},s))})})]}),i.jsx(Cn,{open:n,onOpenChange:l,children:i.jsxs(Pn,{className:"max-w-md",children:[i.jsx(Dn,{children:i.jsxs(On,{className:"flex items-center gap-2",children:[i.jsx(Cs,{className:"h-5 w-5 text-primary"}),"Create Development Plan"]})}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"employee",children:"Select Employee"}),i.jsxs(bn,{value:p.employeeId,onValueChange:e=>{const s=c.find(s=>s.id===e);s&&f({...p,employeeId:e,employeeName:`${s.first_name} ${s.last_name}`,currentPosition:s.current_position||""})},children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Choose an employee..."})}),i.jsx(Sn,{children:c.map(e=>i.jsxs(En,{value:e.id,children:[e.first_name," ",e.last_name," - ",e.current_position]},e.id))})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"targetRole",children:"Target Role"}),i.jsx(ln,{id:"targetRole",value:p.targetRole,onChange:e=>f({...p,targetRole:e.target.value}),placeholder:"e.g., Senior Software Engineer"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"careerGoals",children:"Career Goals"}),i.jsx(kf,{id:"careerGoals",value:p.careerGoals,onChange:e=>f({...p,careerGoals:e.target.value}),placeholder:"Describe the employee's career aspirations and objectives...",rows:3})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"currentSkills",children:"Current Skills (comma-separated)"}),i.jsx(ln,{id:"currentSkills",value:p.currentSkills,onChange:e=>f({...p,currentSkills:e.target.value}),placeholder:"e.g., JavaScript, React, Node.js"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"timeframe",children:"Development Timeline (months)"}),i.jsxs(bn,{value:p.timeframe,onValueChange:e=>f({...p,timeframe:e}),children:[i.jsx(wn,{children:i.jsx(Nn,{})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"6",children:"6 months"}),i.jsx(En,{value:"12",children:"12 months"}),i.jsx(En,{value:"18",children:"18 months"}),i.jsx(En,{value:"24",children:"24 months"})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-4",children:[i.jsx(nn,{variant:"outline",onClick:()=>l(!1),disabled:d,children:"Cancel"}),i.jsx(nn,{onClick:async()=>{var e;if(p.employeeId&&p.careerGoals&&p.targetRole){m(!0);try{const s=c.find(e=>e.id===p.employeeId),{data:t,error:a}=await en.functions.invoke("development-pathways",{body:{employeeProfile:{name:p.employeeName,currentPosition:p.currentPosition,experienceLevel:"Intermediate",department:(null==s?void 0:s.current_department)||""},careerGoals:p.careerGoals,currentSkills:p.currentSkills.split(",").map(e=>e.trim()).filter(e=>e),industryTrends:"Current trends in telecommunications and technology"}});if(a)throw a;const r={employee_id:p.employeeId,target_role:p.targetRole,current_skill_level:0,target_skill_level:5,development_areas:p.currentSkills.split(",").map(e=>e.trim()).filter(e=>e),recommended_courses:[],recommended_certifications:[],recommended_projects:[],timeline_months:parseInt(p.timeframe),progress_percentage:0,plan_status:"active",created_by:(null==(e=(await en.auth.getUser()).data.user)?void 0:e.id)||"",assigned_to:p.employeeId,next_review_date:new Date(Date.now()+2592e6)},{error:n}=await en.from("xlsmart_development_plans").insert(r);if(n)throw n;x({title:"Development Plan Created",description:`Successfully created development plan for ${p.employeeName}`}),f({employeeId:"",employeeName:"",currentPosition:"",targetRole:"",careerGoals:"",currentSkills:"",timeframe:"12"}),l(!1)}catch(s){x({title:"Error",description:"Failed to create development plan. Please try again.",variant:"destructive"})}finally{m(!1)}}else x({title:"Missing Information",description:"Please fill in employee, target role, and career goals.",variant:"destructive"})},disabled:d,children:d?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"h-4 w-4 mr-2 animate-spin"}),"Creating Plan..."]}):i.jsxs(i.Fragment,{children:[i.jsx(Cs,{className:"h-4 w-4 mr-2"}),"Create Plan"]})})]})]})]})})]})},Xy=({metrics:e})=>{var s,t,a,r,n,l,c,o,d,m,h,u,x,p,f,g,v,j;const y=Vy();if(!e)return null;const b=e.totalEmployees||0,N=(null==(s=e.retentionRisk)?void 0:s.highRisk)||0,w=(null==(t=e.retentionRisk)?void 0:t.mediumRisk)||0,_=(null==(a=e.retentionRisk)?void 0:a.lowRisk)||0,k=b>0?Math.round(100-N/b*100):0,S=[{range:"4.5-5.0",count:(null==(r=e.performanceMetrics)?void 0:r.highPerformers)||0,label:"Exceptional",color:"bg-green-500"},{range:"3.5-4.4",count:Math.floor(.4*(e.totalEmployees||0)),label:"High Performer",color:"bg-blue-500"},{range:"2.5-3.4",count:Math.floor(.3*(e.totalEmployees||0)),label:"Meets Expectations",color:"bg-yellow-500"},{range:"1.5-2.4",count:(null==(n=e.performanceMetrics)?void 0:n.lowPerformers)||0,label:"Needs Improvement",color:"bg-orange-500"},{range:"1.0-1.4",count:Math.floor(.05*(e.totalEmployees||0)),label:"Underperforming",color:"bg-red-500"}];return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ts,{className:"h-5 w-5 text-primary"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:(null==(l=e.performanceMetrics)?void 0:l.averageRating)||0}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Performance"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-secondary"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold",children:[k,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Retention Rate"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ft,{className:"h-5 w-5 text-accent"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:(null==(c=e.performanceMetrics)?void 0:c.highPerformers)||0}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"High Performers"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Vs,{className:"h-5 w-5 text-destructive"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:(null==(o=e.retentionRisk)?void 0:o.highRisk)||0}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Flight Risk"})]})]})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ts,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Performance Distribution"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:S.map((s,t)=>{const a=e.totalEmployees>0?Math.round(s.count/e.totalEmployees*100):0;return i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${s.color}`}),i.jsx("span",{className:"font-medium",children:s.label}),i.jsx(zn,{variant:"outline",children:s.range})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("span",{className:"font-bold",children:s.count}),i.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a,"%)"]})]})]}),i.jsx(Bi,{value:a,className:"h-2"})]},t)})})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(It,{className:"h-5 w-5 text-destructive"}),i.jsx("span",{children:"Retention Risk Analysis"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:[{level:"High Risk",count:(null==(d=e.retentionRisk)?void 0:d.highRisk)||0,color:"bg-red-500",description:"Immediate attention required"},{level:"Medium Risk",count:(null==(m=e.retentionRisk)?void 0:m.mediumRisk)||0,color:"bg-yellow-500",description:"Monitor closely"},{level:"Low Risk",count:(null==(h=e.retentionRisk)?void 0:h.lowRisk)||0,color:"bg-green-500",description:"Stable employees"}].map((e,s)=>{const t=N+w+_,a=t>0?Math.round(e.count/t*100):0;return i.jsxs("div",{className:"border rounded-lg p-3",children:[i.jsxs("div",{className:"flex items-center justify-between mb-2",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${e.color}`}),i.jsx("span",{className:"font-medium",children:e.level})]}),i.jsxs("span",{className:"font-bold",children:[e.count," (",a,"%)"]})]}),i.jsx(Bi,{value:a,className:"h-2 mb-1"}),i.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]},s)})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Wt,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Department Performance"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:Object.entries(e.departmentBreakdown||{}).slice(0,5).map(([e,s],t)=>{const a=Math.round(1.5*Math.random()+3.5);return i.jsxs("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:e}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[s," employees"]})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"text-lg font-bold text-primary",children:a.toFixed(1)}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Avg Rating"})]})]},t)})})})]})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"AI-Powered Talent Insights"})}),i.jsx(yn,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs(Hi,{children:[i.jsx(Ut,{className:"h-4 w-4"}),i.jsxs(Vi,{children:[i.jsx("strong",{children:"Promotion Readiness:"})," ",(null==(u=e.mobilityPlanning)?void 0:u.readyForPromotion)||0," employees are ready for promotion based on performance and skill assessments."]})]}),i.jsxs(Hi,{children:[i.jsx(Vs,{className:"h-4 w-4"}),i.jsxs(Vi,{children:[i.jsx("strong",{children:"Skill Gaps:"})," ",(null==(x=e.skillGaps)?void 0:x.criticalGaps)||0," critical skill gaps identified that may impact team performance."]})]}),i.jsxs(Hi,{children:[i.jsx(Wt,{className:"h-4 w-4"}),i.jsxs(Vi,{children:[i.jsx("strong",{children:"Internal Mobility:"})," ",(null==(p=e.mobilityPlanning)?void 0:p.totalPlans)||0," employees have active career development plans in progress."]})]})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Training & Development Impact"})}),i.jsx(yn,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-3xl font-bold text-primary mb-2",children:[(null==(f=e.trainingMetrics)?void 0:f.completionRate)||0,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Training Completion Rate"}),i.jsx(Bi,{value:(null==(g=e.trainingMetrics)?void 0:g.completionRate)||0,className:"mt-2"})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-3xl font-bold text-secondary mb-2",children:[(null==(v=e.trainingMetrics)?void 0:v.averageHours)||0,"h"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Avg Training Hours"}),i.jsx(Bi,{value:Math.min(((null==(j=e.trainingMetrics)?void 0:j.averageHours)||0)/40*100,100),className:"mt-2"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-accent mb-2",children:y.activeCertifications}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Certifications"}),i.jsxs("p",{className:"text-xs text-destructive mt-1",children:[y.expiringSoon," expiring soon"]})]})]})})]})]})},Zy=()=>{const{metrics:e,loading:s,error:t,refetch:a}=(()=>{const[e,s]=ce.useState(null),[t,a]=ce.useState(!0),[r,n]=ce.useState(null),i=async()=>{try{a(!0),n(null);const[t,r,i,l,c,o,d,m]=await Promise.all([en.from("xlsmart_employees").select("*"),en.from("xlsmart_skill_assessments").select("*"),en.from("employee_certifications").select("*, xlsmart_employees(current_department)"),en.from("employee_training_enrollments").select("\n          *,\n          training_programs(name, category, duration_hours),\n          xlsmart_employees!employee_training_enrollments_employee_id_fkey(current_department)\n        "),en.from("training_programs").select("*"),en.from("xlsmart_role_mappings").select("*"),en.from("xlsmart_standard_roles").select("*"),en.from("ai_analysis_results").select("*")]);if(t.error)throw t.error;if(r.error)throw r.error;if(i.error)throw i.error;if(l.error)throw l.error;if(c.error)throw c.error;if(o.error)throw o.error;if(d.error)throw d.error;if(m.error)throw m.error;let h=[];try{const e=await en.from("training_completions").select("*");e.error||(h=e.data||[])}catch(e){}const u=t.data||[],x=r.data||[],p=i.data||[],f=l.data||[],g=c.data||[],v=(o.data,d.data,m.data||[]),j=u.length,y=u.reduce((e,s)=>e+(s.years_of_experience||0),0)/j||0,b={};u.forEach(e=>{const s=e.current_department||e.source_company||"Unassigned";b[s]=(b[s]||0)+1});const N={};u.forEach(e=>{e.skills&&Array.isArray(e.skills)&&e.skills.forEach(e=>{const s="string"==typeof e?e:e.name||e.skill||"Unknown";s&&s.length>1&&!s.includes(":")&&(N[s]=(N[s]||0)+1)})});const w=u.map(e=>Number(e.performance_rating)).filter(e=>!isNaN(e)&&e>0),_=w.reduce((e,s)=>e+s,0)/w.length||0,k=w.filter(e=>e>=4).length,S=w.filter(e=>e<=2).length,E=g.length,T=(g.filter(e=>"active"===e.status).length,f.length),C=h.length>0?h.length:f.filter(e=>"completed"===e.status).length,A=(f.filter(e=>"in_progress"===e.status).length,T>0?C/T*100:0),R=g.reduce((e,s)=>e+(s.duration_hours||0),0),I=f.reduce((e,s)=>e+(s.time_spent_hours||0),0),P=T>0?I>0?I/T:R/Math.max(T,1):0,D=p.length,M=new Date((new Date).getTime()+7776e6),O=p.filter(e=>e.expiry_date&&new Date(e.expiry_date)<=M).length,F={};p.forEach(e=>{const s=e.certification_name||"Unknown";F[s]=(F[s]||0)+1}),g.forEach(e=>{if(e.certification_provided&&e.certification_name){const s=f.filter(s=>s.training_program_id===e.id&&["completed","in_progress"].includes(s.status)).length;s>0&&(F[e.certification_name]=(F[e.certification_name]||0)+s)}});const L=Object.entries(F).map(([e,s])=>({name:e,count:s})).sort((e,s)=>s.count-e.count).slice(0,5),z=new Map;x.forEach(e=>{const s=e.employee_id,t=z.get(s);(!t||new Date(e.assessment_date)>new Date(t.assessment_date))&&z.set(s,e)});const U=Array.from(z.values()),B=U.length,$=U.reduce((e,s)=>e+(Number(s.overall_match_percentage)||0),0)/B||0,H=U.filter(e=>e.overall_match_percentage&&Number(e.overall_match_percentage)<60).length,V={};u.forEach(e=>{const s=e.current_position||"Unassigned";V[s]=(V[s]||0)+1});const G=U.filter(e=>(e.churn_risk_score||0)>70||(e.rotation_risk_score||0)>70).length,q=U.filter(e=>(e.churn_risk_score||0)>40&&(e.churn_risk_score||0)<=70||(e.rotation_risk_score||0)>40&&(e.rotation_risk_score||0)<=70).length,W=j-G-q,Y=v.filter(e=>"career_planning"===e.analysis_type||"employee-career-paths"===e.function_name),K=Y.length,J=Y.filter(e=>"completed"===e.status).length,X=v.filter(e=>"mobility_planning"===e.analysis_type||"employee-mobility-planning"===e.function_name).length,Z=Math.floor(.3*X),Q=Math.floor(.15*j),ee=v.filter(e=>"mobility_plan"===e.analysis_type||"employee-mobility-planning-bulk"===e.function_name).length,se=v.filter(e=>"career_path"===e.analysis_type||"employee-career-paths-bulk"===e.function_name).length,te={totalEmployees:j,averageExperience:Math.round(10*y)/10,skillDistribution:N,departmentBreakdown:b,performanceMetrics:{averageRating:Math.round(10*_)/10,highPerformers:k,lowPerformers:S},trainingMetrics:{totalTrainings:E,completionRate:Math.round(A),averageHours:Math.round(P)},certificationMetrics:{totalCertifications:D,expiringCertifications:O,topCertifications:L},skillGaps:{criticalGaps:H,totalAssessments:B,averageMatchPercentage:Math.round($)},roleDistribution:V,retentionRisk:{highRisk:G,mediumRisk:q,lowRisk:W},careerPathways:{totalPathways:K,activePathways:J,avgReadinessScore:Math.round(30*Math.random()+60)},mobilityPlanning:{totalPlans:X,internalMoves:Z,readyForPromotion:Q},aiInsights:{totalAnalyses:v.length,roleOptimizations:ee,skillRecommendations:se}};s(te)}catch(t){n(t instanceof Error?t.message:"Failed to fetch analytics")}finally{a(!1)}};return ce.useEffect(()=>{i()},[]),{metrics:e,loading:t,error:r,refetch:i}})(),r=Vy(),{certifications:n}=Hy(),{availableCertifications:l}=Gy(),{employees:c}=Wy(),[o,d]=ce.useState("overview"),[m,h]=ce.useState(!1),[u,x]=ce.useState(""),[p,f]=ce.useState(""),[g,v]=ce.useState(""),[j,y]=ce.useState(!1),[b,N]=ce.useState(null),[w,_]=ce.useState(!1),[k,S]=ce.useState(!1),[E,T]=ce.useState(!1),[C,A]=ce.useState(""),[R,I]=ce.useState(""),[P,D]=ce.useState(!1),[M,O]=ce.useState(!1),F=async()=>{var e;if(u&&p&&g){y(!0);try{const s=l.find(e=>e.id===p);if(!s)return void xr.error("Selected certification not found");const{data:t,error:a}=await en.functions.invoke("assign-certification",{body:{employee_id:u,certification_name:s.certification_name.trim(),certification_type:"professional",provider:(null==(e=s.issuing_authority)?void 0:e.trim())||"Unknown",issue_date:(new Date).toISOString().split("T")[0],expiry_date:g}});if(a)throw a;if(!t.success)throw new Error(t.error||"Unknown error from function");xr.success("Certification assigned successfully!"),h(!1),x(""),f(""),v(""),window.location.reload()}catch(s){xr.error(`Failed to assign certification: ${s instanceof Error?s.message:"Unknown error"}`)}finally{y(!1)}}else xr.error("Please fill in all required fields")};if(s)return i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx(kt,{className:"h-12 w-12 animate-spin mx-auto mb-4 text-primary"}),i.jsx("h3",{className:"text-xl font-semibold mb-2",children:"Loading Workforce Analytics"}),i.jsx("p",{className:"text-muted-foreground",children:"Analyzing data from multiple sources..."})]})});if(t)return i.jsx("div",{className:"space-y-6",children:i.jsxs("div",{className:"text-center py-12",children:[i.jsx(Bt,{className:"h-12 w-12 mx-auto mb-4 text-destructive"}),i.jsx("h3",{className:"text-xl font-semibold mb-2 text-destructive",children:"Error Loading Analytics"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:t}),i.jsxs(nn,{onClick:a,variant:"outline",children:[i.jsx(kt,{className:"h-4 w-4 mr-2"}),"Retry"]})]})});const L=[{title:"Total Workforce",value:(null==e?void 0:e.totalEmployees)||0,subtitle:"Active employees across all departments",icon:Wt,color:"from-blue-500 to-blue-600",trend:"↗ +5.2% this month",details:[{label:"Full-time",value:Math.floor(.85*((null==e?void 0:e.totalEmployees)||0)),progress:85,description:"Permanent employees"},{label:"Part-time",value:Math.floor(.15*((null==e?void 0:e.totalEmployees)||0)),progress:15,description:"Contract & temporary staff"},{label:"Remote",value:Math.floor(.6*((null==e?void 0:e.totalEmployees)||0)),progress:60,description:"Working remotely"},{label:"On-site",value:Math.floor(.4*((null==e?void 0:e.totalEmployees)||0)),progress:40,description:"Office-based employees"}]},{title:"AI Assessments",value:(null==e?void 0:e.skillGaps.totalAssessments)||0,subtitle:"Completed skill and performance assessments",icon:Rs,color:"from-purple-500 to-purple-600",trend:"↗ +12.8% this week",details:[{label:"Skills Assessments",value:(null==e?void 0:e.skillGaps.totalAssessments)||0,progress:78,description:"Technical & soft skills"},{label:"Performance Reviews",value:Math.floor(.9*((null==e?void 0:e.totalEmployees)||0)),progress:90,description:"Annual reviews completed"},{label:"Career Assessments",value:(null==e?void 0:e.careerPathways.totalPathways)||0,progress:65,description:"Career planning sessions"},{label:"AI Recommendations",value:(null==e?void 0:e.aiInsights.totalAnalyses)||0,progress:82,description:"AI-generated insights"}]},{title:"Avg Performance",value:`${(null==e?void 0:e.performanceMetrics.averageRating)||0}/5`,subtitle:"Organization-wide performance rating",icon:Ts,color:"from-green-500 to-green-600",trend:"↗ +0.3 from last quarter",details:[{label:"Exceptional (5.0)",value:Math.floor(.15*((null==e?void 0:e.totalEmployees)||0)),progress:15,description:"Top performers"},{label:"Exceeds (4.0-4.9)",value:(null==e?void 0:e.performanceMetrics.highPerformers)||0,progress:35,description:"Above average"},{label:"Meets (3.0-3.9)",value:Math.floor(.4*((null==e?void 0:e.totalEmployees)||0)),progress:40,description:"Meeting expectations"},{label:"Below (1.0-2.9)",value:(null==e?void 0:e.performanceMetrics.lowPerformers)||0,progress:10,description:"Needs improvement"}]},{title:"Role Types",value:Object.keys((null==e?void 0:e.roleDistribution)||{}).length,subtitle:"Distinct roles across the organization",icon:Ft,color:"from-orange-500 to-orange-600",trend:"→ Stable",details:Object.entries((null==e?void 0:e.roleDistribution)||{}).map(([s,t])=>({label:s,value:t,progress:Math.round(t/(null==e?void 0:e.totalEmployees)*100),description:`${Math.round(t/(null==e?void 0:e.totalEmployees)*100)}% of workforce`}))}],z=[{icon:Ut,title:"High Performers Ready",value:(null==e?void 0:e.mobilityPlanning.readyForPromotion)||0,description:"Employees ready for promotion",color:"text-green-600",bgColor:"bg-green-50"},{icon:Bt,title:"Critical Skill Gaps",value:(null==e?void 0:e.skillGaps.criticalGaps)||0,description:"Areas requiring immediate attention",color:"text-red-600",bgColor:"bg-red-50"},{icon:It,title:"Flight Risk",value:(null==e?void 0:e.retentionRisk.highRisk)||0,description:"Employees at high retention risk",color:"text-orange-600",bgColor:"bg-orange-50"},{icon:Cs,title:"Training Completion",value:`${(null==e?void 0:e.trainingMetrics.completionRate)||0}%`,description:"Overall training completion rate",color:"text-blue-600",bgColor:"bg-blue-50"}];return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-4xl font-bold bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent",children:"Workforce Intelligence Hub"}),i.jsx("p",{className:"text-lg text-muted-foreground mt-2",children:"AI-powered insights across roles, skills, career pathways, and organizational development"})]}),i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsxs(zn,{variant:"outline",className:"px-3 py-1",children:[i.jsx(ks,{className:"h-3 w-3 mr-1"}),"Live Data"]}),i.jsxs(nn,{onClick:a,variant:"outline",size:"sm",children:[i.jsx(kt,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:L.map((e,s)=>i.jsx(Yy,{title:e.title,value:e.value,subtitle:e.subtitle,icon:e.icon,color:e.color,trend:e.trend,details:e.details},s))}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:z.map((e,s)=>i.jsx(fn,{className:`${e.bgColor} border-0 hover:shadow-md transition-shadow`,children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(e.icon,{className:`h-8 w-8 ${e.color}`}),i.jsxs("div",{children:[i.jsx("div",{className:"text-2xl font-bold text-foreground",children:e.value}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:e.title}),i.jsx("p",{className:"text-xs text-muted-foreground",children:e.description})]})]})})},s))})]}),i.jsxs(hn,{value:o,onValueChange:d,className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-10 lg:w-fit bg-muted/50 p-1 rounded-xl",children:[i.jsxs(xn,{value:"overview",className:"flex items-center gap-2 data-[state=active]:bg-background",children:[i.jsx(Ms,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Overview"})]}),i.jsxs(xn,{value:"performance",className:"flex items-center gap-2 data-[state=active]:bg-background",children:[i.jsx(Bt,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Performance"})]}),i.jsxs(xn,{value:"skills",className:"flex items-center gap-2 data-[state=active]:bg-background",children:[i.jsx(Rs,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Skills"})]}),i.jsxs(xn,{value:"career-pathways",className:"flex items-center gap-2 data-[state=active]:bg-background",children:[i.jsx(mt,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Careers"})]}),i.jsxs(xn,{value:"talent",className:"flex items-center gap-2 data-[state=active]:bg-background",children:[i.jsx(Wt,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Talent"})]}),i.jsxs(xn,{value:"departments",className:"flex items-center gap-2 data-[state=active]:bg-background",children:[i.jsx(Ft,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Departments"})]}),i.jsxs(xn,{value:"training",className:"flex items-center gap-2 data-[state=active]:bg-background",children:[i.jsx(Cs,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Training"})]}),i.jsxs(xn,{value:"certifications",className:"flex items-center gap-2 data-[state=active]:bg-background",children:[i.jsx(Ts,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Certifications"})]}),i.jsxs(xn,{value:"analytics",className:"flex items-center gap-2 data-[state=active]:bg-background",children:[i.jsx(ks,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Analytics"})]}),i.jsxs(xn,{value:"insights",className:"flex items-center gap-2 data-[state=active]:bg-background",children:[i.jsx(Zt,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"AI Insights"})]})]}),i.jsxs(pn,{value:"overview",className:"space-y-6 mt-8",children:[i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[i.jsxs(fn,{className:"shadow-lg border-0",children:[i.jsx(gn,{className:"bg-gradient-to-r from-primary/5 to-secondary/5",children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Os,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Department Workforce Distribution"})]})}),i.jsx(yn,{className:"p-6",children:i.jsx("div",{className:"space-y-4",children:Object.entries((null==e?void 0:e.departmentBreakdown)||{}).slice(0,6).map(([s,t],a)=>{const r=Math.round(t/(null==e?void 0:e.totalEmployees)*100),n=["bg-blue-500","bg-green-500","bg-purple-500","bg-orange-500","bg-pink-500","bg-indigo-500"];return i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:`w-3 h-3 rounded-full ${n[a%n.length]}`}),i.jsx("span",{className:"font-medium",children:s})]}),i.jsxs("div",{className:"text-right",children:[i.jsx("span",{className:"font-bold",children:t}),i.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",r,"%)"]})]})]}),i.jsx(Bi,{value:r,className:"h-3"})]},a)})})})]}),i.jsxs(fn,{className:"shadow-lg border-0",children:[i.jsx(gn,{className:"bg-gradient-to-r from-secondary/5 to-accent/5",children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ft,{className:"h-5 w-5 text-secondary"}),i.jsx("span",{children:"Role Type Analysis"})]})}),i.jsx(yn,{className:"p-6",children:i.jsx("div",{className:"space-y-4",children:Object.entries((null==e?void 0:e.roleDistribution)||{}).slice(0,6).map(([s,t],a)=>{const r=Math.round(t/(null==e?void 0:e.totalEmployees)*100);return i.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/30 rounded-lg hover:bg-muted/50 transition-colors",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:s}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[t," employees"]})]}),i.jsxs(zn,{variant:"outline",children:[r,"%"]})]},a)})})})]})]}),i.jsxs(fn,{className:"shadow-lg border-0",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(ks,{className:"h-5 w-5 text-accent"}),i.jsx("span",{children:"Organizational Health Snapshot"})]})}),i.jsx(yn,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"text-center p-6 bg-gradient-to-br from-green-50 to-green-100 rounded-xl",children:[i.jsxs("div",{className:"text-3xl font-bold text-green-600 mb-2",children:[Math.round(100-((null==e?void 0:e.retentionRisk.highRisk)||0)/(null==e?void 0:e.totalEmployees)*100),"%"]}),i.jsx("p",{className:"text-sm font-medium text-green-700",children:"Retention Rate"}),i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Year over year"})]}),i.jsxs("div",{className:"text-center p-6 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl",children:[i.jsxs("div",{className:"text-3xl font-bold text-blue-600 mb-2",children:[null==e?void 0:e.skillGaps.averageMatchPercentage,"%"]}),i.jsx("p",{className:"text-sm font-medium text-blue-700",children:"Skill Match"}),i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Role-skill alignment"})]}),i.jsxs("div",{className:"text-center p-6 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl",children:[i.jsxs("div",{className:"text-3xl font-bold text-purple-600 mb-2",children:[null==e?void 0:e.trainingMetrics.completionRate,"%"]}),i.jsx("p",{className:"text-sm font-medium text-purple-700",children:"Training Engagement"}),i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Completion rate"})]}),i.jsxs("div",{className:"text-center p-6 bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl",children:[i.jsx("div",{className:"text-3xl font-bold text-orange-600 mb-2",children:null==e?void 0:e.performanceMetrics.averageRating}),i.jsx("p",{className:"text-sm font-medium text-orange-700",children:"Performance Score"}),i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Average rating"})]})]})})]})]}),i.jsx(pn,{value:"performance",className:"space-y-6 mt-8",children:i.jsxs(fn,{className:"shadow-lg border-0",children:[i.jsx(gn,{className:"bg-gradient-to-r from-red-50 to-orange-50 border-b border-red-100",children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Bt,{className:"h-5 w-5 text-red-600"}),i.jsx("span",{children:"Performance Management Dashboard"})]})}),i.jsx(yn,{className:"p-6",children:(()=>{const e=(null==c?void 0:c.filter(e=>e.performance_rating&&e.performance_rating<3))||[],s=(null==c?void 0:c.filter(e=>e.performance_rating&&e.performance_rating<2))||[];return 0===e.length?i.jsxs("div",{className:"text-center py-12",children:[i.jsx("div",{className:"text-green-600 text-2xl mb-4",children:"🎉 Excellent Performance Across Board!"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"All employees are performing at satisfactory levels"}),i.jsxs("div",{className:"mt-6 p-4 bg-green-50 rounded-lg border border-green-200",children:[i.jsx("p",{className:"text-green-700 font-medium",children:"Team Performance Summary:"}),i.jsxs("p",{className:"text-green-600 text-sm mt-1",children:["All ",(null==c?void 0:c.length)||0," employees have performance ratings of 3.0 or higher"]})]})]}):i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsxs("div",{className:"bg-red-50 p-6 rounded-lg border border-red-200 shadow-sm",children:[i.jsx("div",{className:"text-3xl font-bold text-red-600 mb-2",children:s.length}),i.jsx("div",{className:"text-sm font-medium text-red-700",children:"Critical Performance"}),i.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Rating < 2.0 - Immediate action required"})]}),i.jsxs("div",{className:"bg-orange-50 p-6 rounded-lg border border-orange-200 shadow-sm",children:[i.jsx("div",{className:"text-3xl font-bold text-orange-600",children:e.length-s.length}),i.jsx("div",{className:"text-sm font-medium text-orange-700",children:"Needs Improvement"}),i.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Rating < 3.0 - Development plan needed"})]}),i.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg border border-blue-200 shadow-sm",children:[i.jsx("div",{className:"text-3xl font-bold text-blue-600",children:e.length}),i.jsx("div",{className:"text-sm font-medium text-blue-700",children:"Total Under Review"}),i.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"All employees requiring attention"})]}),i.jsxs("div",{className:"bg-green-50 p-6 rounded-lg border border-green-200 shadow-sm",children:[i.jsx("div",{className:"text-3xl font-bold text-green-600",children:((null==c?void 0:c.length)||0)-e.length}),i.jsx("div",{className:"text-sm font-medium text-green-700",children:"Performing Well"}),i.jsx("div",{className:"text-xs text-muted-foreground mt-1",children:"Rating ≥ 3.0 - Good standing"})]})]}),i.jsxs(fn,{className:"shadow-sm",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Wt,{className:"h-5 w-5 text-orange-600"}),i.jsx("span",{children:"Employees Requiring Attention"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:e.map((e,s)=>i.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg border hover:bg-gray-100 transition-colors",children:[i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsx("div",{className:"w-4 h-4 rounded-full "+(e.performance_rating<2?"bg-red-500":"bg-orange-500")}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"font-medium text-lg",children:[e.first_name," ",e.last_name]}),i.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.current_position," • ",e.current_department||"No Department"]}),i.jsxs("div",{className:"text-xs text-muted-foreground mt-1",children:["Employee ID: ",e.id]})]})]}),i.jsxs("div",{className:"flex items-center space-x-4",children:[i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:"font-bold text-xl text-red-600",children:["⭐ ",e.performance_rating,"/5"]}),i.jsx("div",{className:"text-xs text-muted-foreground",children:"Performance Rating"})]}),i.jsx("div",{className:"flex flex-col space-y-2",children:e.performance_rating<2?i.jsx(zn,{variant:"destructive",className:"text-xs",children:"Critical Priority"}):i.jsx(zn,{variant:"secondary",className:"text-xs",children:"Needs Support"})}),i.jsx("div",{className:"flex flex-col space-y-2",children:i.jsxs(nn,{size:"sm",variant:"outline",className:"text-xs",onClick:()=>(e=>{N(e),_(!0)})(e),children:[i.jsx(Rt,{className:"h-3 w-3 mr-1"}),"Take Action"]})})]})]},e.id))})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{className:"shadow-sm",children:[i.jsx(gn,{className:"bg-blue-50",children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ft,{className:"h-5 w-5 text-blue-600"}),i.jsx("span",{children:"Improvement Action Plans"})]})}),i.jsx(yn,{className:"p-6",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("h6",{className:"font-semibold text-blue-800 mb-2",children:"Immediate Actions (Critical):"}),i.jsxs("ul",{className:"text-blue-700 space-y-2 text-sm",children:[i.jsxs("li",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"text-blue-500 mt-1",children:"•"}),i.jsx("span",{children:"Schedule urgent 1-on-1 performance review meetings"})]}),i.jsxs("li",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"text-blue-500 mt-1",children:"•"}),i.jsx("span",{children:"Create detailed 30-60-90 day improvement plans"})]}),i.jsxs("li",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"text-blue-500 mt-1",children:"•"}),i.jsx("span",{children:"Consider temporary role adjustments or support"})]}),i.jsxs("li",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"text-blue-500 mt-1",children:"•"}),i.jsx("span",{children:"Document performance issues formally"})]})]})]}),i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h6",{className:"font-semibold text-blue-800 mb-2",children:"Development Support:"}),i.jsxs("ul",{className:"text-blue-700 space-y-2 text-sm",children:[i.jsxs("li",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"text-blue-500 mt-1",children:"•"}),i.jsx("span",{children:"Assign experienced mentors or coaching sessions"})]}),i.jsxs("li",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"text-blue-500 mt-1",children:"•"}),i.jsx("span",{children:"Enroll in relevant skill-building training programs"})]}),i.jsxs("li",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"text-blue-500 mt-1",children:"•"}),i.jsx("span",{children:"Establish regular check-ins and feedback cycles"})]}),i.jsxs("li",{className:"flex items-start space-x-2",children:[i.jsx("span",{className:"text-blue-500 mt-1",children:"•"}),i.jsx("span",{children:"Provide additional resources and tools"})]})]})]})]})})]}),s.length>0&&i.jsxs(fn,{className:"shadow-sm",children:[i.jsx(gn,{className:"bg-red-50",children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Bt,{className:"h-5 w-5 text-red-600"}),i.jsx("span",{children:"Offboarding Consideration Strategy"})]})}),i.jsx(yn,{className:"p-6",children:i.jsxs("div",{className:"text-sm text-red-700 space-y-4",children:[i.jsx("p",{className:"font-medium",children:"For critical performance cases (rating < 2.0), follow this structured timeline:"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"bg-white p-4 rounded border border-red-200",children:[i.jsx("div",{className:"font-semibold text-red-800",children:"Week 1-2: Intensive Support Phase"}),i.jsx("div",{className:"text-xs mt-1",children:"Clear performance expectations, daily check-ins, immediate support"})]}),i.jsxs("div",{className:"bg-white p-4 rounded border border-red-200",children:[i.jsx("div",{className:"font-semibold text-red-800",children:"Week 3-6: Monitoring & Feedback"}),i.jsx("div",{className:"text-xs mt-1",children:"Track progress closely, provide continuous feedback, adjust support as needed"})]}),i.jsxs("div",{className:"bg-white p-4 rounded border border-red-200",children:[i.jsx("div",{className:"font-semibold text-red-800",children:"Week 7-8: Final Evaluation"}),i.jsx("div",{className:"text-xs mt-1",children:"Comprehensive performance review, make final employment decision"})]})]}),i.jsx("div",{className:"mt-4 p-3 bg-red-100 rounded border border-red-300",children:i.jsx("p",{className:"text-xs font-medium text-red-800",children:"⚠️ Ensure all documentation is complete and HR procedures are followed throughout this process."})})]})})]})]})]})})()})]})}),i.jsx(pn,{value:"skills",className:"space-y-6 mt-8",children:i.jsx(Ky,{metrics:e})}),i.jsx(pn,{value:"career-pathways",className:"space-y-6 mt-8",children:i.jsx(Jy,{metrics:e})}),i.jsx(pn,{value:"talent",className:"space-y-6 mt-8",children:i.jsx(Xy,{metrics:e})}),i.jsx(pn,{value:"departments",className:"space-y-6 mt-8",children:i.jsxs(fn,{className:"shadow-lg border-0",children:[i.jsx(gn,{className:"bg-gradient-to-r from-secondary/5 to-accent/5",children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Wt,{className:"h-5 w-5 text-secondary"}),i.jsx("span",{children:"Comprehensive Department Analysis"})]})}),i.jsx(yn,{className:"p-6",children:i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"border-b-2",children:[i.jsx("th",{className:"text-left py-4 px-4 font-semibold",children:"Department"}),i.jsx("th",{className:"text-left py-4 px-4 font-semibold",children:"Employees"}),i.jsx("th",{className:"text-left py-4 px-4 font-semibold",children:"Avg Experience"}),i.jsx("th",{className:"text-left py-4 px-4 font-semibold",children:"Performance"}),i.jsx("th",{className:"text-left py-4 px-4 font-semibold",children:"Skill Match"}),i.jsx("th",{className:"text-left py-4 px-4 font-semibold",children:"Training Rate"})]})}),i.jsx("tbody",{children:Object.entries((null==e?void 0:e.departmentBreakdown)||{}).map(([e,s],t)=>i.jsxs("tr",{className:"border-b hover:bg-muted/30 transition-colors",children:[i.jsx("td",{className:"py-4 px-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-3 h-3 rounded-full bg-primary"}),i.jsx("span",{className:"font-medium",children:e})]})}),i.jsx("td",{className:"py-4 px-4",children:s}),i.jsx("td",{className:"py-4 px-4",children:i.jsxs(zn,{variant:"outline",children:[Math.round(5*Math.random()+3),"y"]})}),i.jsx("td",{className:"py-4 px-4",children:i.jsxs("span",{className:"text-primary font-medium",children:[(1.5*Math.random()+3.5).toFixed(1),"/5"]})}),i.jsx("td",{className:"py-4 px-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Bi,{value:Math.round(20*Math.random()+70),className:"w-16 h-2"}),i.jsxs("span",{className:"text-sm font-medium",children:[Math.round(20*Math.random()+70),"%"]})]})}),i.jsx("td",{className:"py-4 px-4",children:i.jsxs(zn,{variant:"secondary",children:[Math.round(30*Math.random()+60),"%"]})})]},t))})]})})})]})}),i.jsx(pn,{value:"training",className:"space-y-6 mt-8",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs(fn,{className:"shadow-lg",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Cs,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Training Overview"})]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-4xl font-bold text-primary mb-2",children:null==e?void 0:e.trainingMetrics.totalTrainings}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Training Programs"})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Completion Rate"}),i.jsxs("span",{className:"font-bold",children:[null==e?void 0:e.trainingMetrics.completionRate,"%"]})]}),i.jsx(Bi,{value:null==e?void 0:e.trainingMetrics.completionRate,className:"h-3"}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-sm",children:"Avg Hours"}),i.jsxs("span",{className:"font-bold",children:[null==e?void 0:e.trainingMetrics.averageHours,"h"]})]})]})]})})]}),i.jsxs(fn,{className:"shadow-lg",children:[i.jsx(gn,{children:i.jsx(vn,{children:"Top Certifications"})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:(()=>{const e={};n.forEach(s=>{const t=s.certification_name||"Unknown";e[t]=(e[t]||0)+1});const s=Object.entries(e).map(([e,s])=>({name:e,count:s})).sort((e,s)=>s.count-e.count).slice(0,5);return s.length>0?s.map((e,s)=>i.jsxs("div",{className:"flex justify-between items-center p-3 bg-muted/30 rounded-lg",children:[i.jsx("span",{className:"font-medium",children:e.name}),i.jsx(zn,{variant:"outline",children:e.count})]},s)):i.jsx("div",{className:"text-center py-4 text-muted-foreground",children:"No certifications found"})})()})})]}),i.jsxs(fn,{className:"shadow-lg",children:[i.jsx(gn,{children:i.jsx(vn,{children:"Certification Status"})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-3xl font-bold text-green-600 mb-2",children:r.activeCertifications}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Certifications"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"text-2xl font-bold text-red-600 mb-2",children:r.expiringSoon}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Expiring in 90 days"})]})]})})]})]})}),i.jsx(pn,{value:"analytics",className:"space-y-6 mt-8",children:i.jsxs(fn,{className:"shadow-lg",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(ks,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Advanced Analytics Dashboard"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{label:"Predictive Turnover Risk",value:"12.3%",trend:"↓ -2.1%",color:"text-green-600"},{label:"Skill Gap Severity",value:"Medium",trend:"→ Stable",color:"text-yellow-600"},{label:"Promotion Readiness",value:"67%",trend:"↗ +5.4%",color:"text-blue-600"},{label:"Training ROI",value:"340%",trend:"↗ +12%",color:"text-purple-600"}].map((e,s)=>i.jsxs("div",{className:"text-center p-6 border rounded-xl",children:[i.jsx("div",{className:`text-2xl font-bold ${e.color} mb-2`,children:e.value}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:e.label}),i.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:e.trend})]},s))})})]})}),i.jsx(pn,{value:"insights",className:"space-y-6 mt-8",children:i.jsxs(fn,{className:"shadow-lg",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Zt,{className:"h-5 w-5 text-accent"}),i.jsx("span",{children:"AI-Powered Insights & Recommendations"})]})}),i.jsx(yn,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"text-center p-6 border rounded-xl bg-gradient-to-br from-primary/5 to-primary/10",children:[i.jsx(Rs,{className:"h-12 w-12 text-primary mx-auto mb-4"}),i.jsx("div",{className:"text-3xl font-bold text-primary mb-2",children:null==e?void 0:e.aiInsights.totalAnalyses}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:"Total AI Analyses"}),i.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Comprehensive workforce intelligence insights"})]}),i.jsxs("div",{className:"text-center p-6 border rounded-xl bg-gradient-to-br from-secondary/5 to-secondary/10",children:[i.jsx(Ft,{className:"h-12 w-12 text-secondary mx-auto mb-4"}),i.jsx("div",{className:"text-3xl font-bold text-secondary mb-2",children:null==e?void 0:e.aiInsights.roleOptimizations}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:"Role Optimizations"}),i.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"AI-suggested role assignments and improvements"})]}),i.jsxs("div",{className:"text-center p-6 border rounded-xl bg-gradient-to-br from-accent/5 to-accent/10",children:[i.jsx(Ts,{className:"h-12 w-12 text-accent mx-auto mb-4"}),i.jsx("div",{className:"text-3xl font-bold text-accent mb-2",children:null==e?void 0:e.aiInsights.skillRecommendations}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:"Skill Recommendations"}),i.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"AI-generated skill development suggestions"})]})]})})]})}),i.jsxs(pn,{value:"certifications",className:"space-y-6 mt-8",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold",children:"Certification Management"}),i.jsx("p",{className:"text-muted-foreground",children:"Assign active certifications to employees and manage expiry dates"})]}),i.jsxs(Cn,{open:m,onOpenChange:h,children:[i.jsx(An,{asChild:!0,children:i.jsxs(nn,{className:"flex items-center gap-2",children:[i.jsx(Ts,{className:"h-4 w-4"}),"Assign Certification"]})}),i.jsxs(Pn,{className:"sm:max-w-[425px]",children:[i.jsx(Dn,{children:i.jsx(On,{children:"Assign Certification to Employee"})}),i.jsxs("div",{className:"grid gap-4 py-4",children:[i.jsxs("div",{className:"grid gap-2",children:[i.jsx(mn,{htmlFor:"employee",children:"Select Employee"}),i.jsxs(bn,{value:u,onValueChange:x,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Choose an employee"})}),i.jsx(Sn,{children:c.map(e=>i.jsxs(En,{value:e.id,children:[e.first_name," ",e.last_name," - ",e.current_department]},e.id))})]})]}),i.jsxs("div",{className:"grid gap-2",children:[i.jsx(mn,{htmlFor:"certification",children:"Select Certification"}),i.jsxs(bn,{value:p,onValueChange:f,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Choose a certification"})}),i.jsx(Sn,{children:l.map(e=>i.jsxs(En,{value:e.id,children:[e.certification_name," - ",e.issuing_authority]},e.id))})]})]}),i.jsxs("div",{className:"grid gap-2",children:[i.jsx(mn,{htmlFor:"expiry",children:"Expiry Date"}),i.jsx(ln,{id:"expiry",type:"date",value:g,onChange:e=>v(e.target.value),min:(new Date).toISOString().split("T")[0]})]})]}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx(nn,{variant:"outline",onClick:()=>h(!1),disabled:j,children:"Cancel"}),i.jsx(nn,{onClick:F,disabled:j||!u||!p||!g,children:j?"Assigning...":"Assign Certification"})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ts,{className:"h-5 w-5 text-green-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:r.activeCertifications}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Certifications"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Bt,{className:"h-5 w-5 text-orange-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:r.expiringSoon}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Expiring Soon"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(It,{className:"h-5 w-5 text-blue-600"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold",children:[r.complianceRate,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Compliance Rate"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-purple-600"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:l.length}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Available Certifications"})]})]})})})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[i.jsxs(fn,{className:"shadow-lg",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(It,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Available Certifications"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:l.length>0?l.map(e=>i.jsxs("div",{className:"border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("h4",{className:"font-semibold text-sm",children:e.certification_name}),i.jsx(zn,{variant:"outline",children:e.issuing_authority})]}),e.description&&i.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:e.description}),i.jsxs("div",{className:"flex justify-between items-center text-xs",children:[i.jsxs("span",{className:"text-muted-foreground",children:["Duration: ",e.duration||"Not specified"]}),e.cost&&i.jsxs("span",{className:"font-medium",children:["$",e.cost]})]})]},e.id)):i.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No available certifications found"})})})]}),i.jsxs(fn,{className:"shadow-lg",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Wt,{className:"h-5 w-5 text-secondary"}),i.jsx("span",{children:"Employee Certifications"})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:n.length>0?n.slice(0,10).map(e=>{var s,t,a;return i.jsxs("div",{className:"border rounded-lg p-4 hover:bg-muted/50 transition-colors",children:[i.jsxs("div",{className:"flex justify-between items-start mb-2",children:[i.jsx("h4",{className:"font-semibold text-sm",children:e.certification_name}),i.jsx(zn,{variant:e.expiry_date&&new Date(e.expiry_date)<new Date(Date.now()+7776e6)?"destructive":"default",children:e.expiry_date?new Date(e.expiry_date).toLocaleDateString():"No expiry"})]}),i.jsxs("div",{className:"flex justify-between items-center text-xs",children:[i.jsxs("span",{className:"text-muted-foreground",children:[null==(s=e.xlsmart_employees)?void 0:s.first_name," ",null==(t=e.xlsmart_employees)?void 0:t.last_name]}),i.jsx("span",{className:"text-muted-foreground",children:null==(a=e.xlsmart_employees)?void 0:a.current_department})]})]},e.id)}):i.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"No employee certifications found"})})})]})]})]})]}),i.jsx(Cn,{open:w,onOpenChange:_,children:i.jsxs(Pn,{className:"max-w-2xl",children:[i.jsx(Dn,{className:"border-b pb-4",children:i.jsxs(On,{className:"flex items-center space-x-3 text-xl",children:[i.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-red-500 to-orange-500 rounded-full flex items-center justify-center",children:i.jsx(Bt,{className:"h-5 w-5 text-white"})}),i.jsxs("div",{children:[i.jsx("span",{children:"Performance Action Required"}),i.jsxs("p",{className:"text-sm text-muted-foreground font-normal mt-1",children:[null==b?void 0:b.first_name," ",null==b?void 0:b.last_name," • ",null==b?void 0:b.current_position]})]})]})}),i.jsxs("div",{className:"space-y-6 p-6",children:[i.jsx("div",{className:"bg-gradient-to-r from-red-50 to-orange-50 p-4 rounded-lg border border-red-200",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold text-red-800",children:"Current Performance Status"}),i.jsx("p",{className:"text-sm text-red-600 mt-1",children:"Immediate action required to address performance concerns"})]}),i.jsxs("div",{className:"text-right",children:[i.jsxs("div",{className:"text-2xl font-bold text-red-600",children:["⭐ ",null==b?void 0:b.performance_rating,"/5"]}),i.jsx("div",{className:"text-xs text-muted-foreground",children:"Performance Rating"})]})]})}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("h5",{className:"font-semibold text-gray-800 mb-3",children:"Choose Your Action Strategy"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx("div",{className:"group cursor-pointer",onClick:async()=>{if(b){D(!0);try{const{data:e,error:s}=await en.functions.invoke("ai-employee-improvement-plan",{body:{employee:b}});if(s)throw s;if(!e.success)throw new Error(e.error);A(e.improvementPlan),_(!1),S(!0),xr.success(`Improvement plan generated! Using ${e.availableTrainings} training programs and ${e.availableDepartments} departments.`)}catch(e){xr.error(`Failed to generate improvement plan: ${e instanceof Error?e.message:"Unknown error"}`)}finally{D(!1)}}},children:i.jsxs("div",{className:"relative p-6 bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-xl hover:border-blue-400 hover:shadow-lg transition-all duration-200",children:[P&&i.jsx("div",{className:"absolute inset-0 bg-blue-100/50 rounded-xl flex items-center justify-center",children:i.jsx(kt,{className:"h-6 w-6 animate-spin text-blue-600"})}),i.jsxs("div",{className:"text-center space-y-3",children:[i.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center mx-auto",children:i.jsx(tt,{className:"h-6 w-6 text-white"})}),i.jsx("h6",{className:"font-semibold text-blue-800",children:"Generate Improvement Plan"}),i.jsx("p",{className:"text-sm text-blue-600",children:"Create a comprehensive 90-day development strategy with training assignments and mentorship"}),i.jsxs("div",{className:"flex items-center justify-center space-x-2 text-xs text-blue-500",children:[i.jsx("span",{children:"• Performance coaching"}),i.jsx("span",{children:"• Skill development"}),i.jsx("span",{children:"• Clear milestones"})]})]})]})}),i.jsx("div",{className:"group cursor-pointer",onClick:async()=>{if(b){O(!0);try{const{data:e,error:s}=await en.functions.invoke("ai-employee-exit-strategy",{body:{employee:b}});if(s)throw s;if(!e.success)throw new Error(e.error);I(e.exitStrategy),_(!1),T(!0),xr.success(`Exit strategy generated! Analyzed ${e.teamMembersCount} team members for workload redistribution.`)}catch(e){xr.error(`Failed to generate exit strategy: ${e instanceof Error?e.message:"Unknown error"}`)}finally{O(!1)}}},children:i.jsxs("div",{className:"relative p-6 bg-gradient-to-br from-red-50 to-pink-50 border-2 border-red-200 rounded-xl hover:border-red-400 hover:shadow-lg transition-all duration-200",children:[M&&i.jsx("div",{className:"absolute inset-0 bg-red-100/50 rounded-xl flex items-center justify-center",children:i.jsx(kt,{className:"h-6 w-6 animate-spin text-red-600"})}),i.jsxs("div",{className:"text-center space-y-3",children:[i.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-red-500 to-pink-600 rounded-full flex items-center justify-center mx-auto",children:i.jsx(Gt,{className:"h-6 w-6 text-white"})}),i.jsx("h6",{className:"font-semibold text-red-800",children:"Generate Exit Strategy"}),i.jsx("p",{className:"text-sm text-red-600",children:"Create a professional offboarding plan with legal compliance and transition management"}),i.jsxs("div",{className:"flex items-center justify-center space-x-2 text-xs text-red-500",children:[i.jsx("span",{children:"• Legal compliance"}),i.jsx("span",{children:"• Knowledge transfer"}),i.jsx("span",{children:"• Professional exit"})]})]})]})})]})]}),i.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border",children:[i.jsx("h6",{className:"font-semibold text-gray-800 mb-2",children:"🤖 AI Recommendation"}),i.jsx("p",{className:"text-sm text-gray-600",children:(null==b?void 0:b.performance_rating)<2?"Given the critical performance rating (<2), we recommend starting with an improvement plan but also preparing an exit strategy as a contingency measure.":"With a performance rating below 3, we recommend focusing on an improvement plan with structured development goals and regular check-ins."})]})]}),i.jsx("div",{className:"flex justify-end space-x-3 p-6 border-t bg-gray-50/50",children:i.jsx(nn,{variant:"outline",onClick:()=>_(!1),className:"px-6",children:"Cancel"})})]})}),i.jsx(Cn,{open:k,onOpenChange:S,children:i.jsxs(Pn,{className:"max-w-[98vw] w-[98vw] h-[98vh] overflow-hidden flex flex-col",children:[i.jsx(Dn,{className:"border-b pb-2 flex-shrink-0",children:i.jsxs(On,{className:"flex items-center space-x-3 text-lg",children:[i.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-blue-500 to-indigo-600 rounded-full flex items-center justify-center",children:i.jsx(tt,{className:"h-4 w-4 text-white"})}),i.jsxs("div",{children:[i.jsx("span",{children:"AI-Generated Improvement Plan"}),i.jsxs("p",{className:"text-xs text-muted-foreground font-normal mt-1",children:[null==b?void 0:b.first_name," ",null==b?void 0:b.last_name]})]})]})}),i.jsxs("div",{className:"flex-1 min-h-0 flex space-x-4 p-3",children:[i.jsx("div",{className:"w-80 flex-shrink-0",children:i.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 p-3 rounded-lg border border-blue-200 h-full",children:[i.jsxs("div",{className:"mb-3",children:[i.jsxs("h4",{className:"font-semibold text-blue-800 text-sm",children:[null==b?void 0:b.first_name," ",null==b?void 0:b.last_name]}),i.jsx("p",{className:"text-xs text-blue-600",children:null==b?void 0:b.current_position}),i.jsx("p",{className:"text-xs text-blue-600",children:null==b?void 0:b.current_department})]}),i.jsxs("div",{className:"text-center border-t border-blue-200 pt-3",children:[i.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["⭐ ",null==b?void 0:b.performance_rating,"/5"]}),i.jsx("div",{className:"text-xs text-muted-foreground",children:"Current Rating"})]}),i.jsxs("div",{className:"mt-3 pt-3 border-t border-blue-200",children:[i.jsx("h5",{className:"font-semibold text-blue-800 text-xs mb-2",children:"📋 Plan Details"}),i.jsxs("div",{className:"space-y-1 text-xs text-blue-700",children:[i.jsx("div",{children:"• 90-Day Development"}),i.jsx("div",{children:"• AI-Generated Strategy"}),i.jsx("div",{children:"• Performance Focused"}),i.jsx("div",{children:"• Career Growth Path"})]})]})]})}),i.jsx("div",{className:"flex-1 min-h-0",children:i.jsxs("div",{className:"h-full bg-white border rounded-lg flex flex-col",children:[i.jsxs("div",{className:"p-2 bg-gradient-to-r from-blue-50 to-indigo-50 border-b flex items-center justify-between flex-shrink-0",children:[i.jsx("h5",{className:"font-semibold text-blue-800 text-sm",children:"📋 90-Day Development Plan"}),i.jsx(zn,{variant:"outline",className:"bg-blue-100 text-blue-700 text-xs",children:"AI Generated"})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:C?i.jsx("div",{className:"prose prose-blue max-w-none",children:i.jsx("div",{className:"formatted-plan space-y-4",dangerouslySetInnerHTML:{__html:C.replace(/^### (.*$)/gm,'<h3 class="text-lg font-bold text-blue-800 mt-4 mb-3 pb-2 border-b border-blue-200">$1</h3>').replace(/^## (.*$)/gm,'<h2 class="text-xl font-bold text-blue-900 mt-6 mb-4 pb-2 border-b-2 border-blue-300">$1</h2>').replace(/^#### (.*$)/gm,'<h4 class="text-md font-semibold text-blue-700 mt-3 mb-2">$1</h4>').replace(/^# (.*$)/gm,'<h1 class="text-2xl font-bold text-blue-900 mt-6 mb-4 pb-3 border-b-2 border-blue-400">$1</h1>').replace(/\*\*(.*?)\*\*/g,'<strong class="font-semibold text-blue-800 bg-blue-50 px-1 rounded">$1</strong>').replace(/\*(.*?)\*/g,'<em class="italic text-blue-700">$1</em>').replace(/^- (.*$)/gm,'<div class="flex items-start ml-4 mb-2"><span class="text-blue-600 mr-2">•</span><span class="text-gray-700 text-sm leading-relaxed">$1</span></div>').replace(/^\d+\. (.*$)/gm,'<div class="flex items-start ml-4 mb-2"><span class="text-blue-600 mr-2 font-medium">$&</span></div>').replace(/\n\n/g,"<br><br>").replace(/^(?!<[h|d])(.+)$/gm,'<p class="mb-3 text-gray-700 leading-relaxed text-sm">$1</p>').replace(/📋|📊|🎯|⭐|🔍|💡|📈|✅|⚠️|🚀|💼|🎓|👥|⏰|📝|🏆|💪|🌟|🔥|⚡|🎨|🔧|📚|🎪|🎭/g,'<span class="inline-block text-base mr-2 bg-blue-100 px-1 rounded">$&</span>')}})}):i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsxs("div",{className:"text-center p-8",children:[i.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(tt,{className:"h-8 w-8 text-blue-600"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Generate Your Improvement Plan"}),i.jsx("p",{className:"text-gray-600",children:'Click "Generate Improvement Plan" to create a comprehensive development strategy.'})]})})})]})})]}),i.jsxs("div",{className:"flex justify-between items-center space-x-3 p-3 border-t bg-gray-50/50 flex-shrink-0",children:[i.jsxs("div",{className:"flex items-center space-x-2 text-xs text-muted-foreground",children:[i.jsx(Ys,{className:"h-3 w-3"}),i.jsx("span",{children:"Generated with AI • Review and customize as needed"})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx(nn,{variant:"outline",size:"sm",onClick:()=>S(!1),children:"Close"}),i.jsxs(nn,{size:"sm",onClick:()=>{navigator.clipboard.writeText(C),xr.success("Improvement plan copied to clipboard!")},className:"bg-blue-600 hover:bg-blue-700",children:[i.jsx(Ts,{className:"h-3 w-3 mr-1"}),"Copy Plan"]})]})]})]})}),i.jsx(Cn,{open:E,onOpenChange:T,children:i.jsxs(Pn,{className:"max-w-[98vw] w-[98vw] h-[98vh] overflow-hidden flex flex-col",children:[i.jsx(Dn,{className:"border-b pb-2 flex-shrink-0",children:i.jsxs(On,{className:"flex items-center space-x-3 text-lg",children:[i.jsx("div",{className:"w-8 h-8 bg-gradient-to-br from-red-500 to-pink-600 rounded-full flex items-center justify-center",children:i.jsx(Gt,{className:"h-4 w-4 text-white"})}),i.jsxs("div",{children:[i.jsx("span",{children:"AI-Generated Exit Strategy"}),i.jsxs("p",{className:"text-xs text-muted-foreground font-normal mt-1",children:[null==b?void 0:b.first_name," ",null==b?void 0:b.last_name]})]})]})}),i.jsxs("div",{className:"flex-1 min-h-0 flex space-x-4 p-3",children:[i.jsx("div",{className:"w-80 flex-shrink-0",children:i.jsxs("div",{className:"bg-gradient-to-r from-red-50 to-pink-50 p-3 rounded-lg border border-red-200 h-full",children:[i.jsxs("div",{className:"mb-3",children:[i.jsxs("h4",{className:"font-semibold text-red-800 text-sm",children:[null==b?void 0:b.first_name," ",null==b?void 0:b.last_name]}),i.jsx("p",{className:"text-xs text-red-600",children:null==b?void 0:b.current_position}),i.jsx("p",{className:"text-xs text-red-600",children:null==b?void 0:b.current_department})]}),i.jsxs("div",{className:"text-center border-t border-red-200 pt-3 mb-3",children:[i.jsxs("div",{className:"text-lg font-bold text-red-600",children:["⭐ ",null==b?void 0:b.performance_rating,"/5"]}),i.jsx("div",{className:"text-xs text-muted-foreground",children:"Current Rating"})]}),i.jsxs("div",{className:"bg-red-100 p-2 rounded border border-red-300",children:[i.jsxs("p",{className:"text-xs font-medium text-red-800 flex items-center",children:[i.jsx(It,{className:"h-3 w-3 mr-1"}),"🔒 CONFIDENTIAL HR DOCUMENT"]}),i.jsx("p",{className:"text-xs text-red-700 mt-1",children:"Handle with strict confidentiality"})]})]})}),i.jsx("div",{className:"flex-1 min-h-0",children:i.jsxs("div",{className:"h-full bg-white border rounded-lg flex flex-col",children:[i.jsxs("div",{className:"p-2 bg-gradient-to-r from-red-50 to-pink-50 border-b flex items-center justify-between flex-shrink-0",children:[i.jsx("h5",{className:"font-semibold text-red-800 text-sm",children:"⚠️ Professional Exit Strategy"}),i.jsx(zn,{variant:"destructive",className:"bg-red-100 text-red-700 text-xs",children:"Confidential"})]}),i.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:R?i.jsx("div",{className:"prose prose-red max-w-none",children:i.jsx("div",{className:"formatted-strategy space-y-4",dangerouslySetInnerHTML:{__html:R.replace(/^### (.*$)/gm,'<h3 class="text-lg font-bold text-red-800 mt-4 mb-3 pb-2 border-b border-red-200">$1</h3>').replace(/^## (.*$)/gm,'<h2 class="text-xl font-bold text-red-900 mt-6 mb-4 pb-2 border-b-2 border-red-300">$1</h2>').replace(/^#### (.*$)/gm,'<h4 class="text-md font-semibold text-red-700 mt-3 mb-2">$1</h4>').replace(/^# (.*$)/gm,'<h1 class="text-2xl font-bold text-red-900 mt-6 mb-4 pb-3 border-b-2 border-red-400">$1</h1>').replace(/\*\*(.*?)\*\*/g,'<strong class="font-semibold text-red-800 bg-red-50 px-1 rounded">$1</strong>').replace(/\*(.*?)\*/g,'<em class="italic text-red-700">$1</em>').replace(/^- (.*$)/gm,'<div class="flex items-start ml-4 mb-2"><span class="text-red-600 mr-2">•</span><span class="text-gray-700 text-sm leading-relaxed">$1</span></div>').replace(/^\d+\. (.*$)/gm,'<div class="flex items-start ml-4 mb-2"><span class="text-red-600 mr-2 font-medium">$&</span></div>').replace(/\n\n/g,"<br><br>").replace(/^(?!<[h|d])(.+)$/gm,'<p class="mb-3 text-gray-700 leading-relaxed text-sm">$1</p>').replace(/🚪|📋|⚖️|⚠️|🔒|📝|💼|👤|📊|⏰|🏢|📞|✅|❌|🆔|🔐|📄|⚡|🎯|🛡️/g,'<span class="inline-block text-base mr-2 bg-red-100 px-1 rounded">$&</span>')}})}):i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsxs("div",{className:"text-center p-8",children:[i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:i.jsx(Gt,{className:"h-8 w-8 text-red-600"})}),i.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Generate Exit Strategy"}),i.jsx("p",{className:"text-gray-600",children:'Click "Generate Exit Strategy" to create a comprehensive offboarding plan.'})]})})})]})})]}),i.jsxs("div",{className:"flex justify-between items-center space-x-3 p-6 border-t bg-red-50/50 flex-shrink-0",children:[i.jsxs("div",{className:"flex items-center space-x-2 text-sm text-red-600",children:[i.jsx(Bt,{className:"h-4 w-4"}),i.jsx("span",{children:"Legal Review Required • Consult HR Before Implementation"})]}),i.jsxs("div",{className:"flex space-x-2",children:[i.jsx(nn,{variant:"outline",onClick:()=>T(!1),children:"Close"}),i.jsxs(nn,{variant:"destructive",onClick:()=>{navigator.clipboard.writeText(R),xr.success("Exit strategy copied to clipboard!")},children:[i.jsx(It,{className:"h-4 w-4 mr-2"}),"Copy Strategy"]})]})]})]})}),i.jsx(Cn,{open:m,onOpenChange:h,children:i.jsxs(Pn,{children:[i.jsx(Dn,{children:i.jsx(On,{children:"Assign Certification to Employee"})}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"employee-select",children:"Select Employee"}),i.jsxs(bn,{value:u,onValueChange:x,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Choose an employee"})}),i.jsx(Sn,{children:null==c?void 0:c.map(e=>i.jsxs(En,{value:e.id,children:[e.first_name," ",e.last_name," - ",e.current_position]},e.id))})]})]}),i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"certification-select",children:"Select Certification"}),i.jsxs(bn,{value:p,onValueChange:f,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Choose a certification"})}),i.jsx(Sn,{children:null==l?void 0:l.map(e=>i.jsxs(En,{value:e.id,children:[e.certification_name," - ",e.issuing_authority]},e.id))})]})]}),i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"expiry-date",children:"Expiry Date"}),i.jsx(ln,{id:"expiry-date",type:"date",value:g,onChange:e=>v(e.target.value)})]}),i.jsxs("div",{className:"flex justify-end space-x-2",children:[i.jsx(nn,{variant:"outline",onClick:()=>h(!1),children:"Cancel"}),i.jsx(nn,{onClick:F,disabled:j,children:j?"Assigning...":"Assign Certification"})]})]})]})})]})},Qy=()=>{const e=(()=>{const[e,s]=ce.useState({totalSkills:0,employeesWithSkills:0,skillCategories:0,coverageRate:0,loading:!0});return ce.useEffect(()=>{(async()=>{try{const{count:e}=await en.from("skills_master").select("*",{count:"exact",head:!0}),{data:t}=await en.from("skills_master").select("category"),a=new Set(null==t?void 0:t.map(e=>e.category)).size,{data:r}=await en.from("employee_skills").select("employee_id"),n=new Set(null==r?void 0:r.map(e=>e.employee_id)).size,{count:i}=await en.from("xlsmart_employees").select("*",{count:"exact",head:!0}),l=i&&n?Math.round(n/i*100):0;s({totalSkills:e||0,employeesWithSkills:n,skillCategories:a,coverageRate:l,loading:!1})}catch(e){s(e=>({...e,loading:!1}))}})()},[]),e})(),s=[{value:e.loading?"...":e.totalSkills.toString(),label:"Total Skills",icon:gt,color:"text-blue-600",description:"Mapped skills in system"},{value:e.loading?"...":e.employeesWithSkills.toString(),label:"Employees with Skills",icon:Ut,color:"text-green-600",description:"Have skill assessments"},{value:e.loading?"...":e.skillCategories.toString(),label:"Skill Categories",icon:gt,color:"text-purple-600",description:"Different skill types"},{value:e.loading?"...":`${e.coverageRate}%`,label:"Coverage Rate",icon:Ut,color:"text-orange-600",description:"Skills mapped to employees"}];return i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Skill Inventory"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"Comprehensive mapping of organizational skills and competencies"})]}),i.jsxs("section",{className:"bg-muted/50 rounded-xl p-6",children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Skill Inventory Overview"}),i.jsx("p",{className:"text-muted-foreground",children:"Complete view of skills distribution and coverage across the organization"})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:s.map((s,t)=>i.jsx(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer",children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx("div",{className:"p-2 rounded-lg bg-gradient-to-br "+(t%4==0?"from-blue-500 to-blue-600":t%4==1?"from-green-500 to-green-600":t%4==2?"from-purple-500 to-purple-600":"from-orange-500 to-orange-600"),children:i.jsx(s.icon,{className:"h-5 w-5 text-white"})}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:`text-2xl font-bold ${s.color} flex items-center gap-2`,children:[e.loading&&i.jsx(ot,{className:"h-4 w-4 animate-spin"}),s.value]}),i.jsx("p",{className:"text-sm font-medium text-foreground",children:s.label}),i.jsx("p",{className:"text-xs text-muted-foreground",children:s.description})]})]})})},t))})]}),i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Skill Search & Analysis"}),i.jsx("p",{className:"text-muted-foreground",children:"Search and filter skills to analyze competency gaps and opportunities"})]}),i.jsx(fn,{children:i.jsxs(yn,{className:"p-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[i.jsxs("div",{className:"flex-1 relative",children:[i.jsx(Ct,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),i.jsx(ln,{placeholder:"Search skills, competencies, or employees...",className:"pl-10"})]}),i.jsxs(nn,{variant:"outline",className:"flex items-center space-x-2",children:[i.jsx(at,{className:"h-4 w-4"}),i.jsx("span",{children:"Advanced Filters"})]})]}),e.totalSkills>0?i.jsxs("div",{className:"text-center p-8 text-muted-foreground",children:[i.jsx(gt,{className:"h-12 w-12 mx-auto mb-4 text-primary/30"}),i.jsx("p",{className:"font-medium",children:"Skills Analysis Available"}),i.jsxs("p",{className:"text-sm",children:["Found ",e.totalSkills," skills across ",e.skillCategories," categories"]}),i.jsxs("p",{className:"text-sm mt-2",children:[e.employeesWithSkills," employees have skill assessments"]}),i.jsxs("div",{className:"mt-4 text-sm",children:[i.jsx("p",{children:"• Use the search above to find specific skills"}),i.jsx("p",{children:"• Export detailed reports from the actions below"}),i.jsx("p",{children:"• View skill gap analysis for workforce planning"})]})]}):i.jsxs("div",{className:"text-center p-8 text-muted-foreground",children:[i.jsx(gt,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground/30"}),i.jsx("p",{className:"font-medium",children:"No Skills Data"}),i.jsx("p",{className:"text-sm",children:"Add employee skills data to see detailed analysis here."})]})]})})]}),i.jsxs("section",{children:[i.jsxs("div",{className:"mb-6",children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Detailed Skill Analysis"}),i.jsx("p",{className:"text-muted-foreground",children:"Comprehensive breakdown of skills by category and proficiency level"})]}),i.jsx(fn,{children:i.jsx(yn,{className:"p-6",children:e.totalSkills>0?i.jsxs("div",{className:"text-center p-8 text-muted-foreground",children:[i.jsx(Ut,{className:"h-12 w-12 mx-auto mb-4 text-primary/30"}),i.jsx("p",{className:"font-medium",children:"Detailed Skills Breakdown"}),i.jsx("p",{className:"text-sm",children:"Skills analysis will be available with more detailed employee skill data."}),i.jsxs("div",{className:"mt-4 p-4 bg-muted/50 rounded-lg",children:[i.jsx("p",{className:"text-sm font-medium",children:"Current Overview:"}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.totalSkills," total skills • ",e.skillCategories," categories •",e.coverageRate,"% employee coverage"]})]})]}):i.jsxs("div",{className:"text-center p-8 text-muted-foreground",children:[i.jsx(Ut,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground/30"}),i.jsx("p",{className:"font-medium",children:"No Skills Analysis Available"}),i.jsx("p",{className:"text-sm",children:"Add skills master data and employee skill assessments to see detailed breakdown."})]})})})]}),i.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsxs(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(gt,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Export Inventory"})]})}),i.jsx(yn,{children:i.jsx("p",{className:"text-muted-foreground text-sm",children:"Download comprehensive skill inventory reports"})})]}),i.jsxs(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Skill Gap Analysis"})]})}),i.jsx(yn,{children:i.jsx("p",{className:"text-muted-foreground text-sm",children:"Identify critical skill gaps and requirements"})})]}),i.jsxs(fn,{className:"hover:shadow-md transition-all duration-200 cursor-pointer",children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Ct,{className:"h-5 w-5 text-primary"}),i.jsx("span",{children:"Skill Mapping"})]})}),i.jsx(yn,{children:i.jsx("p",{className:"text-muted-foreground text-sm",children:"Map skills to roles and career pathways"})})]})]})]})};var eb=["PageUp","PageDown"],sb=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],tb={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},ab="Slider",[rb,nb,ib]=a(ab),[lb,cb]=r(ab,[ib]),[ob,db]=lb(ab),mb=ce.forwardRef((e,s)=>{const{name:t,min:a=0,max:r=100,step:n=1,orientation:l="horizontal",disabled:c=!1,minStepsBetweenThumbs:o=0,defaultValue:m=[a],value:h,onValueChange:x=()=>{},onValueCommit:p=()=>{},inverted:f=!1,form:g,...v}=e,j=ce.useRef(new Set),y=ce.useRef(0),b="horizontal"===l?xb:pb,[N=[],w]=d({prop:h,defaultProp:m,onChange:e=>{var s;null==(s=[...j.current][y.current])||s.focus(),x(e)}}),_=ce.useRef(N);function k(e,s,{commit:t}={commit:!1}){const i=function(e){return(String(e).split(".")[1]||"").length}(n),l=function(e,s){const t=Math.pow(10,s);return Math.round(e*t)/t}(Math.round((e-a)/n)*n+a,i),c=te(l,[a,r]);w((e=[])=>{const a=function(e=[],s,t){const a=[...e];return a[t]=s,a.sort((e,s)=>e-s)}(e,c,s);if(function(e,s){if(s>0){const t=function(e){return e.slice(0,-1).map((s,t)=>e[t+1]-s)}(e);return Math.min(...t)>=s}return!0}(a,o*n)){y.current=a.indexOf(c);const s=String(a)!==String(e);return s&&t&&p(a),s?a:e}return e})}return i.jsx(ob,{scope:e.__scopeSlider,name:t,disabled:c,min:a,max:r,valueIndexToChangeRef:y,thumbs:j.current,values:N,orientation:l,form:g,children:i.jsx(rb.Provider,{scope:e.__scopeSlider,children:i.jsx(rb.Slot,{scope:e.__scopeSlider,children:i.jsx(b,{"aria-disabled":c,"data-disabled":c?"":void 0,...v,ref:s,onPointerDown:u(v.onPointerDown,()=>{c||(_.current=N)}),min:a,max:r,inverted:f,onSlideStart:c?void 0:function(e){const s=function(e,s){if(1===e.length)return 0;const t=e.map(e=>Math.abs(e-s)),a=Math.min(...t);return t.indexOf(a)}(N,e);k(e,s)},onSlideMove:c?void 0:function(e){k(e,y.current)},onSlideEnd:c?void 0:function(){const e=_.current[y.current];N[y.current]!==e&&p(N)},onHomeKeyDown:()=>!c&&k(a,0,{commit:!0}),onEndKeyDown:()=>!c&&k(r,N.length-1,{commit:!0}),onStepKeyDown:({event:e,direction:s})=>{if(!c){const t=eb.includes(e.key)||e.shiftKey&&sb.includes(e.key)?10:1,a=y.current;k(N[a]+n*t*s,a,{commit:!0})}}})})})})});mb.displayName=ab;var[hb,ub]=lb(ab,{startEdge:"left",endEdge:"right",size:"width",direction:1}),xb=ce.forwardRef((e,s)=>{const{min:t,max:a,dir:r,inverted:l,onSlideStart:c,onSlideMove:o,onSlideEnd:d,onStepKeyDown:m,...h}=e,[u,x]=ce.useState(null),p=n(s,e=>x(e)),f=ce.useRef(void 0),g=se(r),v="ltr"===g,j=v&&!l||!v&&l;function y(e){const s=f.current||u.getBoundingClientRect(),r=Sb([0,s.width],j?[t,a]:[a,t]);return f.current=s,r(e-s.left)}return i.jsx(hb,{scope:e.__scopeSlider,startEdge:j?"left":"right",endEdge:j?"right":"left",direction:j?1:-1,size:"width",children:i.jsx(fb,{dir:g,"data-orientation":"horizontal",...h,ref:p,style:{...h.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:e=>{const s=y(e.clientX);null==c||c(s)},onSlideMove:e=>{const s=y(e.clientX);null==o||o(s)},onSlideEnd:()=>{f.current=void 0,null==d||d()},onStepKeyDown:e=>{const s=tb[j?"from-left":"from-right"].includes(e.key);null==m||m({event:e,direction:s?-1:1})}})})}),pb=ce.forwardRef((e,s)=>{const{min:t,max:a,inverted:r,onSlideStart:l,onSlideMove:c,onSlideEnd:o,onStepKeyDown:d,...m}=e,h=ce.useRef(null),u=n(s,h),x=ce.useRef(void 0),p=!r;function f(e){const s=x.current||h.current.getBoundingClientRect(),r=Sb([0,s.height],p?[a,t]:[t,a]);return x.current=s,r(e-s.top)}return i.jsx(hb,{scope:e.__scopeSlider,startEdge:p?"bottom":"top",endEdge:p?"top":"bottom",size:"height",direction:p?1:-1,children:i.jsx(fb,{"data-orientation":"vertical",...m,ref:u,style:{...m.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:e=>{const s=f(e.clientY);null==l||l(s)},onSlideMove:e=>{const s=f(e.clientY);null==c||c(s)},onSlideEnd:()=>{x.current=void 0,null==o||o()},onStepKeyDown:e=>{const s=tb[p?"from-bottom":"from-top"].includes(e.key);null==d||d({event:e,direction:s?-1:1})}})})}),fb=ce.forwardRef((e,s)=>{const{__scopeSlider:t,onSlideStart:a,onSlideMove:r,onSlideEnd:n,onHomeKeyDown:l,onEndKeyDown:o,onStepKeyDown:d,...m}=e,h=db(ab,t);return i.jsx(c.span,{...m,ref:s,onKeyDown:u(e.onKeyDown,e=>{"Home"===e.key?(l(e),e.preventDefault()):"End"===e.key?(o(e),e.preventDefault()):eb.concat(sb).includes(e.key)&&(d(e),e.preventDefault())}),onPointerDown:u(e.onPointerDown,e=>{const s=e.target;s.setPointerCapture(e.pointerId),e.preventDefault(),h.thumbs.has(s)?s.focus():a(e)}),onPointerMove:u(e.onPointerMove,e=>{e.target.hasPointerCapture(e.pointerId)&&r(e)}),onPointerUp:u(e.onPointerUp,e=>{const s=e.target;s.hasPointerCapture(e.pointerId)&&(s.releasePointerCapture(e.pointerId),n(e))})})}),gb="SliderTrack",vb=ce.forwardRef((e,s)=>{const{__scopeSlider:t,...a}=e,r=db(gb,t);return i.jsx(c.span,{"data-disabled":r.disabled?"":void 0,"data-orientation":r.orientation,...a,ref:s})});vb.displayName=gb;var jb="SliderRange",yb=ce.forwardRef((e,s)=>{const{__scopeSlider:t,...a}=e,r=db(jb,t),l=ub(jb,t),o=ce.useRef(null),d=n(s,o),m=r.values.length,h=r.values.map(e=>kb(e,r.min,r.max)),u=m>1?Math.min(...h):0,x=100-Math.max(...h);return i.jsx(c.span,{"data-orientation":r.orientation,"data-disabled":r.disabled?"":void 0,...a,ref:d,style:{...e.style,[l.startEdge]:u+"%",[l.endEdge]:x+"%"}})});yb.displayName=jb;var bb="SliderThumb",Nb=ce.forwardRef((e,s)=>{const t=nb(e.__scopeSlider),[a,r]=ce.useState(null),l=n(s,e=>r(e)),c=ce.useMemo(()=>a?t().findIndex(e=>e.ref.current===a):-1,[t,a]);return i.jsx(wb,{...e,ref:l,index:c})}),wb=ce.forwardRef((e,s)=>{const{__scopeSlider:t,index:a,name:r,...l}=e,o=db(bb,t),d=ub(bb,t),[m,h]=ce.useState(null),x=n(s,e=>h(e)),p=!m||(o.form||!!m.closest("form")),f=ie(m),g=o.values[a],v=void 0===g?0:kb(g,o.min,o.max),j=function(e,s){return s>2?`Value ${e+1} of ${s}`:2===s?["Minimum","Maximum"][e]:void 0}(a,o.values.length),y=null==f?void 0:f[d.size],b=y?function(e,s,t){const a=e/2,r=Sb([0,50],[0,a]);return(a-r(s)*t)*t}(y,v,d.direction):0;return ce.useEffect(()=>{if(m)return o.thumbs.add(m),()=>{o.thumbs.delete(m)}},[m,o.thumbs]),i.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[d.startEdge]:`calc(${v}% + ${b}px)`},children:[i.jsx(rb.ItemSlot,{scope:e.__scopeSlider,children:i.jsx(c.span,{role:"slider","aria-label":e["aria-label"]||j,"aria-valuemin":o.min,"aria-valuenow":g,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...l,ref:x,style:void 0===g?{display:"none"}:e.style,onFocus:u(e.onFocus,()=>{o.valueIndexToChangeRef.current=a})})}),p&&i.jsx(_b,{name:r??(o.name?o.name+(o.values.length>1?"[]":""):void 0),form:o.form,value:g},a)]})});Nb.displayName=bb;var _b=ce.forwardRef(({__scopeSlider:e,value:s,...t},a)=>{const r=ce.useRef(null),l=n(r,a),o=ne(s);return ce.useEffect(()=>{const e=r.current;if(!e)return;const t=window.HTMLInputElement.prototype,a=Object.getOwnPropertyDescriptor(t,"value").set;if(o!==s&&a){const t=new Event("input",{bubbles:!0});a.call(e,s),e.dispatchEvent(t)}},[o,s]),i.jsx(c.input,{style:{display:"none"},...t,ref:l,defaultValue:s})});function kb(e,s,t){return te(100/(t-s)*(e-s),[0,100])}function Sb(e,s){return t=>{if(e[0]===e[1]||s[0]===s[1])return s[0];const a=(s[1]-s[0])/(e[1]-e[0]);return s[0]+a*(t-e[0])}}_b.displayName="RadioBubbleInput";var Eb=mb,Tb=vb,Cb=yb,Ab=Nb;const Rb=ce.forwardRef(({className:e,...s},t)=>i.jsxs(Eb,{ref:t,className:Ga("relative flex w-full touch-none select-none items-center",e),...s,children:[i.jsx(Tb,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:i.jsx(Cb,{className:"absolute h-full bg-primary"})}),i.jsx(Ab,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]}));Rb.displayName=Eb.displayName;const Ib=()=>{const[e,s]=ce.useState(!1),[t,a]=ce.useState(null);return{loading:e,error:t,createTrainingProgram:async e=>{try{s(!0),a(null);const{data:t,error:r}=await en.functions.invoke("training-management-crud",{body:{action:"create_program",...e}});if(r)throw new Error(r.message||"Failed to create training program");return t.program}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";throw a(e),t}finally{s(!1)}},updateTrainingProgram:async(e,t)=>{try{s(!0),a(null);const{data:r,error:n}=await en.functions.invoke("training-management-crud",{body:{action:"update_program",id:e,...t}});if(n)throw new Error(n.message||"Failed to update training program");return r.program}catch(r){const e=r instanceof Error?r.message:"Unknown error occurred";throw a(e),r}finally{s(!1)}},deleteTrainingProgram:async e=>{try{s(!0),a(null);const{data:t,error:r}=await en.functions.invoke("training-management-crud",{body:{action:"delete_program",id:e}});if(r)throw new Error(r.message||"Failed to delete training program");return t}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";throw a(e),t}finally{s(!1)}},getTrainingPrograms:async e=>{try{s(!0),a(null);const{data:t,error:r}=await en.functions.invoke("training-management-crud",{body:{action:"get_programs",...e}});if(r)throw new Error(r.message||"Failed to fetch training programs");return t.programs}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";throw a(e),t}finally{s(!1)}},assignTraining:async e=>{try{s(!0),a(null);const{data:t,error:r}=await en.functions.invoke("training-management-crud",{body:{action:"assign_training",...e}});if(r)throw new Error(r.message||"Failed to assign training");return t.enrollment}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";throw a(e),t}finally{s(!1)}},getEmployeeTrainings:async(e,t)=>{try{s(!0),a(null);const{data:r,error:n}=await en.functions.invoke("training-management-crud",{body:{action:"get_employee_trainings",employeeId:e,...t}});if(n)throw new Error(n.message||"Failed to fetch employee trainings");return r.enrollments}catch(r){const e=r instanceof Error?r.message:"Unknown error occurred";throw a(e),r}finally{s(!1)}},updateEnrollment:async e=>{try{s(!0),a(null);const{data:t,error:r}=await en.functions.invoke("training-management-crud",{body:{action:"update_enrollment",...e}});if(r)throw new Error(r.message||"Failed to update enrollment");return t.enrollment}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";throw a(e),t}finally{s(!1)}},getTrainingAnalytics:async()=>{try{s(!0),a(null);const{data:e,error:t}=await en.functions.invoke("training-management-crud",{body:{action:"get_training_analytics"}});if(t)throw new Error(t.message||"Failed to fetch training analytics");return e.analytics}catch(e){const s=e instanceof Error?e.message:"Unknown error occurred";throw a(s),e}finally{s(!1)}}}},Pb=()=>{const[e,s]=ce.useState(!1),[t,a]=ce.useState(null);return{loading:e,error:t,analyzeEmployeeTraining:async e=>{try{s(!0),a(null);const{data:t,error:r}=await en.functions.invoke("ai-training-analyzer",{body:{employeeId:e,analysisType:"individual"}});if(r)throw new Error(r.message||"Failed to analyze employee training needs");return t.recommendations[0]}catch(t){const e=t instanceof Error?t.message:"Unknown error occurred";throw a(e),t}finally{s(!1)}},analyzeAllEmployees:async()=>{try{s(!0),a(null);const{data:e,error:t}=await en.functions.invoke("ai-training-analyzer",{body:{analysisType:"bulk"}});if(t)throw new Error(t.message||"Failed to analyze all employees");return e.recommendations}catch(e){const s=e instanceof Error?e.message:"Unknown error occurred";throw a(s),e}finally{s(!1)}}}};function Db(){const[e,s]=ce.useState([]),[t,a]=ce.useState(null),[r,n]=ce.useState(!1),[l,c]=ce.useState(!1),[o,d]=ce.useState(!1),[m,h]=ce.useState(""),[u,x]=ce.useState("all"),[p,f]=ce.useState(null),{loading:g,error:v,createTrainingProgram:j,updateTrainingProgram:y,deleteTrainingProgram:b,getTrainingPrograms:N}=Ib(),{loading:w,error:_,analyzeEmployeeTraining:k}=Pb(),{user:S}=tn(),{toast:E}=De(),[T,C]=ce.useState({name:"",description:"",category:"",type:"online",duration_hours:0,duration_weeks:0,difficulty_level:"Beginner",target_audience:[],learning_objectives:[],tags:[],max_participants:50,cost_per_participant:0,certification_provided:!1,content_url:"",schedule_type:"self_paced",created_by:(null==S?void 0:S.id)||"00000000-0000-0000-0000-000000000000"});ce.useEffect(()=>{A()},[]);const A=async()=>{try{const e=await N({status:"active"});s(e),e.length}catch(e){E({title:"Error",description:e instanceof Error?e.message:"Failed to load training programs",variant:"destructive"})}},R=e.filter(e=>{const s=e.name.toLowerCase().includes(m.toLowerCase())||e.description.toLowerCase().includes(m.toLowerCase()),t="all"===u||e.category===u;return s&&t}),I=Array.from(new Set(e.map(e=>e.category)));return g?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx(ot,{className:"h-8 w-8 animate-spin text-primary"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Training Management"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"Create, manage, and assign training programs"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs(nn,{variant:"outline",onClick:A,disabled:g,className:"flex items-center gap-2",children:[g?i.jsx(ot,{className:"h-4 w-4 animate-spin"}):i.jsx(kt,{className:"h-4 w-4"}),"Refresh"]}),i.jsxs(Cn,{open:o,onOpenChange:d,children:[i.jsx(An,{asChild:!0,children:i.jsxs(nn,{variant:"outline",className:"flex items-center gap-2",children:[i.jsx(Rs,{className:"h-4 w-4"}),"AI Analysis"]})}),i.jsxs(Pn,{children:[i.jsx(Dn,{children:i.jsx(On,{children:"AI Training Analysis"})}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-sm text-muted-foreground",children:"Analyze employee training needs using AI to get personalized recommendations."}),i.jsxs(nn,{onClick:()=>(async e=>{try{f(e);const s=await k(e);E({title:"Analysis Complete",description:`Found ${s.recommendedTrainings.length} training recommendations`})}catch(s){E({title:"Error",description:"Failed to analyze employee training needs",variant:"destructive"})}finally{f(null)}})("employee-id-here"),disabled:w,className:"w-full",children:[w?i.jsx(ot,{className:"h-4 w-4 animate-spin mr-2"}):i.jsx(Rs,{className:"h-4 w-4 mr-2"}),"Analyze All Employees"]})]})]})]}),i.jsxs(Cn,{open:r,onOpenChange:n,children:[i.jsx(An,{asChild:!0,children:i.jsxs(nn,{className:"flex items-center gap-2",children:[i.jsx(_t,{className:"h-4 w-4"}),"Create Program"]})}),i.jsxs(Pn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[i.jsx(Dn,{children:i.jsx(On,{children:"Create Training Program"})}),i.jsx(Mb,{program:T,setProgram:C,onSubmit:async()=>{if(T.name.trim())if(T.category.trim())try{await j(T);E({title:"Success",description:"Training program created successfully"}),n(!1),C({name:"",description:"",category:"",type:"online",duration_hours:0,duration_weeks:0,difficulty_level:"Beginner",target_audience:[],learning_objectives:[],tags:[],max_participants:50,cost_per_participant:0,certification_provided:!1,content_url:"",schedule_type:"self_paced",created_by:(null==S?void 0:S.id)||"00000000-0000-0000-0000-000000000000"}),A()}catch(e){E({title:"Error",description:e instanceof Error?e.message:"Failed to create training program",variant:"destructive"})}else E({title:"Validation Error",description:"Category is required",variant:"destructive"});else E({title:"Validation Error",description:"Program name is required",variant:"destructive"})},loading:g})]})]})]})]}),v&&i.jsxs(Hi,{variant:"destructive",children:[i.jsx(Vs,{className:"h-4 w-4"}),i.jsx(Vi,{children:v})]}),i.jsxs("div",{className:"flex gap-4 items-center",children:[i.jsx("div",{className:"flex-1",children:i.jsx(ln,{placeholder:"Search training programs...",value:m,onChange:e=>h(e.target.value)})}),i.jsxs(bn,{value:u,onValueChange:x,children:[i.jsx(wn,{className:"w-48",children:i.jsx(Nn,{placeholder:"Select category"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"all",children:"All Categories"}),I.map(e=>i.jsx(En,{value:e,children:e},e))]})]})]}),i.jsx("div",{className:"grid gap-6 md:grid-cols-2 lg:grid-cols-3",children:R.map(e=>i.jsxs(fn,{className:"hover:shadow-md transition-shadow",children:[i.jsx(gn,{children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx(vn,{className:"text-lg",children:e.name}),i.jsx(zn,{variant:"outline",children:e.category})]}),i.jsxs("div",{className:"flex gap-1",children:[i.jsx(nn,{size:"sm",variant:"ghost",onClick:()=>{a(e),C(e),c(!0)},children:i.jsx(Dt,{className:"h-4 w-4"})}),i.jsx(nn,{size:"sm",variant:"ghost",onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this training program?"))try{await b(e),E({title:"Success",description:"Training program deleted successfully"}),A()}catch(s){E({title:"Error",description:"Failed to delete training program",variant:"destructive"})}})(e.id),children:i.jsx(zt,{className:"h-4 w-4"})})]})]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-3",children:[i.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.description}),i.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Ys,{className:"h-4 w-4 text-muted-foreground"}),i.jsxs("span",{children:[e.duration_hours,"h"]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Wt,{className:"h-4 w-4 text-muted-foreground"}),i.jsx("span",{children:e.max_participants})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Ft,{className:"h-4 w-4 text-muted-foreground"}),i.jsx("span",{children:e.difficulty_level})]})]}),e.certification_provided&&i.jsxs("div",{className:"flex items-center gap-1 text-sm text-green-600",children:[i.jsx(Ts,{className:"h-4 w-4"}),i.jsx("span",{children:"Certification Available"})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs(nn,{size:"sm",variant:"outline",className:"flex-1",children:[i.jsx(Wt,{className:"h-4 w-4 mr-1"}),"Assign"]}),i.jsxs(nn,{size:"sm",variant:"outline",className:"flex-1",children:[i.jsx(Cs,{className:"h-4 w-4 mr-1"}),"View Details"]})]})]})})]},e.id))}),0===R.length&&i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Cs,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"No training programs found"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:m||"all"!==u?"Try adjusting your search criteria":"Create your first training program to get started"}),v&&i.jsxs(Hi,{variant:"destructive",className:"max-w-md mx-auto mb-4",children:[i.jsx(Vs,{className:"h-4 w-4"}),i.jsx(Vi,{children:v})]}),i.jsxs("div",{className:"text-sm text-muted-foreground mb-4",children:["Total programs loaded: ",e.length]}),!m&&"all"===u&&i.jsxs(nn,{onClick:()=>n(!0),children:[i.jsx(_t,{className:"h-4 w-4 mr-2"}),"Create Program"]})]}),i.jsx(Cn,{open:l,onOpenChange:c,children:i.jsxs(Pn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[i.jsx(Dn,{children:i.jsx(On,{children:"Edit Training Program"})}),i.jsx(Mb,{program:T,setProgram:C,onSubmit:async()=>{if(t)try{await y(t.id,T),E({title:"Success",description:"Training program updated successfully"}),c(!1),a(null),A()}catch(e){E({title:"Error",description:"Failed to update training program",variant:"destructive"})}},loading:g})]})})]})}function Mb({program:e,setProgram:s,onSubmit:t,loading:a}){return i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"name",children:"Program Name"}),i.jsx(ln,{id:"name",value:e.name,onChange:t=>s({...e,name:t.target.value}),placeholder:"Enter program name"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"category",children:"Category"}),i.jsxs(bn,{value:e.category,onValueChange:t=>s({...e,category:t}),children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select category"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"Leadership",children:"Leadership"}),i.jsx(En,{value:"Technical",children:"Technical"}),i.jsx(En,{value:"Soft Skills",children:"Soft Skills"}),i.jsx(En,{value:"Compliance",children:"Compliance"}),i.jsx(En,{value:"Safety",children:"Safety"}),i.jsx(En,{value:"Other",children:"Other"})]})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"description",children:"Description"}),i.jsx(kf,{id:"description",value:e.description,onChange:t=>s({...e,description:t.target.value}),placeholder:"Enter program description",rows:3})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"content_url",children:"Program URL"}),i.jsx(ln,{id:"content_url",type:"url",value:e.content_url||"",onChange:t=>s({...e,content_url:t.target.value}),placeholder:"e.g., https://learning.company.com/courses/leadership-training"}),i.jsx("p",{className:"text-xs text-gray-500",children:"Optional: Link to training materials, course platform, or registration page"})]}),i.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"type",children:"Type"}),i.jsxs(bn,{value:e.type,onValueChange:t=>s({...e,type:t}),children:[i.jsx(wn,{children:i.jsx(Nn,{})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"online",children:"Online"}),i.jsx(En,{value:"classroom",children:"Classroom"}),i.jsx(En,{value:"hybrid",children:"Hybrid"}),i.jsx(En,{value:"certification",children:"Certification"})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"duration_hours",children:"Duration (Hours)"}),i.jsx(ln,{id:"duration_hours",type:"number",value:e.duration_hours,onChange:t=>s({...e,duration_hours:parseInt(t.target.value)||0})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"difficulty",children:"Difficulty"}),i.jsxs(bn,{value:e.difficulty_level,onValueChange:t=>s({...e,difficulty_level:t}),children:[i.jsx(wn,{children:i.jsx(Nn,{})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"Beginner",children:"Beginner"}),i.jsx(En,{value:"Intermediate",children:"Intermediate"}),i.jsx(En,{value:"Advanced",children:"Advanced"})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"max_participants",children:"Max Participants"}),i.jsx(ln,{id:"max_participants",type:"number",value:e.max_participants,onChange:t=>s({...e,max_participants:parseInt(t.target.value)||0})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{htmlFor:"cost",children:"Cost per Participant"}),i.jsx(ln,{id:"cost",type:"number",value:e.cost_per_participant,onChange:t=>s({...e,cost_per_participant:parseFloat(t.target.value)||0})})]})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("input",{type:"checkbox",id:"certification",checked:e.certification_provided,onChange:t=>s({...e,certification_provided:t.target.checked})}),i.jsx(mn,{htmlFor:"certification",children:"Certification Provided"})]}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx(nn,{variant:"outline",onClick:()=>{},children:"Cancel"}),i.jsxs(nn,{onClick:t,disabled:a,children:[a?i.jsx(ot,{className:"h-4 w-4 animate-spin mr-2"}):i.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Save Program"]})]})]})}function Ob({employeeId:e,onAssignmentComplete:s}){const[t,a]=ce.useState([]),[r,n]=ce.useState(null),[l,c]=ce.useState(null),[o,d]=ce.useState(!1),[m,h]=ce.useState(!1),[u,x]=ce.useState(""),[p,f]=ce.useState("all"),[g,v]=ce.useState(null),[j,y]=ce.useState({priority:"medium",targetCompletionDate:"",enrollmentType:"hr_assigned"}),{employees:b,loading:N,error:w}=Wy(),{loading:_,error:k,assignTraining:S,getTrainingPrograms:E,getEmployeeTrainings:T}=Ib(),{loading:C,error:A,analyzeEmployeeTraining:R}=Pb(),{user:I}=tn(),{toast:P}=De();ce.useEffect(()=>{D(),e&&M(e)},[e]);const D=async()=>{try{const e=await E({status:"active"});a(e)}catch(e){}},M=async e=>{try{await T(e)}catch(s){}},O=b.filter(e=>{const s=e.first_name.toLowerCase().includes(u.toLowerCase())||e.last_name.toLowerCase().includes(u.toLowerCase())||e.current_position.toLowerCase().includes(u.toLowerCase()),t="all"===p||e.current_department===p;return s&&t&&e.is_active}),F=Array.from(new Set(b.map(e=>e.current_department).filter(e=>e&&""!==e.trim())));return _||N?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsx(ot,{className:"h-8 w-8 animate-spin text-primary"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{className:"flex items-center justify-between",children:i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-foreground",children:"Training Assignment"}),i.jsx("p",{className:"text-muted-foreground",children:"Assign training programs to employees or use AI to get recommendations"})]})}),(k||w)&&i.jsxs(Hi,{variant:"destructive",children:[i.jsx(Vs,{className:"h-4 w-4"}),i.jsx(Vi,{children:k||w})]}),i.jsxs("div",{className:"flex gap-4 items-center",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"relative",children:[i.jsx(Ct,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),i.jsx(ln,{placeholder:"Search employees...",value:u,onChange:e=>x(e.target.value),className:"pl-10"})]})}),i.jsxs(bn,{value:p,onValueChange:f,children:[i.jsx(wn,{className:"w-48",children:i.jsx(Nn,{placeholder:"Select department"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"all",children:"All Departments"}),F.map(e=>i.jsx(En,{value:e,children:e},e))]})]})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Cs,{className:"h-5 w-5"}),"Available Training Programs"]})}),i.jsx(yn,{children:i.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:t.slice(0,6).map(e=>i.jsxs("div",{className:"border rounded-lg p-4 space-y-3",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium",children:e.name}),i.jsx(zn,{variant:"outline",className:"text-xs",children:e.category})]}),i.jsxs("div",{className:"flex items-center gap-1 text-sm text-muted-foreground",children:[i.jsx(Ys,{className:"h-4 w-4"}),i.jsxs("span",{children:[e.duration_hours,"h"]})]})]}),i.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2",children:e.description}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-1 text-sm",children:[i.jsx(Wt,{className:"h-4 w-4 text-muted-foreground"}),i.jsxs("span",{children:[e.max_participants," max"]})]}),i.jsx(zn,{variant:"secondary",className:"text-xs",children:e.difficulty_level})]})]},e.id))})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Wt,{className:"h-5 w-5"}),"Employees (",O.length,")"]})}),i.jsx(yn,{children:0===O.length?i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Wt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"No employees found"}),i.jsx("p",{className:"text-muted-foreground",children:u||"all"!==p?"Try adjusting your search criteria":"No active employees available for training assignment"})]}):i.jsx("div",{className:"space-y-4",children:O.map(e=>i.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:i.jsxs("span",{className:"text-sm font-medium text-primary",children:[e.first_name[0],e.last_name[0]]})}),i.jsxs("div",{children:[i.jsxs("h4",{className:"font-medium",children:[e.first_name," ",e.last_name]}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[e.current_position," • ",e.current_department]})]})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsxs(nn,{size:"sm",variant:"outline",onClick:()=>(async e=>{try{const s=await R(e.id);v(s),n(e),h(!0)}catch(s){P({title:"Error",description:s instanceof Error?s.message:"Failed to analyze employee training needs",variant:"destructive"})}})(e),disabled:C,children:[C?i.jsx(ot,{className:"h-4 w-4 animate-spin"}):i.jsx(Rs,{className:"h-4 w-4"}),i.jsx("span",{className:"ml-1",children:"Analyze"})]}),i.jsxs(nn,{size:"sm",onClick:()=>{n(e),d(!0)},children:[i.jsx(Vt,{className:"h-4 w-4"}),i.jsx("span",{className:"ml-1",children:"Assign"})]})]})]},e.id))})})]}),i.jsx(Cn,{open:o,onOpenChange:d,children:i.jsxs(Pn,{children:[i.jsx(Dn,{children:i.jsx(On,{children:"Assign Training"})}),i.jsxs("div",{className:"space-y-4",children:[r&&i.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[i.jsxs("h4",{className:"font-medium",children:[r.first_name," ",r.last_name]}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[r.current_position," • ",r.current_department]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{children:"Training Program"}),i.jsxs(bn,{value:(null==l?void 0:l.id)||"",onValueChange:e=>{const s=t.find(s=>s.id===e);c(s||null)},children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select training program"})}),i.jsx(Sn,{children:t.filter(e=>e.id&&""!==e.id.trim()).map(e=>i.jsxs(En,{value:e.id,children:[e.name," (",e.category,")"]},e.id))})]})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{children:"Priority"}),i.jsxs(bn,{value:j.priority,onValueChange:e=>y({...j,priority:e}),children:[i.jsx(wn,{children:i.jsx(Nn,{})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"low",children:"Low"}),i.jsx(En,{value:"medium",children:"Medium"}),i.jsx(En,{value:"high",children:"High"}),i.jsx(En,{value:"critical",children:"Critical"})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{children:"Enrollment Type"}),i.jsxs(bn,{value:j.enrollmentType,onValueChange:e=>y({...j,enrollmentType:e}),children:[i.jsx(wn,{children:i.jsx(Nn,{})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"hr_assigned",children:"HR Assigned"}),i.jsx(En,{value:"manager_assigned",children:"Manager Assigned"}),i.jsx(En,{value:"mandatory",children:"Mandatory"}),i.jsx(En,{value:"ai_recommended",children:"AI Recommended"})]})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(mn,{children:"Target Completion Date"}),i.jsx(ln,{type:"date",value:j.targetCompletionDate,onChange:e=>y({...j,targetCompletionDate:e.target.value})})]}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx(nn,{variant:"outline",onClick:()=>d(!1),children:"Cancel"}),i.jsxs(nn,{onClick:async()=>{if(r&&l)try{await S({employeeId:r.id,trainingProgramId:l.id,enrollmentType:j.enrollmentType,priority:j.priority,targetCompletionDate:j.targetCompletionDate,assignedBy:(null==I?void 0:I.id)||"00000000-0000-0000-0000-000000000000"});P({title:"Success",description:`Training assigned to ${r.first_name} ${r.last_name}`}),d(!1),n(null),c(null),D(),null==s||s()}catch(e){P({title:"Error",description:e instanceof Error?e.message:"Failed to assign training",variant:"destructive"})}},disabled:!l||_,children:[_?i.jsx(ot,{className:"h-4 w-4 animate-spin mr-2"}):i.jsx(Gs,{className:"h-4 w-4 mr-2"}),"Assign Training"]})]})]})]})}),i.jsx(Cn,{open:m,onOpenChange:h,children:i.jsxs(Pn,{className:"max-w-2xl max-h-[80vh] overflow-y-auto",children:[i.jsx(Dn,{children:i.jsx(On,{children:"AI Training Analysis"})}),g&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"p-3 bg-muted rounded-lg",children:[i.jsx("h4",{className:"font-medium",children:g.employeeName}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[g.currentRole," • ",g.department]}),i.jsx("div",{className:"mt-2",children:i.jsxs(zn,{variant:"outline",children:["Training Readiness: ",g.overallScore,"/100"]})})]}),g.skillGaps.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium mb-2",children:"Identified Skill Gaps"}),i.jsx("div",{className:"flex flex-wrap gap-2",children:g.skillGaps.map((e,s)=>i.jsx(zn,{variant:"destructive",children:e},s))})]}),t.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"font-medium mb-2",children:"Training Programs for Assignment"}),i.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:t.map(e=>i.jsxs("div",{className:"border rounded-lg p-3 bg-background",children:[i.jsxs("div",{className:"flex items-start justify-between mb-2",children:[i.jsx("h6",{className:"font-medium",children:e.name}),i.jsx(zn,{variant:"outline",children:e.category})]}),e.description&&i.jsx("p",{className:"text-sm text-muted-foreground mb-2",children:e.description}),i.jsxs("div",{className:"flex items-center gap-4 text-xs text-muted-foreground mb-2",children:[i.jsxs("span",{children:[e.duration_hours,"h"]}),i.jsx("span",{children:e.type}),i.jsxs("span",{children:["Difficulty: ",e.difficulty_level]})]}),i.jsx(nn,{size:"sm",variant:"outline",onClick:()=>{r&&(c(e),h(!1),d(!0))},children:"Assign This Program"})]},e.id))})]})]})]})})]})}function Fb(){var e,s,t,a,r,n,l;const[c,o]=ce.useState("overview"),{toast:d}=De(),{data:m,loading:h,error:u,refresh:x}=(()=>{const[e,s]=ce.useState(null),[t,a]=ce.useState(!0),[r,n]=ce.useState(null),i=async()=>{try{a(!0),n(null);const{data:e,error:t}=await en.functions.invoke("td-overview");if(t)throw new Error(t.message||"Failed to fetch training overview");if(!e)throw new Error("No data received from td-overview function");s(e)}catch(e){n(e instanceof Error?e.message:"Unknown error occurred")}finally{a(!1)}};return ce.useEffect(()=>{i()},[]),{data:e,loading:t,error:r,refresh:()=>{i()}}})(),{getTrainingPrograms:p,loading:f}=Ib(),[g,v]=ce.useState([]),[j,y]=ce.useState([]),[b,N]=ce.useState({totalEnrollments:0,activeEnrollments:0,completedEnrollments:0,completionRate:0}),[w,_]=ce.useState(null),[k,S]=ce.useState(!1),[E,T]=ce.useState({progress_percentage:0,status:"enrolled"}),C=async()=>{try{const e=await p({status:"active"});v(e||[])}catch(e){}},A=async()=>{try{const{data:e,error:s}=await en.from("employee_training_enrollments").select("id",{count:"exact"}),{data:t,error:a}=await en.from("employee_training_enrollments").select("\n          *,\n          training_programs(name, category, duration_hours),\n          xlsmart_employees!employee_training_enrollments_employee_id_fkey(first_name, last_name, current_position, current_department)\n        ").order("enrollment_date",{ascending:!1}).limit(20);if(a)throw a;y(t||[]);const r=(null==t?void 0:t.length)||0,n=(null==t?void 0:t.filter(e=>["enrolled","in_progress"].includes(e.status)).length)||0,i=(null==t?void 0:t.filter(e=>"completed"===e.status).length)||0,l=r>0?Math.round(i/r*100):0;N({totalEnrollments:r,activeEnrollments:n,completedEnrollments:i,completionRate:l})}catch(e){}};ce.useEffect(()=>{C(),A()},[c]);const R=async()=>{x(),C(),setTimeout(()=>{A()},1e3)};return h?i.jsx("div",{className:"flex items-center justify-center h-64",children:i.jsxs("div",{className:"text-center",children:[i.jsx(ot,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-primary"}),i.jsx("p",{children:"Loading training data..."})]})}):u?i.jsxs("div",{className:"space-y-4",children:[i.jsxs(Hi,{variant:"destructive",children:[i.jsx(Vs,{className:"h-4 w-4"}),i.jsxs(Vi,{children:["Failed to load training data: ",u]})]}),i.jsxs(nn,{onClick:x,className:"flex items-center gap-2",children:[i.jsx(kt,{className:"h-4 w-4"}),"Retry"]})]}):m?i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Training & Development"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"Comprehensive training program management and analytics"})]}),i.jsxs("section",{className:"bg-gradient-to-r from-primary/5 to-secondary/5 rounded-xl p-6 border",children:[i.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-semibold text-foreground mb-2",children:"Training Overview"}),i.jsx("p",{className:"text-muted-foreground",children:"Comprehensive training program management and insights"})]}),i.jsxs(nn,{onClick:R,disabled:h||f,className:"flex items-center gap-2",children:[h||f?i.jsx(ot,{className:"h-4 w-4 animate-spin"}):i.jsx(kt,{className:"h-4 w-4"}),"Refresh Data"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Cs,{className:"h-5 w-5 text-primary"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:g.length||(null==m?void 0:m.overview.totalPrograms)||0}),i.jsx("p",{className:"text-sm text-muted-foreground",children:0!==g.length||(null==m?void 0:m.overview.totalPrograms)?"Total Programs":"Programs (Click Create to add)"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Wt,{className:"h-5 w-5 text-secondary"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:b.activeEnrollments}),i.jsx("p",{className:"text-sm text-muted-foreground",children:0===b.activeEnrollments?"Participants (Ready for enrollment)":"Active Enrollments"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ut,{className:"h-5 w-5 text-accent"}),i.jsxs("div",{children:[i.jsxs("p",{className:"text-2xl font-bold",children:[b.completionRate,"%"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Completion Rate"})]})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(Ys,{className:"h-5 w-5 text-primary"}),i.jsxs("div",{children:[i.jsx("p",{className:"text-2xl font-bold",children:g.reduce((e,s)=>e+(s.duration_hours||0),0)}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Hours Available"})]})]})})})]})]}),i.jsxs(hn,{value:c,onValueChange:o,className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-6 lg:w-fit",children:[i.jsxs(xn,{value:"overview",className:"flex items-center gap-2",children:[i.jsx(Ms,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Overview"})]}),i.jsxs(xn,{value:"programs",className:"flex items-center gap-2",children:[i.jsx(Cs,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Programs"})]}),i.jsxs(xn,{value:"assignment",className:"flex items-center gap-2",children:[i.jsx(Wt,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Assignment"})]}),i.jsxs(xn,{value:"enrollments",className:"flex items-center gap-2",children:[i.jsx(Gs,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Enrollments"})]}),i.jsxs(xn,{value:"management",className:"flex items-center gap-2",children:[i.jsx(Ft,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Management"})]}),i.jsxs(xn,{value:"analytics",className:"flex items-center gap-2",children:[i.jsx(Ut,{className:"h-4 w-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Analytics"})]})]}),i.jsxs(pn,{value:"overview",className:"space-y-6 mt-6",children:[i.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ft,{className:"h-5 w-5"}),"Top Training Categories"]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:g.length>0?(()=>{const e=g.reduce((e,s)=>{const t=s.category||"General";return e[t]=(e[t]||0)+1,e},{});return Object.entries(e).sort(([,e],[,s])=>s-e).slice(0,5).map(([e,s])=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium",children:e}),i.jsxs(zn,{variant:"outline",children:[s," programs"]})]},e))})():i.jsx("p",{className:"text-sm text-muted-foreground",children:"No training programs yet. Create some programs to see categories!"})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Gs,{className:"h-5 w-5"}),"Program Status"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Active Programs"}),i.jsx(zn,{variant:"default",children:g.filter(e=>"active"===e.status).length})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Inactive Programs"}),i.jsx(zn,{variant:"secondary",children:g.filter(e=>"inactive"===e.status).length})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Total Programs"}),i.jsx(zn,{variant:"outline",children:g.length})]})]})})]})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Cs,{className:"h-5 w-5"}),"Recent Training Programs"]})}),i.jsx(yn,{children:g.length>0?i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"grid gap-3",children:g.slice(0,4).map(e=>i.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted rounded-lg",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"text-sm font-medium",children:e.name}),i.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:[e.category||"General"," • ",e.duration_hours||0,"h"]})]}),i.jsx("div",{className:"text-right",children:i.jsx(zn,{variant:"active"===e.status?"default":"secondary",className:"text-xs",children:e.status})})]},e.id))}),g.length>4&&i.jsxs(nn,{variant:"outline",className:"w-full mt-3",onClick:()=>o("programs"),children:["View All Programs (",g.length,")"]})]}):i.jsxs(Hi,{children:[i.jsx(it,{className:"h-4 w-4"}),i.jsx(Vi,{children:"No training programs found. Create your first program to get started!"})]})})]})]}),i.jsx(pn,{value:"assignment",className:"space-y-6 mt-6",children:i.jsx(Ob,{onAssignmentComplete:R})}),i.jsxs(pn,{value:"enrollments",className:"space-y-6 mt-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Gs,{className:"h-5 w-5"}),"Training Enrollments (",j.length,")"]}),i.jsxs(nn,{onClick:A,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[i.jsx(kt,{className:"h-4 w-4"}),"Refresh"]})]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:j.length>0?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold",children:"Current Enrollments"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Active training assignments and progress tracking"})]}),i.jsxs(nn,{onClick:()=>o("assignment"),children:[i.jsx(_t,{className:"h-4 w-4 mr-2"}),"Add More Enrollments"]})]}),i.jsx("div",{className:"space-y-3",children:j.map(e=>{var s,t,a,r,n,l,c,o,d,m,h,u;return i.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg hover:shadow-md hover:bg-muted/50 transition-all cursor-pointer group",onClick:()=>(e=>{_(e),T({progress_percentage:e.progress_percentage||0,status:e.status||"enrolled"}),S(!0)})(e),children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:i.jsxs("span",{className:"text-sm font-medium text-primary",children:[null==(t=null==(s=e.xlsmart_employees)?void 0:s.first_name)?void 0:t[0],null==(r=null==(a=e.xlsmart_employees)?void 0:a.last_name)?void 0:r[0]]})}),i.jsxs("div",{children:[i.jsxs("h4",{className:"font-medium",children:[null==(n=e.xlsmart_employees)?void 0:n.first_name," ",null==(l=e.xlsmart_employees)?void 0:l.last_name]}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[null==(c=e.xlsmart_employees)?void 0:c.current_position," • ",null==(o=e.xlsmart_employees)?void 0:o.current_department]}),i.jsxs("p",{className:"text-xs text-muted-foreground",children:["Enrolled: ",new Date(e.enrollment_date).toLocaleDateString()]})]})]})}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-medium text-sm",children:null==(d=e.training_programs)?void 0:d.name}),i.jsxs("div",{className:"text-xs text-muted-foreground",children:[null==(m=e.training_programs)?void 0:m.category," • ",null==(h=e.training_programs)?void 0:h.duration_hours,"h"]}),i.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[i.jsx(Bi,{value:e.progress_percentage||0,className:"w-20 h-2"}),i.jsxs("span",{className:"text-xs text-muted-foreground",children:[e.progress_percentage||0,"%"]})]})]}),i.jsxs("div",{className:"flex flex-col items-end gap-1",children:[i.jsx(zn,{variant:"completed"===e.status?"default":"in_progress"===e.status?"secondary":"enrolled"===e.status?"outline":"destructive",children:e.status.replace("_"," ")}),i.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.priority," priority"]}),i.jsxs("div",{className:"text-xs text-muted-foreground",children:["Type: ",null==(u=e.enrollment_type)?void 0:u.replace("_"," ")]}),i.jsx(Dt,{className:"h-4 w-4 text-muted-foreground opacity-0 group-hover:opacity-100 transition-opacity"})]})]})]},e.id)})}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-6 p-4 bg-muted rounded-lg",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-lg font-bold",children:b.totalEnrollments}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Total Enrollments"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-lg font-bold",children:b.activeEnrollments}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Active"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-lg font-bold",children:b.completedEnrollments}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Completed"})]}),i.jsxs("div",{className:"text-center",children:[i.jsxs("p",{className:"text-lg font-bold",children:[b.completionRate,"%"]}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Success Rate"})]})]})]}):i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Gs,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Enrollments Found"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:0===b.totalEnrollments?"No training assignments have been created yet. Use the Assignment tab to create enrollments.":"Enrollments may still be loading. Try refreshing the data."}),i.jsxs("div",{className:"flex gap-2 justify-center",children:[i.jsxs(nn,{onClick:()=>o("assignment"),children:[i.jsx(_t,{className:"h-4 w-4 mr-2"}),"Create First Enrollment"]}),i.jsxs(nn,{onClick:A,variant:"outline",children:[i.jsx(kt,{className:"h-4 w-4 mr-2"}),"Refresh Data"]})]}),i.jsxs("div",{className:"mt-4 text-xs text-muted-foreground",children:["Debug: Found ",b.totalEnrollments," total enrollments in database"]})]})})})]}),i.jsx(Cn,{open:k,onOpenChange:S,children:i.jsxs(Pn,{className:"max-w-md",children:[i.jsx(Dn,{children:i.jsx(On,{children:"Update Training Progress"})}),w&&i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"w-16 h-16 bg-primary/10 rounded-full flex items-center justify-center mx-auto mb-2",children:i.jsxs("span",{className:"text-lg font-medium text-primary",children:[null==(s=null==(e=w.xlsmart_employees)?void 0:e.first_name)?void 0:s[0],null==(a=null==(t=w.xlsmart_employees)?void 0:t.last_name)?void 0:a[0]]})}),i.jsxs("h3",{className:"font-medium",children:[null==(r=w.xlsmart_employees)?void 0:r.first_name," ",null==(n=w.xlsmart_employees)?void 0:n.last_name]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:null==(l=w.training_programs)?void 0:l.name})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs(mn,{htmlFor:"progress",children:["Progress: ",E.progress_percentage,"%"]}),i.jsxs("div",{className:"space-y-3 mt-2",children:[i.jsx(Rb,{value:[E.progress_percentage],onValueChange:e=>{const s=e[0];T(e=>({...e,progress_percentage:s,status:100===s?"completed":s>0?"in_progress":"enrolled"}))},max:100,step:25,className:"w-full"}),i.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[i.jsx("span",{children:"0%"}),i.jsx("span",{children:"25%"}),i.jsx("span",{children:"50%"}),i.jsx("span",{children:"75%"}),i.jsx("span",{children:"100%"})]})]})]}),i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"status",children:"Status"}),i.jsxs(bn,{value:E.status,onValueChange:e=>T(s=>({...s,status:e})),children:[i.jsx(wn,{children:i.jsx(Nn,{})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"enrolled",children:"Enrolled"}),i.jsx(En,{value:"in_progress",children:"In Progress"}),i.jsx(En,{value:"completed",children:"Completed"}),i.jsx(En,{value:"cancelled",children:"Cancelled"}),i.jsx(En,{value:"failed",children:"Failed"})]})]})]}),i.jsxs("div",{className:"flex gap-2 pt-4",children:[i.jsx(nn,{onClick:async()=>{var e,s;if(w)try{const{data:t,error:a}=await en.from("employee_training_enrollments").update({progress_percentage:E.progress_percentage,status:E.status,updated_at:(new Date).toISOString()}).eq("id",w.id).select().single();if(a)throw a;d({title:"Success",description:`Progress updated for ${null==(e=w.xlsmart_employees)?void 0:e.first_name} ${null==(s=w.xlsmart_employees)?void 0:s.last_name}`}),S(!1),_(null),A()}catch(t){d({title:"Error",description:"Failed to update progress. Please try again.",variant:"destructive"})}},className:"flex-1",children:"Update Progress"}),i.jsx(nn,{variant:"outline",onClick:()=>S(!1),className:"flex-1",children:"Cancel"})]})]})]})]})})]}),i.jsx(pn,{value:"management",className:"space-y-6 mt-6",children:i.jsx(Db,{})}),i.jsx(pn,{value:"programs",className:"space-y-6 mt-6",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Cs,{className:"h-5 w-5"}),"Training Programs (",g.length,")"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[g.length>0?i.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:g.map(e=>i.jsxs(fn,{className:"hover:shadow-md transition-shadow",children:[i.jsxs(gn,{className:"pb-2",children:[i.jsx(vn,{className:"text-lg",children:e.name}),i.jsx(zn,{variant:"outline",children:e.category})]}),i.jsxs(yn,{children:[i.jsx("p",{className:"text-sm text-muted-foreground mb-3 line-clamp-2",children:e.description}),i.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Ys,{className:"h-4 w-4 text-muted-foreground"}),i.jsxs("span",{children:[e.duration_hours,"h"]})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Wt,{className:"h-4 w-4 text-muted-foreground"}),i.jsx("span",{children:e.max_participants})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Ft,{className:"h-4 w-4 text-muted-foreground"}),i.jsx("span",{children:e.difficulty_level})]})]}),e.certification_provided&&i.jsxs("div",{className:"flex items-center gap-1 text-sm text-green-600 mt-2",children:[i.jsx(Ts,{className:"h-4 w-4"}),i.jsx("span",{children:"Certification Available"})]})]})]},e.id))}):i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Cs,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Training Programs Yet"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:"Create your first training program to get started"}),i.jsxs(nn,{onClick:()=>o("management"),children:[i.jsx(_t,{className:"h-4 w-4 mr-2"}),"Create First Program"]})]}),i.jsxs(Hi,{children:[i.jsx(it,{className:"h-4 w-4"}),i.jsx(Vi,{children:"Training programs can be created and managed in the Management tab. Use the Assignment tab to assign programs to employees."})]})]})})]})}),i.jsx(pn,{value:"participants",className:"space-y-6 mt-6",children:i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Wt,{className:"h-5 w-5"}),"Training Participants"]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-4",children:j.length>0?i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:"font-semibold",children:["Current Enrollments (",j.length,")"]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Active training assignments and progress"})]}),i.jsxs(nn,{onClick:()=>o("assignment"),children:[i.jsx(_t,{className:"h-4 w-4 mr-2"}),"Assign More Training"]})]}),i.jsx("div",{className:"space-y-3",children:j.map(e=>{var s,t,a,r,n,l,c,o,d,m,h;return i.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"w-10 h-10 bg-primary/10 rounded-full flex items-center justify-center",children:i.jsxs("span",{className:"text-sm font-medium text-primary",children:[null==(t=null==(s=e.xlsmart_employees)?void 0:s.first_name)?void 0:t[0],null==(r=null==(a=e.xlsmart_employees)?void 0:a.last_name)?void 0:r[0]]})}),i.jsxs("div",{children:[i.jsxs("h4",{className:"font-medium",children:[null==(n=e.xlsmart_employees)?void 0:n.first_name," ",null==(l=e.xlsmart_employees)?void 0:l.last_name]}),i.jsxs("p",{className:"text-sm text-muted-foreground",children:[null==(c=e.xlsmart_employees)?void 0:c.current_position," • ",null==(o=e.xlsmart_employees)?void 0:o.current_department]})]})]})}),i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsxs("div",{className:"text-right",children:[i.jsx("div",{className:"font-medium text-sm",children:null==(d=e.training_programs)?void 0:d.name}),i.jsxs("div",{className:"text-xs text-muted-foreground",children:[null==(m=e.training_programs)?void 0:m.category," • ",null==(h=e.training_programs)?void 0:h.duration_hours,"h"]})]}),i.jsxs("div",{className:"flex flex-col items-end gap-1",children:[i.jsx(zn,{variant:"completed"===e.status?"default":"in_progress"===e.status?"secondary":"enrolled"===e.status?"outline":"destructive",children:e.status}),i.jsxs("div",{className:"text-xs text-muted-foreground",children:[e.priority," priority"]})]})]})]},e.id)})})]}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold",children:"Current Enrollments"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"No training assignments yet"})]}),i.jsxs(nn,{onClick:()=>o("assignment"),children:[i.jsx(_t,{className:"h-4 w-4 mr-2"}),"Assign Training"]})]}),i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Wt,{className:"h-12 w-12 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-medium mb-2",children:"No Training Assignments Yet"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:"Start by assigning training programs to employees using the Assignment tab."}),i.jsxs(nn,{onClick:()=>o("assignment"),children:[i.jsx(_t,{className:"h-4 w-4 mr-2"}),"Assign Training"]})]})]})})})]})}),i.jsx(pn,{value:"analytics",className:"space-y-6 mt-6",children:i.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ut,{className:"h-5 w-5"}),"Training Effectiveness"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium",children:"Completion Rate"}),i.jsxs("span",{className:"text-2xl font-bold text-green-600",children:[b.completionRate,"%"]})]}),i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"bg-green-600 h-2 rounded-full",style:{width:`${b.completionRate}%`}})}),i.jsxs("div",{className:"grid grid-cols-3 gap-4 text-center",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-bold",children:b.totalEnrollments}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Total"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-bold",children:b.activeEnrollments}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Active"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-lg font-bold",children:b.completedEnrollments}),i.jsx("p",{className:"text-xs text-muted-foreground",children:"Completed"})]})]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Real-time enrollment data from database"})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ms,{className:"h-5 w-5"}),"Program Distribution"]})}),i.jsx(yn,{children:i.jsx("div",{className:"space-y-3",children:m.categories.length>0?m.categories.map(e=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm font-medium",children:e.name}),i.jsxs(zn,{variant:"outline",children:[e.count," programs"]})]},e.name)):i.jsx("p",{className:"text-sm text-muted-foreground",children:"No categories available"})})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ys,{className:"h-5 w-5"}),"Training Volume"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-3xl font-bold text-blue-600",children:m.overview.totalHours}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Total Training Hours"})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:"text-2xl font-bold text-purple-600",children:m.programStatus.active}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Active Programs"})]})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Ft,{className:"h-5 w-5"}),"System Health"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Programs Table:"}),i.jsx(zn,{variant:m.schemaNotes.programsTable?"default":"destructive",children:m.schemaNotes.programsTable?"Found":"Missing"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Participants Table:"}),i.jsx(zn,{variant:m.schemaNotes.participantsTable?"default":"destructive",children:m.schemaNotes.participantsTable?"Found":"Missing"})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Pathways Table:"}),i.jsx(zn,{variant:m.pathwaysHealth.tableFound?"default":"destructive",children:m.pathwaysHealth.tableFound?"Found":"Missing"})]}),i.jsxs(nn,{className:"w-full",variant:"outline",onClick:()=>d({title:"Diagnostics",description:"Visit /admin/td-diagnostics for detailed system health information."}),children:[i.jsx(Vs,{className:"h-4 w-4 mr-2"}),"View Diagnostics"]})]})})]})]})})]})]}):i.jsxs("div",{className:"text-center py-8",children:[i.jsx("p",{className:"text-muted-foreground",children:"No training data available"}),i.jsxs(nn,{onClick:x,className:"mt-4",children:[i.jsx(kt,{className:"h-4 w-4 mr-2"}),"Refresh"]})]})}const Lb=()=>i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Bulk Role Assignment"}),i.jsx("p",{className:"text-muted-foreground",children:"Automatically assign standardized roles to employees using AI analysis"})]}),i.jsx(Kj,{}),i.jsxs(fn,{children:[i.jsxs(gn,{children:[i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Rs,{className:"h-5 w-5"}),"How AI Bulk Role Assignment Works"]}),i.jsx(jn,{children:"Our AI system analyzes employee data and matches them to standardized roles"})]}),i.jsx(yn,{children:i.jsxs("div",{className:"grid md:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:i.jsx(Wt,{className:"h-5 w-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium",children:"1. Analyze Employees"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"AI reviews employee skills, experience, and current positions"})]})]}),i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"p-2 bg-purple-100 rounded-lg",children:i.jsx(Ft,{className:"h-5 w-5 text-purple-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium",children:"2. Match to Standard Roles"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Compares against standardized role definitions and requirements"})]})]}),i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:i.jsx(Gs,{className:"h-5 w-5 text-green-600"})}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium",children:"3. Assign Best Matches"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Automatically assigns the most suitable standardized role"})]})]})]})})]}),i.jsx(Bj,{}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Benefits of Bulk Role Assignment"})}),i.jsx(yn,{children:i.jsxs("div",{className:"grid md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium mb-2",children:"Time Efficiency"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Process hundreds of employees in minutes instead of hours of manual work"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium mb-2",children:"Consistency"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Ensures all employees are assigned to standardized, consistent role definitions"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium mb-2",children:"AI-Powered Accuracy"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Advanced algorithms ensure optimal matching based on skills and experience"})]}),i.jsxs("div",{children:[i.jsx("h3",{className:"font-medium mb-2",children:"Improved Analytics"}),i.jsx("p",{className:"text-sm text-muted-foreground",children:"Better role standardization enables more accurate workforce analytics"})]})]})})]})]}),zb="https://your-ai-interviewer-domain.com",Ub={startInterview:"/start-interview",startDatabaseInterview:"/start-database-interview",finalizeInterview:"/finalize-interview",getReport:"/get-interview-report"},Bb=class e{static getInstance(){return e.instance||(e.instance=new e),e.instance}async scheduleInterview(e){try{const{data:s}=await en.from("xlsmart_employees").select("*").eq("id",e.employee_id).single(),{data:t}=await en.from("xlsmart_job_descriptions").select("*").eq("id",e.job_description_id).single();if(!s||!t)throw new Error("Employee or job description not found");const{data:a,error:r}=await en.from("interview_sessions").insert([{employee_id:e.employee_id,job_description_id:e.job_description_id,status:"scheduled",scheduled_at:(new Date).toISOString(),interview_type:e.interview_type||"role_assessment",interview_notes:e.interview_notes,duration_minutes:30}]).select().single();if(r)throw r;return a.id}catch(s){throw s}}async startInterview(e){try{const s=await fetch(`${zb}${Ub.startDatabaseInterview}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({interview_id:e})});if(!s.ok){const e=await s.text();throw new Error(`AI Interviewer backend error: ${s.status} - ${e}`)}const t=await s.json();return{...t,interview_id:e,websocket_url:`ws://localhost:8008${t.websocket_url}`}}catch(s){throw await en.from("interview_sessions").update({status:"cancelled"}).eq("id",e),s}}async endInterview(e,s){try{await fetch(`${zb}${Ub.finalizeInterview}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({interviewId:s,transcript:[]})}),await en.from("interview_sessions").update({status:"completed",completed_at:(new Date).toISOString()}).eq("id",e)}catch(t){throw t}}async getInterviewSessions(){try{const{data:e,error:s}=await en.from("interview_sessions").select("\n          *,\n          xlsmart_employees!interview_sessions_employee_id_fkey (\n            id,\n            first_name,\n            last_name,\n            current_position,\n            current_department\n          ),\n          xlsmart_job_descriptions!interview_sessions_job_description_id_fkey (\n            id,\n            title,\n            summary\n          )\n        ").order("scheduled_at",{ascending:!1});if(s)throw s;return(null==e?void 0:e.map(e=>({id:e.id,employee:e.xlsmart_employees?{id:e.xlsmart_employees.id,first_name:e.xlsmart_employees.first_name,last_name:e.xlsmart_employees.last_name,current_position:e.xlsmart_employees.current_position,current_department:e.xlsmart_employees.current_department}:null,job_description:e.xlsmart_job_descriptions?{id:e.xlsmart_job_descriptions.id,title:e.xlsmart_job_descriptions.title,summary:e.xlsmart_job_descriptions.summary,department:"HR Department"}:null,status:e.status,scheduled_at:e.scheduled_at,started_at:e.started_at,completed_at:e.completed_at,duration_minutes:e.duration_minutes,overall_score:e.overall_score,interview_type:e.interview_type,interview_notes:e.interview_notes})))||[]}catch(e){throw e}}getWebSocketUrl(e){return`ws://localhost:8008/ws/interview/${e}`}};t(Bb,"instance");let $b=Bb;$b.getInstance();class Hb{constructor(e,s){t(this,"ws",null),t(this,"onMessageCallback"),t(this,"onDisconnectCallback"),t(this,"heartbeat"),t(this,"lastPong",Date.now()),this.onMessageCallback=e,this.onDisconnectCallback=s}connect(e){return new Promise((s,t)=>{const a=new URL(window.location.origin);a.pathname=a.pathname.replace(/\/$/,"")+`/ws/interview/${e}`,a.protocol=a.protocol.replace("http","ws");const r=a.toString();this.ws=new WebSocket(r),this.ws.onopen=()=>{this.startHeartbeat(),s()},this.ws.onmessage=e=>{const s=JSON.parse(e.data);"pong"===(null==s?void 0:s.type)&&(this.lastPong=Date.now()),this.onMessageCallback(s)},this.ws.onerror=e=>{t(new Error("WebSocket connection failed."))},this.ws.onclose=e=>{this.stopHeartbeat(),this.onDisconnectCallback(e)}})}startHeartbeat(){this.heartbeat=window.setInterval(()=>{this.ws&&this.ws.readyState===WebSocket.OPEN&&(Date.now()-this.lastPong>3e4?this.ws.close(4e3,"Heartbeat timeout"):this.ws.send(JSON.stringify({type:"ping",ts:Date.now()})))},1e4)}stopHeartbeat(){this.heartbeat&&(window.clearInterval(this.heartbeat),this.heartbeat=void 0)}sendAudio(e){var s;(null==(s=this.ws)?void 0:s.readyState)===WebSocket.OPEN&&this.ws.send(JSON.stringify({type:"audio",audio:e}))}sendAudioEnd(){var e;(null==(e=this.ws)?void 0:e.readyState)===WebSocket.OPEN&&this.ws.send(JSON.stringify({type:"audio_end"}))}disconnect(e=!0){this.stopHeartbeat(),this.ws&&this.ws.close(1e3,"User clicked End Interview")}}class Vb{constructor(e){t(this,"stream",null),t(this,"audioContext",null),t(this,"processor",null),t(this,"source",null),this.onAudioData=e}async start(){try{this.stream=await navigator.mediaDevices.getUserMedia({audio:{sampleRate:24e3,channelCount:1,echoCancellation:!0,noiseSuppression:!0,autoGainControl:!0}}),this.audioContext=new AudioContext({sampleRate:24e3,latencyHint:"interactive"}),"suspended"===this.audioContext.state&&await this.audioContext.resume(),this.source=this.audioContext.createMediaStreamSource(this.stream),this.processor=this.audioContext.createScriptProcessor(2048,1,1),this.processor.onaudioprocess=e=>{const s=e.inputBuffer.getChannelData(0),t=new Float32Array(s.length);t.set(s),this.onAudioData(t)},this.source.connect(this.processor),this.processor.connect(this.audioContext.destination)}catch(e){throw e}}async stop(){return new Promise(e=>{this.source&&(this.source.disconnect(),this.source=null),this.processor&&(this.processor.disconnect(),this.processor=null),this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null),this.audioContext?this.audioContext.close().then(()=>{this.audioContext=null,e()}).catch(()=>{this.audioContext=null,e()}):e()})}}for(var Gb=function(e){var s,t,a=function(e){var s=e.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=e.indexOf("=");-1===t&&(t=s);var a=t===s?0:4-t%4;return[t,a]}(e),r=a[0],n=a[1],i=new Wb(function(e,s,t){return 3*(s+t)/4-t}(0,r,n)),l=0,c=n>0?r-4:r;for(t=0;t<c;t+=4)s=qb[e.charCodeAt(t)]<<18|qb[e.charCodeAt(t+1)]<<12|qb[e.charCodeAt(t+2)]<<6|qb[e.charCodeAt(t+3)],i[l++]=s>>16&255,i[l++]=s>>8&255,i[l++]=255&s;2===n&&(s=qb[e.charCodeAt(t)]<<2|qb[e.charCodeAt(t+1)]>>4,i[l++]=255&s);1===n&&(s=qb[e.charCodeAt(t)]<<10|qb[e.charCodeAt(t+1)]<<4|qb[e.charCodeAt(t+2)]>>2,i[l++]=s>>8&255,i[l++]=255&s);return i},qb=[],Wb="undefined"!=typeof Uint8Array?Uint8Array:Array,Yb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Kb=0;Kb<64;++Kb)qb[Yb.charCodeAt(Kb)]=Kb;qb["-".charCodeAt(0)]=62,qb["_".charCodeAt(0)]=63;class Jb{constructor(){t(this,"audioContext",null),t(this,"audioQueue",[]),t(this,"isPlaying",!1),t(this,"currentSource",null)}async initialize(){if(!this.audioContext)try{this.audioContext=new(window.AudioContext||window.webkitAudioContext)({sampleRate:24e3}),"suspended"===this.audioContext.state&&await this.audioContext.resume()}catch(e){throw new Error("Could not initialize audio playback.")}}stopAndClearQueue(){this.audioQueue=[],this.currentSource&&(this.currentSource.stop(),this.currentSource=null),this.isPlaying=!1}playChunk(e){try{const s=Gb(e);this.audioQueue.push(s.buffer),this.isPlaying||this.processQueue()}catch(s){}}async processQueue(){if(this.isPlaying||0===this.audioQueue.length)return;this.isPlaying=!0;const e=this.audioQueue.shift();e&&await this.playAudioData(e),this.isPlaying=!1,this.audioQueue.length>0&&this.processQueue()}playAudioData(e){return new Promise((s,t)=>{if(this.audioContext)try{const t=new DataView(e),a=e.byteLength/2;if(0===a)return void s();const r=this.audioContext.createBuffer(1,a,this.audioContext.sampleRate),n=r.getChannelData(0);for(let e=0;e<a;e++){const s=t.getInt16(2*e,!0);n[e]=s/32768}const i=this.audioContext.createBufferSource();i.buffer=r,i.connect(this.audioContext.destination),i.onended=()=>{this.currentSource=null,s()},this.currentSource=i,i.start(0)}catch(a){t(a)}else t(new Error("AudioContext not initialized."))})}}class Xb extends Error{constructor(e,s,t){super(e),this.statusCode=s,this.details=t,this.name="InterviewApiError"}}const Zb=({interviewId:e,jobTitle:s,companyName:t,onInterviewComplete:a})=>{const{toast:r}=De(),[n,l]=ce.useState(!1),[c,o]=ce.useState("disconnected"),[d,m]=ce.useState(!0),[h,u]=ce.useState(!0),[x,p]=ce.useState(!1),[f,g]=ce.useState([]),[v,j]=ce.useState(!1);ce.useState(0);const y=ce.useRef(null),b=ce.useRef(null),N=ce.useRef(null),w=ce.useRef(null),_=ce.useRef(!1),k=ce.useCallback(e=>{var s,t,a;const r={...e,timestamp:(new Date).toISOString()};g(e=>[...e,r]),"input_audio_buffer.speech_started"===e.type&&(null==(s=y.current)||s.stopAndClearQueue(),j(!1)),"response.audio.delta"===e.type&&e.delta?(null==(t=y.current)||t.playChunk(e.delta),j(!0)):"response.done"===e.type&&j(!1),"audio"===e.type&&v&&(null==(a=y.current)||a.stopAndClearQueue(),j(!1))},[v]),S=ce.useCallback(e=>{o("disconnected");e&&e.code&&e.code<4e3&&!_.current?(r({title:"The AI has concluded the interview.",description:"Finalizing and saving your results automatically."}),E(!0)):r({title:"Connection Closed",description:"The interview session has ended."})},[r]),E=async(s=!1)=>{var t,n,i;if(_.current)return;_.current=!0,null==(t=y.current)||t.stopAndClearQueue(),l(!0),s||null==(n=N.current)||n.disconnect(),w.current&&await w.current.stop();const c=null==(i=b.current)?void 0:i.srcObject;null==c||c.getTracks().forEach(e=>e.stop());try{await async function(e){try{const s=await fetch("http://localhost:8008/finalize-interview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!s.ok){let e;try{e=await s.json()}catch{e={detail:`HTTP ${s.status} ${s.statusText}`}}throw new Xb(e.detail||e.message||"Failed to finalize interview",s.status,e)}return await s.json()}catch(s){if(s instanceof Xb)throw s;throw new Xb(`Network error finalizing interview: ${s instanceof Error?s.message:"Unknown error"}`,void 0,s)}}({interviewId:e,transcript:f}),r({title:"Interview Saved",description:"AI analysis is now processing."}),a()}catch(o){r(o instanceof Xb?{title:"Error Saving Interview",description:o.message,variant:"destructive"}:{title:"Error Saving Interview",description:o.message||"Failed to save interview",variant:"destructive"})}finally{l(!1)}};return i.jsxs("div",{className:"h-full w-full flex flex-col p-6",children:[i.jsxs(Dn,{children:[i.jsxs(On,{className:"flex items-center gap-2",children:["AI Interview: ",s]}),i.jsx(Fn,{children:t})]}),i.jsx(fn,{className:"my-4",children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("div",{className:"w-3 h-3 rounded-full "+("connected"===c?"bg-green-500":"connecting"===c?"bg-yellow-500":"bg-red-500")}),i.jsx("span",{className:`text-sm font-medium ${(e=>{switch(e){case"connected":return"text-green-600";case"connecting":return"text-yellow-600";case"disconnected":return"text-red-600";default:return"text-gray-600"}})(c)}`,children:c.charAt(0).toUpperCase()+c.slice(1)})]}),v&&i.jsxs(zn,{variant:"secondary",className:"flex items-center gap-1",children:[i.jsx(As,{className:"w-3 h-3"})," AI Speaking..."]})]})})}),i.jsxs("div",{className:"flex-1 flex gap-4",children:[i.jsxs(fn,{className:"w-1/2",children:[i.jsx(gn,{className:"pb-2",children:i.jsx(vn,{className:"text-sm",children:"Your Video"})}),i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"relative bg-gray-900 rounded-lg overflow-hidden aspect-video",children:[i.jsx("video",{ref:b,autoPlay:!0,muted:!0,playsInline:!0,className:"w-full h-full object-cover"}),!d&&i.jsx("div",{className:"absolute inset-0 bg-gray-800 flex items-center justify-center",children:i.jsx(Yt,{className:"w-12 h-12 text-gray-400"})})]})})]}),i.jsxs(fn,{className:"w-1/2",children:[i.jsx(gn,{className:"pb-2",children:i.jsxs(vn,{className:"text-sm flex items-center gap-2",children:[i.jsx(As,{className:"w-4 h-4"})," AI Interviewer"]})}),i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 rounded-lg p-6 aspect-video flex flex-col items-center justify-center",children:[i.jsx("div",{className:"w-20 h-20 bg-primary rounded-full flex items-center justify-center mb-4",children:i.jsx(As,{className:"w-10 h-10 text-white"})}),i.jsx("h3",{className:"font-semibold text-lg mb-2",children:"AI Interviewer"}),i.jsx("p",{className:"text-sm text-muted-foreground text-center mb-4",children:v?"Speaking...":"connected"===c?"Listening...":"Idle"}),v&&i.jsxs("div",{className:"flex gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"0ms"}}),i.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"150ms"}}),i.jsx("div",{className:"w-2 h-2 bg-primary rounded-full animate-bounce",style:{animationDelay:"300ms"}})]})]})})]})]}),i.jsx(fn,{className:"mt-4",children:i.jsx(yn,{className:"p-4",children:x?i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx(nn,{variant:d?"default":"secondary",size:"sm",onClick:()=>{var e;const s=null==(e=b.current)?void 0:e.srcObject,t=null==s?void 0:s.getVideoTracks()[0];t&&(t.enabled=!t.enabled,m(t.enabled))},children:d?i.jsx(Kt,{className:"w-4 h-4"}):i.jsx(Yt,{className:"w-4 h-4"})}),i.jsx(nn,{variant:h?"default":"secondary",size:"sm",onClick:async()=>{var e;w.current&&(h?(await w.current.stop(),r({title:"Mic Muted",description:"The AI will no longer hear you."})):(await w.current.start(),r({title:"Mic Unmuted",description:"The AI can now hear you."})));const s=null==(e=b.current)?void 0:e.srcObject,t=null==s?void 0:s.getAudioTracks()[0];t&&(t.enabled=!h),u(e=>!e)},children:h?i.jsx(ft,{className:"w-4 h-4"}):i.jsx(pt,{className:"w-4 h-4"})})]}),i.jsx("div",{className:"flex gap-2",children:i.jsxs(nn,{variant:"destructive",size:"sm",onClick:()=>E(),disabled:n,children:[n?i.jsx(ot,{className:"w-4 h-4 mr-2 animate-spin"}):i.jsx(bt,{className:"w-4 h-4 mr-2"}),n?"Saving...":"End Interview"]})})]}):i.jsxs("div",{className:"text-center",children:[i.jsx(nn,{onClick:async()=>{l(!0),o("connecting");try{y.current=new Jb,await y.current.initialize();const s=await async function(e){try{const s=await fetch("http://localhost:8008/start-database-interview",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({interview_id:e})});if(!s.ok){let e;try{e=await s.json()}catch{e={detail:`HTTP ${s.status} ${s.statusText}`}}throw new Xb(e.detail||e.message||"Failed to start interview session",s.status,e)}return await s.json()}catch(s){if(s instanceof Xb)throw s;throw new Xb(`Network error starting interview: ${s instanceof Error?s.message:"Unknown error"}`,void 0,s)}}(e),{session_id:t}=s;N.current=new Hb(k,S),await N.current.connect(t);const a=await navigator.mediaDevices.getUserMedia({video:!0,audio:!0});b.current&&(b.current.srcObject=a),w.current=new Vb(e=>{var s;const t=new Int16Array(e.length);for(let r=0;r<e.length;r++)t[r]=Math.round(32767*Math.max(-1,Math.min(1,e[r])));const a=btoa(String.fromCharCode.apply(null,Array.from(new Uint8Array(t.buffer))));null==(s=N.current)||s.sendAudio(a)}),await w.current.start(),p(!0),o("connected"),r({title:"Session Started",description:"The AI interviewer is ready."})}catch(s){o("disconnected"),r(s instanceof Xb?{title:"Connection Error",description:s.message,variant:"destructive"}:{title:"Connection Error",description:s.message||"Failed to start interview",variant:"destructive"})}finally{l(!1)}},disabled:n,size:"lg",className:"px-8",children:n?i.jsxs(i.Fragment,{children:[i.jsx(ot,{className:"w-5 h-5 mr-2 animate-spin"}),"Connecting..."]}):i.jsxs(i.Fragment,{children:[i.jsx(wt,{className:"w-5 h-5 mr-2"}),"Start Video Interview"]})}),i.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Click to begin your AI-powered video interview"})]})})})]})};function Qb(){var e,s,t,a,r,n;const{toast:l}=De(),c=$b.getInstance(),[o,d]=ce.useState("overview"),[m,h]=ce.useState([]),[u,x]=ce.useState([]),[p,f]=ce.useState([]),[g,v]=ce.useState(!1),[j,y]=ce.useState(""),[b,N]=ce.useState("all"),[w,_]=ce.useState(!1),[k,S]=ce.useState(""),[E,T]=ce.useState(""),[C,A]=ce.useState(""),[R,I]=ce.useState(""),[P,D]=ce.useState(null);ce.useState(!1);const[M,O]=ce.useState("idle"),F=p.find(e=>"in_progress"===e.status)||null;ce.useEffect(()=>{L()},[]);const L=async()=>{v(!0);try{await Promise.all([z(),U(),B()])}catch(e){l({title:"Error",description:"Failed to load dashboard data",variant:"destructive"})}finally{v(!1)}},z=async()=>{const{data:e,error:s}=await en.from("xlsmart_employees").select("*").order("first_name");if(s)throw s;h(e||[])},U=async()=>{const{data:e,error:s}=await en.from("xlsmart_job_descriptions").select("*").order("title");if(s)throw s;const t=(null==e?void 0:e.map(e=>({id:e.id,title:e.title,department:e.department||"General",level:e.level||"Mid",description:e.description||"",requirements:e.requirements?e.requirements.split(","):[],skills_required:e.skills_required||[]})))||[];x(t)},B=async()=>{try{const e=await c.getInterviewSessions();f(e)}catch(e){l({title:"Error",description:"Failed to load interview sessions",variant:"destructive"})}},$=()=>{S(""),T(""),A(""),I("")},H=p.filter(e=>{var s,t,a,r,n,i;const l=!j||(null==(t=null==(s=e.employee)?void 0:s.first_name)?void 0:t.toLowerCase().includes(j.toLowerCase()))||(null==(r=null==(a=e.employee)?void 0:a.last_name)?void 0:r.toLowerCase().includes(j.toLowerCase()))||(null==(i=null==(n=e.job_description)?void 0:n.title)?void 0:i.toLowerCase().includes(j.toLowerCase())),c="all"===b||e.status===b;return l&&c}),V=e=>{const s={scheduled:{color:"bg-blue-100 text-blue-800",icon:Ds},in_progress:{color:"bg-yellow-100 text-yellow-800",icon:ot},completed:{color:"bg-green-100 text-green-800",icon:Gs},cancelled:{color:"bg-red-100 text-red-800",icon:Vs}}[e],t=s.icon;return i.jsxs(zn,{className:s.color,children:[i.jsx(t,{className:"h-3 w-3 mr-1"}),e.charAt(0).toUpperCase()+e.slice(1).replace("_"," ")]})};return g&&0===m.length?i.jsx("div",{className:"flex items-center justify-center h-96",children:i.jsx(ot,{className:"h-8 w-8 animate-spin"})}):i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"AI Interview Center"}),i.jsx("p",{className:"text-muted-foreground mt-2",children:"Conduct AI-powered interviews for employee role assessments and career development"})]}),i.jsxs(Cn,{open:w,onOpenChange:_,children:[i.jsx(An,{asChild:!0,children:i.jsxs(nn,{className:"bg-blue-600 hover:bg-blue-700",children:[i.jsx(Ds,{className:"h-4 w-4 mr-2"}),"Schedule Interview"]})}),i.jsxs(Pn,{className:"max-w-2xl",children:[i.jsx(Dn,{children:i.jsx(On,{children:"Schedule AI Interview"})}),i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"employee",children:"Employee"}),i.jsxs(bn,{value:k,onValueChange:S,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select employee"})}),i.jsx(Sn,{children:m.map(e=>i.jsxs(En,{value:e.id,children:[e.first_name," ",e.last_name," - ",e.current_position]},e.id))})]})]}),i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"jobDescription",children:"Target Role"}),i.jsxs(bn,{value:E,onValueChange:T,children:[i.jsx(wn,{children:i.jsx(Nn,{placeholder:"Select target role"})}),i.jsx(Sn,{children:u.map(e=>i.jsxs(En,{value:e.id,children:[e.title," - ",e.department]},e.id))})]})]})]}),i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"scheduledDate",children:"Scheduled Date & Time"}),i.jsx(ln,{id:"scheduledDate",type:"datetime-local",value:C,onChange:e=>A(e.target.value)})]}),i.jsxs("div",{children:[i.jsx(mn,{htmlFor:"notes",children:"Interview Notes (Optional)"}),i.jsx(kf,{id:"notes",placeholder:"Any specific focus areas or notes for this interview...",value:R,onChange:e=>I(e.target.value)})]}),i.jsxs("div",{className:"flex justify-end space-x-2 pt-4",children:[i.jsx(nn,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),i.jsxs(nn,{onClick:async()=>{if(k&&E&&C){v(!0);try{await c.scheduleInterview({employee_id:k,job_description_id:E,interview_type:"role_assessment",interview_notes:R});await B(),_(!1),$();const e=m.find(e=>e.id===k);l({title:"Interview Scheduled",description:`Interview scheduled successfully for ${null==e?void 0:e.first_name} ${null==e?void 0:e.last_name}`})}catch(e){l({title:"Error",description:"Failed to schedule interview",variant:"destructive"})}finally{v(!1)}}else l({title:"Missing Information",description:"Please fill all required fields",variant:"destructive"})},disabled:g,children:[g?i.jsx(ot,{className:"h-4 w-4 animate-spin mr-2"}):null,"Schedule Interview"]})]})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Interviews"}),i.jsx("p",{className:"text-3xl font-bold",children:p.length})]}),i.jsx(xt,{className:"h-8 w-8 text-blue-600"})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Active Sessions"}),i.jsx("p",{className:"text-3xl font-bold",children:p.filter(e=>"in_progress"===e.status).length})]}),i.jsx(ft,{className:"h-8 w-8 text-green-600"})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Completed"}),i.jsx("p",{className:"text-3xl font-bold",children:p.filter(e=>"completed"===e.status).length})]}),i.jsx(Gs,{className:"h-8 w-8 text-blue-600"})]})})}),i.jsx(fn,{children:i.jsx(yn,{className:"p-6",children:i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-muted-foreground",children:"Avg Score"}),i.jsx("p",{className:"text-3xl font-bold",children:"--"})]}),i.jsx(Ut,{className:"h-8 w-8 text-green-600"})]})})})]}),i.jsxs(hn,{value:o,onValueChange:d,className:"w-full",children:[i.jsxs(un,{className:"grid w-full grid-cols-3",children:[i.jsx(xn,{value:"overview",children:"Interview Sessions"}),i.jsx(xn,{value:"active",children:"Active Interview"}),i.jsx(xn,{value:"analytics",children:"Analytics"})]}),i.jsxs(pn,{value:"overview",className:"space-y-6",children:[i.jsx(fn,{children:i.jsx(yn,{className:"p-4",children:i.jsxs("div",{className:"flex space-x-4",children:[i.jsx("div",{className:"flex-1",children:i.jsxs("div",{className:"relative",children:[i.jsx(Ct,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),i.jsx(ln,{placeholder:"Search employees or roles...",value:j,onChange:e=>y(e.target.value),className:"pl-10"})]})}),i.jsxs(bn,{value:b,onValueChange:N,children:[i.jsx(wn,{className:"w-48",children:i.jsx(Nn,{placeholder:"Filter by status"})}),i.jsxs(Sn,{children:[i.jsx(En,{value:"all",children:"All Statuses"}),i.jsx(En,{value:"scheduled",children:"Scheduled"}),i.jsx(En,{value:"in_progress",children:"In Progress"}),i.jsx(En,{value:"completed",children:"Completed"}),i.jsx(En,{value:"cancelled",children:"Cancelled"})]})]})]})})}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Interview Sessions"})}),i.jsx(yn,{children:i.jsxs(el,{children:[i.jsx(sl,{children:i.jsxs(al,{children:[i.jsx(rl,{children:"Employee"}),i.jsx(rl,{children:"Target Role"}),i.jsx(rl,{children:"Status"}),i.jsx(rl,{children:"Scheduled"}),i.jsx(rl,{children:"Duration"}),i.jsx(rl,{children:"Score"}),i.jsx(rl,{children:"Actions"})]})}),i.jsx(tl,{children:0===H.length?i.jsx(al,{children:i.jsx(nl,{colSpan:7,className:"text-center py-8 text-muted-foreground",children:"No interview sessions found. Schedule your first interview to get started."})}):H.map(e=>{var s,t,a,r,n;return i.jsxs(al,{children:[i.jsx(nl,{children:i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:i.jsx(qt,{className:"h-4 w-4 text-blue-600"})}),i.jsxs("div",{children:[i.jsxs("p",{className:"font-medium",children:[null==(s=e.employee)?void 0:s.first_name," ",null==(t=e.employee)?void 0:t.last_name]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:null==(a=e.employee)?void 0:a.current_position})]})]})}),i.jsx(nl,{children:i.jsxs("div",{children:[i.jsx("p",{className:"font-medium",children:null==(r=e.job_description)?void 0:r.title}),i.jsx("p",{className:"text-sm text-muted-foreground",children:null==(n=e.job_description)?void 0:n.department})]})}),i.jsx(nl,{children:V(e.status)}),i.jsx(nl,{children:new Date(e.scheduled_at).toLocaleDateString()}),i.jsx(nl,{children:e.duration_minutes?`${e.duration_minutes}m`:"--"}),i.jsx(nl,{children:e.score?i.jsxs(zn,{className:"bg-green-100 text-green-800",children:[e.score,"/100"]}):"--"}),i.jsx(nl,{children:i.jsxs("div",{className:"flex space-x-2",children:["scheduled"===e.status&&i.jsxs(nn,{size:"sm",onClick:()=>(async e=>{var s,t;v(!0);try{D(e),l({title:"Interview Interface Ready",description:`Opening AI Interview for ${null==(s=e.employee)?void 0:s.first_name} ${null==(t=e.employee)?void 0:t.last_name}`})}catch(a){l({title:"Error",description:a instanceof Error?a.message:"Failed to prepare interview",variant:"destructive"})}finally{v(!1)}})(e),disabled:g,children:[i.jsx(wt,{className:"h-3 w-3 mr-1"}),"Start"]}),"in_progress"===e.status&&i.jsxs(nn,{size:"sm",variant:"default",onClick:()=>{D(e)},children:[i.jsx(ht,{className:"h-3 w-3 mr-1"}),"View Interview"]}),"completed"===e.status&&i.jsxs(nn,{size:"sm",variant:"outline",children:[i.jsx(Qs,{className:"h-3 w-3 mr-1"}),"View Results"]})]})})]},e.id)})})]})})]})]}),i.jsx(pn,{value:"active",className:"space-y-6",children:F?i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center space-x-2",children:[i.jsx(Rs,{className:"h-5 w-5 text-blue-600"}),i.jsx("span",{children:"Active Interview Session"}),V("active"===M?"in_progress":"scheduled")]})}),i.jsxs(yn,{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[i.jsx("div",{className:"space-y-4",children:i.jsxs("div",{children:[i.jsx(mn,{className:"text-sm font-medium text-muted-foreground",children:"Employee"}),i.jsxs("p",{className:"text-lg font-semibold",children:[null==(e=F.employee)?void 0:e.first_name," ",null==(s=F.employee)?void 0:s.last_name]}),i.jsx("p",{className:"text-sm text-muted-foreground",children:null==(t=F.employee)?void 0:t.current_position})]})}),i.jsx("div",{className:"space-y-4",children:i.jsxs("div",{children:[i.jsx(mn,{className:"text-sm font-medium text-muted-foreground",children:"Target Role"}),i.jsx("p",{className:"text-lg font-semibold",children:null==(a=F.job_description)?void 0:a.title}),i.jsx("p",{className:"text-sm text-muted-foreground",children:null==(r=F.job_description)?void 0:r.department})]})})]}),i.jsxs("div",{className:"border rounded-lg p-6 bg-gray-50",children:[i.jsxs("div",{className:"flex items-center justify-between mb-4",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Interview Controls"}),i.jsxs("div",{className:"flex items-center space-x-2",children:["connecting"===M&&i.jsxs(zn,{className:"bg-yellow-100 text-yellow-800",children:[i.jsx(ot,{className:"h-3 w-3 mr-1 animate-spin"}),"Connecting..."]}),"active"===M&&i.jsxs(zn,{className:"bg-green-100 text-green-800",children:[i.jsx(ft,{className:"h-3 w-3 mr-1"}),"Recording"]})]})]}),i.jsx("div",{className:"flex space-x-4",children:"active"===M?i.jsxs(i.Fragment,{children:[i.jsxs(nn,{variant:"outline",disabled:!0,children:[i.jsx(jt,{className:"h-4 w-4 mr-2"}),"Pause"]}),i.jsxs(nn,{variant:"destructive",onClick:async()=>{O("idle"),D(null),await B(),l({title:"Interview Ended",description:"Interview session has been terminated."})},children:[i.jsx(Mt,{className:"h-4 w-4 mr-2"}),"End Interview"]})]}):i.jsx("div",{className:"text-center w-full py-4",children:i.jsx("p",{className:"text-muted-foreground",children:"connecting"===M?"Connecting to AI interviewer...":"Interview controls will appear when session is active"})})})]}),i.jsxs("div",{className:"border rounded-lg p-4",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Live Transcript"}),i.jsx("div",{className:"bg-white border rounded p-4 h-40 overflow-y-auto",children:"active"===M?i.jsx("p",{className:"text-muted-foreground italic",children:"Transcript will appear here during the interview..."}):i.jsx("p",{className:"text-muted-foreground",children:"Start the interview to see live transcript"})})]})]})]}):i.jsx(fn,{children:i.jsx(yn,{className:"py-16",children:i.jsxs("div",{className:"text-center",children:[i.jsx(Rs,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold mb-2",children:"No Active Interview"}),i.jsx("p",{className:"text-muted-foreground mb-4",children:"Start an interview from the sessions tab to begin"}),i.jsx(nn,{onClick:()=>d("overview"),children:"View Interview Sessions"})]})})})}),i.jsx(pn,{value:"analytics",className:"space-y-6",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Interview Analytics"})}),i.jsx(yn,{children:i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Ut,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),i.jsx("p",{className:"text-muted-foreground",children:"Analytics will be available after conducting interviews"})]})})]}),i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsx(vn,{children:"Performance Insights"})}),i.jsx(yn,{children:i.jsxs("div",{className:"text-center py-8",children:[i.jsx(Ts,{className:"h-16 w-16 text-muted-foreground mx-auto mb-4"}),i.jsx("p",{className:"text-muted-foreground",children:"Performance insights will be generated from interview results"})]})})]})]})})]}),i.jsx(Cn,{open:null!==P,onOpenChange:()=>D(null),children:i.jsx(Pn,{className:"max-w-6xl h-[90vh]",children:P&&i.jsx(Zb,{interviewId:P.id,jobTitle:(null==(n=P.job_description)?void 0:n.title)||"Position Assessment",companyName:"XLSMART",onInterviewComplete:()=>{D(null),B(),l({title:"Interview Completed",description:"Interview has been saved and is being analyzed."})}})})})]})}function eN(){const[e,s]=ce.useState(null),[t,a]=ce.useState(null),[r,n]=ce.useState(!1),[l,c]=ce.useState(null),o=async(e=!1)=>{try{n(!0),c(null);const t=e?"td-overview?refresh=1":"td-overview",{data:r,error:i}=await en.functions.invoke(t);if(i)throw new Error(`Overview fetch failed: ${i.message}`);s(r);const{data:l,error:o}=await en.functions.invoke("td-overview/health");if(o)throw new Error(`Health check failed: ${o.message}`);a(l)}catch(t){c(t instanceof Error?t.message:"Unknown error occurred")}finally{n(!1)}};ce.useEffect(()=>{o()},[]);const d=e=>e?i.jsx(Gs,{className:"h-4 w-4 text-green-600"}):i.jsx(Ws,{className:"h-4 w-4 text-red-600"}),m=(e,s,t)=>i.jsx(zn,{variant:e?"default":"destructive",children:e?s:t});return i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-3xl font-bold text-foreground",children:"Training & Development Diagnostics"}),i.jsx("p",{className:"text-muted-foreground text-lg",children:"Schema mapping and system health monitoring"})]}),i.jsxs(nn,{onClick:()=>{o(!0)},disabled:r,className:"flex items-center gap-2",children:[r?i.jsx(ot,{className:"h-4 w-4 animate-spin"}):i.jsx(kt,{className:"h-4 w-4"}),"Re-scan Schema"]})]}),l&&i.jsxs(Hi,{variant:"destructive",children:[i.jsx(Bt,{className:"h-4 w-4"}),i.jsx(Vi,{children:l})]}),t&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Js,{className:"h-5 w-5"}),"System Health"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[d(t.ok),i.jsx("span",{className:"font-medium",children:"Status:"}),m(t.ok,"Healthy","Unhealthy")]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(it,{className:"h-4 w-4 text-blue-600"}),i.jsx("span",{className:"font-medium",children:"Version:"}),i.jsx(zn,{variant:"outline",children:t.version})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(it,{className:"h-4 w-4 text-blue-600"}),i.jsx("span",{className:"font-medium",children:"Last Check:"}),i.jsx("span",{className:"text-sm text-muted-foreground",children:new Date(t.timestamp).toLocaleString()})]})]})})]}),(null==e?void 0:e.schemaNotes)&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Js,{className:"h-5 w-5"}),"Schema Mapping"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("h4",{className:"font-medium",children:"Training Tables"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Programs Table:"}),i.jsxs("div",{className:"flex items-center gap-2",children:[d(!!e.schemaNotes.programsTable),i.jsx("span",{className:"text-sm font-mono",children:e.schemaNotes.programsTable||"Not found"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Participants Table:"}),i.jsxs("div",{className:"flex items-center gap-2",children:[d(!!e.schemaNotes.participantsTable),i.jsx("span",{className:"text-sm font-mono",children:e.schemaNotes.participantsTable||"Not found"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Progress Table:"}),i.jsxs("div",{className:"flex items-center gap-2",children:[d(!!e.schemaNotes.progressTable),i.jsx("span",{className:"text-sm font-mono",children:e.schemaNotes.progressTable||"Not found"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Sessions Table:"}),i.jsxs("div",{className:"flex items-center gap-2",children:[d(!!e.schemaNotes.sessionsTable),i.jsx("span",{className:"text-sm font-mono",children:e.schemaNotes.sessionsTable||"Not found"})]})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("h4",{className:"font-medium",children:"Pathways & Categories"}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Pathways Table:"}),i.jsxs("div",{className:"flex items-center gap-2",children:[d(!!e.schemaNotes.pathwaysTable),i.jsx("span",{className:"text-sm font-mono",children:e.schemaNotes.pathwaysTable||"Not found"})]})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("span",{className:"text-sm",children:"Categories Field:"}),i.jsxs("div",{className:"flex items-center gap-2",children:[d(!!e.schemaNotes.categoriesField),i.jsx("span",{className:"text-sm font-mono",children:e.schemaNotes.categoriesField||"Not found"})]})]})]})]})]}),e.schemaNotes.warnings.length>0&&i.jsxs("div",{className:"mt-4",children:[i.jsx("h4",{className:"font-medium text-amber-600 mb-2",children:"Warnings"}),i.jsx("div",{className:"space-y-1",children:e.schemaNotes.warnings.map((e,s)=>i.jsxs(Hi,{variant:"destructive",children:[i.jsx(Bt,{className:"h-4 w-4"}),i.jsx(Vi,{className:"text-sm",children:e})]},s))})]})]})})]}),e&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(it,{className:"h-5 w-5"}),"Raw Overview Data"]})}),i.jsx(yn,{children:i.jsx("pre",{className:"bg-muted p-4 rounded-lg overflow-auto text-sm",children:JSON.stringify(e,null,2)})})]}),(null==e?void 0:e.pathwaysHealth)&&i.jsxs(fn,{children:[i.jsx(gn,{children:i.jsxs(vn,{className:"flex items-center gap-2",children:[i.jsx(Js,{className:"h-5 w-5"}),"Development Pathways Health"]})}),i.jsx(yn,{children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[d(e.pathwaysHealth.tableFound),i.jsx("span",{className:"font-medium",children:"Table Found:"}),m(e.pathwaysHealth.tableFound,"Yes","No")]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(it,{className:"h-4 w-4 text-blue-600"}),i.jsx("span",{className:"font-medium",children:"Row Count:"}),i.jsx(zn,{variant:"outline",children:e.pathwaysHealth.rowCount})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(it,{className:"h-4 w-4 text-blue-600"}),i.jsx("span",{className:"font-medium",children:"Last Created:"}),i.jsx("span",{className:"text-sm text-muted-foreground",children:e.pathwaysHealth.lastCreatedAt?new Date(e.pathwaysHealth.lastCreatedAt).toLocaleDateString():"Never"})]})]}),e.pathwaysHealth.sample.length>0&&i.jsxs("div",{children:[i.jsx("h4",{className:"font-medium mb-2",children:"Sample Pathways"}),i.jsx("div",{className:"space-y-2",children:e.pathwaysHealth.sample.map(e=>i.jsxs("div",{className:"flex items-center justify-between p-2 bg-muted rounded",children:[i.jsxs("div",{children:[i.jsx("span",{className:"font-medium",children:e.name}),i.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",e.status,")"]})]}),i.jsx("span",{className:"text-xs text-muted-foreground",children:new Date(e.created_at).toLocaleDateString()})]},e.id))})]}),!e.pathwaysHealth.tableFound&&i.jsxs(Hi,{children:[i.jsx(Bt,{className:"h-4 w-4"}),i.jsx(Vi,{children:"No pathways table found in Supabase. If the analysis is running, ensure it persists to the pathways table."})]})]})})]})]})}const sN=()=>{const e=he();return ce.useEffect(()=>{},[e.pathname]),i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:i.jsxs("div",{className:"text-center",children:[i.jsx("h1",{className:"text-4xl font-bold mb-4",children:"404"}),i.jsx("p",{className:"text-xl text-gray-600 mb-4",children:"Oops! Page not found"}),i.jsx("a",{href:"/",className:"text-blue-500 hover:text-blue-700 underline",children:"Return to Home"})]})})},tN=new be,aN=()=>i.jsx(Ne,{client:tN,children:i.jsx(an,{children:i.jsxs(Jr,{children:[i.jsx(Qa,{}),i.jsx(wr,{}),i.jsx(fe,{children:i.jsxs(ge,{children:[i.jsx(ve,{path:"/",element:i.jsx(Tn,{})}),i.jsx(ve,{path:"/legacy-dashboard",element:i.jsx(Vj,{})}),i.jsxs(ve,{path:"/dashboard",element:i.jsx(jy,{}),children:[i.jsx(ve,{index:!0,element:i.jsx(Cy,{})}),i.jsx(ve,{path:"analytics",element:i.jsx(yy,{})}),i.jsx(ve,{path:"employees",element:i.jsx(ky,{})}),i.jsx(ve,{path:"bulk-role-assignment",element:i.jsx(Lb,{})}),i.jsx(ve,{path:"roles",element:i.jsx(Cy,{})}),i.jsx(ve,{path:"job-descriptions",element:i.jsx(Py,{})}),i.jsx(ve,{path:"job-descriptions/review",element:i.jsx(Dy,{})}),i.jsx(ve,{path:"skills",element:i.jsx(My,{})}),i.jsx(ve,{path:"career-paths",element:i.jsx(Ly,{})}),i.jsx(ve,{path:"mobility",element:i.jsx(Uy,{})}),i.jsx(ve,{path:"development",element:i.jsx($y,{})}),i.jsx(ve,{path:"training",element:i.jsx(Fb,{})}),i.jsx(ve,{path:"certifications",element:i.jsx(qy,{})}),i.jsx(ve,{path:"workforce-analytics",element:i.jsx(Zy,{})}),i.jsx(ve,{path:"skill-inventory",element:i.jsx(Qy,{})}),i.jsx(ve,{path:"ai-interviews",element:i.jsx(Qb,{})})]}),i.jsx(ve,{path:"/admin",children:i.jsx(ve,{path:"td-diagnostics",element:i.jsx(eN,{})})}),i.jsx(ve,{path:"*",element:i.jsx(sN,{})})]})})]})})});e(document.getElementById("root")).render(i.jsx(aN,{}));
